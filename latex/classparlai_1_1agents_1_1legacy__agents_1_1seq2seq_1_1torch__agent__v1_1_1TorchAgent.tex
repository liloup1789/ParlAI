\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent}\index{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent@{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=279pt]{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a00701a40d62943dbd887525bf8e8002d}{add\+\_\+cmdline\+\_\+args} (cls, argparser)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a1c4eb91757ee23e75edfa957d05db338}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4e938a91873bd6edde0ac7ed5299bc6a}{opt}, shared=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a1727b17db185dcc7237d893018c7b76c}{init\+\_\+optim} (self, params, optim\+\_\+states=None, saved\+\_\+optim\+\_\+type=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_af97699a6b03a17969830db378f09cac4}{receive\+\_\+metrics} (self, metrics\+\_\+dict)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3d922c4a8452c9e44fa2478e6fecdfd1}{share} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a866838e1c81063a3ec18c5609e029f90}{vectorize} (self, obs, add\+\_\+start=True, add\+\_\+end=True, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ac0286e4dbf6dc71bda0c364851de5f22}{truncate}=None, split\+\_\+lines=False)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ab8b2fa26aabfd9d7e7abb0abbcfe8044}{batchify} (self, obs\+\_\+batch, sort=False, is\+\_\+valid=lambda obs\+:\textquotesingle{}text\+\_\+vec\textquotesingle{} in obs or \textquotesingle{}image\textquotesingle{} in obs)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_acac419cfad0fc5988e7e796c244f3a9f}{match\+\_\+batch} (self, batch\+\_\+reply, valid\+\_\+inds, output=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a8984452b8b4e6194625530aeae49b243}{get\+\_\+dialog\+\_\+history} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a04fa334c086cf9afa815a44f1948e625}{observation}, reply=None, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a81f970d715f2525ad342330a28703c5c}{add\+\_\+person\+\_\+tokens}=False, add\+\_\+p1\+\_\+after\+\_\+newln=False)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_abf7a50ea0eb319737123d2e46fde4c0f}{last\+\_\+reply} (self, use\+\_\+label=True)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ae4b2346c35e214a8028eb83d1fc5ffd7}{reply\+\_\+history} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a0eb23a78aea413ae4f90ce0628179920}{observe} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a04fa334c086cf9afa815a44f1948e625}{observation})
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4a01defa1d669571f574fcfe021776a8}{save} (self, path=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a6d71ad7997e048e4f4f7d957fae64ac5}{load} (self, path)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a93e935c0d2d589d8990ff14d6e528c4d}{reset} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3ab251071823f34358a569c1c2a11bf9}{act} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_af3929c1bedc50a48dcf8d1184321f4f5}{batch\+\_\+act} (self, observations)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aff9cc5c105bbf154075aa83e288582ca}{train\+\_\+step} (self, batch)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a801f2b9a359201fd0a395ab61fd61806}{eval\+\_\+step} (self, batch)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_abc77ad96264e7597c46bc001a9a6af90}{dictionary\+\_\+class} ()
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a91d101db75d3618e8240a44b258f3129}{replies}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_afa0def82ae9760fde7f60c0881b8a138}{dict}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4e938a91873bd6edde0ac7ed5299bc6a}{opt}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aa8efd385be7532abd27359b5dbbbbb24}{use\+\_\+cuda}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a60d1038c25746d97d791b82a5c8e0492}{id}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aaed187f97f489122996e967206a01927}{E\+M\+P\+TY}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a6e6a5f2f7644a6cc273bfa25eca17df6}{N\+U\+L\+L\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a37d6429a766547a68f72ffb6c27783db}{S\+T\+A\+R\+T\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aa78932aa1b5886cd03f1592bfa6ed4f5}{E\+N\+D\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a2f9045fdfe9f956ee5023de84dd25a06}{random}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a31b5e2e435a70f40ce155dabe831d41c}{batch\+\_\+idx}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_add94f2eee8d2a4aba14869587e9dd4d3}{histsz}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a858bd7d01a3d6298f2e2f72efcf73953}{history}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ac0286e4dbf6dc71bda0c364851de5f22}{truncate}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ab768649f4b4a30eb9a75fedde5a9935f}{rank\+\_\+candidates}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a81f970d715f2525ad342330a28703c5c}{add\+\_\+person\+\_\+tokens}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a99254a4351798f66797e0a5a8ff855d5}{clip}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a2524bfb4b01626290e6fa26be52f2a80}{optimizer}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aea16ae8f9536959afd6e7434d418a719}{scheduler}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3f1da649c485f406076be7bf84b2d4ee}{proj\+\_\+rp}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a04fa334c086cf9afa815a44f1948e625}{observation}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
dictionary \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ae574bf3e21ff941060ae0f3dcb284d8d}{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}
\item 
string \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a14e0236052fb45181b6717922c517537}{P1\+\_\+\+T\+O\+K\+EN} = \textquotesingle{}\+\_\+\+\_\+p1\+\_\+\+\_\+\textquotesingle{}
\item 
string \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a50d73f48f3f951684afc094495473ec5}{P2\+\_\+\+T\+O\+K\+EN} = \textquotesingle{}\+\_\+\+\_\+p2\+\_\+\+\_\+\textquotesingle{}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}A provided base agent for any model that wants to use Torch.

Exists to make it easier to implement a new agent.
Not necessary, but reduces duplicated code.

Many methods are intended to be either used as is when the default is
acceptable, or to be overriden and called with super(), with the extra
functionality added to the initial result. See the method comment for
recommended behavior.

This agent serves as a common framework for all ParlAI models which want
to use PyTorch.
\end{DoxyVerb}
\begin{DoxyVerb}Utility mapping of simple names to optimizers.

For example:
'adagrad': optim.Adagrad, 'adam': optim.Adad, 'sgd': optim.SGD
\end{DoxyVerb}
 

\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a1c4eb91757ee23e75edfa957d05db338}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a1c4eb91757ee23e75edfa957d05db338}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize agent.
\end{DoxyVerb}
 

\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3ab251071823f34358a569c1c2a11bf9}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3ab251071823f34358a569c1c2a11bf9}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!act@{act}}
\index{act@{act}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Call batch_act with the singleton batch.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a00701a40d62943dbd887525bf8e8002d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a00701a40d62943dbd887525bf8e8002d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{cls,  }\item[{}]{argparser }\end{DoxyParamCaption})}

\begin{DoxyVerb}Add the default commandline args we expect most agents to want.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_af3929c1bedc50a48dcf8d1184321f4f5}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_af3929c1bedc50a48dcf8d1184321f4f5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!batch\+\_\+act@{batch\+\_\+act}}
\index{batch\+\_\+act@{batch\+\_\+act}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+act()}{batch\_act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+batch\+\_\+act (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}

\begin{DoxyVerb}Process a batch of observations (batchsize list of message dicts).

These observations have been preprocessed by the observe method.

Subclasses can override this for special functionality, but if the
default behaviors are fine then just override the ``train_step`` and
``eval_step`` methods instead. The former is called when labels are
present in the observations batch; otherwise, the latter is called.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ab8b2fa26aabfd9d7e7abb0abbcfe8044}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ab8b2fa26aabfd9d7e7abb0abbcfe8044}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!batchify@{batchify}}
\index{batchify@{batchify}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{batchify()}{batchify()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+batchify (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs\+\_\+batch,  }\item[{}]{sort = {\ttfamily False},  }\item[{}]{is\+\_\+valid = {\ttfamily lambda~obs\+:~\textquotesingle{}text\+\_\+vec\textquotesingle{}~in~obs~or~\textquotesingle{}image\textquotesingle{}~in~obs} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a batch of valid observations from an unchecked batch.

A valid observation is one that passes the lambda provided to the
function, which defaults to checking if the preprocessed 'text_vec'
field is present which would have been set by this agent's 'vectorize'
function.

Returns a namedtuple Batch. See original definition above for in-depth
explanation of each field.

If you want to include additonal fields in the batch, you can subclass
this function and return your own "Batch" namedtuple: copy the Batch
namedtuple at the top of this class, and then add whatever additional
fields that you want to be able to access. You can then call
super().batchify(...) to set up the original fields and then set up the
additional fields in your subclass and return that batch instead.

:param obs_batch: List of vectorized observations
:param sort:      Default False, orders the observations by length of
          vectors. Set to true when using
          torch.nn.utils.rnn.pack_padded_sequence.
          Uses the text vectors if available, otherwise uses
          the label vectors if available.
:param is_valid:  Function that checks if 'text_vec' is in the
          observation, determines if an observation is valid
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_abc77ad96264e7597c46bc001a9a6af90}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_abc77ad96264e7597c46bc001a9a6af90}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!dictionary\+\_\+class@{dictionary\+\_\+class}}
\index{dictionary\+\_\+class@{dictionary\+\_\+class}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{dictionary\+\_\+class()}{dictionary\_class()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+dictionary\+\_\+class (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Return the dictionary class that this agent expects to use.

Can be overriden if a more complex dictionary is required.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a801f2b9a359201fd0a395ab61fd61806}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a801f2b9a359201fd0a395ab61fd61806}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!eval\+\_\+step@{eval\+\_\+step}}
\index{eval\+\_\+step@{eval\+\_\+step}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{eval\+\_\+step()}{eval\_step()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+eval\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Process one batch but do not train on it.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a8984452b8b4e6194625530aeae49b243}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a8984452b8b4e6194625530aeae49b243}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!get\+\_\+dialog\+\_\+history@{get\+\_\+dialog\+\_\+history}}
\index{get\+\_\+dialog\+\_\+history@{get\+\_\+dialog\+\_\+history}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{get\+\_\+dialog\+\_\+history()}{get\_dialog\_history()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+get\+\_\+dialog\+\_\+history (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation,  }\item[{}]{reply = {\ttfamily None},  }\item[{}]{add\+\_\+person\+\_\+tokens = {\ttfamily False},  }\item[{}]{add\+\_\+p1\+\_\+after\+\_\+newln = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Retrieve dialog history and add current observations to it.

:param observation:        current observation
:param reply:              past utterance from the model to add to the
                   history, such as the past label or response
                   generated by the model.
:param add_person_tokens:  add tokens identifying each speaking before
                   utterances in the text & history.
:param add_p1_after_newln: add the other speaker token before the last
                   newline in the input instead of at the
                   beginning of the input. this is useful for
                   tasks that include some kind of context
                   before the actual utterance (e.g. squad,
                   babi, personachat).

:return: observation with text replaced with full dialog
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a1727b17db185dcc7237d893018c7b76c}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a1727b17db185dcc7237d893018c7b76c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!init\+\_\+optim@{init\+\_\+optim}}
\index{init\+\_\+optim@{init\+\_\+optim}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{init\+\_\+optim()}{init\_optim()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+init\+\_\+optim (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{params,  }\item[{}]{optim\+\_\+states = {\ttfamily None},  }\item[{}]{saved\+\_\+optim\+\_\+type = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize optimizer with model parameters.

:param params:       parameters from the model, for example:
             [p for p in model.parameters() if p.requires_grad]
:param optim_states: optional argument providing states of optimizer
             to load
:saved_optim_type:   type of optimizer being loaded, if changed will
             skip loading optimizer states
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_abf7a50ea0eb319737123d2e46fde4c0f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_abf7a50ea0eb319737123d2e46fde4c0f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!last\+\_\+reply@{last\+\_\+reply}}
\index{last\+\_\+reply@{last\+\_\+reply}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{last\+\_\+reply()}{last\_reply()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+last\+\_\+reply (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{use\+\_\+label = {\ttfamily True} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Retrieve the last reply from the model.

If available, we use the true label instead of the model's prediction.

By default, batch_act stores the batch of replies and this method
will extract the reply of the current instance from the batch.

:param use_label: default true, use the label when available instead of
          the model's generated response.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a6d71ad7997e048e4f4f7d957fae64ac5}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a6d71ad7997e048e4f4f7d957fae64ac5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!load@{load}}
\index{load@{load}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return opt and model states.

Override this method for more specific loading.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_acac419cfad0fc5988e7e796c244f3a9f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_acac419cfad0fc5988e7e796c244f3a9f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!match\+\_\+batch@{match\+\_\+batch}}
\index{match\+\_\+batch@{match\+\_\+batch}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{match\+\_\+batch()}{match\_batch()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+match\+\_\+batch (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch\+\_\+reply,  }\item[{}]{valid\+\_\+inds,  }\item[{}]{output = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Match sub-batch of predictions to the original batch indices.

Batches may be only partially filled (i.e when completing the remainder
at the end of the validation or test set), or we may want to sort by
e.g the length of the input sequences if using pack_padded_sequence.

This matches rows back with their original row in the batch for
calculating metrics like accuracy.

If output is None (model choosing not to provide any predictions), we
will just return the batch of replies.

Otherwise, output should be a parlai.core.torch_agent.Output object.
This is a namedtuple, which can provide text predictions and/or
text_candidates predictions. If you would like to map additional
fields into the batch_reply, you can override this method as well as
providing your own namedtuple with additional fields.

:param batch_reply: Full-batchsize list of message dictionaries to put
    responses into.
:param valid_inds: Original indices of the predictions.
:param output: Output namedtuple which contains sub-batchsize list of
    text outputs from model. May be None (default) if model chooses not
    to answer. This method will check for ``text`` and
    ``text_candidates`` fields.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a0eb23a78aea413ae4f90ce0628179920}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a0eb23a78aea413ae4f90ce0628179920}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!observe@{observe}}
\index{observe@{observe}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Process incoming message in preparation for producing a response.

This includes remembering the past history of the conversation.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_af97699a6b03a17969830db378f09cac4}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_af97699a6b03a17969830db378f09cac4}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!receive\+\_\+metrics@{receive\+\_\+metrics}}
\index{receive\+\_\+metrics@{receive\+\_\+metrics}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{receive\+\_\+metrics()}{receive\_metrics()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+receive\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{metrics\+\_\+dict }\end{DoxyParamCaption})}

\begin{DoxyVerb}Use the metrics to decide when to adjust LR schedule.

This uses the loss as the validation metric if present, if not this function
does nothing. Note that the model must be reporting loss for this to work.
Override this to override the behavior.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ae4b2346c35e214a8028eb83d1fc5ffd7}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ae4b2346c35e214a8028eb83d1fc5ffd7}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!reply\+\_\+history@{reply\+\_\+history}}
\index{reply\+\_\+history@{reply\+\_\+history}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{reply\+\_\+history()}{reply\_history()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+reply\+\_\+history (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get the model's predicted reply history within this episode.

:param batch: (default False) return the reply history for every
      row in the batch, otherwise will return just for this
      example.

:return: list of lists of strings, each of the past model replies in
 in the current episode. will be None wherever model did not
 reply.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a93e935c0d2d589d8990ff14d6e528c4d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a93e935c0d2d589d8990ff14d6e528c4d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!reset@{reset}}
\index{reset@{reset}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Clear internal states.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4a01defa1d669571f574fcfe021776a8}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4a01defa1d669571f574fcfe021776a8}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!save@{save}}
\index{save@{save}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save model parameters to path (or default to model_file arg).

Override this method for more specific saving.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3d922c4a8452c9e44fa2478e6fecdfd1}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3d922c4a8452c9e44fa2478e6fecdfd1}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!share@{share}}
\index{share@{share}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Share fields from parent as well as useful objects in this class.

Subclasses will likely want to share their model as well.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aff9cc5c105bbf154075aa83e288582ca}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aff9cc5c105bbf154075aa83e288582ca}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!train\+\_\+step@{train\+\_\+step}}
\index{train\+\_\+step@{train\+\_\+step}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{train\+\_\+step()}{train\_step()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+train\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Process one batch with training labels.
\end{DoxyVerb}
 \mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a866838e1c81063a3ec18c5609e029f90}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a866838e1c81063a3ec18c5609e029f90}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!vectorize@{vectorize}}
\index{vectorize@{vectorize}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{vectorize()}{vectorize()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+vectorize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs,  }\item[{}]{add\+\_\+start = {\ttfamily True},  }\item[{}]{add\+\_\+end = {\ttfamily True},  }\item[{}]{truncate = {\ttfamily None},  }\item[{}]{split\+\_\+lines = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Make vectors out of observation fields and store in the observation.

In particular, the 'text' and 'labels'/'eval_labels' fields are
processed and a new field is added to the observation with the suffix
'_vec'.

If you want to use additional fields on your subclass, you can override
this function, call super().vectorize(...) to process the text and
labels, and then process the other fields in your subclass.

:param obs:         Single observation from observe function.
:param add_start:   default True, adds the start token to each label.
:param add_end:     default True, adds the end token to each label.
:param truncate:    default None, if set truncates all vectors to the
            specified length. Note that this truncates to the
            rightmost for inputs and the leftmost for labels
            and, when applicable, candidates.
:param split_lines: If set, returns list of vectors instead of a single
            vector for input text, one for each substring after
            splitting on newlines.
\end{DoxyVerb}
 

\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a81f970d715f2525ad342330a28703c5c}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a81f970d715f2525ad342330a28703c5c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!add\+\_\+person\+\_\+tokens@{add\+\_\+person\+\_\+tokens}}
\index{add\+\_\+person\+\_\+tokens@{add\+\_\+person\+\_\+tokens}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+person\+\_\+tokens}{add\_person\_tokens}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+add\+\_\+person\+\_\+tokens}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a31b5e2e435a70f40ce155dabe831d41c}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a31b5e2e435a70f40ce155dabe831d41c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!batch\+\_\+idx@{batch\+\_\+idx}}
\index{batch\+\_\+idx@{batch\+\_\+idx}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+idx}{batch\_idx}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+batch\+\_\+idx}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a99254a4351798f66797e0a5a8ff855d5}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a99254a4351798f66797e0a5a8ff855d5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!clip@{clip}}
\index{clip@{clip}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{clip}{clip}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+clip}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_afa0def82ae9760fde7f60c0881b8a138}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_afa0def82ae9760fde7f60c0881b8a138}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!dict@{dict}}
\index{dict@{dict}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+dict}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aaed187f97f489122996e967206a01927}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aaed187f97f489122996e967206a01927}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!E\+M\+P\+TY@{E\+M\+P\+TY}}
\index{E\+M\+P\+TY@{E\+M\+P\+TY}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{E\+M\+P\+TY}{EMPTY}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+E\+M\+P\+TY}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aa78932aa1b5886cd03f1592bfa6ed4f5}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aa78932aa1b5886cd03f1592bfa6ed4f5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!E\+N\+D\+\_\+\+I\+DX@{E\+N\+D\+\_\+\+I\+DX}}
\index{E\+N\+D\+\_\+\+I\+DX@{E\+N\+D\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{E\+N\+D\+\_\+\+I\+DX}{END\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+E\+N\+D\+\_\+\+I\+DX}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a858bd7d01a3d6298f2e2f72efcf73953}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a858bd7d01a3d6298f2e2f72efcf73953}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!history@{history}}
\index{history@{history}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{history}{history}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+history}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_add94f2eee8d2a4aba14869587e9dd4d3}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_add94f2eee8d2a4aba14869587e9dd4d3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!histsz@{histsz}}
\index{histsz@{histsz}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{histsz}{histsz}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+histsz}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a60d1038c25746d97d791b82a5c8e0492}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a60d1038c25746d97d791b82a5c8e0492}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!id@{id}}
\index{id@{id}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+id}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a6e6a5f2f7644a6cc273bfa25eca17df6}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a6e6a5f2f7644a6cc273bfa25eca17df6}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}}
\index{N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{N\+U\+L\+L\+\_\+\+I\+DX}{NULL\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+N\+U\+L\+L\+\_\+\+I\+DX}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a04fa334c086cf9afa815a44f1948e625}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a04fa334c086cf9afa815a44f1948e625}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!observation@{observation}}
\index{observation@{observation}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+observation}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4e938a91873bd6edde0ac7ed5299bc6a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a4e938a91873bd6edde0ac7ed5299bc6a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!opt@{opt}}
\index{opt@{opt}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+opt}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ae574bf3e21ff941060ae0f3dcb284d8d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ae574bf3e21ff941060ae0f3dcb284d8d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!O\+P\+T\+I\+M\+\_\+\+O\+P\+TS@{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}}
\index{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS@{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}{OPTIM\_OPTS}}
{\footnotesize\ttfamily dictionary parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+O\+P\+T\+I\+M\+\_\+\+O\+P\+TS\hspace{0.3cm}{\ttfamily [static]}}

{\bfseries Initial value\+:}
\begin{DoxyCode}
=  \{
        k.lower(): v
        \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} optim.\_\_dict\_\_.items()
        \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} k.startswith(\textcolor{stringliteral}{'\_\_'}) \textcolor{keywordflow}{and} k[0].isupper()
    \}
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a2524bfb4b01626290e6fa26be52f2a80}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a2524bfb4b01626290e6fa26be52f2a80}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+optimizer}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a14e0236052fb45181b6717922c517537}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a14e0236052fb45181b6717922c517537}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!P1\+\_\+\+T\+O\+K\+EN@{P1\+\_\+\+T\+O\+K\+EN}}
\index{P1\+\_\+\+T\+O\+K\+EN@{P1\+\_\+\+T\+O\+K\+EN}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{P1\+\_\+\+T\+O\+K\+EN}{P1\_TOKEN}}
{\footnotesize\ttfamily string parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+P1\+\_\+\+T\+O\+K\+EN = \textquotesingle{}\+\_\+\+\_\+p1\+\_\+\+\_\+\textquotesingle{}\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a50d73f48f3f951684afc094495473ec5}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a50d73f48f3f951684afc094495473ec5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!P2\+\_\+\+T\+O\+K\+EN@{P2\+\_\+\+T\+O\+K\+EN}}
\index{P2\+\_\+\+T\+O\+K\+EN@{P2\+\_\+\+T\+O\+K\+EN}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{P2\+\_\+\+T\+O\+K\+EN}{P2\_TOKEN}}
{\footnotesize\ttfamily string parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+P2\+\_\+\+T\+O\+K\+EN = \textquotesingle{}\+\_\+\+\_\+p2\+\_\+\+\_\+\textquotesingle{}\hspace{0.3cm}{\ttfamily [static]}}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3f1da649c485f406076be7bf84b2d4ee}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a3f1da649c485f406076be7bf84b2d4ee}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!proj\+\_\+rp@{proj\+\_\+rp}}
\index{proj\+\_\+rp@{proj\+\_\+rp}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{proj\+\_\+rp}{proj\_rp}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+proj\+\_\+rp}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a2f9045fdfe9f956ee5023de84dd25a06}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a2f9045fdfe9f956ee5023de84dd25a06}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!random@{random}}
\index{random@{random}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{random}{random}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+random}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ab768649f4b4a30eb9a75fedde5a9935f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ab768649f4b4a30eb9a75fedde5a9935f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!rank\+\_\+candidates@{rank\+\_\+candidates}}
\index{rank\+\_\+candidates@{rank\+\_\+candidates}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{rank\+\_\+candidates}{rank\_candidates}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+rank\+\_\+candidates}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a91d101db75d3618e8240a44b258f3129}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a91d101db75d3618e8240a44b258f3129}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!replies@{replies}}
\index{replies@{replies}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{replies}{replies}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+replies}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aea16ae8f9536959afd6e7434d418a719}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aea16ae8f9536959afd6e7434d418a719}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!scheduler@{scheduler}}
\index{scheduler@{scheduler}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{scheduler}{scheduler}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+scheduler}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a37d6429a766547a68f72ffb6c27783db}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_a37d6429a766547a68f72ffb6c27783db}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!S\+T\+A\+R\+T\+\_\+\+I\+DX@{S\+T\+A\+R\+T\+\_\+\+I\+DX}}
\index{S\+T\+A\+R\+T\+\_\+\+I\+DX@{S\+T\+A\+R\+T\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{S\+T\+A\+R\+T\+\_\+\+I\+DX}{START\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+S\+T\+A\+R\+T\+\_\+\+I\+DX}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ac0286e4dbf6dc71bda0c364851de5f22}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_ac0286e4dbf6dc71bda0c364851de5f22}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!truncate@{truncate}}
\index{truncate@{truncate}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{truncate}{truncate}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+truncate}

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aa8efd385be7532abd27359b5dbbbbb24}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent_aa8efd385be7532abd27359b5dbbbbb24}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Torch\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Torch\+Agent.\+use\+\_\+cuda}



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/seq2seq/\hyperlink{torch__agent__v1_8py}{torch\+\_\+agent\+\_\+v1.\+py}\end{DoxyCompactItemize}
