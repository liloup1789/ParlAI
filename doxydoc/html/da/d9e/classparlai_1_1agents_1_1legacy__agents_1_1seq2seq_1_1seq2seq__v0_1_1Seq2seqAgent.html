<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ParlAI: parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ParlAI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/d22/namespaceparlai.html">parlai</a></li><li class="navelem"><a class="el" href="../../dd/d61/namespaceparlai_1_1agents.html">agents</a></li><li class="navelem"><a class="el" href="../../d1/dae/namespaceparlai_1_1agents_1_1legacy__agents.html">legacy_agents</a></li><li class="navelem"><a class="el" href="../../d9/dd0/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq.html">seq2seq</a></li><li class="navelem"><a class="el" href="../../db/d8b/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0.html">seq2seq_v0</a></li><li class="navelem"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html">Seq2seqAgent</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="../../d8/dce/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/d2f/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent__inherit__graph.png" border="0" usemap="#parlai_8agents_8legacy__agents_8seq2seq_8seq2seq__v0_8Seq2seqAgent_inherit__map" alt="Inheritance graph"/></div>
<map name="parlai_8agents_8legacy__agents_8seq2seq_8seq2seq__v0_8Seq2seqAgent_inherit__map" id="parlai_8agents_8legacy__agents_8seq2seq_8seq2seq__v0_8Seq2seqAgent_inherit__map">
<area shape="rect" id="node4" href="../../d0/d73/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1PerplexityEvaluatorAgent.html" title="parlai.agents.legacy\l_agents.seq2seq.seq2seq\l_v0.PerplexityEvaluatorAgent" alt="" coords="5,288,200,344"/>
<area shape="rect" id="node2" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html" title="parlai.agents.legacy\l_agents.seq2seq.seq2seq\l_v0.Agent" alt="" coords="15,80,190,136"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent:</div>
<div class="dyncontent">
<div class="center"><img src="../../dc/d5a/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent__coll__graph.png" border="0" usemap="#parlai_8agents_8legacy__agents_8seq2seq_8seq2seq__v0_8Seq2seqAgent_coll__map" alt="Collaboration graph"/></div>
<map name="parlai_8agents_8legacy__agents_8seq2seq_8seq2seq__v0_8Seq2seqAgent_coll__map" id="parlai_8agents_8legacy__agents_8seq2seq_8seq2seq__v0_8Seq2seqAgent_coll__map">
<area shape="rect" id="node2" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html" title="parlai.agents.legacy\l_agents.seq2seq.seq2seq\l_v0.Agent" alt="" coords="5,80,180,136"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a88801410eefdb0b71bb674a0768e87b9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a88801410eefdb0b71bb674a0768e87b9">__init__</a> (self, <a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a8e4926c0c0da6bd7d530c44aa5416731">opt</a>, shared=None)</td></tr>
<tr class="separator:a88801410eefdb0b71bb674a0768e87b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40d38a1cc2cafe32c43477740b4a164"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ad40d38a1cc2cafe32c43477740b4a164">override_opt</a> (self, new_opt)</td></tr>
<tr class="separator:ad40d38a1cc2cafe32c43477740b4a164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a073830870e283f88ee45a95c0ae8ad2f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a073830870e283f88ee45a95c0ae8ad2f">parse</a> (self, text)</td></tr>
<tr class="separator:a073830870e283f88ee45a95c0ae8ad2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f6de929b475d3915c159c48165b4575"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a8f6de929b475d3915c159c48165b4575">v2t</a> (self, vec)</td></tr>
<tr class="separator:a8f6de929b475d3915c159c48165b4575"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0be9f1e378a403284d8afac5648fbf4d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a0be9f1e378a403284d8afac5648fbf4d">zero_grad</a> (self)</td></tr>
<tr class="separator:a0be9f1e378a403284d8afac5648fbf4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3933d4fdc5e603b1a168d92e7da77151"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a3933d4fdc5e603b1a168d92e7da77151">update_params</a> (self)</td></tr>
<tr class="separator:a3933d4fdc5e603b1a168d92e7da77151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56d246fd8b6bcf41726181c17cdc2762"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a56d246fd8b6bcf41726181c17cdc2762">reset</a> (self)</td></tr>
<tr class="separator:a56d246fd8b6bcf41726181c17cdc2762"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae76435bf7acee9501188de47c0ba6991"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ae76435bf7acee9501188de47c0ba6991">reset_metrics</a> (self)</td></tr>
<tr class="separator:ae76435bf7acee9501188de47c0ba6991"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83a444ecb418dfb4381147f23653dd7b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a83a444ecb418dfb4381147f23653dd7b">report</a> (self)</td></tr>
<tr class="separator:a83a444ecb418dfb4381147f23653dd7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac050147b69c47182730e92866f64156a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ac050147b69c47182730e92866f64156a">share</a> (self)</td></tr>
<tr class="separator:ac050147b69c47182730e92866f64156a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8419a9652b14a16cedff86206a7bb613"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a8419a9652b14a16cedff86206a7bb613">observe</a> (self, <a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a4473b0e478d7928c2b59ab653c8334fb">observation</a>)</td></tr>
<tr class="separator:a8419a9652b14a16cedff86206a7bb613"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadec879f7d8daa6451076e4fb358715b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#aadec879f7d8daa6451076e4fb358715b">predict</a> (self, xs, ys=None, cands=None, valid_cands=None, is_training=False)</td></tr>
<tr class="separator:aadec879f7d8daa6451076e4fb358715b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83e2433e00bff6162ebad3b818771b59"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a83e2433e00bff6162ebad3b818771b59">vectorize</a> (self, observations)</td></tr>
<tr class="separator:a83e2433e00bff6162ebad3b818771b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9326d8ed88999a992b8ec73313c70a36"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a9326d8ed88999a992b8ec73313c70a36">init_cuda_buffer</a> (self, batchsize)</td></tr>
<tr class="separator:a9326d8ed88999a992b8ec73313c70a36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ae534e440fd57603bc9b6e7c08b1c57"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a4ae534e440fd57603bc9b6e7c08b1c57">batch_act</a> (self, observations)</td></tr>
<tr class="separator:a4ae534e440fd57603bc9b6e7c08b1c57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae66e8065addb136eb82828ccbe56c5ca"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ae66e8065addb136eb82828ccbe56c5ca">act</a> (self)</td></tr>
<tr class="separator:ae66e8065addb136eb82828ccbe56c5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31c017cd07b01834a5d467fadfddd7cd"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a31c017cd07b01834a5d467fadfddd7cd">save</a> (self, path=None)</td></tr>
<tr class="separator:a31c017cd07b01834a5d467fadfddd7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c41e705170f0b2e56a5bbc378aead9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a86c41e705170f0b2e56a5bbc378aead9">shutdown</a> (self)</td></tr>
<tr class="separator:a86c41e705170f0b2e56a5bbc378aead9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aabe1e56b7b94f46875ae7f704f681f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a2aabe1e56b7b94f46875ae7f704f681f">load</a> (self, path)</td></tr>
<tr class="separator:a2aabe1e56b7b94f46875ae7f704f681f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a584d45d729817694d615d2d545532af2"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a584d45d729817694d615d2d545532af2">receive_metrics</a> (self, metrics_dict)</td></tr>
<tr class="separator:a584d45d729817694d615d2d545532af2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Agent</a></td></tr>
<tr class="memitem:ae84057ceae2e7cf0b5d6248b48596b76 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#ae84057ceae2e7cf0b5d6248b48596b76">__init__</a> (self, <a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#ae07383697f7232bb21cbd0a1c6e93389">opt</a>, shared=None)</td></tr>
<tr class="separator:ae84057ceae2e7cf0b5d6248b48596b76 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f030b5540055279a41d99dd8b8690c inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a39f030b5540055279a41d99dd8b8690c">observe</a> (self, <a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a6371fe160ef331078a794fc1d8b67371">observation</a>)</td></tr>
<tr class="separator:a39f030b5540055279a41d99dd8b8690c inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a403f4e9f07a342da898de6768f857bf3 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a403f4e9f07a342da898de6768f857bf3">act</a> (self)</td></tr>
<tr class="separator:a403f4e9f07a342da898de6768f857bf3 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bddd5b89230c9a2810e7ca15914997e inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a8bddd5b89230c9a2810e7ca15914997e">getID</a> (self)</td></tr>
<tr class="separator:a8bddd5b89230c9a2810e7ca15914997e inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a9ad9d2de9befe0dca62d19ae0d797c inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a2a9ad9d2de9befe0dca62d19ae0d797c">epoch_done</a> (self)</td></tr>
<tr class="separator:a2a9ad9d2de9befe0dca62d19ae0d797c inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7151ba0c843bd32a0d9c5376fbf9c803 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a7151ba0c843bd32a0d9c5376fbf9c803">reset</a> (self)</td></tr>
<tr class="separator:a7151ba0c843bd32a0d9c5376fbf9c803 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbe0accc588c66ea679806cd6450b293 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#acbe0accc588c66ea679806cd6450b293">reset_metrics</a> (self)</td></tr>
<tr class="separator:acbe0accc588c66ea679806cd6450b293 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7bb24c12c27de36cc7ca6a200ffa9aa1 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a7bb24c12c27de36cc7ca6a200ffa9aa1">save</a> (self, path=None)</td></tr>
<tr class="separator:a7bb24c12c27de36cc7ca6a200ffa9aa1 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76e7a147dd6740bd60f696a5f0c34e5a inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a76e7a147dd6740bd60f696a5f0c34e5a">share</a> (self)</td></tr>
<tr class="separator:a76e7a147dd6740bd60f696a5f0c34e5a inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8eca4b6d832aa2b55ac191324105c43 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#af8eca4b6d832aa2b55ac191324105c43">shutdown</a> (self)</td></tr>
<tr class="separator:af8eca4b6d832aa2b55ac191324105c43 inherit pub_methods_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a05552a2714cd8d15d754a62258727c98"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a05552a2714cd8d15d754a62258727c98">dictionary_class</a> ()</td></tr>
<tr class="separator:a05552a2714cd8d15d754a62258727c98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac00637641bf7d8f23614c53ec8a1c610"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ac00637641bf7d8f23614c53ec8a1c610">add_cmdline_args</a> (argparser)</td></tr>
<tr class="separator:ac00637641bf7d8f23614c53ec8a1c610"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a7943d21acc4e6986e15678e7da1d2f27"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a7943d21acc4e6986e15678e7da1d2f27">truncate</a></td></tr>
<tr class="separator:a7943d21acc4e6986e15678e7da1d2f27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac50fcecc3b2ec89ece9bf75df8e21c6d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ac50fcecc3b2ec89ece9bf75df8e21c6d">metrics</a></td></tr>
<tr class="separator:ac50fcecc3b2ec89ece9bf75df8e21c6d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11398edabc596559f45324d2d603b1e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a11398edabc596559f45324d2d603b1e3">history</a></td></tr>
<tr class="separator:a11398edabc596559f45324d2d603b1e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f13aca25d825730f0dacbf50f48d7c6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a3f13aca25d825730f0dacbf50f48d7c6">report_freq</a></td></tr>
<tr class="separator:a3f13aca25d825730f0dacbf50f48d7c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a227faa3994686ab266237ce9e11a2dc7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a227faa3994686ab266237ce9e11a2dc7">use_person_tokens</a></td></tr>
<tr class="separator:a227faa3994686ab266237ce9e11a2dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f31501d3923b8fb080d147d23ab727b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a2f31501d3923b8fb080d147d23ab727b">batch_idx</a></td></tr>
<tr class="separator:a2f31501d3923b8fb080d147d23ab727b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07995ff61edb2c4699aa766122878e94"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a07995ff61edb2c4699aa766122878e94">rank</a></td></tr>
<tr class="separator:a07995ff61edb2c4699aa766122878e94"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a215857d3ce2c7522c43728ab2879ce89"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a215857d3ce2c7522c43728ab2879ce89">beam_size</a></td></tr>
<tr class="separator:a215857d3ce2c7522c43728ab2879ce89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0b7a3b712fe92dbabee7f31972b8a47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ac0b7a3b712fe92dbabee7f31972b8a47">topk</a></td></tr>
<tr class="separator:ac0b7a3b712fe92dbabee7f31972b8a47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab81d3b0bd5474debb2f983d1b6220d5e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ab81d3b0bd5474debb2f983d1b6220d5e">use_cuda</a></td></tr>
<tr class="separator:ab81d3b0bd5474debb2f983d1b6220d5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e4926c0c0da6bd7d530c44aa5416731"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a8e4926c0c0da6bd7d530c44aa5416731">opt</a></td></tr>
<tr class="separator:a8e4926c0c0da6bd7d530c44aa5416731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5ff9534948d32ca9b387fe1189174e6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ad5ff9534948d32ca9b387fe1189174e6">dict</a></td></tr>
<tr class="separator:ad5ff9534948d32ca9b387fe1189174e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a044b5f18e6d9f0207b947769f06bcc6b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a044b5f18e6d9f0207b947769f06bcc6b">START_IDX</a></td></tr>
<tr class="separator:a044b5f18e6d9f0207b947769f06bcc6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a46ebee256e0812f6cab77a71c02578e0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a46ebee256e0812f6cab77a71c02578e0">END_IDX</a></td></tr>
<tr class="separator:a46ebee256e0812f6cab77a71c02578e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8589f9403a5d358b1c58b467fc556680"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a8589f9403a5d358b1c58b467fc556680">NULL_IDX</a></td></tr>
<tr class="separator:a8589f9403a5d358b1c58b467fc556680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d4bdcd877577596273c4af1eb4c70d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ad5d4bdcd877577596273c4af1eb4c70d">answers</a></td></tr>
<tr class="separator:ad5d4bdcd877577596273c4af1eb4c70d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6ef958bb58cc1597b23b0a6c6c49b3f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ae6ef958bb58cc1597b23b0a6c6c49b3f">model</a></td></tr>
<tr class="separator:ae6ef958bb58cc1597b23b0a6c6c49b3f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a616955265cd96254aae5b5958ac18159"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a616955265cd96254aae5b5958ac18159">id</a></td></tr>
<tr class="separator:a616955265cd96254aae5b5958ac18159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203f77c92dd9f343cd7c5580756d5e5a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a203f77c92dd9f343cd7c5580756d5e5a">model_class</a></td></tr>
<tr class="separator:a203f77c92dd9f343cd7c5580756d5e5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad336994a64a83591ba1388aef3f1d5de"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ad336994a64a83591ba1388aef3f1d5de">criterion</a></td></tr>
<tr class="separator:ad336994a64a83591ba1388aef3f1d5de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4896d5dc3fd7a0f876a654f0bc942b6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a4896d5dc3fd7a0f876a654f0bc942b6a">clip</a></td></tr>
<tr class="separator:a4896d5dc3fd7a0f876a654f0bc942b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6a5cc3b1faaae160f5c10318a7afcfd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ac6a5cc3b1faaae160f5c10318a7afcfd">optimizer</a></td></tr>
<tr class="separator:ac6a5cc3b1faaae160f5c10318a7afcfd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8229fafe6c4b7d7ebedbd0f00b55eb0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#ac8229fafe6c4b7d7ebedbd0f00b55eb0">scheduler</a></td></tr>
<tr class="separator:ac8229fafe6c4b7d7ebedbd0f00b55eb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4473b0e478d7928c2b59ab653c8334fb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a4473b0e478d7928c2b59ab653c8334fb">observation</a></td></tr>
<tr class="separator:a4473b0e478d7928c2b59ab653c8334fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31e1353ee2c64ac03af2bc7854597f35"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a31e1353ee2c64ac03af2bc7854597f35">buffer_initialized</a></td></tr>
<tr class="separator:a31e1353ee2c64ac03af2bc7854597f35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent')"><img src="../../closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Agent</a></td></tr>
<tr class="memitem:a446e864fc95a310d508e3095c7f3d930 inherit pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a446e864fc95a310d508e3095c7f3d930">id</a></td></tr>
<tr class="separator:a446e864fc95a310d508e3095c7f3d930 inherit pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae07383697f7232bb21cbd0a1c6e93389 inherit pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#ae07383697f7232bb21cbd0a1c6e93389">opt</a></td></tr>
<tr class="separator:ae07383697f7232bb21cbd0a1c6e93389 inherit pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6371fe160ef331078a794fc1d8b67371 inherit pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/db2/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent.html#a6371fe160ef331078a794fc1d8b67371">observation</a></td></tr>
<tr class="separator:a6371fe160ef331078a794fc1d8b67371 inherit pub_attribs_classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:a83374019847ffa0c1cc43bf0b24120e9"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d9e/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent.html#a83374019847ffa0c1cc43bf0b24120e9">OPTIM_OPTS</a></td></tr>
<tr class="separator:a83374019847ffa0c1cc43bf0b24120e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Agent which takes an input sequence and produces an output sequence.

This model supports encoding the input and decoding the output via one of
several flavors of RNN. It then uses a linear layer (whose weights can
be shared with the embedding layer) to convert RNN output states into
output tokens. This model currently uses greedy decoding, selecting the
highest probability token at each time step.

For more information, see the following papers:
- Neural Machine Translation by Jointly Learning to Align and Translate
  `(Bahdanau et al. 2014) &lt;arxiv.org/abs/1409.0473&gt;`_
- Sequence to Sequence Learning with Neural Networks
  `(Sutskever et al. 2014) &lt;arxiv.org/abs/1409.3215&gt;`_
- Effective Approaches to Attention-based Neural Machine Translation
  `(Luong et al. 2015) &lt;arxiv.org/abs/1508.04025&gt;`_
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00095">95</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a88801410eefdb0b71bb674a0768e87b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a88801410eefdb0b71bb674a0768e87b9">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shared</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Set up model.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00357">357</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">def </span>__init__(self, opt, shared=None):</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="stringliteral">        Set up model.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        super().__init__(opt, shared)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        opt = self.opt  <span class="comment"># there is a deepcopy in the init</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="comment"># all instances may need some params</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        self.truncate = opt[<span class="stringliteral">&#39;truncate&#39;</span>] <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;truncate&#39;</span>] &gt; 0 <span class="keywordflow">else</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        self.metrics = {</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="stringliteral">&#39;loss&#39;</span>: 0.0,</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="stringliteral">&#39;num_tokens&#39;</span>: 0,</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;            <span class="stringliteral">&#39;correct_tokens&#39;</span>: 0,</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="stringliteral">&#39;total_skipped_batches&#39;</span>: 0,</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        }</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        self.history = {}</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        self.report_freq = opt.get(<span class="stringliteral">&#39;report_freq&#39;</span>, 0.001)</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        self.use_person_tokens = opt.get(<span class="stringliteral">&#39;person_tokens&#39;</span>, <span class="keyword">False</span>)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        self.batch_idx = shared <span class="keywordflow">and</span> shared.get(<span class="stringliteral">&#39;batchindex&#39;</span>) <span class="keywordflow">or</span> 0</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        self.rank = opt[<span class="stringliteral">&#39;rank_candidates&#39;</span>]</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        self.beam_size = opt.get(<span class="stringliteral">&#39;beam_size&#39;</span>, 1)</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        self.topk = opt.get(<span class="stringliteral">&#39;topk&#39;</span>, 1)</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        states = {}</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="comment"># check for cuda</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        self.use_cuda = <span class="keywordflow">not</span> opt.get(<span class="stringliteral">&#39;no_cuda&#39;</span>) <span class="keywordflow">and</span> torch.cuda.is_available()</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;numthreads&#39;</span>, 1) &gt; 1:</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            torch.set_num_threads(1)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="keywordflow">if</span> shared:</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            <span class="comment"># set up shared properties</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            self.opt = shared[<span class="stringliteral">&#39;opt&#39;</span>]</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;            opt = self.opt</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            self.dict = shared[<span class="stringliteral">&#39;dict&#39;</span>]</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            self.START_IDX = shared[<span class="stringliteral">&#39;START_IDX&#39;</span>]</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            self.END_IDX = shared[<span class="stringliteral">&#39;END_IDX&#39;</span>]</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            self.NULL_IDX = shared[<span class="stringliteral">&#39;NULL_IDX&#39;</span>]</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="comment"># answers contains a batch_size list of the last answer produced</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            self.answers = shared[<span class="stringliteral">&#39;answers&#39;</span>]</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;            self.model = shared[<span class="stringliteral">&#39;model&#39;</span>]</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            self.metrics = shared[<span class="stringliteral">&#39;metrics&#39;</span>]</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            states = shared.get(<span class="stringliteral">&#39;states&#39;</span>, {})</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            <span class="comment"># this is not a shared instance of this class, so do full init</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            <span class="comment"># answers contains a batch_size list of the last answer produced</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            self.answers = [<span class="keywordtype">None</span>] * opt[<span class="stringliteral">&#39;batchsize&#39;</span>]</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                print(<span class="stringliteral">&#39;[ Using CUDA ]&#39;</span>)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                torch.cuda.set_device(opt[<span class="stringliteral">&#39;gpu&#39;</span>])</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            init_model = <span class="keywordtype">None</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            <span class="comment"># check first for &#39;init_model&#39; for loading model from file</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;            <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;init_model&#39;</span>) <span class="keywordflow">and</span> os.path.isfile(opt[<span class="stringliteral">&#39;init_model&#39;</span>]):</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                init_model = opt[<span class="stringliteral">&#39;init_model&#39;</span>]</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="comment"># next check for &#39;model_file&#39;, this would override init_model</span></div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;            <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;model_file&#39;</span>) <span class="keywordflow">and</span> os.path.isfile(opt[<span class="stringliteral">&#39;model_file&#39;</span>]):</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                init_model = opt[<span class="stringliteral">&#39;model_file&#39;</span>]</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;            <span class="keywordflow">if</span> init_model <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                <span class="comment"># load model parameters if available</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                print(<span class="stringliteral">&#39;[ Loading existing model params from {} ]&#39;</span>.<a class="code" href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">format</a>(init_model))</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                states = self.load(init_model)</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                <span class="keywordflow">if</span> os.path.isfile(init_model + <span class="stringliteral">&#39;.dict&#39;</span>) <span class="keywordflow">or</span> opt[<span class="stringliteral">&#39;dict_file&#39;</span>] <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    opt[<span class="stringliteral">&#39;dict_file&#39;</span>] = init_model + <span class="stringliteral">&#39;.dict&#39;</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;            <span class="comment"># load dictionary and basic tokens &amp; vectors</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;            self.dict = DictionaryAgent(opt)</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            self.id = <span class="stringliteral">&#39;Seq2Seq&#39;</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;            <span class="comment"># we use START markers to start our output</span></div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            self.START_IDX = self.dict[self.dict.start_token]</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;            <span class="comment"># we use END markers to end our output</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;            self.END_IDX = self.dict[self.dict.end_token]</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;            <span class="comment"># get index of null token from dictionary (probably 0)</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;            self.NULL_IDX = self.dict[self.dict.null_token]</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> hasattr(self, <span class="stringliteral">&#39;model_class&#39;</span>):</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                <span class="comment"># this allows child classes to override this but inherit init</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                self.model_class = Seq2seq</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;            self.model = self.model_class(</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                opt,</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                len(self.dict),</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                padding_idx=self.NULL_IDX,</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                start_idx=self.START_IDX,</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                end_idx=self.END_IDX,</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                longest_label=states.get(<span class="stringliteral">&#39;longest_label&#39;</span>, 1),</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;            )</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;dict_tokenizer&#39;</span>) == <span class="stringliteral">&#39;bpe&#39;</span> <span class="keywordflow">and</span> opt[<span class="stringliteral">&#39;embedding_type&#39;</span>] != <span class="stringliteral">&#39;random&#39;</span>:</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                print(<span class="stringliteral">&#39;skipping preinitialization of embeddings for bpe&#39;</span>)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;            <span class="keywordflow">elif</span> <span class="keywordflow">not</span> states <span class="keywordflow">and</span> opt[<span class="stringliteral">&#39;embedding_type&#39;</span>] != <span class="stringliteral">&#39;random&#39;</span>:</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                <span class="comment"># set up preinitialized embeddings</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="keyword">import</span> torchtext.vocab <span class="keyword">as</span> vocab</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                <span class="keywordflow">except</span> ImportError <span class="keyword">as</span> ex:</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                    print(<span class="stringliteral">&#39;Please install torch text with `pip install torchtext`&#39;</span>)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                    <span class="keywordflow">raise</span> ex</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                pretrained_dim = 300</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;embedding_type&#39;</span>].startswith(<span class="stringliteral">&#39;glove&#39;</span>):</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                    <span class="keywordflow">if</span> <span class="stringliteral">&#39;twitter&#39;</span> <span class="keywordflow">in</span> opt[<span class="stringliteral">&#39;embedding_type&#39;</span>]:</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                        init = <span class="stringliteral">&#39;glove-twitter&#39;</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        name = <span class="stringliteral">&#39;twitter.27B&#39;</span></div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                        pretrained_dim = 200</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                    <span class="keywordflow">else</span>:</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        init = <span class="stringliteral">&#39;glove&#39;</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        name = <span class="stringliteral">&#39;840B&#39;</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    embs = vocab.GloVe(</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        name=name,</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                        dim=pretrained_dim,</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        cache=<a class="code" href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#a5fbd3301b67f00d6d146fb01c7cd7626">modelzoo_path</a>(</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                            self.opt.get(<span class="stringliteral">&#39;datapath&#39;</span>), <span class="stringliteral">&#39;models:glove_vectors&#39;</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                        ),</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                    )</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                <span class="keywordflow">elif</span> opt[<span class="stringliteral">&#39;embedding_type&#39;</span>].startswith(<span class="stringliteral">&#39;fasttext&#39;</span>):</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                    init = <span class="stringliteral">&#39;fasttext&#39;</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                    embs = vocab.FastText(</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                        language=<span class="stringliteral">&#39;en&#39;</span>,</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                        cache=<a class="code" href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#a5fbd3301b67f00d6d146fb01c7cd7626">modelzoo_path</a>(</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                            self.opt.get(<span class="stringliteral">&#39;datapath&#39;</span>), <span class="stringliteral">&#39;models:fasttext_vectors&#39;</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                        ),</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;                    )</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;                    <span class="keywordflow">raise</span> RuntimeError(<span class="stringliteral">&#39;embedding type not implemented&#39;</span>)</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;embeddingsize&#39;</span>] != pretrained_dim:</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                    rp = torch.Tensor(pretrained_dim, opt[<span class="stringliteral">&#39;embeddingsize&#39;</span>]).normal_()</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                    t = <span class="keyword">lambda</span> x: torch.mm(x.unsqueeze(0), rp)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                    t = <span class="keyword">lambda</span> x: x</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;                cnt = 0</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                <span class="keywordflow">for</span> w, i <span class="keywordflow">in</span> self.dict.tok2ind.items():</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                    <span class="keywordflow">if</span> w <span class="keywordflow">in</span> embs.stoi:</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;                        vec = t(embs.vectors[embs.stoi[w]])</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;                        self.model.decoder.lt.weight.data[i] = vec</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;                        cnt += 1</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                        <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;lookuptable&#39;</span>] <span class="keywordflow">in</span> [<span class="stringliteral">&#39;unique&#39;</span>, <span class="stringliteral">&#39;dec_out&#39;</span>]:</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                            <span class="comment"># also set encoder lt, since it&#39;s not shared</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;                            self.model.encoder.lt.weight.data[i] = vec</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                print(</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                    <span class="stringliteral">&#39;Seq2seq: initialized embeddings for {} tokens from {}.&#39;</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                    <span class="stringliteral">&#39;&#39;</span>.<a class="code" href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">format</a>(cnt, init)</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                )</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;            <span class="keywordflow">if</span> states:</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                <span class="comment"># set loaded states if applicable</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                self.model.load_state_dict(states[<span class="stringliteral">&#39;model&#39;</span>])</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                self.model.cuda()</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment"># set up criteria</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;numsoftmax&#39;</span>, 1) &gt; 1:</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            self.criterion = nn.NLLLoss(ignore_index=self.NULL_IDX, size_average=<span class="keyword">False</span>)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            self.criterion = nn.CrossEntropyLoss(</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                ignore_index=self.NULL_IDX, size_average=<span class="keyword">False</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            )</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;            self.criterion.cuda()</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;train&#39;</span> <span class="keywordflow">in</span> opt.get(<span class="stringliteral">&#39;datatype&#39;</span>, <span class="stringliteral">&#39;&#39;</span>):</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            <span class="comment"># we only set up optimizers when training</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="comment"># we only set this up for the original instance or hogwild ones</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;            self.clip = opt.get(<span class="stringliteral">&#39;gradient_clip&#39;</span>, -1)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            <span class="comment"># set up optimizer</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;            lr = opt[<span class="stringliteral">&#39;learningrate&#39;</span>]</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            optim_class = Seq2seqAgent.OPTIM_OPTS[opt[<span class="stringliteral">&#39;optimizer&#39;</span>]]</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            kwargs = {<span class="stringliteral">&#39;lr&#39;</span>: lr}</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;momentum&#39;</span>) &gt; 0 <span class="keywordflow">and</span> opt[<span class="stringliteral">&#39;optimizer&#39;</span>] <span class="keywordflow">in</span> [<span class="stringliteral">&#39;sgd&#39;</span>, <span class="stringliteral">&#39;rmsprop&#39;</span>]:</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                kwargs[<span class="stringliteral">&#39;momentum&#39;</span>] = opt[<span class="stringliteral">&#39;momentum&#39;</span>]</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;optimizer&#39;</span>] == <span class="stringliteral">&#39;sgd&#39;</span>:</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    kwargs[<span class="stringliteral">&#39;nesterov&#39;</span>] = <span class="keyword">True</span></div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;optimizer&#39;</span>] == <span class="stringliteral">&#39;adam&#39;</span>:</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                <span class="comment"># https://openreview.net/forum?id=ryQu7f-RZ</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                kwargs[<span class="stringliteral">&#39;amsgrad&#39;</span>] = <span class="keyword">True</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;embedding_type&#39;</span>].endswith(<span class="stringliteral">&#39;fixed&#39;</span>):</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                print(<span class="stringliteral">&#39;Seq2seq: fixing embedding weights.&#39;</span>)</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                self.model.decoder.lt.weight.requires_grad = <span class="keyword">False</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                self.model.encoder.lt.weight.requires_grad = <span class="keyword">False</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;lookuptable&#39;</span>] <span class="keywordflow">in</span> [<span class="stringliteral">&#39;dec_out&#39;</span>, <span class="stringliteral">&#39;all&#39;</span>]:</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                    self.model.decoder.e2s.weight.requires_grad = <span class="keyword">False</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            self.optimizer = optim_class(</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                [p <span class="keywordflow">for</span> p <span class="keywordflow">in</span> self.model.parameters() <span class="keywordflow">if</span> p.requires_grad], **kwargs</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            )</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            <span class="keywordflow">if</span> states.get(<span class="stringliteral">&#39;optimizer&#39;</span>):</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                <span class="keywordflow">if</span> states[<span class="stringliteral">&#39;optimizer_type&#39;</span>] != opt[<span class="stringliteral">&#39;optimizer&#39;</span>]:</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                    print(</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                        <span class="stringliteral">&#39;WARNING: not loading optim state since optim class &#39;</span> <span class="stringliteral">&#39;changed.&#39;</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                    )</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <span class="keywordflow">try</span>:</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        self.optimizer.load_state_dict(states[<span class="stringliteral">&#39;optimizer&#39;</span>])</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <span class="keywordflow">except</span> ValueError:</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                        print(</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                            <span class="stringliteral">&#39;WARNING: not loading optim state since model &#39;</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                            <span class="stringliteral">&#39;params changed.&#39;</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                        )</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                    <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                        <span class="keywordflow">for</span> state <span class="keywordflow">in</span> self.optimizer.state.values():</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                            <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> state.items():</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                <span class="keywordflow">if</span> isinstance(v, torch.Tensor):</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                    state[k] = v.cuda()</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            self.scheduler = optim.lr_scheduler.ReduceLROnPlateau(</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                self.optimizer, <span class="stringliteral">&#39;min&#39;</span>, factor=0.5, patience=3, verbose=<span class="keyword">True</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            )</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        self.reset()</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_html_a5fbd3301b67f00d6d146fb01c7cd7626"><div class="ttname"><a href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#a5fbd3301b67f00d6d146fb01c7cd7626">parlai.agents.legacy_agents.seq2seq.utils_v0.modelzoo_path</a></div><div class="ttdeci">def modelzoo_path(datapath, path)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd3/utils__v0_8py_source.html#l00755">utils_v0.py:755</a></div></div>
<div class="ttc" id="namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_html_a32e2e2022b824fbaf80c747160b52a76"><div class="ttname"><a href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">parlai.chat_service.services.messenger.shared_utils.format</a></div><div class="ttdeci">format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da3/chat__service_2services_2messenger_2shared__utils_8py_source.html#l00029">shared_utils.py:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="ae66e8065addb136eb82828ccbe56c5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae66e8065addb136eb82828ccbe56c5ca">&#9670;&nbsp;</a></span>act()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.act </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00924">924</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    <span class="keyword">def </span>act(self):</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="comment"># call batch_act with this batch of one</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        <span class="keywordflow">return</span> self.batch_act([self.observation])[0]</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ac00637641bf7d8f23614c53ec8a1c610"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac00637641bf7d8f23614c53ec8a1c610">&#9670;&nbsp;</a></span>add_cmdline_args()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.add_cmdline_args </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>argparser</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Add command-line arguments specifically for this agent.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00131">131</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keyword">def </span><a class="code" href="../../d3/d7d/namespaceparlai_1_1agents_1_1drqa_1_1config.html#a62fdd5554f1da6be0cba185271058320">add_cmdline_args</a>(argparser):</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="stringliteral">        Add command-line arguments specifically for this agent.</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        agent = argparser.add_argument_group(<span class="stringliteral">&#39;Seq2Seq Arguments&#39;</span>)</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="stringliteral">&#39;--init-model&#39;</span>,</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            type=str,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            default=<span class="keywordtype">None</span>,</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;            help=<span class="stringliteral">&#39;load dict/features/weights/opts from this file&#39;</span>,</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        )</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <span class="stringliteral">&#39;-hs&#39;</span>,</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            <span class="stringliteral">&#39;--hiddensize&#39;</span>,</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            type=int,</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            default=128,</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            help=<span class="stringliteral">&#39;size of the hidden layers&#39;</span>,</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        )</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            <span class="stringliteral">&#39;-esz&#39;</span>,</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            <span class="stringliteral">&#39;--embeddingsize&#39;</span>,</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            type=int,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            default=128,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            help=<span class="stringliteral">&#39;size of the token embeddings&#39;</span>,</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        )</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;            <span class="stringliteral">&#39;-nl&#39;</span>, <span class="stringliteral">&#39;--numlayers&#39;</span>, type=int, default=2, help=<span class="stringliteral">&#39;number of hidden layers&#39;</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        )</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="stringliteral">&#39;-lr&#39;</span>, <span class="stringliteral">&#39;--learningrate&#39;</span>, type=float, default=1, help=<span class="stringliteral">&#39;learning rate&#39;</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        )</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="stringliteral">&#39;-dr&#39;</span>, <span class="stringliteral">&#39;--dropout&#39;</span>, type=float, default=0.1, help=<span class="stringliteral">&#39;dropout rate&#39;</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        )</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="stringliteral">&#39;-clip&#39;</span>,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <span class="stringliteral">&#39;--gradient-clip&#39;</span>,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            type=float,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            default=0.1,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            help=<span class="stringliteral">&#39;gradient clipping using l2 norm&#39;</span>,</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        )</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="stringliteral">&#39;-bi&#39;</span>,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="stringliteral">&#39;--bidirectional&#39;</span>,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            help=<span class="stringliteral">&#39;whether to encode the context with a &#39;</span> <span class="stringliteral">&#39;bidirectional rnn&#39;</span>,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        )</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            <span class="stringliteral">&#39;-att&#39;</span>,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="stringliteral">&#39;--attention&#39;</span>,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            default=<span class="stringliteral">&#39;none&#39;</span>,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            choices=[<span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;concat&#39;</span>, <span class="stringliteral">&#39;general&#39;</span>, <span class="stringliteral">&#39;dot&#39;</span>, <span class="stringliteral">&#39;local&#39;</span>],</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            help=<span class="stringliteral">&#39;Choices: none, concat, general, local. &#39;</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            <span class="stringliteral">&#39;If set local, also set attention-length. &#39;</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            <span class="stringliteral">&#39;(see arxiv.org/abs/1508.04025)&#39;</span>,</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        )</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            <span class="stringliteral">&#39;-attl&#39;</span>,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            <span class="stringliteral">&#39;--attention-length&#39;</span>,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            default=48,</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            type=int,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            help=<span class="stringliteral">&#39;Length of local attention.&#39;</span>,</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        )</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="stringliteral">&#39;--attention-time&#39;</span>,</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            default=<span class="stringliteral">&#39;post&#39;</span>,</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            choices=[<span class="stringliteral">&#39;pre&#39;</span>, <span class="stringliteral">&#39;post&#39;</span>],</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            help=<span class="stringliteral">&#39;Whether to apply attention before or after &#39;</span> <span class="stringliteral">&#39;decoding.&#39;</span>,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        )</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            <span class="stringliteral">&#39;--no-cuda&#39;</span>,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            action=<span class="stringliteral">&#39;store_true&#39;</span>,</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            help=<span class="stringliteral">&#39;disable GPUs even if available&#39;</span>,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        )</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="stringliteral">&#39;-gpu&#39;</span>, <span class="stringliteral">&#39;--gpu&#39;</span>, type=int, default=-1, help=<span class="stringliteral">&#39;which GPU device to use&#39;</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        )</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="comment"># ranking arguments</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;            <span class="stringliteral">&#39;-rc&#39;</span>,</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="stringliteral">&#39;--rank-candidates&#39;</span>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            help=<span class="stringliteral">&#39;rank candidates if available. this is done by&#39;</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="stringliteral">&#39; computing the prob score per token for each &#39;</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            <span class="stringliteral">&#39;candidate and selecting the highest scoring.&#39;</span>,</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        )</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="stringliteral">&#39;-tr&#39;</span>,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            <span class="stringliteral">&#39;--truncate&#39;</span>,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            type=int,</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            default=-1,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            help=<span class="stringliteral">&#39;truncate input &amp; output lengths to speed up &#39;</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="stringliteral">&#39;training (may reduce accuracy). This fixes all &#39;</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="stringliteral">&#39;input and output to have a maximum length. This &#39;</span></div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="stringliteral">&#39;reduces the total amount &#39;</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="stringliteral">&#39;of padding in the batches.&#39;</span>,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        )</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            <span class="stringliteral">&#39;-rnn&#39;</span>,</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            <span class="stringliteral">&#39;--rnn-class&#39;</span>,</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            default=<span class="stringliteral">&#39;lstm&#39;</span>,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            choices=Seq2seq.RNN_OPTS.keys(),</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            help=<span class="stringliteral">&#39;Choose between different types of RNNs.&#39;</span>,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        )</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="stringliteral">&#39;-dec&#39;</span>,</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="stringliteral">&#39;--decoder&#39;</span>,</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            default=<span class="stringliteral">&#39;same&#39;</span>,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;            choices=[<span class="stringliteral">&#39;same&#39;</span>, <span class="stringliteral">&#39;shared&#39;</span>],</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            help=<span class="stringliteral">&#39;Choose between different decoder modules. &#39;</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="stringliteral">&#39;Default &quot;same&quot; uses same class as encoder, &#39;</span></div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="stringliteral">&#39;while &quot;shared&quot; also uses the same weights. &#39;</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            <span class="stringliteral">&#39;Note that shared disabled some encoder &#39;</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            <span class="stringliteral">&#39;options--in particular, bidirectionality.&#39;</span>,</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        )</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            <span class="stringliteral">&#39;-lt&#39;</span>,</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="stringliteral">&#39;--lookuptable&#39;</span>,</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            default=<span class="stringliteral">&#39;unique&#39;</span>,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            choices=[<span class="stringliteral">&#39;unique&#39;</span>, <span class="stringliteral">&#39;enc_dec&#39;</span>, <span class="stringliteral">&#39;dec_out&#39;</span>, <span class="stringliteral">&#39;all&#39;</span>],</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            help=<span class="stringliteral">&#39;The encoder, decoder, and output modules can &#39;</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            <span class="stringliteral">&#39;share weights, or not. &#39;</span></div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            <span class="stringliteral">&#39;Unique has independent embeddings for each. &#39;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="stringliteral">&#39;Enc_dec shares the embedding for the encoder &#39;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="stringliteral">&#39;and decoder. &#39;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="stringliteral">&#39;Dec_out shares decoder embedding and output &#39;</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            <span class="stringliteral">&#39;weights. &#39;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;            <span class="stringliteral">&#39;All shares all three weights.&#39;</span>,</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        )</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="stringliteral">&#39;-opt&#39;</span>,</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            <span class="stringliteral">&#39;--optimizer&#39;</span>,</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            default=<span class="stringliteral">&#39;sgd&#39;</span>,</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            choices=Seq2seqAgent.OPTIM_OPTS.keys(),</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            help=<span class="stringliteral">&#39;Choose between pytorch optimizers. &#39;</span></div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="stringliteral">&#39;Any member of torch.optim is valid and will &#39;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="stringliteral">&#39;be used with default params except learning &#39;</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            <span class="stringliteral">&#39;rate (as specified by -lr).&#39;</span>,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        )</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="stringliteral">&#39;-mom&#39;</span>,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            <span class="stringliteral">&#39;--momentum&#39;</span>,</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            default=-1,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            type=float,</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            help=<span class="stringliteral">&#39;if applicable, momentum value for optimizer. &#39;</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="stringliteral">&#39;if &gt; 0, sgd uses nesterov momentum.&#39;</span>,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        )</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="stringliteral">&#39;-emb&#39;</span>,</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="stringliteral">&#39;--embedding-type&#39;</span>,</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            default=<span class="stringliteral">&#39;random&#39;</span>,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            choices=[</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="stringliteral">&#39;random&#39;</span>,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                <span class="stringliteral">&#39;glove&#39;</span>,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="stringliteral">&#39;glove-fixed&#39;</span>,</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="stringliteral">&#39;fasttext&#39;</span>,</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                <span class="stringliteral">&#39;fasttext-fixed&#39;</span>,</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                <span class="stringliteral">&#39;glove-twitter&#39;</span>,</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;            ],</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            help=<span class="stringliteral">&#39;Choose between different strategies &#39;</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="stringliteral">&#39;for word embeddings. Default is random, &#39;</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="stringliteral">&#39;but can also preinitialize from Glove or &#39;</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="stringliteral">&#39;Fasttext.&#39;</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="stringliteral">&#39;Preinitialized embeddings can also be fixed &#39;</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="stringliteral">&#39;so they are not updated during training.&#39;</span>,</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        )</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="stringliteral">&#39;-soft&#39;</span>,</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="stringliteral">&#39;--numsoftmax&#39;</span>,</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            default=1,</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            type=int,</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;            help=<span class="stringliteral">&#39;default 1, if greater then uses mixture of &#39;</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;            <span class="stringliteral">&#39;softmax (see arxiv.org/abs/1711.03953).&#39;</span>,</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        )</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;            <span class="stringliteral">&#39;-rf&#39;</span>,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            <span class="stringliteral">&#39;--report-freq&#39;</span>,</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;            type=float,</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            default=0.001,</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;            help=<span class="stringliteral">&#39;Report frequency of prediction during eval.&#39;</span>,</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        )</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="stringliteral">&#39;-histr&#39;</span>,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="stringliteral">&#39;--history-replies&#39;</span>,</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            default=<span class="stringliteral">&#39;label_else_model&#39;</span>,</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            type=str,</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            choices=[<span class="stringliteral">&#39;none&#39;</span>, <span class="stringliteral">&#39;model&#39;</span>, <span class="stringliteral">&#39;label&#39;</span>, <span class="stringliteral">&#39;label_else_model&#39;</span>],</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;            help=<span class="stringliteral">&#39;Keep replies in the history, or not.&#39;</span>,</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        )</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;            <span class="stringliteral">&#39;-pt&#39;</span>,</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;            <span class="stringliteral">&#39;--person-tokens&#39;</span>,</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;            help=<span class="stringliteral">&#39;use special tokens before each speaker&#39;</span>,</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        )</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            <span class="stringliteral">&#39;--beam-size&#39;</span>,</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            type=int,</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            default=1,</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            help=<span class="stringliteral">&#39;Beam size, if 1 then greedy search&#39;</span>,</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        )</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            <span class="stringliteral">&#39;--beam-log-freq&#39;</span>,</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            type=float,</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            default=0.0,</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            help=<span class="stringliteral">&#39;The portion of beams to dump from minibatch into model_name.beam_dump folder&#39;</span>,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        )</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;            <span class="stringliteral">&#39;--topk&#39;</span>,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;            type=int,</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            default=1,</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            help=<span class="stringliteral">&#39;Top k sampling from renormalized softmax in test/valid time, default 1 means simple greedy max output&#39;</span>,</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        )</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="stringliteral">&#39;--softmax-layer-bias&#39;</span>,</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            help=<span class="stringliteral">&#39;Put True if you want to include the bias in decoder.e2s layer&#39;</span>,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        )</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        Seq2seqAgent.dictionary_class().<a class="code" href="../../d3/d7d/namespaceparlai_1_1agents_1_1drqa_1_1config.html#a62fdd5554f1da6be0cba185271058320">add_cmdline_args</a>(argparser)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keywordflow">return</span> agent</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1drqa_1_1config_html_a62fdd5554f1da6be0cba185271058320"><div class="ttname"><a href="../../d3/d7d/namespaceparlai_1_1agents_1_1drqa_1_1config.html#a62fdd5554f1da6be0cba185271058320">parlai.agents.drqa.config.add_cmdline_args</a></div><div class="ttdeci">def add_cmdline_args(parser)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/deb/config_8py_source.html#l00010">config.py:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ae534e440fd57603bc9b6e7c08b1c57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ae534e440fd57603bc9b6e7c08b1c57">&#9670;&nbsp;</a></span>batch_act()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.batch_act </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00871">871</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;    <span class="keyword">def </span>batch_act(self, observations):</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        batchsize = len(observations)</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        self.init_cuda_buffer(batchsize)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="comment"># initialize a table of replies with this agent&#39;s id</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        batch_reply = [{<span class="stringliteral">&#39;id&#39;</span>: self.getID()} <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(batchsize)]</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <span class="comment"># convert the observations into batches of inputs and targets</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        <span class="comment"># valid_inds tells us the indices of all valid examples</span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="comment"># e.g. for input [{}, {&#39;text&#39;: &#39;hello&#39;}, {}, {}], valid_inds is [1]</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="comment"># since the other three elements had no &#39;text&#39; field</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        xs, ys, labels, valid_inds, cands, valid_cands, is_training = self.vectorize(</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            observations</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        )</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <span class="keywordflow">if</span> xs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            <span class="comment"># no valid examples, just return empty responses</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <span class="keywordflow">return</span> batch_reply</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;        <span class="comment"># produce predictions, train on targets if availables</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        cand_inds = [i[0] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> valid_cands] <span class="keywordflow">if</span> valid_cands <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        predictions, cand_preds = self.predict(xs, ys, cands, cand_inds, is_training)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> is_training:</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            report_freq = 0</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            report_freq = self.report_freq</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="keywordflow">if</span> predictions <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;            PaddingUtils.map_predictions(</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                predictions,</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;                valid_inds,</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                batch_reply,</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                observations,</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                self.dict,</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                self.END_IDX,</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                report_freq=report_freq,</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                labels=labels,</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                answers=self.answers,</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                ys=ys.data <span class="keywordflow">if</span> ys <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span>,</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            )</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="keywordflow">if</span> cand_preds <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            <span class="keywordflow">if</span> valid_cands <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;                valid_cands = [(<span class="keywordtype">None</span>, i, labels) <span class="keywordflow">for</span> i <span class="keywordflow">in</span> valid_inds]</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(valid_cands)):</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;                order = cand_preds[i]</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;                _, batch_idx, curr_cands = valid_cands[i]</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;                curr = batch_reply[batch_idx]</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;                curr[<span class="stringliteral">&#39;text_candidates&#39;</span>] = [</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;                    curr_cands[idx] <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> order <span class="keywordflow">if</span> idx &lt; len(curr_cands)</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                ]</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        <span class="keywordflow">return</span> batch_reply</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a05552a2714cd8d15d754a62258727c98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05552a2714cd8d15d754a62258727c98">&#9670;&nbsp;</a></span>dictionary_class()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.dictionary_class </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00127">127</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keyword">def </span>dictionary_class():</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">return</span> DictionaryAgent</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a9326d8ed88999a992b8ec73313c70a36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9326d8ed88999a992b8ec73313c70a36">&#9670;&nbsp;</a></span>init_cuda_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.init_cuda_buffer </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batchsize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00850">850</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keyword">def </span>init_cuda_buffer(self, batchsize):</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        <span class="keywordflow">if</span> self.use_cuda <span class="keywordflow">and</span> <span class="keywordflow">not</span> hasattr(self, <span class="stringliteral">&#39;buffer_initialized&#39;</span>):</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                print(<span class="stringliteral">&#39;preinitializing pytorch cuda buffer&#39;</span>)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                bsz = self.opt.get(<span class="stringliteral">&#39;batchsize&#39;</span>, batchsize)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;                maxlen = self.truncate <span class="keywordflow">or</span> 180</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                dummy = torch.ones(bsz, maxlen).long().cuda()</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                sc = self.model(dummy, dummy)[1]</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                loss = self.criterion(sc.view(-1, sc.size(-1)), dummy.view(-1))</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                loss.backward()</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                self.buffer_initialized = <span class="keyword">True</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            <span class="keywordflow">except</span> RuntimeError <span class="keyword">as</span> e:</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;                <span class="keywordflow">if</span> <span class="stringliteral">&#39;out of memory&#39;</span> <span class="keywordflow">in</span> <a class="code" href="../../df/d5f/namespacegenerate__task__READMEs.html#a5b88452ffb87b78c8c85ececebafc09f">str</a>(e):</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                    m = (</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;                        <span class="stringliteral">&#39;CUDA OOM: Lower batch size (-bs) from {} or lower max&#39;</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                        <span class="stringliteral">&#39; sequence length (-tr) from {}&#39;</span>.<a class="code" href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">format</a>(bsz, maxlen)</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                    )</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                    <span class="keywordflow">raise</span> RuntimeError(m)</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                    <span class="keywordflow">raise</span> e</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="ttc" id="namespacegenerate__task__READMEs_html_a5b88452ffb87b78c8c85ececebafc09f"><div class="ttname"><a href="../../df/d5f/namespacegenerate__task__READMEs.html#a5b88452ffb87b78c8c85ececebafc09f">generate_task_READMEs.str</a></div><div class="ttdeci">string str</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d04/generate__task__READMEs_8py_source.html#l00022">generate_task_READMEs.py:22</a></div></div>
<div class="ttc" id="namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_html_a32e2e2022b824fbaf80c747160b52a76"><div class="ttname"><a href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">parlai.chat_service.services.messenger.shared_utils.format</a></div><div class="ttdeci">format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da3/chat__service_2services_2messenger_2shared__utils_8py_source.html#l00029">shared_utils.py:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2aabe1e56b7b94f46875ae7f704f681f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2aabe1e56b7b94f46875ae7f704f681f">&#9670;&nbsp;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.load </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return opt and model states.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00957">957</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keyword">def </span>load(self, path):</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral">        Return opt and model states.</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        states = torch.load(path, map_location=<span class="keyword">lambda</span> cpu, _: cpu)</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;        <span class="keywordflow">return</span> states</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a8419a9652b14a16cedff86206a7bb613"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8419a9652b14a16cedff86206a7bb613">&#9670;&nbsp;</a></span>observe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.observe </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save observation for act.

If multiple observations are from the same episode, concatenate them.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00708">708</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keyword">def </span>observe(self, observation):</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">        Save observation for act.</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">        If multiple observations are from the same episode, concatenate them.</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        <span class="comment"># shallow copy observation (deep copy can be expensive)</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        obs = observation.copy()</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> obs.get(<span class="stringliteral">&#39;preprocessed&#39;</span>, <span class="keyword">False</span>) <span class="keywordflow">or</span> <span class="stringliteral">&#39;text2vec&#39;</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> obs:</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;            obs[<span class="stringliteral">&#39;text2vec&#39;</span>] = <a class="code" href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#ac7cb3ffae208474d6e67f37ecfe07f64">maintain_dialog_history</a>(</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                self.history,</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                obs,</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                reply=self.answers[self.batch_idx],</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;                historyLength=self.truncate,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                useReplies=self.opt.get(<span class="stringliteral">&#39;history_replies&#39;</span>),</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                dict=self.dict,</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                useStartEndIndices=self.use_person_tokens,</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            )</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            obs[<span class="stringliteral">&#39;text2vec&#39;</span>] = deque(obs[<span class="stringliteral">&#39;text2vec&#39;</span>], maxlen=self.truncate)</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        self.observation = obs</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        self.answers[self.batch_idx] = <span class="keywordtype">None</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="keywordflow">return</span> obs</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_html_ac7cb3ffae208474d6e67f37ecfe07f64"><div class="ttname"><a href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#ac7cb3ffae208474d6e67f37ecfe07f64">parlai.agents.legacy_agents.seq2seq.utils_v0.maintain_dialog_history</a></div><div class="ttdeci">def maintain_dialog_history(history, observation, reply='', historyLength=1, useReplies='label_else_model', dict=None, useStartEndIndices=True, splitSentences=False)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd3/utils__v0_8py_source.html#l00337">utils_v0.py:337</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad40d38a1cc2cafe32c43477740b4a164"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40d38a1cc2cafe32c43477740b4a164">&#9670;&nbsp;</a></span>override_opt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.override_opt </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new_opt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Set overridable opts from loaded opt file.

Print out each added key and each overriden key. Only override args specific to
the model.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00570">570</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keyword">def </span>override_opt(self, new_opt):</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral">        Set overridable opts from loaded opt file.</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">        Print out each added key and each overriden key. Only override args specific to</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">        the model.</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        model_args = {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="stringliteral">&#39;hiddensize&#39;</span>,</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;            <span class="stringliteral">&#39;embeddingsize&#39;</span>,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <span class="stringliteral">&#39;numlayers&#39;</span>,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;            <span class="stringliteral">&#39;optimizer&#39;</span>,</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="stringliteral">&#39;encoder&#39;</span>,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;            <span class="stringliteral">&#39;decoder&#39;</span>,</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            <span class="stringliteral">&#39;lookuptable&#39;</span>,</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            <span class="stringliteral">&#39;attention&#39;</span>,</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="stringliteral">&#39;attention_length&#39;</span>,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;            <span class="stringliteral">&#39;rnn_class&#39;</span>,</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        }</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> new_opt.items():</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">if</span> k <span class="keywordflow">not</span> <span class="keywordflow">in</span> model_args:</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                <span class="comment"># skip non-model args</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                <span class="keywordflow">continue</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">if</span> k <span class="keywordflow">not</span> <span class="keywordflow">in</span> self.opt:</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                print(<span class="stringliteral">&#39;[ Adding new option: | {k}: {v} | ]&#39;</span>.<a class="code" href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">format</a>(k=k, v=v))</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;            <span class="keywordflow">elif</span> self.opt[k] != v:</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                print(</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                    <span class="stringliteral">&#39;[ Overriding option: | {k}: {old} =&gt; {v} | ]&#39;</span>.<a class="code" href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">format</a>(</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                        k=k, old=self.opt[k], v=v</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    )</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                )</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            self.opt[k] = v</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;dict_file&#39;</span> <span class="keywordflow">in</span> new_opt <span class="keywordflow">and</span> <span class="keywordflow">not</span> self.opt.get(<span class="stringliteral">&#39;dict_file&#39;</span>):</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;            print(</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="stringliteral">&#39;[ No dictionary path detected, trying to load previous &#39;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="stringliteral">&#39;path {} ]&#39;</span>.<a class="code" href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">format</a>(new_opt[<span class="stringliteral">&#39;dict_file&#39;</span>])</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            )</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            self.opt[<span class="stringliteral">&#39;dict_file&#39;</span>] = new_opt[<span class="stringliteral">&#39;dict_file&#39;</span>]</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="keywordflow">return</span> self.opt</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_html_a32e2e2022b824fbaf80c747160b52a76"><div class="ttname"><a href="../../d4/d94/namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils.html#a32e2e2022b824fbaf80c747160b52a76">parlai.chat_service.services.messenger.shared_utils.format</a></div><div class="ttdeci">format</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/da3/chat__service_2services_2messenger_2shared__utils_8py_source.html#l00029">shared_utils.py:29</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a073830870e283f88ee45a95c0ae8ad2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a073830870e283f88ee45a95c0ae8ad2f">&#9670;&nbsp;</a></span>parse()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.parse </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>text</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert string to token indices.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00610">610</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keyword">def </span>parse(self, text):</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="stringliteral">        Convert string to token indices.</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">return</span> self.dict.txt2vec(text)</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="aadec879f7d8daa6451076e4fb358715b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadec879f7d8daa6451076e4fb358715b">&#9670;&nbsp;</a></span>predict()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.predict </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>xs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ys</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cands</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>valid_cands</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>is_training</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Produce a prediction from our model.

Update the model using the targets if available, otherwise rank candidates as
well if they are available and param is set.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00733">733</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keyword">def </span>predict(self, xs, ys=None, cands=None, valid_cands=None, is_training=False):</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="stringliteral">        Produce a prediction from our model.</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="stringliteral">        Update the model using the targets if available, otherwise rank candidates as</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral">        well if they are available and param is set.</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        predictions, cand_preds = <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <span class="keywordflow">if</span> is_training:</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            self.model.<a class="code" href="../../d2/d65/namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run.html#a36a5f4f6f9df0611a6818610518d2cf0">train</a>()</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;            self.zero_grad()</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            out = <span class="keywordtype">None</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                out = self.model(xs, ys, rank_during_training=cands <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                <span class="comment"># generated response</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                _preds, scores, cand_preds = out[0], out[1], out[2]</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                score_view = scores.view(-1, scores.size(-1))</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                loss = self.criterion(score_view, ys.view(-1))</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                <span class="comment"># save loss to metrics</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                y_ne = ys.ne(self.NULL_IDX)</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                target_tokens = y_ne.long().sum().item()</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                correct = ((ys == _preds) * y_ne).sum().item()</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                self.metrics[<span class="stringliteral">&#39;correct_tokens&#39;</span>] += correct</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                self.metrics[<span class="stringliteral">&#39;loss&#39;</span>] += loss.item()</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                self.metrics[<span class="stringliteral">&#39;num_tokens&#39;</span>] += target_tokens</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                loss /= target_tokens  <span class="comment"># average loss per token</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;                loss.backward()</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;            <span class="keywordflow">except</span> RuntimeError <span class="keyword">as</span> e:</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                <span class="comment"># catch out of memory exceptions during fwd/bck (skip batch)</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                <span class="keywordflow">if</span> <span class="stringliteral">&#39;out of memory&#39;</span> <span class="keywordflow">in</span> <a class="code" href="../../df/d5f/namespacegenerate__task__READMEs.html#a5b88452ffb87b78c8c85ececebafc09f">str</a>(e):</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;                    print(</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;                        <span class="stringliteral">&#39;| WARNING: ran out of memory, skipping batch. &#39;</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                        <span class="stringliteral">&#39;if this happens frequently, decrease batchsize or &#39;</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                        <span class="stringliteral">&#39;truncate the inputs to the model.&#39;</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                    )</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                    self.metrics[<span class="stringliteral">&#39;total_skipped_batches&#39;</span>] += 1</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                    <span class="keywordflow">return</span> predictions, cand_preds</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">else</span>:</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                    <span class="keywordflow">raise</span> e</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            self.update_params()</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;            self.model.eval()</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            out = self.model(</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                xs,</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                ys=<span class="keywordtype">None</span>,</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                cands=cands,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                valid_cands=valid_cands,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                beam_size=self.beam_size,</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                topk=self.topk,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            )</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            predictions, cand_preds = out[0], out[2]</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            <span class="keywordflow">if</span> ys <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <span class="comment"># calculate loss on targets</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                out = self.model(xs, ys)</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                scores = out[1]</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                score_view = scores.view(-1, scores.size(-1))</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                loss = self.criterion(score_view, ys.view(-1))</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                <span class="comment"># save loss to metrics</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                target_tokens = ys.ne(self.NULL_IDX).long().sum().item()</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                self.metrics[<span class="stringliteral">&#39;loss&#39;</span>] += loss.item()</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                self.metrics[<span class="stringliteral">&#39;num_tokens&#39;</span>] += target_tokens</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;        <span class="keywordflow">return</span> predictions, cand_preds</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="ttc" id="namespacegenerate__task__READMEs_html_a5b88452ffb87b78c8c85ececebafc09f"><div class="ttname"><a href="../../df/d5f/namespacegenerate__task__READMEs.html#a5b88452ffb87b78c8c85ececebafc09f">generate_task_READMEs.str</a></div><div class="ttdeci">string str</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d04/generate__task__READMEs_8py_source.html#l00022">generate_task_READMEs.py:22</a></div></div>
<div class="ttc" id="namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_html_a36a5f4f6f9df0611a6818610518d2cf0"><div class="ttname"><a href="../../d2/d65/namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run.html#a36a5f4f6f9df0611a6818610518d2cf0">projects.mastering_the_dungeon.mturk.tasks.MTD.run.train</a></div><div class="ttdeci">def train(opt, round_index, machine_index, file_index, train_data, valid_data, valid_weights=None, save_all=True, return_acc_len=False, seq2seq=False)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d69/projects_2mastering__the__dungeon_2mturk_2tasks_2MTD_2run_8py_source.html#l00182">run.py:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a584d45d729817694d615d2d545532af2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a584d45d729817694d615d2d545532af2">&#9670;&nbsp;</a></span>receive_metrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.receive_metrics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metrics_dict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Use the metrics to decide when to adjust LR schedule.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00964">964</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keyword">def </span>receive_metrics(self, metrics_dict):</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="stringliteral">        Use the metrics to decide when to adjust LR schedule.</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;loss&#39;</span> <span class="keywordflow">in</span> metrics_dict:</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            self.scheduler.step(metrics_dict[<span class="stringliteral">&#39;loss&#39;</span>])</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a83a444ecb418dfb4381147f23653dd7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83a444ecb418dfb4381147f23653dd7b">&#9670;&nbsp;</a></span>report()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.report </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Report loss and perplexity from model's perspective.

Note that this includes predicting __END__ and __UNK__ tokens and may differ
from a truly independent measurement.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00660">660</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keyword">def </span><a class="code" href="../../db/d1c/namespaceprojects_1_1convai2_1_1eval__f1.html#a01a47b9c08dad189837a51f085defc45">report</a>(self):</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">        Report loss and perplexity from model&#39;s perspective.</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">        Note that this includes predicting __END__ and __UNK__ tokens and may differ</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral">        from a truly independent measurement.</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        m = {}</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        num_tok = self.metrics[<span class="stringliteral">&#39;num_tokens&#39;</span>]</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="keywordflow">if</span> num_tok &gt; 0:</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;            <span class="keywordflow">if</span> self.metrics[<span class="stringliteral">&#39;correct_tokens&#39;</span>] &gt; 0:</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;                m[<span class="stringliteral">&#39;token_acc&#39;</span>] = self.metrics[<span class="stringliteral">&#39;correct_tokens&#39;</span>] / num_tok</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            m[<span class="stringliteral">&#39;loss&#39;</span>] = self.metrics[<span class="stringliteral">&#39;loss&#39;</span>] / num_tok</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">try</span>:</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                m[<span class="stringliteral">&#39;ppl&#39;</span>] = math.exp(m[<span class="stringliteral">&#39;loss&#39;</span>])</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">except</span> OverflowError:</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                m[<span class="stringliteral">&#39;ppl&#39;</span>] = <a class="code" href="../../d7/dc3/namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset.html#aa2b7207688c641dbc094ab44eca27113">float</a>(<span class="stringliteral">&#39;inf&#39;</span>)</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        <span class="keywordflow">if</span> self.metrics[<span class="stringliteral">&#39;total_skipped_batches&#39;</span>] &gt; 0:</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;            m[<span class="stringliteral">&#39;total_skipped_batches&#39;</span>] = self.metrics[<span class="stringliteral">&#39;total_skipped_batches&#39;</span>]</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> m.items():</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;            <span class="comment"># clean up: rounds to sigfigs and converts tensors to floats</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            m[k] = <a class="code" href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#af377ec61bfc0423461e7b409ffc883b9">round_sigfigs</a>(v, 4)</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;        <span class="keywordflow">return</span> m</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="ttc" id="namespaceprojects_1_1convai2_1_1eval__f1_html_a01a47b9c08dad189837a51f085defc45"><div class="ttname"><a href="../../db/d1c/namespaceprojects_1_1convai2_1_1eval__f1.html#a01a47b9c08dad189837a51f085defc45">projects.convai2.eval_f1.report</a></div><div class="ttdeci">report</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d61/convai2_2eval__f1_8py_source.html#l00039">eval_f1.py:39</a></div></div>
<div class="ttc" id="namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_html_af377ec61bfc0423461e7b409ffc883b9"><div class="ttname"><a href="../../d5/dbb/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0.html#af377ec61bfc0423461e7b409ffc883b9">parlai.agents.legacy_agents.seq2seq.utils_v0.round_sigfigs</a></div><div class="ttdeci">def round_sigfigs(x, sigfigs=4)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd3/utils__v0_8py_source.html#l00395">utils_v0.py:395</a></div></div>
<div class="ttc" id="namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_html_aa2b7207688c641dbc094ab44eca27113"><div class="ttname"><a href="../../d7/dc3/namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset.html#aa2b7207688c641dbc094ab44eca27113">projects.controllable_dialogue.make_control_dataset.float</a></div><div class="ttdeci">float</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d82/make__control__dataset_8py_source.html#l00117">make_control_dataset.py:117</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a56d246fd8b6bcf41726181c17cdc2762"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56d246fd8b6bcf41726181c17cdc2762">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.reset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reset observation and episode_done.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00642">642</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keyword">def </span>reset(self):</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral">        Reset observation and episode_done.</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        self.observation = <span class="keywordtype">None</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        self.history.clear()</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(self.answers)):</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;            self.answers[i] = <span class="keywordtype">None</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        self.reset_metrics()</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ae76435bf7acee9501188de47c0ba6991"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae76435bf7acee9501188de47c0ba6991">&#9670;&nbsp;</a></span>reset_metrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.reset_metrics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Reset metrics for reporting loss and perplexity.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00652">652</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keyword">def </span>reset_metrics(self):</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral">        Reset metrics for reporting loss and perplexity.</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        self.metrics[<span class="stringliteral">&#39;loss&#39;</span>] = 0.0</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        self.metrics[<span class="stringliteral">&#39;num_tokens&#39;</span>] = 0</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        self.metrics[<span class="stringliteral">&#39;correct_tokens&#39;</span>] = 0</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a31c017cd07b01834a5d467fadfddd7cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31c017cd07b01834a5d467fadfddd7cd">&#9670;&nbsp;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.save </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save model parameters if model_file is set.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00928">928</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    <span class="keyword">def </span>save(self, path=None):</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="stringliteral">        Save model parameters if model_file is set.</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        path = self.opt.get(<span class="stringliteral">&#39;model_file&#39;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">if</span> path <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> path</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        <span class="keywordflow">if</span> path <span class="keywordflow">and</span> hasattr(self, <span class="stringliteral">&#39;model&#39;</span>):</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            model = {}</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            model[<span class="stringliteral">&#39;model&#39;</span>] = self.model.state_dict()</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            model[<span class="stringliteral">&#39;longest_label&#39;</span>] = self.model.longest_label</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            model[<span class="stringliteral">&#39;optimizer&#39;</span>] = self.optimizer.state_dict()</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            model[<span class="stringliteral">&#39;optimizer_type&#39;</span>] = self.opt[<span class="stringliteral">&#39;optimizer&#39;</span>]</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            with open(path, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> write:</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                torch.save(model, write)</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <span class="comment"># save opt file</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            with open(path + <span class="stringliteral">&quot;.opt&quot;</span>, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> handle:</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;                pickle.dump(self.opt, handle, protocol=pickle.HIGHEST_PROTOCOL)</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ac050147b69c47182730e92866f64156a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac050147b69c47182730e92866f64156a">&#9670;&nbsp;</a></span>share()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.share </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Share internal states between parent and child instances.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00684">684</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keyword">def </span>share(self):</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral">        Share internal states between parent and child instances.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        shared = super().share()</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        shared[<span class="stringliteral">&#39;opt&#39;</span>] = self.opt</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        shared[<span class="stringliteral">&#39;answers&#39;</span>] = self.answers</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        shared[<span class="stringliteral">&#39;dict&#39;</span>] = self.dict</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        shared[<span class="stringliteral">&#39;START_IDX&#39;</span>] = self.START_IDX</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        shared[<span class="stringliteral">&#39;END_IDX&#39;</span>] = self.END_IDX</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        shared[<span class="stringliteral">&#39;NULL_IDX&#39;</span>] = self.NULL_IDX</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        shared[<span class="stringliteral">&#39;model&#39;</span>] = self.model</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;        <span class="keywordflow">if</span> self.opt.get(<span class="stringliteral">&#39;numthreads&#39;</span>, 1) &gt; 1:</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment"># we&#39;re doing hogwild so share the model too</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <span class="keywordflow">if</span> <a class="code" href="../../d4/da3/namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf.html#ad5dfae268e23f506da084a9efb72f619">type</a>(self.metrics) == dict:</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;                <span class="comment"># move metrics and model to shared memory</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                self.metrics = SharedTable(self.metrics)</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;                self.model.share_memory()</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;            shared[<span class="stringliteral">&#39;states&#39;</span>] = {  <span class="comment"># don&#39;t share optimizer states</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                <span class="stringliteral">&#39;optimizer_type&#39;</span>: self.opt[<span class="stringliteral">&#39;optimizer&#39;</span>]</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            }</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        shared[<span class="stringliteral">&#39;metrics&#39;</span>] = self.metrics  <span class="comment"># do after numthreads check</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="keywordflow">return</span> shared</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_html_ad5dfae268e23f506da084a9efb72f619"><div class="ttname"><a href="../../d4/da3/namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf.html#ad5dfae268e23f506da084a9efb72f619">parlai.agents.tfidf_retriever.build_tfidf.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="../../df/de8/build__tfidf_8py_source.html#l00339">build_tfidf.py:339</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a86c41e705170f0b2e56a5bbc378aead9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c41e705170f0b2e56a5bbc378aead9">&#9670;&nbsp;</a></span>shutdown()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.shutdown </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save the state of the model when shutdown.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00948">948</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keyword">def </span>shutdown(self):</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">        Save the state of the model when shutdown.</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        path = self.opt.get(<span class="stringliteral">&#39;model_file&#39;</span>, <span class="keywordtype">None</span>)</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">if</span> path <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> hasattr(self, <span class="stringliteral">&#39;optimizer&#39;</span>):</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            self.save(path + <span class="stringliteral">&#39;.shutdown_state&#39;</span>)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;        super().shutdown()</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a3933d4fdc5e603b1a168d92e7da77151"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3933d4fdc5e603b1a168d92e7da77151">&#9670;&nbsp;</a></span>update_params()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.update_params </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Do one optimization step.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00634">634</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keyword">def </span>update_params(self):</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">        Do one optimization step.</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">if</span> self.clip &gt; 0:</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            torch.nn.utils.clip_grad_norm_(self.model.parameters(), self.clip)</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        self.optimizer.step()</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a8f6de929b475d3915c159c48165b4575"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f6de929b475d3915c159c48165b4575">&#9670;&nbsp;</a></span>v2t()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.v2t </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>vec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert token indices to string of tokens.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00616">616</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="keyword">def </span>v2t(self, vec):</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="stringliteral">        Convert token indices to string of tokens.</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        new_vec = []</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">for</span> i <span class="keywordflow">in</span> vec:</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">if</span> i == self.END_IDX:</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                <span class="keywordflow">break</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">elif</span> i != self.START_IDX:</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                new_vec.append(i)</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">return</span> self.dict.vec2txt(new_vec)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a83e2433e00bff6162ebad3b818771b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83e2433e00bff6162ebad3b818771b59">&#9670;&nbsp;</a></span>vectorize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.vectorize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Convert a list of observations into input &amp; target tensors.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00799">799</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keyword">def </span><a class="code" href="../../d6/d5b/namespaceparlai_1_1agents_1_1drqa_1_1utils.html#a5c76cc39e3014c7bcf9199d566dbdc0f">vectorize</a>(self, observations):</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">        Convert a list of observations into input &amp; target tensors.</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        is_training = any([<span class="stringliteral">&#39;labels&#39;</span> <span class="keywordflow">in</span> obs <span class="keywordflow">for</span> obs <span class="keywordflow">in</span> observations])</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        xs, ys, labels, valid_inds, _, _ = PaddingUtils.pad_text(</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            observations,</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            self.dict,</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            end_idx=self.END_IDX,</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            null_idx=self.NULL_IDX,</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            dq=<span class="keyword">True</span>,</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            eval_labels=<span class="keyword">True</span>,</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            truncate=self.truncate,</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        )</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <span class="keywordflow">if</span> xs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            <span class="keywordflow">return</span> <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        xs = torch.LongTensor(xs)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">if</span> ys <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            ys = torch.LongTensor(ys)</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="comment"># copy to gpu</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            xs = xs.cuda()</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;            <span class="keywordflow">if</span> ys <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;                ys = ys.cuda()</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        cands = <span class="keywordtype">None</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        valid_cands = <span class="keywordtype">None</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> is_training <span class="keywordflow">and</span> self.rank:</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="comment"># set up candidates</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;            cands = []</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            valid_cands = []</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">for</span> i, v <span class="keywordflow">in</span> enumerate(valid_inds):</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                <span class="keywordflow">if</span> <span class="stringliteral">&#39;label_candidates&#39;</span> <span class="keywordflow">in</span> observations[v]:</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                    curr_lcs = list(observations[v][<span class="stringliteral">&#39;label_candidates&#39;</span>])</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                    curr_cands = [{<span class="stringliteral">&#39;text&#39;</span>: c} <span class="keywordflow">for</span> c <span class="keywordflow">in</span> curr_lcs]</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                    cs, _, _, valid_c_inds, *_ = PaddingUtils.pad_text(</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                        curr_cands,</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                        self.dict,</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                        null_idx=self.NULL_IDX,</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                        dq=<span class="keyword">True</span>,</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                        truncate=self.truncate,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                    )</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;                    valid_cands.append((i, v, [curr_lcs[j] <span class="keywordflow">for</span> j <span class="keywordflow">in</span> valid_c_inds]))</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                    cs = torch.LongTensor(cs)</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                    <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                        cs = cs.cuda()</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                    cands.append(cs)</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;        <span class="keywordflow">return</span> xs, ys, labels, valid_inds, cands, valid_cands, is_training</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1drqa_1_1utils_html_a5c76cc39e3014c7bcf9199d566dbdc0f"><div class="ttname"><a href="../../d6/d5b/namespaceparlai_1_1agents_1_1drqa_1_1utils.html#a5c76cc39e3014c7bcf9199d566dbdc0f">parlai.agents.drqa.utils.vectorize</a></div><div class="ttdeci">def vectorize(opt, ex, word_dict, feature_dict)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d52/parlai_2agents_2drqa_2utils_8py_source.html#l00070">utils.py:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0be9f1e378a403284d8afac5648fbf4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0be9f1e378a403284d8afac5648fbf4d">&#9670;&nbsp;</a></span>zero_grad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.zero_grad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Zero out optimizer.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00628">628</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keyword">def </span>zero_grad(self):</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">        Zero out optimizer.</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        self.optimizer.zero_grad()</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad5d4bdcd877577596273c4af1eb4c70d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d4bdcd877577596273c4af1eb4c70d">&#9670;&nbsp;</a></span>answers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.answers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00395">395</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a2f31501d3923b8fb080d147d23ab727b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f31501d3923b8fb080d147d23ab727b">&#9670;&nbsp;</a></span>batch_idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.batch_idx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00375">375</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a215857d3ce2c7522c43728ab2879ce89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a215857d3ce2c7522c43728ab2879ce89">&#9670;&nbsp;</a></span>beam_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.beam_size</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00377">377</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a31e1353ee2c64ac03af2bc7854597f35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31e1353ee2c64ac03af2bc7854597f35">&#9670;&nbsp;</a></span>buffer_initialized</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.buffer_initialized</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00860">860</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a4896d5dc3fd7a0f876a654f0bc942b6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4896d5dc3fd7a0f876a654f0bc942b6a">&#9670;&nbsp;</a></span>clip</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.clip</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00523">523</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ad336994a64a83591ba1388aef3f1d5de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad336994a64a83591ba1388aef3f1d5de">&#9670;&nbsp;</a></span>criterion</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.criterion</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00511">511</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ad5ff9534948d32ca9b387fe1189174e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5ff9534948d32ca9b387fe1189174e6">&#9670;&nbsp;</a></span>dict</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.dict</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00390">390</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a46ebee256e0812f6cab77a71c02578e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46ebee256e0812f6cab77a71c02578e0">&#9670;&nbsp;</a></span>END_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.END_IDX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00392">392</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a11398edabc596559f45324d2d603b1e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11398edabc596559f45324d2d603b1e3">&#9670;&nbsp;</a></span>history</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.history</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00372">372</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a616955265cd96254aae5b5958ac18159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a616955265cd96254aae5b5958ac18159">&#9670;&nbsp;</a></span>id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00427">427</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ac50fcecc3b2ec89ece9bf75df8e21c6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac50fcecc3b2ec89ece9bf75df8e21c6d">&#9670;&nbsp;</a></span>metrics</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.metrics</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00366">366</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ae6ef958bb58cc1597b23b0a6c6c49b3f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6ef958bb58cc1597b23b0a6c6c49b3f">&#9670;&nbsp;</a></span>model</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.model</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00396">396</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a203f77c92dd9f343cd7c5580756d5e5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203f77c92dd9f343cd7c5580756d5e5a">&#9670;&nbsp;</a></span>model_class</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.model_class</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00437">437</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a8589f9403a5d358b1c58b467fc556680"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8589f9403a5d358b1c58b467fc556680">&#9670;&nbsp;</a></span>NULL_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.NULL_IDX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00393">393</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a4473b0e478d7928c2b59ab653c8334fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4473b0e478d7928c2b59ab653c8334fb">&#9670;&nbsp;</a></span>observation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.observation</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00646">646</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a8e4926c0c0da6bd7d530c44aa5416731"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e4926c0c0da6bd7d530c44aa5416731">&#9670;&nbsp;</a></span>opt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.opt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00388">388</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a83374019847ffa0c1cc43bf0b24120e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83374019847ffa0c1cc43bf0b24120e9">&#9670;&nbsp;</a></span>OPTIM_OPTS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dictionary parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.OPTIM_OPTS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {</div><div class="line">        <span class="stringliteral">&#39;adadelta&#39;</span>: optim.Adadelta,</div><div class="line">        <span class="stringliteral">&#39;adagrad&#39;</span>: optim.Adagrad,</div><div class="line">        <span class="stringliteral">&#39;adam&#39;</span>: optim.Adam,</div><div class="line">        <span class="stringliteral">&#39;adamax&#39;</span>: optim.Adamax,</div><div class="line">        <span class="stringliteral">&#39;asgd&#39;</span>: optim.ASGD,</div><div class="line">        <span class="stringliteral">&#39;lbfgs&#39;</span>: optim.LBFGS,</div><div class="line">        <span class="stringliteral">&#39;rmsprop&#39;</span>: optim.RMSprop,</div><div class="line">        <span class="stringliteral">&#39;rprop&#39;</span>: optim.Rprop,</div><div class="line">        <span class="stringliteral">&#39;sgd&#39;</span>: optim.SGD,</div><div class="line">    }</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00114">114</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ac6a5cc3b1faaae160f5c10318a7afcfd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6a5cc3b1faaae160f5c10318a7afcfd">&#9670;&nbsp;</a></span>optimizer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.optimizer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00543">543</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a07995ff61edb2c4699aa766122878e94"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07995ff61edb2c4699aa766122878e94">&#9670;&nbsp;</a></span>rank</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.rank</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00376">376</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a3f13aca25d825730f0dacbf50f48d7c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f13aca25d825730f0dacbf50f48d7c6">&#9670;&nbsp;</a></span>report_freq</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.report_freq</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00373">373</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ac8229fafe6c4b7d7ebedbd0f00b55eb0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8229fafe6c4b7d7ebedbd0f00b55eb0">&#9670;&nbsp;</a></span>scheduler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.scheduler</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00564">564</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a044b5f18e6d9f0207b947769f06bcc6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a044b5f18e6d9f0207b947769f06bcc6b">&#9670;&nbsp;</a></span>START_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.START_IDX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00391">391</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ac0b7a3b712fe92dbabee7f31972b8a47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0b7a3b712fe92dbabee7f31972b8a47">&#9670;&nbsp;</a></span>topk</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.topk</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00378">378</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a7943d21acc4e6986e15678e7da1d2f27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7943d21acc4e6986e15678e7da1d2f27">&#9670;&nbsp;</a></span>truncate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.truncate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00365">365</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="ab81d3b0bd5474debb2f983d1b6220d5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab81d3b0bd5474debb2f983d1b6220d5e">&#9670;&nbsp;</a></span>use_cuda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.use_cuda</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00382">382</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<a id="a227faa3994686ab266237ce9e11a2dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a227faa3994686ab266237ce9e11a2dc7">&#9670;&nbsp;</a></span>use_person_tokens</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.seq2seq_v0.Seq2seqAgent.use_person_tokens</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html#l00374">374</a> of file <a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>parlai/agents/legacy_agents/seq2seq/<a class="el" href="../../d6/d59/seq2seq__v0_8py_source.html">seq2seq_v0.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
