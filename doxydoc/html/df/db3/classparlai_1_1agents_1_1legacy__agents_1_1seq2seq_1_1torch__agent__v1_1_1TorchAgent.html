<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ParlAI: parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ParlAI
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d5/d22/namespaceparlai.html">parlai</a></li><li class="navelem"><a class="el" href="../../dd/d61/namespaceparlai_1_1agents.html">agents</a></li><li class="navelem"><a class="el" href="../../d1/dae/namespaceparlai_1_1agents_1_1legacy__agents.html">legacy_agents</a></li><li class="navelem"><a class="el" href="../../d9/dd0/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq.html">seq2seq</a></li><li class="navelem"><a class="el" href="../../db/d30/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1.html">torch_agent_v1</a></li><li class="navelem"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html">TorchAgent</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pub-static-attribs">Static Public Attributes</a> &#124;
<a href="../../df/d89/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent:</div>
<div class="dyncontent">
<div class="center"><img src="../../d3/daf/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent__inherit__graph.png" border="0" usemap="#parlai_8agents_8legacy__agents_8seq2seq_8torch__agent__v1_8TorchAgent_inherit__map" alt="Inheritance graph"/></div>
<map name="parlai_8agents_8legacy__agents_8seq2seq_8torch__agent__v1_8TorchAgent_inherit__map" id="parlai_8agents_8legacy__agents_8seq2seq_8torch__agent__v1_8TorchAgent_inherit__map">
<area shape="rect" id="node4" href="../../d6/d27/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v1_1_1Seq2seqAgent.html" title="parlai.agents.legacy\l_agents.seq2seq.seq2seq\l_v1.Seq2seqAgent" alt="" coords="15,259,190,315"/>
<area shape="rect" id="node2" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html" title="parlai.core.agents.Agent" alt="" coords="21,80,184,107"/>
<area shape="rect" id="node5" href="../../d9/d12/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v1_1_1PerplexityEvaluatorAgent.html" title="parlai.agents.legacy\l_agents.seq2seq.seq2seq\l_v1.PerplexityEvaluatorAgent" alt="" coords="5,363,200,419"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent:</div>
<div class="dyncontent">
<div class="center"><img src="../../d2/da6/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent__coll__graph.png" border="0" usemap="#parlai_8agents_8legacy__agents_8seq2seq_8torch__agent__v1_8TorchAgent_coll__map" alt="Collaboration graph"/></div>
<map name="parlai_8agents_8legacy__agents_8seq2seq_8torch__agent__v1_8TorchAgent_coll__map" id="parlai_8agents_8legacy__agents_8seq2seq_8torch__agent__v1_8TorchAgent_coll__map">
<area shape="rect" id="node2" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html" title="parlai.core.agents.Agent" alt="" coords="5,81,168,108"/>
</map>
<center><span class="legend">[<a href="../../graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a00701a40d62943dbd887525bf8e8002d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a00701a40d62943dbd887525bf8e8002d">add_cmdline_args</a> (cls, argparser)</td></tr>
<tr class="separator:a00701a40d62943dbd887525bf8e8002d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c4eb91757ee23e75edfa957d05db338"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a1c4eb91757ee23e75edfa957d05db338">__init__</a> (self, <a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a4e938a91873bd6edde0ac7ed5299bc6a">opt</a>, shared=None)</td></tr>
<tr class="separator:a1c4eb91757ee23e75edfa957d05db338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1727b17db185dcc7237d893018c7b76c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a1727b17db185dcc7237d893018c7b76c">init_optim</a> (self, params, optim_states=None, saved_optim_type=None)</td></tr>
<tr class="separator:a1727b17db185dcc7237d893018c7b76c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af97699a6b03a17969830db378f09cac4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#af97699a6b03a17969830db378f09cac4">receive_metrics</a> (self, metrics_dict)</td></tr>
<tr class="separator:af97699a6b03a17969830db378f09cac4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d922c4a8452c9e44fa2478e6fecdfd1"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a3d922c4a8452c9e44fa2478e6fecdfd1">share</a> (self)</td></tr>
<tr class="separator:a3d922c4a8452c9e44fa2478e6fecdfd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a866838e1c81063a3ec18c5609e029f90"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a866838e1c81063a3ec18c5609e029f90">vectorize</a> (self, obs, add_start=True, add_end=True, <a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#ac0286e4dbf6dc71bda0c364851de5f22">truncate</a>=None, split_lines=False)</td></tr>
<tr class="separator:a866838e1c81063a3ec18c5609e029f90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b2fa26aabfd9d7e7abb0abbcfe8044"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#ab8b2fa26aabfd9d7e7abb0abbcfe8044">batchify</a> (self, obs_batch, sort=False, is_valid=lambda obs:'text_vec' in obs or 'image' in obs)</td></tr>
<tr class="separator:ab8b2fa26aabfd9d7e7abb0abbcfe8044"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac419cfad0fc5988e7e796c244f3a9f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#acac419cfad0fc5988e7e796c244f3a9f">match_batch</a> (self, batch_reply, valid_inds, output=None)</td></tr>
<tr class="separator:acac419cfad0fc5988e7e796c244f3a9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8984452b8b4e6194625530aeae49b243"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a8984452b8b4e6194625530aeae49b243">get_dialog_history</a> (self, <a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a04fa334c086cf9afa815a44f1948e625">observation</a>, reply=None, <a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a81f970d715f2525ad342330a28703c5c">add_person_tokens</a>=False, add_p1_after_newln=False)</td></tr>
<tr class="separator:a8984452b8b4e6194625530aeae49b243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf7a50ea0eb319737123d2e46fde4c0f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#abf7a50ea0eb319737123d2e46fde4c0f">last_reply</a> (self, use_label=True)</td></tr>
<tr class="separator:abf7a50ea0eb319737123d2e46fde4c0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4b2346c35e214a8028eb83d1fc5ffd7"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#ae4b2346c35e214a8028eb83d1fc5ffd7">reply_history</a> (self)</td></tr>
<tr class="separator:ae4b2346c35e214a8028eb83d1fc5ffd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eb23a78aea413ae4f90ce0628179920"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a0eb23a78aea413ae4f90ce0628179920">observe</a> (self, <a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a04fa334c086cf9afa815a44f1948e625">observation</a>)</td></tr>
<tr class="separator:a0eb23a78aea413ae4f90ce0628179920"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a01defa1d669571f574fcfe021776a8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a4a01defa1d669571f574fcfe021776a8">save</a> (self, path=None)</td></tr>
<tr class="separator:a4a01defa1d669571f574fcfe021776a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d71ad7997e048e4f4f7d957fae64ac5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a6d71ad7997e048e4f4f7d957fae64ac5">load</a> (self, path)</td></tr>
<tr class="separator:a6d71ad7997e048e4f4f7d957fae64ac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93e935c0d2d589d8990ff14d6e528c4d"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a93e935c0d2d589d8990ff14d6e528c4d">reset</a> (self)</td></tr>
<tr class="separator:a93e935c0d2d589d8990ff14d6e528c4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ab251071823f34358a569c1c2a11bf9"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a3ab251071823f34358a569c1c2a11bf9">act</a> (self)</td></tr>
<tr class="separator:a3ab251071823f34358a569c1c2a11bf9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3929c1bedc50a48dcf8d1184321f4f5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#af3929c1bedc50a48dcf8d1184321f4f5">batch_act</a> (self, observations)</td></tr>
<tr class="separator:af3929c1bedc50a48dcf8d1184321f4f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff9cc5c105bbf154075aa83e288582ca"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#aff9cc5c105bbf154075aa83e288582ca">train_step</a> (self, batch)</td></tr>
<tr class="separator:aff9cc5c105bbf154075aa83e288582ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801f2b9a359201fd0a395ab61fd61806"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a801f2b9a359201fd0a395ab61fd61806">eval_step</a> (self, batch)</td></tr>
<tr class="separator:a801f2b9a359201fd0a395ab61fd61806"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classparlai_1_1core_1_1agents_1_1Agent')"><img src="../../closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html">parlai.core.agents.Agent</a></td></tr>
<tr class="memitem:aa7992ab392e2803607937e805ceb176f inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#aa7992ab392e2803607937e805ceb176f">__init__</a> (self, <a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#ab3b45d2754244608c75d4068b90cd051">opt</a>, shared=None)</td></tr>
<tr class="separator:aa7992ab392e2803607937e805ceb176f inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98041e2d186aa81bd5e1649a91f623bc inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a98041e2d186aa81bd5e1649a91f623bc">observe</a> (self, <a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#aedbecc4b4aa7af7413882a0429e0f1db">observation</a>)</td></tr>
<tr class="separator:a98041e2d186aa81bd5e1649a91f623bc inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a8abe0a98dd59bc39c9f12b163072db inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a6a8abe0a98dd59bc39c9f12b163072db">act</a> (self)</td></tr>
<tr class="separator:a6a8abe0a98dd59bc39c9f12b163072db inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29e1cdd729ac4236f8bae90b2e66fa04 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a29e1cdd729ac4236f8bae90b2e66fa04">getID</a> (self)</td></tr>
<tr class="separator:a29e1cdd729ac4236f8bae90b2e66fa04 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40157e237ea85d75ebc3fd248c7a1a1b inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a40157e237ea85d75ebc3fd248c7a1a1b">epoch_done</a> (self)</td></tr>
<tr class="separator:a40157e237ea85d75ebc3fd248c7a1a1b inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27cb8206372681605b00dc28b81a7c39 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a27cb8206372681605b00dc28b81a7c39">reset</a> (self)</td></tr>
<tr class="separator:a27cb8206372681605b00dc28b81a7c39 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaefcbd7c61d319b368b3ee13997c8c99 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#aaefcbd7c61d319b368b3ee13997c8c99">reset_metrics</a> (self)</td></tr>
<tr class="separator:aaefcbd7c61d319b368b3ee13997c8c99 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51e706e3e5389c9b48c7a1589d97ec99 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a51e706e3e5389c9b48c7a1589d97ec99">save</a> (self, path=None)</td></tr>
<tr class="separator:a51e706e3e5389c9b48c7a1589d97ec99 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2525db5bdd19a3bf5b0669bfa158f9ff inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a2525db5bdd19a3bf5b0669bfa158f9ff">clone</a> (self)</td></tr>
<tr class="separator:a2525db5bdd19a3bf5b0669bfa158f9ff inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbbb06bf0f46ff927c8b186726a68b47 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#afbbb06bf0f46ff927c8b186726a68b47">share</a> (self)</td></tr>
<tr class="separator:afbbb06bf0f46ff927c8b186726a68b47 inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a801e5ca2a5e8e96a72f0c04549008e8f inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a801e5ca2a5e8e96a72f0c04549008e8f">shutdown</a> (self)</td></tr>
<tr class="separator:a801e5ca2a5e8e96a72f0c04549008e8f inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a005f62f977e8a7ebf91b9646307153bc inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#a005f62f977e8a7ebf91b9646307153bc">upgrade_opt</a> (cls, opt_from_disk)</td></tr>
<tr class="separator:a005f62f977e8a7ebf91b9646307153bc inherit pub_methods_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:abc77ad96264e7597c46bc001a9a6af90"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#abc77ad96264e7597c46bc001a9a6af90">dictionary_class</a> ()</td></tr>
<tr class="separator:abc77ad96264e7597c46bc001a9a6af90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a91d101db75d3618e8240a44b258f3129"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a91d101db75d3618e8240a44b258f3129">replies</a></td></tr>
<tr class="separator:a91d101db75d3618e8240a44b258f3129"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa0def82ae9760fde7f60c0881b8a138"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#afa0def82ae9760fde7f60c0881b8a138">dict</a></td></tr>
<tr class="separator:afa0def82ae9760fde7f60c0881b8a138"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e938a91873bd6edde0ac7ed5299bc6a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a4e938a91873bd6edde0ac7ed5299bc6a">opt</a></td></tr>
<tr class="separator:a4e938a91873bd6edde0ac7ed5299bc6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8efd385be7532abd27359b5dbbbbb24"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#aa8efd385be7532abd27359b5dbbbbb24">use_cuda</a></td></tr>
<tr class="separator:aa8efd385be7532abd27359b5dbbbbb24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60d1038c25746d97d791b82a5c8e0492"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a60d1038c25746d97d791b82a5c8e0492">id</a></td></tr>
<tr class="separator:a60d1038c25746d97d791b82a5c8e0492"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed187f97f489122996e967206a01927"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#aaed187f97f489122996e967206a01927">EMPTY</a></td></tr>
<tr class="separator:aaed187f97f489122996e967206a01927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e6a5f2f7644a6cc273bfa25eca17df6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a6e6a5f2f7644a6cc273bfa25eca17df6">NULL_IDX</a></td></tr>
<tr class="separator:a6e6a5f2f7644a6cc273bfa25eca17df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37d6429a766547a68f72ffb6c27783db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a37d6429a766547a68f72ffb6c27783db">START_IDX</a></td></tr>
<tr class="separator:a37d6429a766547a68f72ffb6c27783db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa78932aa1b5886cd03f1592bfa6ed4f5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#aa78932aa1b5886cd03f1592bfa6ed4f5">END_IDX</a></td></tr>
<tr class="separator:aa78932aa1b5886cd03f1592bfa6ed4f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9045fdfe9f956ee5023de84dd25a06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a2f9045fdfe9f956ee5023de84dd25a06">random</a></td></tr>
<tr class="separator:a2f9045fdfe9f956ee5023de84dd25a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b5e2e435a70f40ce155dabe831d41c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a31b5e2e435a70f40ce155dabe831d41c">batch_idx</a></td></tr>
<tr class="separator:a31b5e2e435a70f40ce155dabe831d41c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add94f2eee8d2a4aba14869587e9dd4d3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#add94f2eee8d2a4aba14869587e9dd4d3">histsz</a></td></tr>
<tr class="separator:add94f2eee8d2a4aba14869587e9dd4d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a858bd7d01a3d6298f2e2f72efcf73953"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a858bd7d01a3d6298f2e2f72efcf73953">history</a></td></tr>
<tr class="separator:a858bd7d01a3d6298f2e2f72efcf73953"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac0286e4dbf6dc71bda0c364851de5f22"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#ac0286e4dbf6dc71bda0c364851de5f22">truncate</a></td></tr>
<tr class="separator:ac0286e4dbf6dc71bda0c364851de5f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab768649f4b4a30eb9a75fedde5a9935f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#ab768649f4b4a30eb9a75fedde5a9935f">rank_candidates</a></td></tr>
<tr class="separator:ab768649f4b4a30eb9a75fedde5a9935f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81f970d715f2525ad342330a28703c5c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a81f970d715f2525ad342330a28703c5c">add_person_tokens</a></td></tr>
<tr class="separator:a81f970d715f2525ad342330a28703c5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99254a4351798f66797e0a5a8ff855d5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a99254a4351798f66797e0a5a8ff855d5">clip</a></td></tr>
<tr class="separator:a99254a4351798f66797e0a5a8ff855d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2524bfb4b01626290e6fa26be52f2a80"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a2524bfb4b01626290e6fa26be52f2a80">optimizer</a></td></tr>
<tr class="separator:a2524bfb4b01626290e6fa26be52f2a80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea16ae8f9536959afd6e7434d418a719"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#aea16ae8f9536959afd6e7434d418a719">scheduler</a></td></tr>
<tr class="separator:aea16ae8f9536959afd6e7434d418a719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f1da649c485f406076be7bf84b2d4ee"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a3f1da649c485f406076be7bf84b2d4ee">proj_rp</a></td></tr>
<tr class="separator:a3f1da649c485f406076be7bf84b2d4ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04fa334c086cf9afa815a44f1948e625"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a04fa334c086cf9afa815a44f1948e625">observation</a></td></tr>
<tr class="separator:a04fa334c086cf9afa815a44f1948e625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classparlai_1_1core_1_1agents_1_1Agent')"><img src="../../closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html">parlai.core.agents.Agent</a></td></tr>
<tr class="memitem:ac00c13f4c7dd1263bf9203fa96dd2366 inherit pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#ac00c13f4c7dd1263bf9203fa96dd2366">id</a></td></tr>
<tr class="separator:ac00c13f4c7dd1263bf9203fa96dd2366 inherit pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3b45d2754244608c75d4068b90cd051 inherit pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#ab3b45d2754244608c75d4068b90cd051">opt</a></td></tr>
<tr class="separator:ab3b45d2754244608c75d4068b90cd051 inherit pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedbecc4b4aa7af7413882a0429e0f1db inherit pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d4b/classparlai_1_1core_1_1agents_1_1Agent.html#aedbecc4b4aa7af7413882a0429e0f1db">observation</a></td></tr>
<tr class="separator:aedbecc4b4aa7af7413882a0429e0f1db inherit pub_attribs_classparlai_1_1core_1_1agents_1_1Agent"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-attribs"></a>
Static Public Attributes</h2></td></tr>
<tr class="memitem:ae574bf3e21ff941060ae0f3dcb284d8d"><td class="memItemLeft" align="right" valign="top">dictionary&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#ae574bf3e21ff941060ae0f3dcb284d8d">OPTIM_OPTS</a></td></tr>
<tr class="separator:ae574bf3e21ff941060ae0f3dcb284d8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e0236052fb45181b6717922c517537"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a14e0236052fb45181b6717922c517537">P1_TOKEN</a> = '__p1__'</td></tr>
<tr class="separator:a14e0236052fb45181b6717922c517537"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d73f48f3f951684afc094495473ec5"><td class="memItemLeft" align="right" valign="top">string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../df/db3/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1TorchAgent.html#a50d73f48f3f951684afc094495473ec5">P2_TOKEN</a> = '__p2__'</td></tr>
<tr class="separator:a50d73f48f3f951684afc094495473ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">A provided base agent for any model that wants to use Torch.

Exists to make it easier to implement a new agent.
Not necessary, but reduces duplicated code.

Many methods are intended to be either used as is when the default is
acceptable, or to be overriden and called with super(), with the extra
functionality added to the initial result. See the method comment for
recommended behavior.

This agent serves as a common framework for all ParlAI models which want
to use PyTorch.
</pre><pre class="fragment">Utility mapping of simple names to optimizers.

For example:
'adagrad': optim.Adagrad, 'adam': optim.Adad, 'sgd': optim.SGD
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00111">111</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1c4eb91757ee23e75edfa957d05db338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c4eb91757ee23e75edfa957d05db338">&#9670;&nbsp;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>shared</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialize agent.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00286">286</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keyword">def </span>__init__(self, opt, shared=None):</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="stringliteral">        Initialize agent.</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        super().__init__(opt, shared)</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        opt = self.opt</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> shared:</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            <span class="comment"># intitialize any important structures from scratch</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            self.replies = {}  <span class="comment"># past replies</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            self.dict = self.dictionary_class()(opt)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;person_tokens&#39;</span>):</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                self.dict[self.P1_TOKEN] = 999999999</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                self.dict[self.P2_TOKEN] = 999999998</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="comment"># copy initialized data from shared table</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            self.opt = shared[<span class="stringliteral">&#39;opt&#39;</span>]</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;            self.dict = shared[<span class="stringliteral">&#39;dict&#39;</span>]</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            self.replies = shared[<span class="stringliteral">&#39;replies&#39;</span>]</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;numthreads&#39;</span>, 1) &gt; 1:</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;            torch.set_num_threads(1)</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="comment"># check for cuda</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        self.use_cuda = <span class="keywordflow">not</span> opt[<span class="stringliteral">&#39;no_cuda&#39;</span>] <span class="keywordflow">and</span> torch.cuda.is_available()</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;            <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;multigpu&#39;</span>] <span class="keywordflow">and</span> opt[<span class="stringliteral">&#39;gpu&#39;</span>] != -1:</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Can&#39;t use --multigpu and --gpu together.&quot;</span>)</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> shared:</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                print(<span class="stringliteral">&#39;[ Using CUDA ]&#39;</span>)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">if</span> <span class="keywordflow">not</span> shared <span class="keywordflow">and</span> opt[<span class="stringliteral">&#39;gpu&#39;</span>] != -1:</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                torch.cuda.set_device(opt[<span class="stringliteral">&#39;gpu&#39;</span>])</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;            <span class="comment"># It&#39;s up to the user of TorchAgent to handle multiple GPU issues.</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;            <span class="comment"># A typical approach would be to employ nn.DataParallel</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;            <span class="comment"># (https://pytorch.org/docs/0.4.1/nn.html?highlight=dataparallel#torch.nn.DataParallel)</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="comment"># now set up any fields that all instances may need</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        self.id = <span class="stringliteral">&#39;TorchAgent&#39;</span>  <span class="comment"># child can override</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        self.EMPTY = torch.LongTensor([])</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        self.NULL_IDX = self.dict[self.dict.null_token]</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        self.START_IDX = self.dict[self.dict.start_token]</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        self.END_IDX = self.dict[self.dict.end_token]</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        self.random = random.Random(42)  <span class="comment"># fixed random seed</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="comment"># which row in the batch this instance is</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        self.batch_idx = shared <span class="keywordflow">and</span> shared.get(<span class="stringliteral">&#39;batchindex&#39;</span>) <span class="keywordflow">or</span> 0</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="comment"># can remember as few as zero utterances if desired</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        self.histsz = opt[<span class="stringliteral">&#39;history_size&#39;</span>] <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;history_size&#39;</span>] &gt;= 0 <span class="keywordflow">else</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="comment"># stores up to hist_utt past observations within current dialog</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        self.history = deque(maxlen=self.histsz)</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="comment"># truncate == 0 might give funny behavior</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        self.truncate = opt[<span class="stringliteral">&#39;truncate&#39;</span>] <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;truncate&#39;</span>] &gt;= 0 <span class="keywordflow">else</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        self.rank_candidates = opt[<span class="stringliteral">&#39;rank_candidates&#39;</span>]</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;        self.add_person_tokens = opt.get(<span class="stringliteral">&#39;person_tokens&#39;</span>, <span class="keyword">False</span>)</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3ab251071823f34358a569c1c2a11bf9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ab251071823f34358a569c1c2a11bf9">&#9670;&nbsp;</a></span>act()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.act </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Call batch_act with the singleton batch.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l01019">1019</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keyword">def </span>act(self):</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">        Call batch_act with the singleton batch.</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;        <span class="keywordflow">return</span> self.batch_act([self.observation])[0]</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a00701a40d62943dbd887525bf8e8002d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00701a40d62943dbd887525bf8e8002d">&#9670;&nbsp;</a></span>add_cmdline_args()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.add_cmdline_args </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>argparser</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Add the default commandline args we expect most agents to want.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00151">151</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">def </span><a class="code" href="../../d3/d7d/namespaceparlai_1_1agents_1_1drqa_1_1config.html#a62fdd5554f1da6be0cba185271058320">add_cmdline_args</a>(cls, argparser):</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="stringliteral">        Add the default commandline args we expect most agents to want.</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        agent = argparser.add_argument_group(<span class="stringliteral">&#39;TorchAgent Arguments&#39;</span>)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="comment"># pretrained embedding arguments</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            <span class="stringliteral">&#39;-emb&#39;</span>,</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            <span class="stringliteral">&#39;--embedding-type&#39;</span>,</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            default=<span class="stringliteral">&#39;random&#39;</span>,</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            choices=[</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                <span class="stringliteral">&#39;random&#39;</span>,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                <span class="stringliteral">&#39;glove&#39;</span>,</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                <span class="stringliteral">&#39;glove-fixed&#39;</span>,</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                <span class="stringliteral">&#39;glove-twitter-fixed&#39;</span>,</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                <span class="stringliteral">&#39;fasttext&#39;</span>,</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                <span class="stringliteral">&#39;fasttext-fixed&#39;</span>,</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                <span class="stringliteral">&#39;fasttext_cc&#39;</span>,</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                <span class="stringliteral">&#39;fasttext_cc-fixed&#39;</span>,</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            ],</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            help=<span class="stringliteral">&#39;Choose between different strategies for initializing word &#39;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            <span class="stringliteral">&#39;embeddings. Default is random, but can also preinitialize &#39;</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="stringliteral">&#39;from Glove or Fasttext. Preinitialized embeddings can also &#39;</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            <span class="stringliteral">&#39;be fixed so they are not updated during training.&#39;</span>,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        )</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="stringliteral">&#39;-embp&#39;</span>,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            <span class="stringliteral">&#39;--embedding-projection&#39;</span>,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            default=<span class="stringliteral">&#39;random&#39;</span>,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            help=<span class="stringliteral">&#39;If pretrained embeddings have a different dimensionality &#39;</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="stringliteral">&#39;than your embedding size, strategy for projecting to the &#39;</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <span class="stringliteral">&#39;correct size. If the dimensions are the same, this is &#39;</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="stringliteral">&#39;ignored unless you append &quot;-force&quot; to your choice.&#39;</span>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        )</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="comment"># optimizer arguments</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="stringliteral">&#39;-opt&#39;</span>,</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;            <span class="stringliteral">&#39;--optimizer&#39;</span>,</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            default=<span class="stringliteral">&#39;sgd&#39;</span>,</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;            choices=cls.OPTIM_OPTS,</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            help=<span class="stringliteral">&#39;Choose between pytorch optimizers. Any member of torch.optim&#39;</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <span class="stringliteral">&#39; should be valid.&#39;</span>,</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        )</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            <span class="stringliteral">&#39;-lr&#39;</span>, <span class="stringliteral">&#39;--learningrate&#39;</span>, type=float, default=1, help=<span class="stringliteral">&#39;learning rate&#39;</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        )</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            <span class="stringliteral">&#39;-clip&#39;</span>,</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="stringliteral">&#39;--gradient-clip&#39;</span>,</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            type=float,</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            default=0.1,</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            help=<span class="stringliteral">&#39;gradient clipping using l2 norm&#39;</span>,</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        )</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            <span class="stringliteral">&#39;-mom&#39;</span>,</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="stringliteral">&#39;--momentum&#39;</span>,</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            default=0,</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            type=float,</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            help=<span class="stringliteral">&#39;if applicable, momentum value for optimizer.&#39;</span>,</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        )</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="comment"># preprocessing arguments</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;            <span class="stringliteral">&#39;-rc&#39;</span>,</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;            <span class="stringliteral">&#39;--rank-candidates&#39;</span>,</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            help=<span class="stringliteral">&#39;Whether the model should parse candidates for ranking.&#39;</span>,</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        )</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            <span class="stringliteral">&#39;-tr&#39;</span>,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;            <span class="stringliteral">&#39;--truncate&#39;</span>,</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            default=-1,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            type=int,</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            help=<span class="stringliteral">&#39;Truncate input lengths to increase speed / use less memory.&#39;</span>,</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        )</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="stringliteral">&#39;-histsz&#39;</span>,</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="stringliteral">&#39;--history-size&#39;</span>,</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            default=-1,</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;            type=int,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            help=<span class="stringliteral">&#39;Number of past dialog utterances to remember.&#39;</span>,</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        )</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="stringliteral">&#39;-pt&#39;</span>,</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="stringliteral">&#39;--person-tokens&#39;</span>,</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            help=<span class="stringliteral">&#39;add person tokens to history. adds __p1__ in front of input &#39;</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="stringliteral">&#39;text and __p2__ in front of past labels when available or &#39;</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="stringliteral">&#39;past utterances generated by the model. these are added to &#39;</span></div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="stringliteral">&#39;the dictionary during initialization.&#39;</span>,</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        )</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="stringliteral">&#39;--use-reply&#39;</span>,</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            default=<span class="stringliteral">&#39;label&#39;</span>,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;            hidden=<span class="keyword">True</span>,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            choices=[<span class="stringliteral">&#39;label&#39;</span>, <span class="stringliteral">&#39;model&#39;</span>],</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            help=<span class="stringliteral">&#39;Which previous replies to use as history. If label, use &#39;</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="stringliteral">&#39;gold dataset replies. If model, use model\&#39;s own replies.&#39;</span>,</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        )</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        agent.add_argument(</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="stringliteral">&#39;--add-p1-after-newln&#39;</span>,</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            hidden=<span class="keyword">True</span>,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;            help=<span class="stringliteral">&#39;Add the other speaker token before the last newline in the &#39;</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;            <span class="stringliteral">&#39;input instead of at the beginning of the input. this is &#39;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            <span class="stringliteral">&#39;useful for tasks that include some kind of context before &#39;</span></div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            <span class="stringliteral">&#39;the actual utterance (e.g. squad, babi, personachat).&#39;</span>,</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        )</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="comment"># GPU arguments</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment"># these gpu options are all mutually exclusive, and should error if the</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="comment"># user tries to present multiple of them</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        gpugroup = agent.add_mutually_exclusive_group()</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        gpugroup.add_argument(</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            <span class="stringliteral">&#39;-gpu&#39;</span>, <span class="stringliteral">&#39;--gpu&#39;</span>, type=int, default=-1, help=<span class="stringliteral">&#39;which GPU to use&#39;</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        )</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        gpugroup.add_argument(</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="stringliteral">&#39;--multigpu&#39;</span>,</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            type=<span class="stringliteral">&#39;bool&#39;</span>,</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            help=<span class="stringliteral">&#39;Suggest model should employ multiple GPUs. Not all models &#39;</span></div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="stringliteral">&#39;respect this flag.&#39;</span>,</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        )</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        gpugroup.add_argument(</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            <span class="stringliteral">&#39;--no-cuda&#39;</span>,</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            default=<span class="keyword">False</span>,</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            action=<span class="stringliteral">&#39;store_true&#39;</span>,</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            dest=<span class="stringliteral">&#39;no_cuda&#39;</span>,</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            help=<span class="stringliteral">&#39;disable GPUs even if available. otherwise, will use GPUs if &#39;</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="stringliteral">&#39;available on the device.&#39;</span>,</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        )</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        cls.dictionary_class().<a class="code" href="../../d3/d7d/namespaceparlai_1_1agents_1_1drqa_1_1config.html#a62fdd5554f1da6be0cba185271058320">add_cmdline_args</a>(argparser)</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1drqa_1_1config_html_a62fdd5554f1da6be0cba185271058320"><div class="ttname"><a href="../../d3/d7d/namespaceparlai_1_1agents_1_1drqa_1_1config.html#a62fdd5554f1da6be0cba185271058320">parlai.agents.drqa.config.add_cmdline_args</a></div><div class="ttdeci">def add_cmdline_args(parser)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/deb/config_8py_source.html#l00010">config.py:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af3929c1bedc50a48dcf8d1184321f4f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af3929c1bedc50a48dcf8d1184321f4f5">&#9670;&nbsp;</a></span>batch_act()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.batch_act </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observations</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Process a batch of observations (batchsize list of message dicts).

These observations have been preprocessed by the observe method.

Subclasses can override this for special functionality, but if the
default behaviors are fine then just override the ``train_step`` and
``eval_step`` methods instead. The former is called when labels are
present in the observations batch; otherwise, the latter is called.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l01025">1025</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;    <span class="keyword">def </span>batch_act(self, observations):</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral">        Process a batch of observations (batchsize list of message dicts).</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="stringliteral">        These observations have been preprocessed by the observe method.</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="stringliteral">        Subclasses can override this for special functionality, but if the</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="stringliteral">        default behaviors are fine then just override the ``train_step`` and</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="stringliteral">        ``eval_step`` methods instead. The former is called when labels are</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="stringliteral">        present in the observations batch; otherwise, the latter is called.</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;        batch_size = len(observations)</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <span class="comment"># initialize a list of replies with this agent&#39;s id</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;        batch_reply = [{<span class="stringliteral">&#39;id&#39;</span>: self.getID()} <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(batch_size)]</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;        <span class="comment"># check if there are any labels available, if so we will train on them</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        is_training = any(<span class="stringliteral">&#39;labels&#39;</span> <span class="keywordflow">in</span> obs <span class="keywordflow">for</span> obs <span class="keywordflow">in</span> observations)</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;        <span class="comment"># create a batch from the vectors</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;        batch = self.batchify(observations)</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        <span class="keywordflow">if</span> is_training:</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;            output = self.train_step(batch)</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        <span class="keywordflow">else</span>:</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;            output = self.eval_step(batch)</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;        <span class="keywordflow">if</span> output <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;            self.replies[<span class="stringliteral">&#39;batch_reply&#39;</span>] = <span class="keywordtype">None</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;            <span class="keywordflow">return</span> batch_reply</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        self.match_batch(batch_reply, batch.valid_indices, output)</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        self.replies[<span class="stringliteral">&#39;batch_reply&#39;</span>] = batch_reply</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        self._save_history(observations, batch_reply)  <span class="comment"># save model predictions</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;        <span class="keywordflow">return</span> batch_reply</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ab8b2fa26aabfd9d7e7abb0abbcfe8044"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b2fa26aabfd9d7e7abb0abbcfe8044">&#9670;&nbsp;</a></span>batchify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.batchify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs_batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>sort</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>is_valid</em> = <code>lambda&#160;obs:&#160;'text_vec'&#160;in&#160;obs&#160;or&#160;'image'&#160;in&#160;obs</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Create a batch of valid observations from an unchecked batch.

A valid observation is one that passes the lambda provided to the
function, which defaults to checking if the preprocessed 'text_vec'
field is present which would have been set by this agent's 'vectorize'
function.

Returns a namedtuple Batch. See original definition above for in-depth
explanation of each field.

If you want to include additonal fields in the batch, you can subclass
this function and return your own "Batch" namedtuple: copy the Batch
namedtuple at the top of this class, and then add whatever additional
fields that you want to be able to access. You can then call
super().batchify(...) to set up the original fields and then set up the
additional fields in your subclass and return that batch instead.

:param obs_batch: List of vectorized observations
:param sort:      Default False, orders the observations by length of
          vectors. Set to true when using
          torch.nn.utils.rnn.pack_padded_sequence.
          Uses the text vectors if available, otherwise uses
          the label vectors if available.
:param is_valid:  Function that checks if 'text_vec' is in the
          observation, determines if an observation is valid
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00693">693</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    ):</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral">        Create a batch of valid observations from an unchecked batch.</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">        A valid observation is one that passes the lambda provided to the</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">        function, which defaults to checking if the preprocessed &#39;text_vec&#39;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral">        field is present which would have been set by this agent&#39;s &#39;vectorize&#39;</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">        function.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">        Returns a namedtuple Batch. See original definition above for in-depth</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">        explanation of each field.</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">        If you want to include additonal fields in the batch, you can subclass</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">        this function and return your own &quot;Batch&quot; namedtuple: copy the Batch</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">        namedtuple at the top of this class, and then add whatever additional</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">        fields that you want to be able to access. You can then call</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral">        super().batchify(...) to set up the original fields and then set up the</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">        additional fields in your subclass and return that batch instead.</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">        :param obs_batch: List of vectorized observations</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">        :param sort:      Default False, orders the observations by length of</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral">                          vectors. Set to true when using</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">                          torch.nn.utils.rnn.pack_padded_sequence.</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">                          Uses the text vectors if available, otherwise uses</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral">                          the label vectors if available.</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral">        :param is_valid:  Function that checks if &#39;text_vec&#39; is in the</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">                          observation, determines if an observation is valid</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> len(obs_batch) == 0:</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d30/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1.html#a74cfde390a2b9861179ac0fcd59da28c">Batch</a>()</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        valid_obs = [(i, ex) <span class="keywordflow">for</span> i, ex <span class="keywordflow">in</span> enumerate(obs_batch) <span class="keywordflow">if</span> is_valid(ex)]</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">if</span> len(valid_obs) == 0:</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="../../db/d30/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1.html#a74cfde390a2b9861179ac0fcd59da28c">Batch</a>()</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        valid_inds, exs = zip(*valid_obs)</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <span class="comment"># TEXT</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;        xs, x_lens = <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="keywordflow">if</span> any(<span class="stringliteral">&#39;text_vec&#39;</span> <span class="keywordflow">in</span> ex <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs):</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            _xs = [ex.get(<span class="stringliteral">&#39;text_vec&#39;</span>, self.EMPTY) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            xs, x_lens = <a class="code" href="../../d7/d87/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1.html#adb5a414ae439f14c54e8c760b91cc4c8">padded_tensor</a>(_xs, self.NULL_IDX, self.use_cuda)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="keywordflow">if</span> sort:</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                sort = <span class="keyword">False</span>  <span class="comment"># now we won&#39;t sort on labels</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                xs, x_lens, valid_inds, exs = <a class="code" href="../../d7/d87/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1.html#a1521e559b740f741ebb47b8755202bb2">argsort</a>(</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                    x_lens, xs, x_lens, valid_inds, exs, descending=<span class="keyword">True</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                )</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="comment"># LABELS</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        labels_avail = any(<span class="stringliteral">&#39;labels_vec&#39;</span> <span class="keywordflow">in</span> ex <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs)</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;        some_labels_avail = labels_avail <span class="keywordflow">or</span> any(<span class="stringliteral">&#39;eval_labels_vec&#39;</span> <span class="keywordflow">in</span> ex <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs)</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;        ys, y_lens, labels = <span class="keywordtype">None</span>, <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        <span class="keywordflow">if</span> some_labels_avail:</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            field = <span class="stringliteral">&#39;labels&#39;</span> <span class="keywordflow">if</span> labels_avail <span class="keywordflow">else</span> <span class="stringliteral">&#39;eval_labels&#39;</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            label_vecs = [ex.get(field + <span class="stringliteral">&#39;_vec&#39;</span>, self.EMPTY) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            labels = [ex.get(field + <span class="stringliteral">&#39;_choice&#39;</span>) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            y_lens = [y.shape[0] <span class="keywordflow">for</span> y <span class="keywordflow">in</span> label_vecs]</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;            ys, y_lens = <a class="code" href="../../d7/d87/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1.html#adb5a414ae439f14c54e8c760b91cc4c8">padded_tensor</a>(label_vecs, self.NULL_IDX, self.use_cuda)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;            <span class="keywordflow">if</span> sort <span class="keywordflow">and</span> xs <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;                ys, valid_inds, label_vecs, labels, y_lens = <a class="code" href="../../d7/d87/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1.html#a1521e559b740f741ebb47b8755202bb2">argsort</a>(</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                    y_lens, ys, valid_inds, label_vecs, labels, y_lens, descending=<span class="keyword">True</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                )</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="comment"># LABEL_CANDIDATES</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        cands, cand_vecs = <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">if</span> any(<span class="stringliteral">&#39;label_candidates_vecs&#39;</span> <span class="keywordflow">in</span> ex <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs):</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            cands = [ex.get(<span class="stringliteral">&#39;label_candidates&#39;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            cand_vecs = [ex.get(<span class="stringliteral">&#39;label_candidates_vecs&#39;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;        <span class="comment"># IMAGE</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;        imgs = <span class="keywordtype">None</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;        <span class="keywordflow">if</span> any(<span class="stringliteral">&#39;image&#39;</span> <span class="keywordflow">in</span> ex <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs):</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            imgs = [ex.get(<span class="stringliteral">&#39;image&#39;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        <span class="comment"># MEMORIES</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        mems = <span class="keywordtype">None</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <span class="keywordflow">if</span> any(<span class="stringliteral">&#39;memory_vecs&#39;</span> <span class="keywordflow">in</span> ex <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs):</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            mems = [ex.get(<span class="stringliteral">&#39;memory_vecs&#39;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">for</span> ex <span class="keywordflow">in</span> exs]</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="../../db/d30/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1.html#a74cfde390a2b9861179ac0fcd59da28c">Batch</a>(</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            text_vec=xs,</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            text_lengths=x_lens,</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            label_vec=ys,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            label_lengths=y_lens,</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            labels=labels,</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            valid_indices=valid_inds,</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            candidates=cands,</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            candidate_vecs=cand_vecs,</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            image=imgs,</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;            memory_vecs=mems,</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        )</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;</div><div class="ttc" id="namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1_html_a1521e559b740f741ebb47b8755202bb2"><div class="ttname"><a href="../../d7/d87/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1.html#a1521e559b740f741ebb47b8755202bb2">parlai.agents.legacy_agents.seq2seq.utils_v1.argsort</a></div><div class="ttdeci">def argsort(keys, lists, descending=False)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd4/utils__v1_8py_source.html#l00105">utils_v1.py:105</a></div></div>
<div class="ttc" id="namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1_html_adb5a414ae439f14c54e8c760b91cc4c8"><div class="ttname"><a href="../../d7/d87/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1.html#adb5a414ae439f14c54e8c760b91cc4c8">parlai.agents.legacy_agents.seq2seq.utils_v1.padded_tensor</a></div><div class="ttdeci">def padded_tensor(items, pad_idx=0, use_cuda=False, left_padded=False, max_len=None)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dd4/utils__v1_8py_source.html#l00041">utils_v1.py:41</a></div></div>
<div class="ttc" id="namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_html_a74cfde390a2b9861179ac0fcd59da28c"><div class="ttname"><a href="../../db/d30/namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1.html#a74cfde390a2b9861179ac0fcd59da28c">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.Batch</a></div><div class="ttdeci">Batch</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/ddc/torch__agent__v1_8py_source.html#l00077">torch_agent_v1.py:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abc77ad96264e7597c46bc001a9a6af90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc77ad96264e7597c46bc001a9a6af90">&#9670;&nbsp;</a></span>dictionary_class()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.dictionary_class </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Return the dictionary class that this agent expects to use.

Can be overriden if a more complex dictionary is required.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00142">142</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">def </span>dictionary_class():</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="stringliteral">        Return the dictionary class that this agent expects to use.</span></div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="stringliteral">        Can be overriden if a more complex dictionary is required.</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> DictionaryAgent</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a801f2b9a359201fd0a395ab61fd61806"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a801f2b9a359201fd0a395ab61fd61806">&#9670;&nbsp;</a></span>eval_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.eval_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Process one batch but do not train on it.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l01067">1067</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    <span class="keyword">def </span>eval_step(self, batch):</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="stringliteral">        Process one batch but do not train on it.</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&#39;Abstract class: user must implement eval_step&#39;</span>)</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a8984452b8b4e6194625530aeae49b243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8984452b8b4e6194625530aeae49b243">&#9670;&nbsp;</a></span>get_dialog_history()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.get_dialog_history </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>reply</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_person_tokens</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_p1_after_newln</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retrieve dialog history and add current observations to it.

:param observation:        current observation
:param reply:              past utterance from the model to add to the
                   history, such as the past label or response
                   generated by the model.
:param add_person_tokens:  add tokens identifying each speaking before
                   utterances in the text &amp; history.
:param add_p1_after_newln: add the other speaker token before the last
                   newline in the input instead of at the
                   beginning of the input. this is useful for
                   tasks that include some kind of context
                   before the actual utterance (e.g. squad,
                   babi, personachat).

:return: observation with text replaced with full dialog
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00837">837</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    ):</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">        Retrieve dialog history and add current observations to it.</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral">        :param observation:        current observation</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">        :param reply:              past utterance from the model to add to the</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">                                   history, such as the past label or response</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral">                                   generated by the model.</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral">        :param add_person_tokens:  add tokens identifying each speaking before</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="stringliteral">                                   utterances in the text &amp; history.</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="stringliteral">        :param add_p1_after_newln: add the other speaker token before the last</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="stringliteral">                                   newline in the input instead of at the</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="stringliteral">                                   beginning of the input. this is useful for</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="stringliteral">                                   tasks that include some kind of context</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral">                                   before the actual utterance (e.g. squad,</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral">                                   babi, personachat).</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral">        :return: observation with text replaced with full dialog</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        obs = observation</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> reply <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            <span class="keywordflow">if</span> add_person_tokens:</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                <span class="comment"># add person2 token to reply</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                reply = self._add_person_tokens(reply, self.P2_TOKEN)</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            <span class="comment"># add reply to history</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            self.history.append(reply)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;text&#39;</span> <span class="keywordflow">in</span> obs:</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            <span class="keywordflow">if</span> add_person_tokens:</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                <span class="comment"># add person1 token to text</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                obs[<span class="stringliteral">&#39;text&#39;</span>] = self._add_person_tokens(</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                    obs[<span class="stringliteral">&#39;text&#39;</span>], self.P1_TOKEN, add_p1_after_newln</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;                )</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            <span class="comment"># add text to history</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            self.history.append(obs[<span class="stringliteral">&#39;text&#39;</span>])</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordflow">if</span> len(self.history) &gt; 0:</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;            obs[<span class="stringliteral">&#39;text&#39;</span>] = <span class="stringliteral">&#39;\n&#39;</span>.join(self.history)</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">if</span> obs.get(<span class="stringliteral">&#39;episode_done&#39;</span>, <span class="keyword">True</span>):</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;            <span class="comment"># end of this episode, clear the history</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            self.history.clear()</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordflow">return</span> obs</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a1727b17db185dcc7237d893018c7b76c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1727b17db185dcc7237d893018c7b76c">&#9670;&nbsp;</a></span>init_optim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.init_optim </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>optim_states</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>saved_optim_type</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initialize optimizer with model parameters.

:param params:       parameters from the model, for example:
             [p for p in model.parameters() if p.requires_grad]
:param optim_states: optional argument providing states of optimizer
             to load
:saved_optim_type:   type of optimizer being loaded, if changed will
             skip loading optimizer states
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00341">341</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">def </span>init_optim(self, params, optim_states=None, saved_optim_type=None):</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="stringliteral">        Initialize optimizer with model parameters.</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="stringliteral">        :param params:       parameters from the model, for example:</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="stringliteral">                             [p for p in model.parameters() if p.requires_grad]</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="stringliteral">        :param optim_states: optional argument providing states of optimizer</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="stringliteral">                             to load</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="stringliteral">        :saved_optim_type:   type of optimizer being loaded, if changed will</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="stringliteral">                             skip loading optimizer states</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        opt = self.opt</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="comment"># we only set up optimizers when training</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        self.clip = opt.get(<span class="stringliteral">&#39;gradient_clip&#39;</span>, -1)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="comment"># set up optimizer args</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="comment"># TODO: move optimizer params to command line args</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        lr = opt[<span class="stringliteral">&#39;learningrate&#39;</span>]</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        kwargs = {<span class="stringliteral">&#39;lr&#39;</span>: lr}</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">if</span> opt.get(<span class="stringliteral">&#39;momentum&#39;</span>) &gt; 0 <span class="keywordflow">and</span> opt[<span class="stringliteral">&#39;optimizer&#39;</span>] <span class="keywordflow">in</span> [<span class="stringliteral">&#39;sgd&#39;</span>, <span class="stringliteral">&#39;rmsprop&#39;</span>]:</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            kwargs[<span class="stringliteral">&#39;momentum&#39;</span>] = opt[<span class="stringliteral">&#39;momentum&#39;</span>]</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;optimizer&#39;</span>] == <span class="stringliteral">&#39;sgd&#39;</span>:</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                kwargs[<span class="stringliteral">&#39;nesterov&#39;</span>] = <span class="keyword">True</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">if</span> opt[<span class="stringliteral">&#39;optimizer&#39;</span>] == <span class="stringliteral">&#39;adam&#39;</span>:</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;            <span class="comment"># amsgrad paper: https://openreview.net/forum?id=ryQu7f-RZ</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            kwargs[<span class="stringliteral">&#39;amsgrad&#39;</span>] = <span class="keyword">True</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        optim_class = self.OPTIM_OPTS[opt[<span class="stringliteral">&#39;optimizer&#39;</span>]]</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        self.optimizer = optim_class(params, **kwargs)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">if</span> optim_states:</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> saved_optim_type != opt[<span class="stringliteral">&#39;optimizer&#39;</span>]:</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                print(<span class="stringliteral">&#39;WARNING: not loading optim state since optim class &#39;</span> <span class="stringliteral">&#39;changed.&#39;</span>)</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;            <span class="keywordflow">else</span>:</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">try</span>:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                    self.optimizer.load_state_dict(optim_states)</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                <span class="keywordflow">except</span> ValueError:</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    print(</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                        <span class="stringliteral">&#39;WARNING: not loading optim state since model &#39;</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        <span class="stringliteral">&#39;params changed.&#39;</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                    )</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keywordflow">if</span> self.use_cuda:</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                    <span class="keywordflow">for</span> state <span class="keywordflow">in</span> self.optimizer.state.values():</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                        <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> state.items():</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                            <span class="keywordflow">if</span> isinstance(v, torch.Tensor):</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                                state[k] = v.cuda()</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        <span class="comment"># TODO: Move scheduler params to command line args</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        self.scheduler = optim.lr_scheduler.ReduceLROnPlateau(</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;            self.optimizer, <span class="stringliteral">&#39;min&#39;</span>, factor=0.5, patience=3, verbose=<span class="keyword">True</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        )</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="abf7a50ea0eb319737123d2e46fde4c0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abf7a50ea0eb319737123d2e46fde4c0f">&#9670;&nbsp;</a></span>last_reply()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.last_reply </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_label</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retrieve the last reply from the model.

If available, we use the true label instead of the model's prediction.

By default, batch_act stores the batch of replies and this method
will extract the reply of the current instance from the batch.

:param use_label: default true, use the label when available instead of
          the model's generated response.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00881">881</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="keyword">def </span>last_reply(self, use_label=True):</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">        Retrieve the last reply from the model.</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral">        If available, we use the true label instead of the model&#39;s prediction.</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="stringliteral">        By default, batch_act stores the batch of replies and this method</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral">        will extract the reply of the current instance from the batch.</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">        :param use_label: default true, use the label when available instead of</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral">                          the model&#39;s generated response.</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="comment"># if the last observation was the end of an episode,</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        <span class="comment"># then we shouldn&#39;t use it as history</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        <span class="keywordflow">if</span> <span class="keywordflow">not</span> self.observation <span class="keywordflow">or</span> self.observation.get(<span class="stringliteral">&#39;episode_done&#39;</span>, <span class="keyword">True</span>):</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            <span class="keywordflow">return</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="keywordflow">if</span> use_label:</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            <span class="comment"># first look for the true label, if we aren&#39;t on a new episode</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            label_key = (</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;                <span class="stringliteral">&#39;labels&#39;</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;                <span class="keywordflow">if</span> <span class="stringliteral">&#39;labels&#39;</span> <span class="keywordflow">in</span> self.observation</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;                <span class="keywordflow">else</span> <span class="stringliteral">&#39;eval_labels&#39;</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                <span class="keywordflow">if</span> <span class="stringliteral">&#39;eval_labels&#39;</span> <span class="keywordflow">in</span> self.observation</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                <span class="keywordflow">else</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            )</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            <span class="keywordflow">if</span> label_key <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;                lbls = self.observation[label_key]</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                last_reply = lbls[0] <span class="keywordflow">if</span> len(lbls) == 1 <span class="keywordflow">else</span> self.random.choice(lbls)</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                <span class="keywordflow">return</span> last_reply</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="comment"># otherwise, we use the last reply the model generated</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        batch_reply = self.replies.get(<span class="stringliteral">&#39;batch_reply&#39;</span>)</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="keywordflow">if</span> batch_reply <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;            <span class="keywordflow">return</span> batch_reply[self.batch_idx].get(<span class="stringliteral">&#39;text&#39;</span>)</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <span class="keywordflow">return</span> <span class="keywordtype">None</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a6d71ad7997e048e4f4f7d957fae64ac5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d71ad7997e048e4f4f7d957fae64ac5">&#9670;&nbsp;</a></span>load()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.load </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Return opt and model states.

Override this method for more specific loading.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00997">997</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    <span class="keyword">def </span>load(self, path):</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral">        Return opt and model states.</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="stringliteral">        Override this method for more specific loading.</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        states = torch.load(path, map_location=<span class="keyword">lambda</span> cpu, _: cpu)</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;model&#39;</span> <span class="keywordflow">in</span> states:</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            self.model.load_state_dict(states[<span class="stringliteral">&#39;model&#39;</span>])</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;optimizer&#39;</span> <span class="keywordflow">in</span> states <span class="keywordflow">and</span> hasattr(self, <span class="stringliteral">&#39;optimizer&#39;</span>):</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;            self.optimizer.load_state_dict(states[<span class="stringliteral">&#39;optimizer&#39;</span>])</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordflow">return</span> states</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="acac419cfad0fc5988e7e796c244f3a9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acac419cfad0fc5988e7e796c244f3a9f">&#9670;&nbsp;</a></span>match_batch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.match_batch </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch_reply</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>valid_inds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>output</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Match sub-batch of predictions to the original batch indices.

Batches may be only partially filled (i.e when completing the remainder
at the end of the validation or test set), or we may want to sort by
e.g the length of the input sequences if using pack_padded_sequence.

This matches rows back with their original row in the batch for
calculating metrics like accuracy.

If output is None (model choosing not to provide any predictions), we
will just return the batch of replies.

Otherwise, output should be a parlai.core.torch_agent.Output object.
This is a namedtuple, which can provide text predictions and/or
text_candidates predictions. If you would like to map additional
fields into the batch_reply, you can override this method as well as
providing your own namedtuple with additional fields.

:param batch_reply: Full-batchsize list of message dictionaries to put
    responses into.
:param valid_inds: Original indices of the predictions.
:param output: Output namedtuple which contains sub-batchsize list of
    text outputs from model. May be None (default) if model chooses not
    to answer. This method will check for ``text`` and
    ``text_candidates`` fields.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00789">789</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keyword">def </span>match_batch(self, batch_reply, valid_inds, output=None):</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">        Match sub-batch of predictions to the original batch indices.</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="stringliteral">        Batches may be only partially filled (i.e when completing the remainder</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">        at the end of the validation or test set), or we may want to sort by</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">        e.g the length of the input sequences if using pack_padded_sequence.</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral">        This matches rows back with their original row in the batch for</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">        calculating metrics like accuracy.</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">        If output is None (model choosing not to provide any predictions), we</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">        will just return the batch of replies.</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">        Otherwise, output should be a parlai.core.torch_agent.Output object.</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral">        This is a namedtuple, which can provide text predictions and/or</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">        text_candidates predictions. If you would like to map additional</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">        fields into the batch_reply, you can override this method as well as</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral">        providing your own namedtuple with additional fields.</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral">        :param batch_reply: Full-batchsize list of message dictionaries to put</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">            responses into.</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral">        :param valid_inds: Original indices of the predictions.</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">        :param output: Output namedtuple which contains sub-batchsize list of</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral">            text outputs from model. May be None (default) if model chooses not</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">            to answer. This method will check for ``text`` and</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">            ``text_candidates`` fields.</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        <span class="keywordflow">if</span> output <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;            <span class="keywordflow">return</span> batch_reply</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">if</span> output.text <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">for</span> i, response <span class="keywordflow">in</span> zip(valid_inds, output.text):</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                batch_reply[i][<span class="stringliteral">&#39;text&#39;</span>] = response</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        <span class="keywordflow">if</span> output.text_candidates <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;            <span class="keywordflow">for</span> i, cands <span class="keywordflow">in</span> zip(valid_inds, output.text_candidates):</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;                batch_reply[i][<span class="stringliteral">&#39;text_candidates&#39;</span>] = cands</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <span class="keywordflow">return</span> batch_reply</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a0eb23a78aea413ae4f90ce0628179920"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eb23a78aea413ae4f90ce0628179920">&#9670;&nbsp;</a></span>observe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.observe </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>observation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Process incoming message in preparation for producing a response.

This includes remembering the past history of the conversation.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00955">955</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keyword">def </span>observe(self, observation):</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="stringliteral">        Process incoming message in preparation for producing a response.</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral">        This includes remembering the past history of the conversation.</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;        reply = self.last_reply(</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            use_label=(self.opt.get(<span class="stringliteral">&#39;use_reply&#39;</span>, <span class="stringliteral">&#39;label&#39;</span>) == <span class="stringliteral">&#39;label&#39;</span>)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;        )</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;        self.observation = self.get_dialog_history(</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            observation,</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;            reply=reply,</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            add_person_tokens=self.add_person_tokens,</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            add_p1_after_newln=self.opt.get(<span class="stringliteral">&#39;add_p1_after_newln&#39;</span>, <span class="keyword">False</span>),</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        )</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <span class="keywordflow">return</span> self.vectorize(self.observation, truncate=self.truncate)</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="af97699a6b03a17969830db378f09cac4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af97699a6b03a17969830db378f09cac4">&#9670;&nbsp;</a></span>receive_metrics()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.receive_metrics </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metrics_dict</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Use the metrics to decide when to adjust LR schedule.

This uses the loss as the validation metric if present, if not this function
does nothing. Note that the model must be reporting loss for this to work.
Override this to override the behavior.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00391">391</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">def </span>receive_metrics(self, metrics_dict):</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="stringliteral">        Use the metrics to decide when to adjust LR schedule.</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="stringliteral">        This uses the loss as the validation metric if present, if not this function</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="stringliteral">        does nothing. Note that the model must be reporting loss for this to work.</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="stringliteral">        Override this to override the behavior.</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <span class="keywordflow">if</span> <span class="stringliteral">&#39;loss&#39;</span> <span class="keywordflow">in</span> metrics_dict:</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            self.scheduler.step(metrics_dict[<span class="stringliteral">&#39;loss&#39;</span>])</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="ae4b2346c35e214a8028eb83d1fc5ffd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4b2346c35e214a8028eb83d1fc5ffd7">&#9670;&nbsp;</a></span>reply_history()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.reply_history </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get the model's predicted reply history within this episode.

:param batch: (default False) return the reply history for every
      row in the batch, otherwise will return just for this
      example.

:return: list of lists of strings, each of the past model replies in
 in the current episode. will be None wherever model did not
 reply.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00939">939</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keyword">def </span>reply_history(self):</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="stringliteral">        Get the model&#39;s predicted reply history within this episode.</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="stringliteral">        :param batch: (default False) return the reply history for every</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="stringliteral">                      row in the batch, otherwise will return just for this</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="stringliteral">                      example.</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="stringliteral">        :return: list of lists of strings, each of the past model replies in</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="stringliteral">                 in the current episode. will be None wherever model did not</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="stringliteral">                 reply.</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        <span class="comment"># make sure in batch order</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        preds = sorted((b, p) <span class="keywordflow">for</span> b, p <span class="keywordflow">in</span> self.replies[<span class="stringliteral">&#39;predictions&#39;</span>].items())</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;        <span class="keywordflow">return</span> [p <span class="keywordflow">for</span> b, p <span class="keywordflow">in</span> preds]</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a93e935c0d2d589d8990ff14d6e528c4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93e935c0d2d589d8990ff14d6e528c4d">&#9670;&nbsp;</a></span>reset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.reset </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Clear internal states.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l01010">1010</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;    <span class="keyword">def </span>reset(self):</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">        Clear internal states.</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        self.observation = <span class="keywordtype">None</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        self.history.clear()</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        self.replies.clear()</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;        self.reset_metrics()</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a4a01defa1d669571f574fcfe021776a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a01defa1d669571f574fcfe021776a8">&#9670;&nbsp;</a></span>save()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.save </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>path</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Save model parameters to path (or default to model_file arg).

Override this method for more specific saving.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00972">972</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    <span class="keyword">def </span>save(self, path=None):</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="stringliteral">        Save model parameters to path (or default to model_file arg).</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral">        Override this method for more specific saving.</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;        path = self.opt.get(<span class="stringliteral">&#39;model_file&#39;</span>, <span class="keywordtype">None</span>) <span class="keywordflow">if</span> path <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> path</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;        <span class="keywordflow">if</span> path:</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            states = {}</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <span class="keywordflow">if</span> hasattr(self, <span class="stringliteral">&#39;model&#39;</span>):  <span class="comment"># save model params</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;                states[<span class="stringliteral">&#39;model&#39;</span>] = self.model.state_dict()</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            <span class="keywordflow">if</span> hasattr(self, <span class="stringliteral">&#39;optimizer&#39;</span>):  <span class="comment"># save optimizer params</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;                states[<span class="stringliteral">&#39;optimizer&#39;</span>] = self.optimizer.state_dict()</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;            <span class="keywordflow">if</span> states:  <span class="comment"># anything found to save?</span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                with open(path, <span class="stringliteral">&#39;wb&#39;</span>) <span class="keyword">as</span> write:</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                    torch.save(states, write)</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                <span class="comment"># save opt file</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                with open(path + <span class="stringliteral">&#39;.opt&#39;</span>, <span class="stringliteral">&#39;w&#39;</span>) <span class="keyword">as</span> handle:</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                    <span class="keywordflow">if</span> hasattr(self, <span class="stringliteral">&#39;model_version&#39;</span>):</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                        self.opt[<span class="stringliteral">&#39;model_version&#39;</span>] = self.model_version()</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                    json.dump(self.opt, handle)</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a3d922c4a8452c9e44fa2478e6fecdfd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d922c4a8452c9e44fa2478e6fecdfd1">&#9670;&nbsp;</a></span>share()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.share </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Share fields from parent as well as useful objects in this class.

Subclasses will likely want to share their model as well.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00501">501</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="keyword">def </span>share(self):</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">        Share fields from parent as well as useful objects in this class.</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">        Subclasses will likely want to share their model as well.</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        shared = super().share()</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        shared[<span class="stringliteral">&#39;opt&#39;</span>] = self.opt</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        shared[<span class="stringliteral">&#39;dict&#39;</span>] = self.dict</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        shared[<span class="stringliteral">&#39;replies&#39;</span>] = self.replies</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="keywordflow">return</span> shared</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="aff9cc5c105bbf154075aa83e288582ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff9cc5c105bbf154075aa83e288582ca">&#9670;&nbsp;</a></span>train_step()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.train_step </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>batch</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Process one batch with training labels.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l01061">1061</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keyword">def </span>train_step(self, batch):</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">        Process one batch with training labels.</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;        <span class="keywordflow">raise</span> NotImplementedError(<span class="stringliteral">&#39;Abstract class: user must implement train_step&#39;</span>)</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<a id="a866838e1c81063a3ec18c5609e029f90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a866838e1c81063a3ec18c5609e029f90">&#9670;&nbsp;</a></span>vectorize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.vectorize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>obs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_start</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>add_end</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>truncate</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>split_lines</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Make vectors out of observation fields and store in the observation.

In particular, the 'text' and 'labels'/'eval_labels' fields are
processed and a new field is added to the observation with the suffix
'_vec'.

If you want to use additional fields on your subclass, you can override
this function, call super().vectorize(...) to process the text and
labels, and then process the other fields in your subclass.

:param obs:         Single observation from observe function.
:param add_start:   default True, adds the start token to each label.
:param add_end:     default True, adds the end token to each label.
:param truncate:    default None, if set truncates all vectors to the
            specified length. Note that this truncates to the
            rightmost for inputs and the leftmost for labels
            and, when applicable, candidates.
:param split_lines: If set, returns list of vectors instead of a single
            vector for input text, one for each substring after
            splitting on newlines.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00660">660</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>
<div class="fragment"><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    ):</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="stringliteral">&quot;&quot;&quot;</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">        Make vectors out of observation fields and store in the observation.</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">        In particular, the &#39;text&#39; and &#39;labels&#39;/&#39;eval_labels&#39; fields are</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral">        processed and a new field is added to the observation with the suffix</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral">        &#39;_vec&#39;.</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">        If you want to use additional fields on your subclass, you can override</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">        this function, call super().vectorize(...) to process the text and</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">        labels, and then process the other fields in your subclass.</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral">        :param obs:         Single observation from observe function.</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">        :param add_start:   default True, adds the start token to each label.</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">        :param add_end:     default True, adds the end token to each label.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">        :param truncate:    default None, if set truncates all vectors to the</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral">                            specified length. Note that this truncates to the</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">                            rightmost for inputs and the leftmost for labels</span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">                            and, when applicable, candidates.</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">        :param split_lines: If set, returns list of vectors instead of a single</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral">                            vector for input text, one for each substring after</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral">                            splitting on newlines.</span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">        &quot;&quot;&quot;</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        self._set_text_vec(obs, truncate, split_lines)</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        self._set_label_vec(obs, add_start, add_end, truncate)</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        self._set_label_cands_vec(obs, add_start, add_end, truncate)</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;        <span class="keywordflow">return</span> obs</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a81f970d715f2525ad342330a28703c5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81f970d715f2525ad342330a28703c5c">&#9670;&nbsp;</a></span>add_person_tokens</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.add_person_tokens</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00339">339</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a31b5e2e435a70f40ce155dabe831d41c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b5e2e435a70f40ce155dabe831d41c">&#9670;&nbsp;</a></span>batch_idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.batch_idx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00331">331</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a99254a4351798f66797e0a5a8ff855d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99254a4351798f66797e0a5a8ff855d5">&#9670;&nbsp;</a></span>clip</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.clip</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00354">354</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="afa0def82ae9760fde7f60c0881b8a138"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa0def82ae9760fde7f60c0881b8a138">&#9670;&nbsp;</a></span>dict</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.dict</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00296">296</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="aaed187f97f489122996e967206a01927"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaed187f97f489122996e967206a01927">&#9670;&nbsp;</a></span>EMPTY</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.EMPTY</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00324">324</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="aa78932aa1b5886cd03f1592bfa6ed4f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa78932aa1b5886cd03f1592bfa6ed4f5">&#9670;&nbsp;</a></span>END_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.END_IDX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00327">327</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a858bd7d01a3d6298f2e2f72efcf73953"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a858bd7d01a3d6298f2e2f72efcf73953">&#9670;&nbsp;</a></span>history</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.history</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00335">335</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="add94f2eee8d2a4aba14869587e9dd4d3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add94f2eee8d2a4aba14869587e9dd4d3">&#9670;&nbsp;</a></span>histsz</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.histsz</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00333">333</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a60d1038c25746d97d791b82a5c8e0492"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60d1038c25746d97d791b82a5c8e0492">&#9670;&nbsp;</a></span>id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00323">323</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a6e6a5f2f7644a6cc273bfa25eca17df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e6a5f2f7644a6cc273bfa25eca17df6">&#9670;&nbsp;</a></span>NULL_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.NULL_IDX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00325">325</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a04fa334c086cf9afa815a44f1948e625"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04fa334c086cf9afa815a44f1948e625">&#9670;&nbsp;</a></span>observation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.observation</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00964">964</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a4e938a91873bd6edde0ac7ed5299bc6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e938a91873bd6edde0ac7ed5299bc6a">&#9670;&nbsp;</a></span>opt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.opt</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00302">302</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="ae574bf3e21ff941060ae0f3dcb284d8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae574bf3e21ff941060ae0f3dcb284d8d">&#9670;&nbsp;</a></span>OPTIM_OPTS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">dictionary parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.OPTIM_OPTS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">=  {</div><div class="line">        k.lower(): v</div><div class="line">        <span class="keywordflow">for</span> k, v <span class="keywordflow">in</span> optim.__dict__.items()</div><div class="line">        <span class="keywordflow">if</span> <span class="keywordflow">not</span> k.startswith(<span class="stringliteral">&#39;__&#39;</span>) <span class="keywordflow">and</span> k[0].isupper()</div><div class="line">    }</div></div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00132">132</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a2524bfb4b01626290e6fa26be52f2a80"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2524bfb4b01626290e6fa26be52f2a80">&#9670;&nbsp;</a></span>optimizer</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.optimizer</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00369">369</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a14e0236052fb45181b6717922c517537"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14e0236052fb45181b6717922c517537">&#9670;&nbsp;</a></span>P1_TOKEN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.P1_TOKEN = '__p1__'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00138">138</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a50d73f48f3f951684afc094495473ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a50d73f48f3f951684afc094495473ec5">&#9670;&nbsp;</a></span>P2_TOKEN</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">string parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.P2_TOKEN = '__p2__'</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00139">139</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a3f1da649c485f406076be7bf84b2d4ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f1da649c485f406076be7bf84b2d4ee">&#9670;&nbsp;</a></span>proj_rp</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.proj_rp</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00465">465</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a2f9045fdfe9f956ee5023de84dd25a06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9045fdfe9f956ee5023de84dd25a06">&#9670;&nbsp;</a></span>random</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.random</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00329">329</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="ab768649f4b4a30eb9a75fedde5a9935f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab768649f4b4a30eb9a75fedde5a9935f">&#9670;&nbsp;</a></span>rank_candidates</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.rank_candidates</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00338">338</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a91d101db75d3618e8240a44b258f3129"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91d101db75d3618e8240a44b258f3129">&#9670;&nbsp;</a></span>replies</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.replies</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00295">295</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="aea16ae8f9536959afd6e7434d418a719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea16ae8f9536959afd6e7434d418a719">&#9670;&nbsp;</a></span>scheduler</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.scheduler</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00387">387</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="a37d6429a766547a68f72ffb6c27783db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37d6429a766547a68f72ffb6c27783db">&#9670;&nbsp;</a></span>START_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.START_IDX</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00326">326</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="ac0286e4dbf6dc71bda0c364851de5f22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac0286e4dbf6dc71bda0c364851de5f22">&#9670;&nbsp;</a></span>truncate</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.truncate</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00337">337</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<a id="aa8efd385be7532abd27359b5dbbbbb24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8efd385be7532abd27359b5dbbbbb24">&#9670;&nbsp;</a></span>use_cuda</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">parlai.agents.legacy_agents.seq2seq.torch_agent_v1.TorchAgent.use_cuda</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html#l00310">310</a> of file <a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>parlai/agents/legacy_agents/seq2seq/<a class="el" href="../../dd/ddc/torch__agent__v1_8py_source.html">torch_agent_v1.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
