\hypertarget{classlight__chats_1_1graph_1_1TellFunction}{}\section{light\+\_\+chats.\+graph.\+Tell\+Function Class Reference}
\label{classlight__chats_1_1graph_1_1TellFunction}\index{light\+\_\+chats.\+graph.\+Tell\+Function@{light\+\_\+chats.\+graph.\+Tell\+Function}}


Inheritance diagram for light\+\_\+chats.\+graph.\+Tell\+Function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{db/dac/classlight__chats_1_1graph_1_1TellFunction__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for light\+\_\+chats.\+graph.\+Tell\+Function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{db/d17/classlight__chats_1_1graph_1_1TellFunction__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_ab0442ec224b9e0a627806d5634be2926}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_a91e865e9bbba1f3ed3f01445896be21d}{func} (self, graph, args)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_ab4c8496d4fa9e03040b6090eaa65528a}{format\+\_\+observation} (self, graph, viewing\+\_\+agent, action, telling\+\_\+agent=None)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_a86e8534217b3d10cb4daf5cc080d624e}{valid\+\_\+args} (self, graph, args)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_ad70758fa554b68e7b2517704a7ab5e76}{evaluate\+\_\+constraint\+\_\+set} (self, graph, args, constraints)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_a88ac4115a6cca664cd220fb0b8852629}{parse\+\_\+text\+\_\+to\+\_\+args} (self, graph, actor\+\_\+id, text)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_a39a099e864d0d20f997c03d96d7e1df8}{get\+\_\+name} (self)
\item 
def \hyperlink{classlight__chats_1_1graph_1_1TellFunction_a1ce8fd5a8ee86a01e68e9115f8cc9108}{get\+\_\+canonical\+\_\+form} (self, graph, args)
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\begin{DoxyVerb}Output all the following arguments [Actor, Target, raw text]
\end{DoxyVerb}
 

Definition at line 525 of file graph.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_ab0442ec224b9e0a627806d5634be2926}\label{classlight__chats_1_1graph_1_1TellFunction_ab0442ec224b9e0a627806d5634be2926}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 530 of file graph.\+py.


\begin{DoxyCode}
530     \textcolor{keyword}{def }\_\_init\_\_(self):
531         super().\_\_init\_\_(
532             function\_name=\textcolor{stringliteral}{'tell'},
533             possible\_arg\_nums=[2],
534             arg\_split\_words=[],
535             arg\_find\_type=[\{\}, \{\textcolor{stringliteral}{'type'}: \textcolor{stringliteral}{'sameloc+players'}, \textcolor{stringliteral}{'from'}: 0\}],
536             arg\_constraints=[[], []],
537             func\_constraints=[],
538             callback\_triggers=[\{\textcolor{stringliteral}{'action'}: \textcolor{stringliteral}{'told'}, \textcolor{stringliteral}{'args'}: [0, 1, 2]\}],
539         )
540 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_ad70758fa554b68e7b2517704a7ab5e76}\label{classlight__chats_1_1graph_1_1TellFunction_ad70758fa554b68e7b2517704a7ab5e76}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!evaluate\+\_\+constraint\+\_\+set@{evaluate\+\_\+constraint\+\_\+set}}
\index{evaluate\+\_\+constraint\+\_\+set@{evaluate\+\_\+constraint\+\_\+set}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{evaluate\+\_\+constraint\+\_\+set()}{evaluate\_constraint\_set()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+evaluate\+\_\+constraint\+\_\+set (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{graph,  }\item[{}]{args,  }\item[{}]{constraints }\end{DoxyParamCaption})}

\begin{DoxyVerb}Can't talk to yourself, only constraint.
\end{DoxyVerb}
 

Definition at line 605 of file graph.\+py.


\begin{DoxyCode}
605     \textcolor{keyword}{def }evaluate\_constraint\_set(self, graph, args, constraints):
606         \textcolor{stringliteral}{"""}
607 \textcolor{stringliteral}{        Can't talk to yourself, only constraint.}
608 \textcolor{stringliteral}{        """}
609         \textcolor{keywordflow}{if} args[0] == args[1]:
610             \textcolor{keywordflow}{return} (
611                 \textcolor{keyword}{False},
612                 0,
613                 \{
614                     \textcolor{stringliteral}{'caller'}: \textcolor{keywordtype}{None},
615                     \textcolor{stringliteral}{'room\_id'}: self.location(args[0]),
616                     \textcolor{stringliteral}{'txt'}: \textcolor{stringliteral}{'If you talk to yourself, you might seem crazy...'},
617                 \},
618             )
619         \textcolor{keywordflow}{return} \textcolor{keyword}{True}, 0, \textcolor{keywordtype}{None}
620 
\end{DoxyCode}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_ab4c8496d4fa9e03040b6090eaa65528a}\label{classlight__chats_1_1graph_1_1TellFunction_ab4c8496d4fa9e03040b6090eaa65528a}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!format\+\_\+observation@{format\+\_\+observation}}
\index{format\+\_\+observation@{format\+\_\+observation}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{format\+\_\+observation()}{format\_observation()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+format\+\_\+observation (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{graph,  }\item[{}]{viewing\+\_\+agent,  }\item[{}]{action,  }\item[{}]{telling\+\_\+agent = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Parse the observations to recount, then return them.
\end{DoxyVerb}
 

Definition at line 561 of file graph.\+py.


\begin{DoxyCode}
561     \textcolor{keyword}{def }\hyperlink{namespacelight__chats_1_1graph_a6d359942394976812f0055affc289f56}{format\_observation}(self, graph, viewing\_agent, action, telling\_agent=None):
562         \textcolor{stringliteral}{"""}
563 \textcolor{stringliteral}{        Parse the observations to recount, then return them.}
564 \textcolor{stringliteral}{        """}
565         actor = action[\textcolor{stringliteral}{'actors'}][0]
566         target = action[\textcolor{stringliteral}{'actors'}][1]
567         content = action[\textcolor{stringliteral}{'content'}]
568         involved = \textcolor{keyword}{False}
569         \textcolor{keywordflow}{if} viewing\_agent == actor:
570             actor\_text = \textcolor{stringliteral}{'You'}
571             involved = \textcolor{keyword}{True}
572         \textcolor{keywordflow}{else}:
573             actor\_text = graph.node\_to\_desc(actor, use\_the=\textcolor{keyword}{True}).capitalize()
574         \textcolor{keywordflow}{if} viewing\_agent == target:
575             target\_text = \textcolor{stringliteral}{'you'}
576             involved = \textcolor{keyword}{True}
577         \textcolor{keywordflow}{else}:
578             target\_text = graph.node\_to\_desc(target, use\_the=\textcolor{keyword}{True})
579         \textcolor{keywordflow}{if} involved:
580             \textcolor{keywordflow}{if} content[-1] \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'.'}, \textcolor{stringliteral}{'?'}, \textcolor{stringliteral}{'!'}]:
581                 content += \textcolor{stringliteral}{'.'}
582             \textcolor{keywordflow}{return} \textcolor{stringliteral}{'\{\} told \{\} "\{\}"\(\backslash\)n'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(actor\_text, target\_text, content)
583         \textcolor{keywordflow}{return} \textcolor{stringliteral}{'\{\} whispered something to \{\}.'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(actor\_text, target\_text)
584 
\end{DoxyCode}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_a91e865e9bbba1f3ed3f01445896be21d}\label{classlight__chats_1_1graph_1_1TellFunction_a91e865e9bbba1f3ed3f01445896be21d}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!func@{func}}
\index{func@{func}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{func()}{func()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+func (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{graph,  }\item[{}]{args }\end{DoxyParamCaption})}

\begin{DoxyVerb}<Actor> sends message history to room [or specified <recipient>]
\end{DoxyVerb}
 

Definition at line 541 of file graph.\+py.


\begin{DoxyCode}
541     \textcolor{keyword}{def }func(self, graph, args):
542         \textcolor{stringliteral}{"""}
543 \textcolor{stringliteral}{        <Actor> sends message history to room [or specified <recipient>]}
544 \textcolor{stringliteral}{        """}
545         actor = args[0]
546         words = args[2]
547         room\_id = graph.location(actor)
548         agent\_ids = graph.get\_room\_agents(room\_id)
549         said\_action = \{
550             \textcolor{stringliteral}{'caller'}: self.get\_name(),
551             \textcolor{stringliteral}{'name'}: \textcolor{stringliteral}{'said'},
552             \textcolor{stringliteral}{'room\_id'}: room\_id,
553             \textcolor{stringliteral}{'actors'}: args[:2],
554             \textcolor{stringliteral}{'present\_agent\_ids'}: agent\_ids,
555             \textcolor{stringliteral}{'content'}: words,
556         \}
557         graph.broadcast\_to\_room(said\_action, exclude\_agents=[actor])
558         graph.\_last\_tell\_target[actor] = args[1]
559         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
560 
\end{DoxyCode}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_a1ce8fd5a8ee86a01e68e9115f8cc9108}\label{classlight__chats_1_1graph_1_1TellFunction_a1ce8fd5a8ee86a01e68e9115f8cc9108}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!get\+\_\+canonical\+\_\+form@{get\+\_\+canonical\+\_\+form}}
\index{get\+\_\+canonical\+\_\+form@{get\+\_\+canonical\+\_\+form}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{get\+\_\+canonical\+\_\+form()}{get\_canonical\_form()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+get\+\_\+canonical\+\_\+form (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{graph,  }\item[{}]{args }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get canonical form for the given args on this function.
\end{DoxyVerb}
 

Definition at line 663 of file graph.\+py.


\begin{DoxyCode}
663     \textcolor{keyword}{def }get\_canonical\_form(self, graph, args):
664         \textcolor{stringliteral}{"""}
665 \textcolor{stringliteral}{        Get canonical form for the given args on this function.}
666 \textcolor{stringliteral}{        """}
667         loc = graph.location(args[0])
668         target\_text = graph.node\_to\_desc\_raw(args[1], from\_id=loc)
669         \textcolor{keywordflow}{return} \textcolor{stringliteral}{'tell \{\} "\{\}"'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(target\_text, args[2])
670 
671 
\end{DoxyCode}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_a39a099e864d0d20f997c03d96d7e1df8}\label{classlight__chats_1_1graph_1_1TellFunction_a39a099e864d0d20f997c03d96d7e1df8}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!get\+\_\+name@{get\+\_\+name}}
\index{get\+\_\+name@{get\+\_\+name}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{get\+\_\+name()}{get\_name()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+get\+\_\+name (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get the canonical name of this function.
\end{DoxyVerb}
 

Definition at line 654 of file graph.\+py.


\begin{DoxyCode}
654     \textcolor{keyword}{def }get\_name(self):
655         \textcolor{stringliteral}{"""}
656 \textcolor{stringliteral}{        Get the canonical name of this function.}
657 \textcolor{stringliteral}{        """}
658         name = self.name
659         \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(name) \textcolor{keywordflow}{is} list:
660             name = name[0]
661         \textcolor{keywordflow}{return} name
662 
\end{DoxyCode}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_a88ac4115a6cca664cd220fb0b8852629}\label{classlight__chats_1_1graph_1_1TellFunction_a88ac4115a6cca664cd220fb0b8852629}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!parse\+\_\+text\+\_\+to\+\_\+args@{parse\+\_\+text\+\_\+to\+\_\+args}}
\index{parse\+\_\+text\+\_\+to\+\_\+args@{parse\+\_\+text\+\_\+to\+\_\+args}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{parse\+\_\+text\+\_\+to\+\_\+args()}{parse\_text\_to\_args()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+parse\+\_\+text\+\_\+to\+\_\+args (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{graph,  }\item[{}]{actor\+\_\+id,  }\item[{}]{text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Breaks text into function arguments based on tell target "something"
Returns:
(None, display text, None) if parsing failed to find valid candidates
(True, arg_ids, canonical_text_args) if parsing and constraints succeed
(False, Failure action, matched_args)
if parsing succeeds but constraints fail
\end{DoxyVerb}
 

Definition at line 621 of file graph.\+py.


\begin{DoxyCode}
621     \textcolor{keyword}{def }parse\_text\_to\_args(self, graph, actor\_id, text):
622         \textcolor{stringliteral}{"""Breaks text into function arguments based on tell target "something"}
623 \textcolor{stringliteral}{        Returns:}
624 \textcolor{stringliteral}{        (None, display text, None) if parsing failed to find valid candidates}
625 \textcolor{stringliteral}{        (True, arg\_ids, canonical\_text\_args) if parsing and constraints succeed}
626 \textcolor{stringliteral}{        (False, Failure action, matched\_args)}
627 \textcolor{stringliteral}{                if parsing succeeds but constraints fail}
628 \textcolor{stringliteral}{        """}
629         actor\_id = actor\_id.lower()
630         descs = [actor\_id]
631         text = \textcolor{stringliteral}{' '}.join(text)
632         text = text.lower()
633         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'"'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} text \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} text.endswith(\textcolor{stringliteral}{'"'}):
634             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{'Be sure to use quotes to speak (").'}, \textcolor{keywordtype}{None}
635         \textcolor{keywordflow}{try}:
636             target = text.split(\textcolor{stringliteral}{'"'})[0].strip()
637             content = text.split(\textcolor{stringliteral}{'"'})[1:]
638             content = \textcolor{stringliteral}{'"'}.join(content).strip(\textcolor{stringliteral}{'"'})
639             descs = [actor\_id, target]
640             valid, arg\_ids, c\_args = self.parse\_descs\_to\_args(graph, descs)
641             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} valid:
642                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"You don't know what you're talking to"}, \textcolor{keywordtype}{None}
643             arg\_ids.append(content)
644             c\_args.append(content)
645             \textcolor{keywordflow}{return} valid, arg\_ids, c\_args
646         \textcolor{keywordflow}{except} Exception:
647             \textcolor{comment}{# import sys, traceback}
648             \textcolor{comment}{# exc\_type, exc\_value, exc\_traceback = sys.exc\_info()}
649             \textcolor{comment}{# traceback.print\_tb(exc\_traceback)}
650             \textcolor{comment}{# print(repr(e))}
651             \textcolor{comment}{# TODO the above in debug mode? would be useful}
652             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}, \textcolor{stringliteral}{"You couldn't talk to that now"}, \textcolor{keywordtype}{None}
653 
\end{DoxyCode}
\mbox{\Hypertarget{classlight__chats_1_1graph_1_1TellFunction_a86e8534217b3d10cb4daf5cc080d624e}\label{classlight__chats_1_1graph_1_1TellFunction_a86e8534217b3d10cb4daf5cc080d624e}} 
\index{light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}!valid\+\_\+args@{valid\+\_\+args}}
\index{valid\+\_\+args@{valid\+\_\+args}!light\+\_\+chats\+::graph\+::\+Tell\+Function@{light\+\_\+chats\+::graph\+::\+Tell\+Function}}
\subsubsection{\texorpdfstring{valid\+\_\+args()}{valid\_args()}}
{\footnotesize\ttfamily def light\+\_\+chats.\+graph.\+Tell\+Function.\+valid\+\_\+args (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{graph,  }\item[{}]{args }\end{DoxyParamCaption})}



Definition at line 585 of file graph.\+py.


\begin{DoxyCode}
585     \textcolor{keyword}{def }valid\_args(self, graph, args):
586         args = [a.lower() \textcolor{keywordflow}{for} a \textcolor{keywordflow}{in} args]
587         loc = graph.location(args[0])
588         \textcolor{keywordflow}{try}:
589             \textcolor{comment}{# convert the arguments supplied to text form}
590             text\_args = [
591                 graph.node\_to\_desc\_raw(i, from\_id=loc).lower() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} args[:2]
592             ]
593             \textcolor{comment}{# ensure that those are valid from the parser perspective}
594             valid, args, \_args = self.parse\_descs\_to\_args(graph, text\_args)
595             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} valid:
596                 \textcolor{keywordflow}{return} \textcolor{keyword}{False}
597             \textcolor{comment}{# ensure that they pass the function constraints}
598             valid, \_cons\_passed, \_failure = self.evaluate\_constraint\_set(
599                 graph, args, self.func\_constraints
600             )
601             \textcolor{keywordflow}{return} valid
602         \textcolor{keywordflow}{except} BaseException:
603             \textcolor{keywordflow}{return} \textcolor{keyword}{False}
604 
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/mturk/tasks/light/light\+\_\+chats/\hyperlink{parlai_2mturk_2tasks_2light_2light__chats_2graph_8py}{graph.\+py}\end{DoxyCompactItemize}
