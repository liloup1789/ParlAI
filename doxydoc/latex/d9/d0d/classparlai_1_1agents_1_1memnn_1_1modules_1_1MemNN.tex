\hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN}{}\section{parlai.\+agents.\+memnn.\+modules.\+Mem\+NN Class Reference}
\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN}\index{parlai.\+agents.\+memnn.\+modules.\+Mem\+NN@{parlai.\+agents.\+memnn.\+modules.\+Mem\+NN}}


Inheritance diagram for parlai.\+agents.\+memnn.\+modules.\+Mem\+NN\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=230pt]{d3/d3a/classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+memnn.\+modules.\+Mem\+NN\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=230pt]{df/d11/classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a8bfe18ec94ebe8fc68a4147a1ebcbcb4}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+features, embedding\+\_\+size, \hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a2c29f0e03952f1a7603072a8f13d675f}{hops}=1, memsize=32, time\+\_\+features=False, position\+\_\+encoding=False, dropout=0, padding\+\_\+idx=0)
\item 
def \hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_ab4402719d43be5dba7eb6a15074c0273}{forward} (self, xs, mems, cands=None, pad\+\_\+mask=None)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a2c29f0e03952f1a7603072a8f13d675f}{hops}
\item 
\hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_aa6b47d1470856e76a31e266a049da848}{query\+\_\+lt}
\item 
\hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a5aa6b0e36ae580858341aea864a11caf}{in\+\_\+memory\+\_\+lt}
\item 
\hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a9eecf9c267fd2c15ba376a1bac3a9cc5}{out\+\_\+memory\+\_\+lt}
\item 
\hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_ac1282441a297691b0c9287db71f381ff}{answer\+\_\+embedder}
\item 
\hyperlink{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a9186fc7eb97fc4a18517928091ea7a3b}{memory\+\_\+hop}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Memory Network module.
\end{DoxyVerb}
 

Definition at line 24 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a8bfe18ec94ebe8fc68a4147a1ebcbcb4}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a8bfe18ec94ebe8fc68a4147a1ebcbcb4}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{num\+\_\+features,  }\item[{}]{embedding\+\_\+size,  }\item[{}]{hops = {\ttfamily 1},  }\item[{}]{memsize = {\ttfamily 32},  }\item[{}]{time\+\_\+features = {\ttfamily False},  }\item[{}]{position\+\_\+encoding = {\ttfamily False},  }\item[{}]{dropout = {\ttfamily 0},  }\item[{}]{padding\+\_\+idx = {\ttfamily 0} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize memnn model.

See cmdline args in MemnnAgent for description of arguments.
\end{DoxyVerb}
 

Definition at line 39 of file modules.\+py.


\begin{DoxyCode}
39     ):
40         \textcolor{stringliteral}{"""}
41 \textcolor{stringliteral}{        Initialize memnn model.}
42 \textcolor{stringliteral}{}
43 \textcolor{stringliteral}{        See cmdline args in MemnnAgent for description of arguments.}
44 \textcolor{stringliteral}{        """}
45         super().\_\_init\_\_()
46 
47         \textcolor{comment}{# prepare features}
48         self.hops = hops
49 
50         \textcolor{keyword}{def }embedding(use\_extra\_feats=True):
51             \textcolor{keywordflow}{return} Embed(
52                 num\_features,
53                 embedding\_size,
54                 position\_encoding=position\_encoding,
55                 padding\_idx=padding\_idx,
56             )
57 
58         \textcolor{comment}{# TODO: add token dropout?}
59         \textcolor{comment}{# TODO: add dropout}
60         \textcolor{comment}{# self.dropout = nn.Dropout(dropout)}
61         \textcolor{comment}{# TODO: support more weight tying options?}
62         self.query\_lt = embedding()
63         self.in\_memory\_lt = embedding()
64         self.out\_memory\_lt = embedding()
65         self.answer\_embedder = embedding()
66         self.memory\_hop = Hop(embedding\_size)
67 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_ab4402719d43be5dba7eb6a15074c0273}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_ab4402719d43be5dba7eb6a15074c0273}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!forward@{forward}}
\index{forward@{forward}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{xs,  }\item[{}]{mems,  }\item[{}]{cands = {\ttfamily None},  }\item[{}]{pad\+\_\+mask = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}One forward step.

:param xs:
    (bsz x seqlen) LongTensor queries to the model

:param mems:
    (bsz x num_mems x seqlen) LongTensor memories

:param cands:
    (num_cands x seqlen) or (bsz x num_cands x seqlen)
    LongTensor with candidates to rank
:param pad_mask:
    (bsz x num_mems) optional mask indicating which tokens
    correspond to padding

:returns:
    scores contains the model's predicted scores.
    if cand_params is None, the candidates are the vocabulary;
    otherwise, these scores are over the candidates provided.
    (bsz x num_cands)
\end{DoxyVerb}
 

Definition at line 68 of file modules.\+py.


\begin{DoxyCode}
68     \textcolor{keyword}{def }forward(self, xs, mems, cands=None, pad\_mask=None):
69         \textcolor{stringliteral}{"""}
70 \textcolor{stringliteral}{        One forward step.}
71 \textcolor{stringliteral}{}
72 \textcolor{stringliteral}{        :param xs:}
73 \textcolor{stringliteral}{            (bsz x seqlen) LongTensor queries to the model}
74 \textcolor{stringliteral}{}
75 \textcolor{stringliteral}{        :param mems:}
76 \textcolor{stringliteral}{            (bsz x num\_mems x seqlen) LongTensor memories}
77 \textcolor{stringliteral}{}
78 \textcolor{stringliteral}{        :param cands:}
79 \textcolor{stringliteral}{            (num\_cands x seqlen) or (bsz x num\_cands x seqlen)}
80 \textcolor{stringliteral}{            LongTensor with candidates to rank}
81 \textcolor{stringliteral}{        :param pad\_mask:}
82 \textcolor{stringliteral}{            (bsz x num\_mems) optional mask indicating which tokens}
83 \textcolor{stringliteral}{            correspond to padding}
84 \textcolor{stringliteral}{}
85 \textcolor{stringliteral}{        :returns:}
86 \textcolor{stringliteral}{            scores contains the model's predicted scores.}
87 \textcolor{stringliteral}{            if cand\_params is None, the candidates are the vocabulary;}
88 \textcolor{stringliteral}{            otherwise, these scores are over the candidates provided.}
89 \textcolor{stringliteral}{            (bsz x num\_cands)}
90 \textcolor{stringliteral}{        """}
91         state = self.query\_lt(xs)
92         \textcolor{keywordflow}{if} mems \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
93             \textcolor{comment}{# no memories available, `nomemnn` mode just uses query/ans embs}
94             in\_memory\_embs = self.in\_memory\_lt(mems).transpose(1, 2)
95             out\_memory\_embs = self.out\_memory\_lt(mems)
96 
97             \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(self.hops):
98                 state = self.memory\_hop(
99                     state, in\_memory\_embs, out\_memory\_embs, pad\_mask
100                 )
101 
102         \textcolor{keywordflow}{if} cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
103             \textcolor{comment}{# embed candidates}
104             cand\_embs = self.answer\_embedder(cands)
105         \textcolor{keywordflow}{else}:
106             \textcolor{comment}{# rank all possible tokens}
107             cand\_embs = self.answer\_embedder.weight
108 
109         \textcolor{keywordflow}{return} state, cand\_embs
110 
111 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_ac1282441a297691b0c9287db71f381ff}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_ac1282441a297691b0c9287db71f381ff}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!answer\+\_\+embedder@{answer\+\_\+embedder}}
\index{answer\+\_\+embedder@{answer\+\_\+embedder}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{answer\+\_\+embedder}{answer\_embedder}}
{\footnotesize\ttfamily parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+answer\+\_\+embedder}



Definition at line 65 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a2c29f0e03952f1a7603072a8f13d675f}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a2c29f0e03952f1a7603072a8f13d675f}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!hops@{hops}}
\index{hops@{hops}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{hops}{hops}}
{\footnotesize\ttfamily parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+hops}



Definition at line 48 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a5aa6b0e36ae580858341aea864a11caf}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a5aa6b0e36ae580858341aea864a11caf}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!in\+\_\+memory\+\_\+lt@{in\+\_\+memory\+\_\+lt}}
\index{in\+\_\+memory\+\_\+lt@{in\+\_\+memory\+\_\+lt}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{in\+\_\+memory\+\_\+lt}{in\_memory\_lt}}
{\footnotesize\ttfamily parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+in\+\_\+memory\+\_\+lt}



Definition at line 63 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a9186fc7eb97fc4a18517928091ea7a3b}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a9186fc7eb97fc4a18517928091ea7a3b}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!memory\+\_\+hop@{memory\+\_\+hop}}
\index{memory\+\_\+hop@{memory\+\_\+hop}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{memory\+\_\+hop}{memory\_hop}}
{\footnotesize\ttfamily parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+memory\+\_\+hop}



Definition at line 66 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a9eecf9c267fd2c15ba376a1bac3a9cc5}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_a9eecf9c267fd2c15ba376a1bac3a9cc5}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!out\+\_\+memory\+\_\+lt@{out\+\_\+memory\+\_\+lt}}
\index{out\+\_\+memory\+\_\+lt@{out\+\_\+memory\+\_\+lt}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{out\+\_\+memory\+\_\+lt}{out\_memory\_lt}}
{\footnotesize\ttfamily parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+out\+\_\+memory\+\_\+lt}



Definition at line 64 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_aa6b47d1470856e76a31e266a049da848}\label{classparlai_1_1agents_1_1memnn_1_1modules_1_1MemNN_aa6b47d1470856e76a31e266a049da848}} 
\index{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}!query\+\_\+lt@{query\+\_\+lt}}
\index{query\+\_\+lt@{query\+\_\+lt}!parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN@{parlai\+::agents\+::memnn\+::modules\+::\+Mem\+NN}}
\subsubsection{\texorpdfstring{query\+\_\+lt}{query\_lt}}
{\footnotesize\ttfamily parlai.\+agents.\+memnn.\+modules.\+Mem\+N\+N.\+query\+\_\+lt}



Definition at line 62 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/memnn/\hyperlink{parlai_2agents_2memnn_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
