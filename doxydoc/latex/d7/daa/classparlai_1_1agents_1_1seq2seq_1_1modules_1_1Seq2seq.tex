\hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq}{}\section{parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq Class Reference}
\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq}\index{parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq@{parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq}}


Inheritance diagram for parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{dc/d44/classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=235pt]{dc/d96/classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8e8ad02405bcaf384e154a0e238fc10d}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+features, embeddingsize, hiddensize, numlayers=2, dropout=0, bidirectional=False, rnn\+\_\+class=\textquotesingle{}lstm\textquotesingle{}, lookuptable=\textquotesingle{}unique\textquotesingle{}, \hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a832563fd770ab89f2ff6a9ddf025b5c0}{decoder}=\textquotesingle{}same\textquotesingle{}, numsoftmax=1, attention=\textquotesingle{}none\textquotesingle{}, attention\+\_\+length=48, attention\+\_\+time=\textquotesingle{}post\textquotesingle{}, padding\+\_\+idx=0, start\+\_\+idx=1, end\+\_\+idx=2, unknown\+\_\+idx=3, input\+\_\+dropout=0, \hyperlink{classparlai_1_1core_1_1torch__generator__agent_1_1TorchGeneratorModel_a14dcf5ba14c4438bb4919565ebd30fa8}{longest\+\_\+label}=1)
\item 
def \hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8161e20a5368471c58ec73e74ba35f48}{reorder\+\_\+encoder\+\_\+states} (self, encoder\+\_\+states, indices)
\item 
def \hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8503e583661f0d824e0aa070b3d6ff42}{reorder\+\_\+decoder\+\_\+incremental\+\_\+state} (self, incremental\+\_\+state, inds)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8337117b93156343eac3948bed19d6b0}{attn\+\_\+type}
\item 
\hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a832563fd770ab89f2ff6a9ddf025b5c0}{decoder}
\item 
\hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_add3b14b89043ce0d8154810d082b0e52}{encoder}
\item 
\hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_abccc59e50a65fe8e1b7ca9d3d29fd070}{output}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
dictionary \hyperlink{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a3962ff3f0654a2808f13d677c7192fa2}{R\+N\+N\+\_\+\+O\+P\+TS} = \{\textquotesingle{}rnn\textquotesingle{}\+: nn.\+R\+NN, \textquotesingle{}gru\textquotesingle{}\+: nn.\+G\+RU, \textquotesingle{}lstm\textquotesingle{}\+: nn.\+L\+S\+TM\}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Sequence to sequence parent module.
\end{DoxyVerb}
 

Definition at line 61 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8e8ad02405bcaf384e154a0e238fc10d}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8e8ad02405bcaf384e154a0e238fc10d}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{num\+\_\+features,  }\item[{}]{embeddingsize,  }\item[{}]{hiddensize,  }\item[{}]{numlayers = {\ttfamily 2},  }\item[{}]{dropout = {\ttfamily 0},  }\item[{}]{bidirectional = {\ttfamily False},  }\item[{}]{rnn\+\_\+class = {\ttfamily \textquotesingle{}lstm\textquotesingle{}},  }\item[{}]{lookuptable = {\ttfamily \textquotesingle{}unique\textquotesingle{}},  }\item[{}]{decoder = {\ttfamily \textquotesingle{}same\textquotesingle{}},  }\item[{}]{numsoftmax = {\ttfamily 1},  }\item[{}]{attention = {\ttfamily \textquotesingle{}none\textquotesingle{}},  }\item[{}]{attention\+\_\+length = {\ttfamily 48},  }\item[{}]{attention\+\_\+time = {\ttfamily \textquotesingle{}post\textquotesingle{}},  }\item[{}]{padding\+\_\+idx = {\ttfamily 0},  }\item[{}]{start\+\_\+idx = {\ttfamily 1},  }\item[{}]{end\+\_\+idx = {\ttfamily 2},  }\item[{}]{unknown\+\_\+idx = {\ttfamily 3},  }\item[{}]{input\+\_\+dropout = {\ttfamily 0},  }\item[{}]{longest\+\_\+label = {\ttfamily 1} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize seq2seq model.

See cmdline args in Seq2seqAgent for description of arguments.
\end{DoxyVerb}
 

Definition at line 89 of file modules.\+py.


\begin{DoxyCode}
89     ):
90         \textcolor{stringliteral}{"""}
91 \textcolor{stringliteral}{        Initialize seq2seq model.}
92 \textcolor{stringliteral}{}
93 \textcolor{stringliteral}{        See cmdline args in Seq2seqAgent for description of arguments.}
94 \textcolor{stringliteral}{        """}
95         super().\_\_init\_\_(
96             padding\_idx=padding\_idx,
97             start\_idx=start\_idx,
98             end\_idx=end\_idx,
99             unknown\_idx=unknown\_idx,
100             input\_dropout=input\_dropout,
101             longest\_label=longest\_label,
102         )
103         self.attn\_type = attention
104 
105         rnn\_class = Seq2seq.RNN\_OPTS[rnn\_class]
106         self.decoder = RNNDecoder(
107             num\_features,
108             embeddingsize,
109             hiddensize,
110             padding\_idx=padding\_idx,
111             rnn\_class=rnn\_class,
112             numlayers=numlayers,
113             dropout=dropout,
114             attn\_type=attention,
115             attn\_length=attention\_length,
116             attn\_time=attention\_time,
117             bidir\_input=bidirectional,
118         )
119 
120         shared\_lt = (
121             self.decoder.lt  \textcolor{comment}{# share embeddings between rnns}
122             \textcolor{keywordflow}{if} lookuptable \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'enc\_dec'}, \textcolor{stringliteral}{'all'})
123             \textcolor{keywordflow}{else} \textcolor{keywordtype}{None}
124         )
125         shared\_rnn = self.decoder.rnn \textcolor{keywordflow}{if} decoder == \textcolor{stringliteral}{'shared'} \textcolor{keywordflow}{else} \textcolor{keywordtype}{None}
126         self.encoder = RNNEncoder(
127             num\_features,
128             embeddingsize,
129             hiddensize,
130             padding\_idx=padding\_idx,
131             rnn\_class=rnn\_class,
132             numlayers=numlayers,
133             dropout=dropout,
134             bidirectional=bidirectional,
135             shared\_lt=shared\_lt,
136             shared\_rnn=shared\_rnn,
137             unknown\_idx=unknown\_idx,
138             input\_dropout=input\_dropout,
139         )
140 
141         shared\_weight = (
142             self.decoder.lt  \textcolor{comment}{# use embeddings for projection}
143             \textcolor{keywordflow}{if} lookuptable \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'dec\_out'}, \textcolor{stringliteral}{'all'})
144             \textcolor{keywordflow}{else} \textcolor{keywordtype}{None}
145         )
146         self.output = OutputLayer(
147             num\_features,
148             embeddingsize,
149             hiddensize,
150             dropout=dropout,
151             numsoftmax=numsoftmax,
152             shared\_weight=shared\_weight,
153             padding\_idx=padding\_idx,
154         )
155 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8503e583661f0d824e0aa070b3d6ff42}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8503e583661f0d824e0aa070b3d6ff42}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!reorder\+\_\+decoder\+\_\+incremental\+\_\+state@{reorder\+\_\+decoder\+\_\+incremental\+\_\+state}}
\index{reorder\+\_\+decoder\+\_\+incremental\+\_\+state@{reorder\+\_\+decoder\+\_\+incremental\+\_\+state}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{reorder\+\_\+decoder\+\_\+incremental\+\_\+state()}{reorder\_decoder\_incremental\_state()}}
{\footnotesize\ttfamily def parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+reorder\+\_\+decoder\+\_\+incremental\+\_\+state (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{incremental\+\_\+state,  }\item[{}]{inds }\end{DoxyParamCaption})}



Definition at line 191 of file modules.\+py.


\begin{DoxyCode}
191     \textcolor{keyword}{def }reorder\_decoder\_incremental\_state(self, incremental\_state, inds):
192         \textcolor{keywordflow}{if} torch.is\_tensor(incremental\_state):
193             \textcolor{comment}{# gru or vanilla rnn}
194             \textcolor{keywordflow}{return} torch.index\_select(incremental\_state, 0, inds).contiguous()
195         \textcolor{keywordflow}{elif} isinstance(incremental\_state, tuple):
196             \textcolor{keywordflow}{return} tuple(
197                 self.reorder\_decoder\_incremental\_state(x, inds)
198                 \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} incremental\_state
199             )
200 
201 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8161e20a5368471c58ec73e74ba35f48}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8161e20a5368471c58ec73e74ba35f48}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!reorder\+\_\+encoder\+\_\+states@{reorder\+\_\+encoder\+\_\+states}}
\index{reorder\+\_\+encoder\+\_\+states@{reorder\+\_\+encoder\+\_\+states}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{reorder\+\_\+encoder\+\_\+states()}{reorder\_encoder\_states()}}
{\footnotesize\ttfamily def parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+reorder\+\_\+encoder\+\_\+states (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{encoder\+\_\+states,  }\item[{}]{indices }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reorder encoder states according to a new set of indices.
\end{DoxyVerb}
 

Definition at line 156 of file modules.\+py.


\begin{DoxyCode}
156     \textcolor{keyword}{def }reorder\_encoder\_states(self, encoder\_states, indices):
157         \textcolor{stringliteral}{"""}
158 \textcolor{stringliteral}{        Reorder encoder states according to a new set of indices.}
159 \textcolor{stringliteral}{        """}
160         enc\_out, hidden, attn\_mask = encoder\_states
161 
162         \textcolor{comment}{# make sure we swap the hidden state around, apropos multigpu settings}
163         hidden = \_transpose\_hidden\_state(hidden)
164 
165         \textcolor{comment}{# LSTM or GRU/RNN hidden state?}
166         \textcolor{keywordflow}{if} isinstance(hidden, torch.Tensor):
167             hid, cell = hidden, \textcolor{keywordtype}{None}
168         \textcolor{keywordflow}{else}:
169             hid, cell = hidden
170 
171         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} torch.is\_tensor(indices):
172             \textcolor{comment}{# cast indices to a tensor if needed}
173             indices = torch.LongTensor(indices).to(hid.device)
174 
175         hid = hid.index\_select(1, indices)
176         \textcolor{keywordflow}{if} cell \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
177             hidden = hid
178         \textcolor{keywordflow}{else}:
179             cell = cell.index\_select(1, indices)
180             hidden = (hid, cell)
181 
182         \textcolor{keywordflow}{if} self.attn\_type != \textcolor{stringliteral}{'none'}:
183             enc\_out = enc\_out.index\_select(0, indices)
184             attn\_mask = attn\_mask.index\_select(0, indices)
185 
186         \textcolor{comment}{# and bring it back to multigpu friendliness}
187         hidden = \_transpose\_hidden\_state(hidden)
188 
189         \textcolor{keywordflow}{return} enc\_out, hidden, attn\_mask
190 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8337117b93156343eac3948bed19d6b0}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a8337117b93156343eac3948bed19d6b0}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!attn\+\_\+type@{attn\+\_\+type}}
\index{attn\+\_\+type@{attn\+\_\+type}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{attn\+\_\+type}{attn\_type}}
{\footnotesize\ttfamily parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+attn\+\_\+type}



Definition at line 103 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a832563fd770ab89f2ff6a9ddf025b5c0}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a832563fd770ab89f2ff6a9ddf025b5c0}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!decoder@{decoder}}
\index{decoder@{decoder}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{decoder}{decoder}}
{\footnotesize\ttfamily parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+decoder}



Definition at line 106 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_add3b14b89043ce0d8154810d082b0e52}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_add3b14b89043ce0d8154810d082b0e52}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!encoder@{encoder}}
\index{encoder@{encoder}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{encoder}{encoder}}
{\footnotesize\ttfamily parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+encoder}



Definition at line 126 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_abccc59e50a65fe8e1b7ca9d3d29fd070}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_abccc59e50a65fe8e1b7ca9d3d29fd070}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!output@{output}}
\index{output@{output}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{output}{output}}
{\footnotesize\ttfamily parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+output}



Definition at line 146 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a3962ff3f0654a2808f13d677c7192fa2}\label{classparlai_1_1agents_1_1seq2seq_1_1modules_1_1Seq2seq_a3962ff3f0654a2808f13d677c7192fa2}} 
\index{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}!R\+N\+N\+\_\+\+O\+P\+TS@{R\+N\+N\+\_\+\+O\+P\+TS}}
\index{R\+N\+N\+\_\+\+O\+P\+TS@{R\+N\+N\+\_\+\+O\+P\+TS}!parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq@{parlai\+::agents\+::seq2seq\+::modules\+::\+Seq2seq}}
\subsubsection{\texorpdfstring{R\+N\+N\+\_\+\+O\+P\+TS}{RNN\_OPTS}}
{\footnotesize\ttfamily dictionary parlai.\+agents.\+seq2seq.\+modules.\+Seq2seq.\+R\+N\+N\+\_\+\+O\+P\+TS = \{\textquotesingle{}rnn\textquotesingle{}\+: nn.\+R\+NN, \textquotesingle{}gru\textquotesingle{}\+: nn.\+G\+RU, \textquotesingle{}lstm\textquotesingle{}\+: nn.\+L\+S\+TM\}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 66 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/seq2seq/\hyperlink{parlai_2agents_2seq2seq_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
