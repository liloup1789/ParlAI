\hypertarget{namespaceparlai_1_1core_1_1loader}{}\section{parlai.\+core.\+loader Namespace Reference}
\label{namespaceparlai_1_1core_1_1loader}\index{parlai.\+core.\+loader@{parlai.\+core.\+loader}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1loader_a8e6a8f524cba24b80e9bd157c2e0ab8b}{load\+\_\+agent\+\_\+module}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1loader_a7ae3c6abd5c669634eb8940902735fc4}{load\+\_\+task\+\_\+module}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1loader_a9eed9fa0f15170da9d4de24c2c3d4e2a}{load\+\_\+teacher\+\_\+module}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1loader_adb9c272f49c31c45dcbc61d8e8c6316d}{load\+\_\+world\+\_\+module}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1loader_a8e6a8f524cba24b80e9bd157c2e0ab8b}\label{namespaceparlai_1_1core_1_1loader_a8e6a8f524cba24b80e9bd157c2e0ab8b}} 
\index{parlai\+::core\+::loader@{parlai\+::core\+::loader}!load\+\_\+agent\+\_\+module@{load\+\_\+agent\+\_\+module}}
\index{load\+\_\+agent\+\_\+module@{load\+\_\+agent\+\_\+module}!parlai\+::core\+::loader@{parlai\+::core\+::loader}}
\subsubsection{\texorpdfstring{load\+\_\+agent\+\_\+module()}{load\_agent\_module()}}
{\footnotesize\ttfamily def parlai.\+core.\+loader.\+load\+\_\+agent\+\_\+module (\begin{DoxyParamCaption}\item[{}]{agent\+\_\+path }\end{DoxyParamCaption})}



Definition at line 43 of file loader.\+py.


\begin{DoxyCode}
43 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1loader_a8e6a8f524cba24b80e9bd157c2e0ab8b}{load\_agent\_module}(agent\_path: str):
44     \textcolor{stringliteral}{"""}
45 \textcolor{stringliteral}{    Return the module for an agent specified by ``--model``.}
46 \textcolor{stringliteral}{}
47 \textcolor{stringliteral}{    Can be formatted in several different ways:}
48 \textcolor{stringliteral}{}
49 \textcolor{stringliteral}{    * full: `-m parlai.agents.seq2seq.seq2seq:Seq2seqAgent`}
50 \textcolor{stringliteral}{    * shorthand: -m seq2seq, which will check both paths}
51 \textcolor{stringliteral}{      ``parlai.agents.seq2seq.seq2seq:Seq2seqAgent`` and}
52 \textcolor{stringliteral}{      ``parlai.agents.seq2seq.agents:Seq2seqAgent``}
53 \textcolor{stringliteral}{    * half-shorthand: ``-m seq2seq/variant``, which will check the path}
54 \textcolor{stringliteral}{      `parlai.agents.seq2seq.variant:VariantAgent`}
55 \textcolor{stringliteral}{    * legacy models: ``-m legacy:seq2seq:0``, which will look for the deprecated}
56 \textcolor{stringliteral}{      model at ``parlai.agents.legacy\_agents.seq2seq.seq2seq\_v0:Seq2seqAgent``}
57 \textcolor{stringliteral}{}
58 \textcolor{stringliteral}{    The base path to search when using shorthand formats can be changed from}
59 \textcolor{stringliteral}{    "parlai" to "parlai\_internal" by prepending "internal:" to the path, e.g.}
60 \textcolor{stringliteral}{    "internal:seq2seq".}
61 \textcolor{stringliteral}{}
62 \textcolor{stringliteral}{    To use legacy agent versions, you can prepend "legacy:" to model arguments,}
63 \textcolor{stringliteral}{    e.g. "legacy:seq2seq:0" will translate to ``legacy\_agents/seq2seq/seq2seq\_v0``.}
64 \textcolor{stringliteral}{}
65 \textcolor{stringliteral}{    To use agents in projects, you can prepend "projects:" and the name of the}
66 \textcolor{stringliteral}{    project folder to model arguments, e.g. "projects:personachat:kvmemnn"}
67 \textcolor{stringliteral}{    will translate to ``projects/personachat/kvmemnn``.}
68 \textcolor{stringliteral}{}
69 \textcolor{stringliteral}{    :param agent\_path:}
70 \textcolor{stringliteral}{        path to model class in one of the above formats.}
71 \textcolor{stringliteral}{}
72 \textcolor{stringliteral}{    :return:}
73 \textcolor{stringliteral}{        module of agent}
74 \textcolor{stringliteral}{    """}
75     repo = \textcolor{stringliteral}{'parlai'}
76     \textcolor{keywordflow}{if} agent\_path.startswith(\textcolor{stringliteral}{'internal:'}):
77         \textcolor{comment}{# To switch to local repo, useful for non-public projects}
78         \textcolor{comment}{# (make a directory called 'parlai\_internal' with your private agents)}
79         \textcolor{comment}{# this will follow the same paths but look in parlai\_internal instead}
80         repo = \textcolor{stringliteral}{'parlai\_internal'}
81         agent\_path = agent\_path[9:]
82 
83     \textcolor{keywordflow}{if} agent\_path.startswith(\textcolor{stringliteral}{'legacy:'}):
84         \textcolor{comment}{# e.g. -m legacy:seq2seq:0}
85         \textcolor{comment}{# will check legacy\_agents.seq2seq.seq2seq\_v0:Seq2seqAgent}
86         path\_list = agent\_path.split(\textcolor{stringliteral}{':'})
87         \textcolor{keywordflow}{if} len(path\_list) != 3:
88             \textcolor{keywordflow}{raise} RuntimeError(
89                 \textcolor{stringliteral}{'legacy paths should follow pattern '}
90                 \textcolor{stringliteral}{'legacy:model:version; you used \{\}'}
91                 \textcolor{stringliteral}{''}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(agent\_path)
92             )
93         model\_name = path\_list[1]  \textcolor{comment}{# seq2seq}
94         module\_name = \textcolor{stringliteral}{'parlai.agents.legacy\_agents.\{m\}.\{m\}\_v\{v\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
95             m=model\_name, v=path\_list[2]
96         )
97         class\_name = \_name\_to\_agent\_class(model\_name)
98     \textcolor{keywordflow}{elif} agent\_path.startswith(\textcolor{stringliteral}{'projects:'}):
99         \textcolor{comment}{# e.g. -m projects:personachat:kvmemnn}
100         path\_list = agent\_path.split(\textcolor{stringliteral}{':'})
101         \textcolor{keywordflow}{if} len(path\_list) != 3:
102             \textcolor{keywordflow}{raise} RuntimeError(
103                 \textcolor{stringliteral}{'projects paths should follow pattern '}
104                 \textcolor{stringliteral}{'projects:folder:model; you used \{\}'}
105                 \textcolor{stringliteral}{''}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(agent\_path)
106             )
107         folder\_name = path\_list[1]
108         model\_name = path\_list[2]
109         module\_name = \textcolor{stringliteral}{'projects.\{p\}.\{m\}.\{m\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(m=model\_name, p=folder\_name)
110         class\_name = \_name\_to\_agent\_class(model\_name)
111     \textcolor{keywordflow}{elif} \textcolor{stringliteral}{':'} \textcolor{keywordflow}{in} agent\_path:
112         \textcolor{comment}{# e.g. -m "parlai.agents.seq2seq.seq2seq:Seq2seqAgent"}
113         path\_list = agent\_path.split(\textcolor{stringliteral}{':'})
114         module\_name = path\_list[0]
115         class\_name = path\_list[1]
116     \textcolor{keywordflow}{elif} \textcolor{stringliteral}{'/'} \textcolor{keywordflow}{in} agent\_path:
117         \textcolor{comment}{# e.g. -m my\_agent/special\_variant}
118         \textcolor{comment}{# will check parlai.agents.my\_agent.special\_variant:SpecialVariantAgent}
119         path\_list = agent\_path.split(\textcolor{stringliteral}{'/'})
120         module\_name = \textcolor{stringliteral}{"%s.agents.%s.%s"} % (repo, path\_list[0], path\_list[1])
121         class\_name = \_name\_to\_agent\_class(path\_list[1])
122     \textcolor{keywordflow}{else}:
123         \textcolor{comment}{# e.g. -m seq2seq}
124         \textcolor{comment}{# will check parlai.agents.seq2seq.agents for Seq2seqAgent first}
125         \textcolor{comment}{# then check parlai.agents.seq2seq.seq2seq for Seq2seqAgent second}
126         class\_name = \_name\_to\_agent\_class(agent\_path)
127         \textcolor{keywordflow}{try}:
128             module\_name = \textcolor{stringliteral}{"%s.agents.%s.agents"} % (repo, agent\_path)
129             importlib.import\_module(module\_name)  \textcolor{comment}{# check if it's there}
130         \textcolor{keywordflow}{except} ImportError:
131             module\_name = \textcolor{stringliteral}{"%s.agents.%s.%s"} % (repo, agent\_path, agent\_path)
132 
133     my\_module = importlib.import\_module(module\_name)
134     model\_class = getattr(my\_module, class\_name)
135 
136     \textcolor{keywordflow}{return} model\_class
137 
138 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1loader_a7ae3c6abd5c669634eb8940902735fc4}\label{namespaceparlai_1_1core_1_1loader_a7ae3c6abd5c669634eb8940902735fc4}} 
\index{parlai\+::core\+::loader@{parlai\+::core\+::loader}!load\+\_\+task\+\_\+module@{load\+\_\+task\+\_\+module}}
\index{load\+\_\+task\+\_\+module@{load\+\_\+task\+\_\+module}!parlai\+::core\+::loader@{parlai\+::core\+::loader}}
\subsubsection{\texorpdfstring{load\+\_\+task\+\_\+module()}{load\_task\_module()}}
{\footnotesize\ttfamily def parlai.\+core.\+loader.\+load\+\_\+task\+\_\+module (\begin{DoxyParamCaption}\item[{}]{taskname }\end{DoxyParamCaption})}



Definition at line 162 of file loader.\+py.


\begin{DoxyCode}
162 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1loader_a7ae3c6abd5c669634eb8940902735fc4}{load\_task\_module}(taskname: str):
163     \textcolor{stringliteral}{"""}
164 \textcolor{stringliteral}{    Get the module containing all teacher agents for the task specified by `--task`.}
165 \textcolor{stringliteral}{}
166 \textcolor{stringliteral}{    :param taskname: path to task class in one of the following formats:}
167 \textcolor{stringliteral}{        * full: ``-t parlai.tasks.babi.agents:DefaultTeacher``}
168 \textcolor{stringliteral}{        * shorthand: ``-t babi``, which will check}
169 \textcolor{stringliteral}{            ``parlai.tasks.babi.agents:DefaultTeacher``}
170 \textcolor{stringliteral}{        * shorthand specific: ``-t babi:task10k``, which will check}
171 \textcolor{stringliteral}{            ``parlai.tasks.babi.agents:Task10kTeacher``}
172 \textcolor{stringliteral}{}
173 \textcolor{stringliteral}{    :return:}
174 \textcolor{stringliteral}{        module containing all teacher agents for a task}
175 \textcolor{stringliteral}{    """}
176     task\_path\_list, repo = \_get\_task\_path\_and\_repo(taskname)
177     task\_path = task\_path\_list[0]
178 
179     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'.'} \textcolor{keywordflow}{in} task\_path:
180         module\_name = task\_path
181     \textcolor{keywordflow}{elif} task\_path == \textcolor{stringliteral}{'pytorch\_teacher'}:
182         module\_name = \textcolor{stringliteral}{'parlai.core.pytorch\_data\_teacher'}
183     \textcolor{keywordflow}{else}:
184         task = task\_path.lower()
185         module\_name = \textcolor{stringliteral}{"%s.tasks.%s.agents"} % (repo, task)
186 
187     task\_module = importlib.import\_module(module\_name)
188 
189     \textcolor{keywordflow}{return} task\_module
190 
191 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1loader_a9eed9fa0f15170da9d4de24c2c3d4e2a}\label{namespaceparlai_1_1core_1_1loader_a9eed9fa0f15170da9d4de24c2c3d4e2a}} 
\index{parlai\+::core\+::loader@{parlai\+::core\+::loader}!load\+\_\+teacher\+\_\+module@{load\+\_\+teacher\+\_\+module}}
\index{load\+\_\+teacher\+\_\+module@{load\+\_\+teacher\+\_\+module}!parlai\+::core\+::loader@{parlai\+::core\+::loader}}
\subsubsection{\texorpdfstring{load\+\_\+teacher\+\_\+module()}{load\_teacher\_module()}}
{\footnotesize\ttfamily def parlai.\+core.\+loader.\+load\+\_\+teacher\+\_\+module (\begin{DoxyParamCaption}\item[{}]{taskname }\end{DoxyParamCaption})}



Definition at line 192 of file loader.\+py.


\begin{DoxyCode}
192 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1loader_a9eed9fa0f15170da9d4de24c2c3d4e2a}{load\_teacher\_module}(taskname: str):
193     \textcolor{stringliteral}{"""}
194 \textcolor{stringliteral}{    Get the module of the teacher agent specified by `--task`.}
195 \textcolor{stringliteral}{}
196 \textcolor{stringliteral}{    Can be formatted in several different ways:}
197 \textcolor{stringliteral}{}
198 \textcolor{stringliteral}{    * full: ``-t parlai.tasks.babi.agents:DefaultTeacher``}
199 \textcolor{stringliteral}{    * shorthand: ``-t babi``, which will check}
200 \textcolor{stringliteral}{        ``parlai.tasks.babi.agents:DefaultTeacher``}
201 \textcolor{stringliteral}{    * shorthand specific: ``-t babi:task10k``, which will check}
202 \textcolor{stringliteral}{        ``parlai.tasks.babi.agents:Task10kTeacher``}
203 \textcolor{stringliteral}{}
204 \textcolor{stringliteral}{    The base path to search when using shorthand formats can be changed from}
205 \textcolor{stringliteral}{    "parlai" to "parlai\_internal" by prepending "internal:" to the path, e.g.}
206 \textcolor{stringliteral}{    "internal:babi".}
207 \textcolor{stringliteral}{}
208 \textcolor{stringliteral}{    Options can be sent to the teacher by adding an additional colon,}
209 \textcolor{stringliteral}{    for example ``-t babi:task10k:1`` directs the babi Task10kTeacher to use}
210 \textcolor{stringliteral}{    task number 1.}
211 \textcolor{stringliteral}{}
212 \textcolor{stringliteral}{    :param taskname: path to task class in one of the above formats.}
213 \textcolor{stringliteral}{}
214 \textcolor{stringliteral}{    :return:}
215 \textcolor{stringliteral}{        teacher module}
216 \textcolor{stringliteral}{    """}
217     task\_module = \hyperlink{namespaceparlai_1_1core_1_1loader_a7ae3c6abd5c669634eb8940902735fc4}{load\_task\_module}(taskname)
218     task\_path\_list, repo = \_get\_task\_path\_and\_repo(taskname)
219 
220     \textcolor{keywordflow}{if} len(task\_path\_list) > 1 \textcolor{keywordflow}{and} \textcolor{stringliteral}{'='} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} task\_path\_list[1]:
221         task\_path\_list[1] = task\_path\_list[1][0].upper() + task\_path\_list[1][1:]
222         teacher = task\_path\_list[1]
223         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'.'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} task\_path\_list[0] \textcolor{keywordflow}{and} \textcolor{stringliteral}{'Teacher'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} teacher:
224             \textcolor{comment}{# Reformat from underscore to CamelCase and append "Teacher" to}
225             \textcolor{comment}{# class name by default if a complete path is not given.}
226             words = teacher.split(\textcolor{stringliteral}{'\_'})
227             teacher\_name = \textcolor{stringliteral}{''}
228             \textcolor{keywordflow}{for} w \textcolor{keywordflow}{in} words:
229                 teacher\_name += w[0].upper() + w[1:]
230             teacher = teacher\_name + \textcolor{stringliteral}{"Teacher"}
231     \textcolor{keywordflow}{else}:
232         teacher = \textcolor{stringliteral}{"DefaultTeacher"}
233 
234     teacher\_class = getattr(task\_module, teacher)
235     \textcolor{keywordflow}{return} teacher\_class
236 
237 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1loader_adb9c272f49c31c45dcbc61d8e8c6316d}\label{namespaceparlai_1_1core_1_1loader_adb9c272f49c31c45dcbc61d8e8c6316d}} 
\index{parlai\+::core\+::loader@{parlai\+::core\+::loader}!load\+\_\+world\+\_\+module@{load\+\_\+world\+\_\+module}}
\index{load\+\_\+world\+\_\+module@{load\+\_\+world\+\_\+module}!parlai\+::core\+::loader@{parlai\+::core\+::loader}}
\subsubsection{\texorpdfstring{load\+\_\+world\+\_\+module()}{load\_world\_module()}}
{\footnotesize\ttfamily def parlai.\+core.\+loader.\+load\+\_\+world\+\_\+module (\begin{DoxyParamCaption}\item[{}]{taskname }\end{DoxyParamCaption})}



Definition at line 270 of file loader.\+py.


\begin{DoxyCode}
270     taskname: str,
271     interactive\_task: bool = \textcolor{keyword}{False},
272     num\_agents: int = \textcolor{keywordtype}{None},  \textcolor{comment}{# a priori may not know the number of agents}
273     default\_world=\textcolor{keywordtype}{None},
274 ):
275     \textcolor{stringliteral}{"""}
276 \textcolor{stringliteral}{    Load the world module for the specific environment. If not enough information is to}
277 \textcolor{stringliteral}{    determine which world should be loaded, returns None.}
278 \textcolor{stringliteral}{}
279 \textcolor{stringliteral}{    :param taskname:}
280 \textcolor{stringliteral}{        path to task class in one of the above formats}
281 \textcolor{stringliteral}{    :param interactive\_task:}
282 \textcolor{stringliteral}{        whether or not the task is interactive}
283 \textcolor{stringliteral}{    :param num\_agents:}
284 \textcolor{stringliteral}{        number of agents in the world; this may not be known a priori}
285 \textcolor{stringliteral}{    :param default\_world:}
286 \textcolor{stringliteral}{        default world to return if specified}
287 \textcolor{stringliteral}{}
288 \textcolor{stringliteral}{    :return:}
289 \textcolor{stringliteral}{        World module (or None, if not enough info to determine is present)}
290 \textcolor{stringliteral}{    """}
291     task = taskname.strip()
292     repo = \textcolor{stringliteral}{'parlai'}
293     \textcolor{keywordflow}{if} task.startswith(\textcolor{stringliteral}{'internal:'}):
294         \textcolor{comment}{# To switch to local repo, useful for non-public projects}
295         \textcolor{comment}{# (make a directory called 'parlai\_internal' with your private agents)}
296         repo = \textcolor{stringliteral}{'parlai\_internal'}
297         task = task[9:]
298     task\_path\_list = task.split(\textcolor{stringliteral}{':'})
299     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'.'} \textcolor{keywordflow}{in} task\_path\_list[0]:
300         \textcolor{comment}{# The case of opt['task'] = 'parlai.tasks.squad.agents:DefaultTeacher'}
301         \textcolor{comment}{# (i.e. specifying your own path directly, assumes DialogPartnerWorld)}
302         \textcolor{keywordflow}{return} \_get\_default\_world(default\_world, num\_agents)
303 
304     task = task\_path\_list[0].lower()
305     \textcolor{keywordflow}{if} len(task\_path\_list) > 1:
306         task\_path\_list[1] = task\_path\_list[1][0].upper() + task\_path\_list[1][1:]
307         world\_name = task\_path\_list[1] + \textcolor{stringliteral}{"World"}
308         \textcolor{keywordflow}{if} interactive\_task:
309             world\_name = \textcolor{stringliteral}{"Interactive"} + world\_name
310     \textcolor{keywordflow}{else}:
311         \textcolor{keywordflow}{if} interactive\_task:
312             world\_name = \textcolor{stringliteral}{"InteractiveWorld"}
313         \textcolor{keywordflow}{else}:
314             world\_name = \textcolor{stringliteral}{"DefaultWorld"}
315     module\_name = \textcolor{stringliteral}{"%s.tasks.%s.worlds"} % (repo, task)
316 
317     \textcolor{keywordflow}{try}:
318         my\_module = importlib.import\_module(module\_name)
319         world\_class = getattr(my\_module, world\_name)
320     \textcolor{keywordflow}{except} (ModuleNotFoundError, AttributeError):
321         \textcolor{comment}{# Defaults to this if you did not specify a world for your task.}
322         world\_class = \_get\_default\_world(default\_world, num\_agents)
323 
324     \textcolor{keywordflow}{return} world\_class
325 \end{DoxyCode}
