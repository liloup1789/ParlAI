\hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop}{}\section{projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop Class Reference}
\label{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop}\index{projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop@{projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop}}


Inheritance diagram for projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=299pt]{d3/d67/classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=299pt]{d4/dae/classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a389f38122323e5f5f74241656a0df48a}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a8fb50dd7d635522ebe5b2d36f6d4bc48}{embedding\+\_\+size})
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a49bc88135a02e336541fba3798321df8}{forward} (self, query\+\_\+embeddings, in\+\_\+memory\+\_\+embeddings, out\+\_\+memory\+\_\+embeddings, attention\+\_\+mask=None)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a8fb50dd7d635522ebe5b2d36f6d4bc48}{embedding\+\_\+size}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a373c95e927a46152f811742f2653030f}{linear}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 229 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a389f38122323e5f5f74241656a0df48a}\label{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a389f38122323e5f5f74241656a0df48a}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{embedding\+\_\+size }\end{DoxyParamCaption})}



Definition at line 230 of file modules.\+py.


\begin{DoxyCode}
230     \textcolor{keyword}{def }\_\_init\_\_(self, embedding\_size):
231         super(Hop, self).\_\_init\_\_()
232         self.embedding\_size = embedding\_size
233         self.linear = nn.Linear(embedding\_size, embedding\_size, bias=\textcolor{keyword}{False})
234 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a49bc88135a02e336541fba3798321df8}\label{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a49bc88135a02e336541fba3798321df8}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}!forward@{forward}}
\index{forward@{forward}!projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{query\+\_\+embeddings,  }\item[{}]{in\+\_\+memory\+\_\+embeddings,  }\item[{}]{out\+\_\+memory\+\_\+embeddings,  }\item[{}]{attention\+\_\+mask = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 241 of file modules.\+py.


\begin{DoxyCode}
241     ):
242         attention = torch.bmm(
243             in\_memory\_embeddings, query\_embeddings.unsqueeze(2)
244         ).squeeze(2)
245         \textcolor{keywordflow}{if} attention\_mask \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
246             \textcolor{comment}{# exclude masked elements from the softmax}
247             attention = (
248                 attention\_mask.float() * attention
249                 + (1 - attention\_mask.float()) * -1e20
250             )
251         probs = softmax(attention).unsqueeze(1)
252         memory\_output = torch.bmm(probs, out\_memory\_embeddings).squeeze(1)
253         query\_embeddings = self.linear(query\_embeddings)
254         output = memory\_output + query\_embeddings
255         \textcolor{keywordflow}{return} output
256 
257 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a8fb50dd7d635522ebe5b2d36f6d4bc48}\label{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a8fb50dd7d635522ebe5b2d36f6d4bc48}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}!embedding\+\_\+size@{embedding\+\_\+size}}
\index{embedding\+\_\+size@{embedding\+\_\+size}!projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}}
\subsubsection{\texorpdfstring{embedding\+\_\+size}{embedding\_size}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop.\+embedding\+\_\+size}



Definition at line 232 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a373c95e927a46152f811742f2653030f}\label{classprojects_1_1memnn__feedback_1_1agent_1_1modules_1_1Hop_a373c95e927a46152f811742f2653030f}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}!linear@{linear}}
\index{linear@{linear}!projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop@{projects\+::memnn\+\_\+feedback\+::agent\+::modules\+::\+Hop}}
\subsubsection{\texorpdfstring{linear}{linear}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+modules.\+Hop.\+linear}



Definition at line 233 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/memnn\+\_\+feedback/agent/\hyperlink{projects_2memnn__feedback_2agent_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
