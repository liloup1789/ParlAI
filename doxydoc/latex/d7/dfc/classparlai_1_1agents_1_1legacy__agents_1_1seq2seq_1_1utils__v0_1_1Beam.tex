\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam}\index{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam@{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=192pt]{de/de5/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=192pt]{d2/df7/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a0b15ba633165fe8ae84f7664dc893b99}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa23d688e6e9c2d6ced98d57ac1a7059c}{beam\+\_\+size}, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7d6ef73f817ea0cddaaa2857f5fab206}{min\+\_\+length}=3, padding\+\_\+token=0, bos\+\_\+token=1, eos\+\_\+token=2, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7709dc9d035f249283776d08ca4d93c8}{min\+\_\+n\+\_\+best}=3, cuda=\textquotesingle{}cpu\textquotesingle{})
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a76fadcbf18352eb7f2d741e9b04e0a6a}{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6deaa656e21fd41fafd2958a97ebea18}{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ad45cf956539e1b9cdb38e6ebb2514843}{advance} (self, softmax\+\_\+probs)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ac37b26314438d9e94b03e5a45efaf5dd}{done} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abbb522afdc69dbce77f997dd392c5c1d}{get\+\_\+top\+\_\+hyp} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2df9b1e26c3f35c7149e4d7ae75c2f03}{get\+\_\+hyp\+\_\+from\+\_\+finished} (self, hypothesis\+\_\+tail)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a9e16b7ec90640b527d75642fe93c6417}{get\+\_\+pretty\+\_\+hypothesis} (self, list\+\_\+of\+\_\+hypotails)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a3c573eb1104002cb7da1483a6afb3cfe}{get\+\_\+rescored\+\_\+finished} (self, n\+\_\+best=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abea53933203e2126e38657efe715b8b5}{check\+\_\+finished} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a0f15f5dc35437659d1ab17d4508d3abe}{get\+\_\+beam\+\_\+dot} (self, dictionary=None, n\+\_\+best=None)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa23d688e6e9c2d6ced98d57ac1a7059c}{beam\+\_\+size}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7d6ef73f817ea0cddaaa2857f5fab206}{min\+\_\+length}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a821bdac1bbdef3faa186729b7b361da8}{eos}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abae3db8ae23e5e334edceeeaf6bd4517}{bos}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2b566884e7d177fcbcdcad1547dcf070}{pad}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a5bc1b513284975d51d9ec9554fa29f94}{device}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6f0cb3d9a944a1c1bab850834d81b798}{scores}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ae8e9fc9a712aef34dc78d40faf089d79}{all\+\_\+scores}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a660602181552d0ef501cb99b68d790f3}{bookkeep}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6383bb09ede1b1c681c0eb1ac0bd15f8}{outputs}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a3761685a56c34b82ab6533814b869851}{finished}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa6b1326a200ef63b4b19fbbffc82a14c}{Hypothesis\+Tail}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a707079827f1a9da806ebe4f9c8c1a6bb}{eos\+\_\+top}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2394cda184a58df72b20806215927edf}{eos\+\_\+top\+\_\+ts}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ae8326e055b483e54536dea4210ea5346}{n\+\_\+best\+\_\+counter}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7709dc9d035f249283776d08ca4d93c8}{min\+\_\+n\+\_\+best}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Generic beam class.

It keeps information about beam_size hypothesis.
\end{DoxyVerb}
 

Definition at line 21 of file utils\+\_\+v0.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a0b15ba633165fe8ae84f7664dc893b99}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a0b15ba633165fe8ae84f7664dc893b99}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{beam\+\_\+size,  }\item[{}]{min\+\_\+length = {\ttfamily 3},  }\item[{}]{padding\+\_\+token = {\ttfamily 0},  }\item[{}]{bos\+\_\+token = {\ttfamily 1},  }\item[{}]{eos\+\_\+token = {\ttfamily 2},  }\item[{}]{min\+\_\+n\+\_\+best = {\ttfamily 3},  }\item[{}]{cuda = {\ttfamily \textquotesingle{}cpu\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Instantiate Beam object.

:param beam_size: number of hypothesis in the beam
:param min_length: minimum length of the predicted sequence
:param padding_token: Set to 0 as usual in ParlAI
:param bos_token: Set to 1 as usual in ParlAI
:param eos_token: Set to 2 as usual in ParlAI
:param min_n_best: Beam will not be done unless this amount of finished
           hypothesis (with EOS) is done
:param cuda: What device to use for computations
\end{DoxyVerb}
 

Definition at line 37 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
37     ):
38         \textcolor{stringliteral}{"""}
39 \textcolor{stringliteral}{        Instantiate Beam object.}
40 \textcolor{stringliteral}{}
41 \textcolor{stringliteral}{        :param beam\_size: number of hypothesis in the beam}
42 \textcolor{stringliteral}{        :param min\_length: minimum length of the predicted sequence}
43 \textcolor{stringliteral}{        :param padding\_token: Set to 0 as usual in ParlAI}
44 \textcolor{stringliteral}{        :param bos\_token: Set to 1 as usual in ParlAI}
45 \textcolor{stringliteral}{        :param eos\_token: Set to 2 as usual in ParlAI}
46 \textcolor{stringliteral}{        :param min\_n\_best: Beam will not be done unless this amount of finished}
47 \textcolor{stringliteral}{                           hypothesis (with EOS) is done}
48 \textcolor{stringliteral}{        :param cuda: What device to use for computations}
49 \textcolor{stringliteral}{        """}
50         self.beam\_size = beam\_size
51         self.min\_length = min\_length
52         self.eos = eos\_token
53         self.bos = bos\_token
54         self.pad = padding\_token
55         self.device = cuda
56         \textcolor{comment}{# recent score for each hypo in the beam}
57         self.scores = torch.Tensor(self.beam\_size).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().zero\_().to(self.device)
58         \textcolor{comment}{# self.scores values per each time step}
59         self.all\_scores = [torch.Tensor([0.0] * beam\_size).to(self.device)]
60         \textcolor{comment}{# backtracking id to hypothesis at previous time step}
61         self.bookkeep = []
62         \textcolor{comment}{# output tokens at each time step}
63         self.outputs = [
64             torch.Tensor(self.beam\_size).long().fill\_(padding\_token).to(self.device)
65         ]
66         \textcolor{comment}{# keeps tuples (score, time\_step, hyp\_id)}
67         self.finished = []
68         self.HypothesisTail = namedtuple(
69             \textcolor{stringliteral}{'HypothesisTail'}, [\textcolor{stringliteral}{'timestep'}, \textcolor{stringliteral}{'hypid'}, \textcolor{stringliteral}{'score'}, \textcolor{stringliteral}{'tokenid'}]
70         )
71         self.eos\_top = \textcolor{keyword}{False}
72         self.eos\_top\_ts = \textcolor{keywordtype}{None}
73         self.n\_best\_counter = 0
74         self.min\_n\_best = min\_n\_best
75 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ad45cf956539e1b9cdb38e6ebb2514843}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ad45cf956539e1b9cdb38e6ebb2514843}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!advance@{advance}}
\index{advance@{advance}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{advance()}{advance()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+advance (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{softmax\+\_\+probs }\end{DoxyParamCaption})}



Definition at line 82 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
82     \textcolor{keyword}{def }advance(self, softmax\_probs):
83         voc\_size = softmax\_probs.size(-1)
84         \textcolor{keywordflow}{if} len(self.bookkeep) == 0:
85             \textcolor{comment}{# the first step we take only the first hypo into account since all}
86             \textcolor{comment}{# hypos are the same initially}
87             beam\_scores = softmax\_probs[0]
88         \textcolor{keywordflow}{else}:
89             \textcolor{comment}{# we need to sum up hypo scores and curr softmax scores before topk}
90             \textcolor{comment}{# [beam\_size, voc\_size]}
91             beam\_scores = softmax\_probs + self.scores.unsqueeze(1).expand\_as(
92                 softmax\_probs
93             )
94             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(self.outputs[-1].size(0)):
95                 \textcolor{comment}{#  if previous output hypo token had eos}
96                 \textcolor{comment}{# we penalize those word probs to never be chosen}
97                 \textcolor{keywordflow}{if} self.outputs[-1][i] == self.eos:
98                     \textcolor{comment}{# beam\_scores[i] is voc\_size array for i-th hypo}
99                     beam\_scores[i] = -1e20
100 
101         flatten\_beam\_scores = beam\_scores.view(-1)  \textcolor{comment}{# [beam\_size * voc\_size]}
102         with torch.no\_grad():
103             best\_scores, best\_idxs = torch.topk(
104                 flatten\_beam\_scores, self.beam\_size, dim=-1
105             )
106 
107         self.scores = best\_scores
108         self.all\_scores.append(self.scores)
109         \textcolor{comment}{# get the backtracking hypothesis id as a multiple of full voc\_sizes}
110         hyp\_ids = best\_idxs / voc\_size
111         \textcolor{comment}{# get the actual word id from residual of the same division}
112         tok\_ids = best\_idxs % voc\_size
113 
114         self.outputs.append(tok\_ids)
115         self.bookkeep.append(hyp\_ids)
116 
117         \textcolor{comment}{#  check new hypos for eos label, if we have some, add to finished}
118         \textcolor{keywordflow}{for} hypid \textcolor{keywordflow}{in} range(self.beam\_size):
119             \textcolor{keywordflow}{if} self.outputs[-1][hypid] == self.eos:
120                 \textcolor{comment}{#  this is finished hypo, adding to finished}
121                 eostail = self.HypothesisTail(
122                     timestep=len(self.outputs) - 1,
123                     hypid=hypid,
124                     score=self.scores[hypid],
125                     tokenid=self.eos,
126                 )
127                 self.finished.append(eostail)
128                 self.n\_best\_counter += 1
129 
130         \textcolor{keywordflow}{if} self.outputs[-1][0] == self.eos:
131             self.eos\_top = \textcolor{keyword}{True}
132             \textcolor{keywordflow}{if} self.eos\_top\_ts \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
133                 self.eos\_top\_ts = len(self.outputs) - 1
134 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abea53933203e2126e38657efe715b8b5}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abea53933203e2126e38657efe715b8b5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!check\+\_\+finished@{check\+\_\+finished}}
\index{check\+\_\+finished@{check\+\_\+finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{check\+\_\+finished()}{check\_finished()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+check\+\_\+finished (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Checks if self.finished is empty and add hyptail in that case.

This will be suboptimal hypothesis since the model did not get any EOS

:returns: None
\end{DoxyVerb}
 

Definition at line 211 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
211     \textcolor{keyword}{def }check\_finished(self):
212         \textcolor{stringliteral}{"""}
213 \textcolor{stringliteral}{        Checks if self.finished is empty and add hyptail in that case.}
214 \textcolor{stringliteral}{}
215 \textcolor{stringliteral}{        This will be suboptimal hypothesis since the model did not get any EOS}
216 \textcolor{stringliteral}{}
217 \textcolor{stringliteral}{        :returns: None}
218 \textcolor{stringliteral}{        """}
219         \textcolor{keywordflow}{if} len(self.finished) == 0:
220             \textcolor{comment}{# we change output because we want outputs to have eos}
221             \textcolor{comment}{# to pass assert in L102, it is ok since empty self.finished}
222             \textcolor{comment}{# means junk prediction anyway}
223             self.outputs[-1][0] = self.eos
224             hyptail = self.HypothesisTail(
225                 timestep=len(self.outputs) - 1,
226                 hypid=0,
227                 score=self.all\_scores[-1][0],
228                 tokenid=self.outputs[-1][0],
229             )
230 
231             self.finished.append(hyptail)
232 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ac37b26314438d9e94b03e5a45efaf5dd}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ac37b26314438d9e94b03e5a45efaf5dd}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!done@{done}}
\index{done@{done}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{done()}{done()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+done (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 135 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
135     \textcolor{keyword}{def }done(self):
136         \textcolor{keywordflow}{return} self.eos\_top \textcolor{keywordflow}{and} self.n\_best\_counter >= self.min\_n\_best
137 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6deaa656e21fd41fafd2958a97ebea18}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6deaa656e21fd41fafd2958a97ebea18}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step}}
\index{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step()}{get\_backtrack\_from\_current\_step()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 79 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
79     \textcolor{keyword}{def }get\_backtrack\_from\_current\_step(self):
80         \textcolor{keywordflow}{return} self.bookkeep[-1]
81 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a0f15f5dc35437659d1ab17d4508d3abe}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a0f15f5dc35437659d1ab17d4508d3abe}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+beam\+\_\+dot@{get\+\_\+beam\+\_\+dot}}
\index{get\+\_\+beam\+\_\+dot@{get\+\_\+beam\+\_\+dot}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+beam\+\_\+dot()}{get\_beam\_dot()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+beam\+\_\+dot (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{dictionary = {\ttfamily None},  }\item[{}]{n\+\_\+best = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Creates pydot graph representation of the beam.

:param outputs: self.outputs from the beam
:param dictionary: tok 2 word dict to save words in the tree nodes
:returns: pydot graph
\end{DoxyVerb}
 

Definition at line 233 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
233     \textcolor{keyword}{def }get\_beam\_dot(self, dictionary=None, n\_best=None):
234         \textcolor{stringliteral}{"""}
235 \textcolor{stringliteral}{        Creates pydot graph representation of the beam.}
236 \textcolor{stringliteral}{}
237 \textcolor{stringliteral}{        :param outputs: self.outputs from the beam}
238 \textcolor{stringliteral}{        :param dictionary: tok 2 word dict to save words in the tree nodes}
239 \textcolor{stringliteral}{        :returns: pydot graph}
240 \textcolor{stringliteral}{        """}
241         \textcolor{keywordflow}{try}:
242             \textcolor{keyword}{import} pydot
243         \textcolor{keywordflow}{except} ImportError:
244             print(\textcolor{stringliteral}{"Please install pydot package to dump beam visualization"})
245 
246         graph = pydot.Dot(graph\_type=\textcolor{stringliteral}{'digraph'})
247         outputs = [i.tolist() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.outputs]
248         bookkeep = [i.tolist() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.bookkeep]
249         all\_scores = [i.tolist() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.all\_scores]
250         \textcolor{keywordflow}{if} n\_best \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
251             n\_best = \hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(self.beam\_size / 2)
252 
253         \textcolor{comment}{# get top nbest hyp}
254         top\_hyp\_idx\_n\_best = []
255         n\_best\_colors = [\textcolor{stringliteral}{'aquamarine'}, \textcolor{stringliteral}{'chocolate1'}, \textcolor{stringliteral}{'deepskyblue'}, \textcolor{stringliteral}{'green2'}, \textcolor{stringliteral}{'tan'}]
256         sorted\_finished = self.get\_rescored\_finished(n\_best=n\_best)
257         \textcolor{keywordflow}{for} hyptail \textcolor{keywordflow}{in} sorted\_finished:
258             \textcolor{comment}{# do not include EOS since it has rescored score not from original}
259             \textcolor{comment}{# self.all\_scores, we color EOS with black}
260             top\_hyp\_idx\_n\_best.append(self.get\_hyp\_from\_finished(hyptail))
261 
262         \textcolor{comment}{# create nodes}
263         \textcolor{keywordflow}{for} tstep, lis \textcolor{keywordflow}{in} enumerate(outputs):
264             \textcolor{keywordflow}{for} hypid, token \textcolor{keywordflow}{in} enumerate(lis):
265                 \textcolor{keywordflow}{if} tstep == 0:
266                     hypid = 0  \textcolor{comment}{# collapse all \_\_NULL\_\_ nodes}
267                 node\_tail = self.HypothesisTail(
268                     timestep=tstep,
269                     hypid=hypid,
270                     score=all\_scores[tstep][hypid],
271                     tokenid=token,
272                 )
273                 color = \textcolor{stringliteral}{'white'}
274                 rank = \textcolor{keywordtype}{None}
275                 \textcolor{keywordflow}{for} i, hypseq \textcolor{keywordflow}{in} enumerate(top\_hyp\_idx\_n\_best):
276                     \textcolor{keywordflow}{if} node\_tail \textcolor{keywordflow}{in} hypseq:
277                         \textcolor{keywordflow}{if} n\_best <= 5:  \textcolor{comment}{# color nodes only if <=5}
278                             color = n\_best\_colors[i]
279                         rank = i
280                         \textcolor{keywordflow}{break}
281                 label = (
282                     \textcolor{stringliteral}{"<\{\}"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
283                         dictionary.vec2txt([token]) \textcolor{keywordflow}{if} dictionary \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} token
284                     )
285                     + \textcolor{stringliteral}{" : "}
286                     + \textcolor{stringliteral}{"\{:.\{prec\}f\}>"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(all\_scores[tstep][hypid], prec=3)
287                 )
288 
289                 graph.add\_node(
290                     pydot.Node(
291                         node\_tail.\_\_repr\_\_(),
292                         label=label,
293                         fillcolor=color,
294                         style=\textcolor{stringliteral}{'filled'},
295                         xlabel=\textcolor{stringliteral}{'\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(rank) \textcolor{keywordflow}{if} rank \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} \textcolor{stringliteral}{''},
296                     )
297                 )
298 
299         \textcolor{comment}{# create edges}
300         \textcolor{keywordflow}{for} revtstep, lis \textcolor{keywordflow}{in} reversed(list(enumerate(bookkeep))):
301             \textcolor{keywordflow}{for} i, prev\_id \textcolor{keywordflow}{in} enumerate(lis):
302                 from\_node = graph.get\_node(
303                     \textcolor{stringliteral}{'"\{\}"'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
304                         self.HypothesisTail(
305                             timestep=revtstep,
306                             hypid=prev\_id,
307                             score=all\_scores[revtstep][prev\_id],
308                             tokenid=outputs[revtstep][prev\_id],
309                         ).\_\_repr\_\_()
310                     )
311                 )[0]
312                 to\_node = graph.get\_node(
313                     \textcolor{stringliteral}{'"\{\}"'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
314                         self.HypothesisTail(
315                             timestep=revtstep + 1,
316                             hypid=i,
317                             score=all\_scores[revtstep + 1][i],
318                             tokenid=outputs[revtstep + 1][i],
319                         ).\_\_repr\_\_()
320                     )
321                 )[0]
322                 newedge = pydot.Edge(from\_node.get\_name(), to\_node.get\_name())
323                 graph.add\_edge(newedge)
324 
325         \textcolor{keywordflow}{return} graph
326 
327 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2df9b1e26c3f35c7149e4d7ae75c2f03}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2df9b1e26c3f35c7149e4d7ae75c2f03}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+hyp\+\_\+from\+\_\+finished@{get\+\_\+hyp\+\_\+from\+\_\+finished}}
\index{get\+\_\+hyp\+\_\+from\+\_\+finished@{get\+\_\+hyp\+\_\+from\+\_\+finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+hyp\+\_\+from\+\_\+finished()}{get\_hyp\_from\_finished()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+hyp\+\_\+from\+\_\+finished (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{hypothesis\+\_\+tail }\end{DoxyParamCaption})}

\begin{DoxyVerb}Extract hypothesis ending with EOS at timestep with hyp_id.

:param timestep: timestep with range up to len(self.outputs)-1
:param hyp_id: id with range up to beam_size-1
:return: hypothesis sequence
\end{DoxyVerb}
 

Definition at line 150 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
150     \textcolor{keyword}{def }get\_hyp\_from\_finished(self, hypothesis\_tail):
151         \textcolor{stringliteral}{"""}
152 \textcolor{stringliteral}{        Extract hypothesis ending with EOS at timestep with hyp\_id.}
153 \textcolor{stringliteral}{}
154 \textcolor{stringliteral}{        :param timestep: timestep with range up to len(self.outputs)-1}
155 \textcolor{stringliteral}{        :param hyp\_id: id with range up to beam\_size-1}
156 \textcolor{stringliteral}{        :return: hypothesis sequence}
157 \textcolor{stringliteral}{        """}
158         \textcolor{keyword}{assert} self.outputs[hypothesis\_tail.timestep][hypothesis\_tail.hypid] == self.eos
159         \textcolor{keyword}{assert} hypothesis\_tail.tokenid == self.eos
160         hyp\_idx = []
161         endback = hypothesis\_tail.hypid
162         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(hypothesis\_tail.timestep, -1, -1):
163             hyp\_idx.append(
164                 self.HypothesisTail(
165                     timestep=i,
166                     hypid=endback,
167                     score=self.all\_scores[i][endback],
168                     tokenid=self.outputs[i][endback],
169                 )
170             )
171             endback = self.bookkeep[i - 1][endback]
172 
173         \textcolor{keywordflow}{return} hyp\_idx
174 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a76fadcbf18352eb7f2d741e9b04e0a6a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a76fadcbf18352eb7f2d741e9b04e0a6a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+output\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step}}
\index{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step()}{get\_output\_from\_current\_step()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+output\+\_\+from\+\_\+current\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 76 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
76     \textcolor{keyword}{def }get\_output\_from\_current\_step(self):
77         \textcolor{keywordflow}{return} self.outputs[-1]
78 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a9e16b7ec90640b527d75642fe93c6417}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a9e16b7ec90640b527d75642fe93c6417}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+pretty\+\_\+hypothesis@{get\+\_\+pretty\+\_\+hypothesis}}
\index{get\+\_\+pretty\+\_\+hypothesis@{get\+\_\+pretty\+\_\+hypothesis}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+pretty\+\_\+hypothesis()}{get\_pretty\_hypothesis()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+pretty\+\_\+hypothesis (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{list\+\_\+of\+\_\+hypotails }\end{DoxyParamCaption})}



Definition at line 175 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
175     \textcolor{keyword}{def }get\_pretty\_hypothesis(self, list\_of\_hypotails):
176         hypothesis = []
177         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} list\_of\_hypotails:
178             hypothesis.append(i.tokenid)
179 
180         hypothesis = torch.stack(list(reversed(hypothesis)))
181 
182         \textcolor{keywordflow}{return} hypothesis
183 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a3c573eb1104002cb7da1483a6afb3cfe}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a3c573eb1104002cb7da1483a6afb3cfe}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+rescored\+\_\+finished@{get\+\_\+rescored\+\_\+finished}}
\index{get\+\_\+rescored\+\_\+finished@{get\+\_\+rescored\+\_\+finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+rescored\+\_\+finished()}{get\_rescored\_finished()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+rescored\+\_\+finished (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{n\+\_\+best = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}:param n_best: how many n best hypothesis to return
:return: list with hypothesis
\end{DoxyVerb}
 

Definition at line 184 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
184     \textcolor{keyword}{def }get\_rescored\_finished(self, n\_best=None):
185         \textcolor{stringliteral}{"""}
186 \textcolor{stringliteral}{}
187 \textcolor{stringliteral}{        :param n\_best: how many n best hypothesis to return}
188 \textcolor{stringliteral}{        :return: list with hypothesis}
189 \textcolor{stringliteral}{        """}
190         rescored\_finished = []
191         \textcolor{keywordflow}{for} finished\_item \textcolor{keywordflow}{in} self.finished:
192             current\_length = finished\_item.timestep + 1
193             \textcolor{comment}{# these weights are from Google NMT paper}
194             length\_penalty = math.pow((1 + current\_length) / 6, 0.65)
195             rescored\_finished.append(
196                 self.HypothesisTail(
197                     timestep=finished\_item.timestep,
198                     hypid=finished\_item.hypid,
199                     score=finished\_item.score / length\_penalty,
200                     tokenid=finished\_item.tokenid,
201                 )
202             )
203 
204         srted = sorted(rescored\_finished, key=attrgetter(\textcolor{stringliteral}{'score'}), reverse=\textcolor{keyword}{True})
205 
206         \textcolor{keywordflow}{if} n\_best \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
207             srted = srted[:n\_best]
208 
209         \textcolor{keywordflow}{return} srted
210 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abbb522afdc69dbce77f997dd392c5c1d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abbb522afdc69dbce77f997dd392c5c1d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!get\+\_\+top\+\_\+hyp@{get\+\_\+top\+\_\+hyp}}
\index{get\+\_\+top\+\_\+hyp@{get\+\_\+top\+\_\+hyp}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+top\+\_\+hyp()}{get\_top\_hyp()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+get\+\_\+top\+\_\+hyp (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get single best hypothesis.

:return: hypothesis sequence and the final score
\end{DoxyVerb}
 

Definition at line 138 of file utils\+\_\+v0.\+py.


\begin{DoxyCode}
138     \textcolor{keyword}{def }get\_top\_hyp(self):
139         \textcolor{stringliteral}{"""}
140 \textcolor{stringliteral}{        Get single best hypothesis.}
141 \textcolor{stringliteral}{}
142 \textcolor{stringliteral}{        :return: hypothesis sequence and the final score}
143 \textcolor{stringliteral}{        """}
144         top\_hypothesis\_tail = self.get\_rescored\_finished(n\_best=1)[0]
145         \textcolor{keywordflow}{return} (
146             self.get\_hyp\_from\_finished(top\_hypothesis\_tail),
147             top\_hypothesis\_tail.score,
148         )
149 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ae8e9fc9a712aef34dc78d40faf089d79}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ae8e9fc9a712aef34dc78d40faf089d79}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!all\+\_\+scores@{all\+\_\+scores}}
\index{all\+\_\+scores@{all\+\_\+scores}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{all\+\_\+scores}{all\_scores}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+all\+\_\+scores}



Definition at line 59 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa23d688e6e9c2d6ced98d57ac1a7059c}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa23d688e6e9c2d6ced98d57ac1a7059c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!beam\+\_\+size@{beam\+\_\+size}}
\index{beam\+\_\+size@{beam\+\_\+size}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{beam\+\_\+size}{beam\_size}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+beam\+\_\+size}



Definition at line 50 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a660602181552d0ef501cb99b68d790f3}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a660602181552d0ef501cb99b68d790f3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!bookkeep@{bookkeep}}
\index{bookkeep@{bookkeep}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{bookkeep}{bookkeep}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+bookkeep}



Definition at line 61 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abae3db8ae23e5e334edceeeaf6bd4517}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_abae3db8ae23e5e334edceeeaf6bd4517}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!bos@{bos}}
\index{bos@{bos}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{bos}{bos}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+bos}



Definition at line 53 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a5bc1b513284975d51d9ec9554fa29f94}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a5bc1b513284975d51d9ec9554fa29f94}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!device@{device}}
\index{device@{device}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{device}{device}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+device}



Definition at line 55 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a821bdac1bbdef3faa186729b7b361da8}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a821bdac1bbdef3faa186729b7b361da8}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!eos@{eos}}
\index{eos@{eos}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{eos}{eos}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+eos}



Definition at line 52 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a707079827f1a9da806ebe4f9c8c1a6bb}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a707079827f1a9da806ebe4f9c8c1a6bb}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!eos\+\_\+top@{eos\+\_\+top}}
\index{eos\+\_\+top@{eos\+\_\+top}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{eos\+\_\+top}{eos\_top}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+eos\+\_\+top}



Definition at line 71 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2394cda184a58df72b20806215927edf}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2394cda184a58df72b20806215927edf}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!eos\+\_\+top\+\_\+ts@{eos\+\_\+top\+\_\+ts}}
\index{eos\+\_\+top\+\_\+ts@{eos\+\_\+top\+\_\+ts}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{eos\+\_\+top\+\_\+ts}{eos\_top\_ts}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+eos\+\_\+top\+\_\+ts}



Definition at line 72 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a3761685a56c34b82ab6533814b869851}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a3761685a56c34b82ab6533814b869851}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!finished@{finished}}
\index{finished@{finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{finished}{finished}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+finished}



Definition at line 67 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa6b1326a200ef63b4b19fbbffc82a14c}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_aa6b1326a200ef63b4b19fbbffc82a14c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!Hypothesis\+Tail@{Hypothesis\+Tail}}
\index{Hypothesis\+Tail@{Hypothesis\+Tail}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{Hypothesis\+Tail}{HypothesisTail}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+Hypothesis\+Tail}



Definition at line 68 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7d6ef73f817ea0cddaaa2857f5fab206}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7d6ef73f817ea0cddaaa2857f5fab206}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!min\+\_\+length@{min\+\_\+length}}
\index{min\+\_\+length@{min\+\_\+length}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{min\+\_\+length}{min\_length}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+min\+\_\+length}



Definition at line 51 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7709dc9d035f249283776d08ca4d93c8}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a7709dc9d035f249283776d08ca4d93c8}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!min\+\_\+n\+\_\+best@{min\+\_\+n\+\_\+best}}
\index{min\+\_\+n\+\_\+best@{min\+\_\+n\+\_\+best}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{min\+\_\+n\+\_\+best}{min\_n\_best}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+min\+\_\+n\+\_\+best}



Definition at line 74 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ae8326e055b483e54536dea4210ea5346}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_ae8326e055b483e54536dea4210ea5346}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!n\+\_\+best\+\_\+counter@{n\+\_\+best\+\_\+counter}}
\index{n\+\_\+best\+\_\+counter@{n\+\_\+best\+\_\+counter}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{n\+\_\+best\+\_\+counter}{n\_best\_counter}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+n\+\_\+best\+\_\+counter}



Definition at line 73 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6383bb09ede1b1c681c0eb1ac0bd15f8}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6383bb09ede1b1c681c0eb1ac0bd15f8}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!outputs@{outputs}}
\index{outputs@{outputs}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{outputs}{outputs}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+outputs}



Definition at line 63 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2b566884e7d177fcbcdcad1547dcf070}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a2b566884e7d177fcbcdcad1547dcf070}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!pad@{pad}}
\index{pad@{pad}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{pad}{pad}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+pad}



Definition at line 54 of file utils\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6f0cb3d9a944a1c1bab850834d81b798}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_1_1Beam_a6f0cb3d9a944a1c1bab850834d81b798}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}!scores@{scores}}
\index{scores@{scores}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::utils\+\_\+v0\+::\+Beam}}
\subsubsection{\texorpdfstring{scores}{scores}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+utils\+\_\+v0.\+Beam.\+scores}



Definition at line 57 of file utils\+\_\+v0.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/seq2seq/\hyperlink{utils__v0_8py}{utils\+\_\+v0.\+py}\end{DoxyCompactItemize}
