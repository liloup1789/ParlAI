\hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel}{}\section{projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model Class Reference}
\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel}\index{projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model@{projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model}}


Inheritance diagram for projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=233pt]{d6/d06/classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=233pt]{dc/d72/classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ae1904b5e3a520e4637dd39d378a8419d}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a13919d02a75fa59aebcd81ac27c133f2}{opt}, \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a166e8e99f9976b3774343ddc15a14fc7}{personalities\+\_\+list}, \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a92f8c4f0826beac705e067625611a582}{dictionary})
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a1a0d7d70271cf1cb881f3166bfd7bf10}{forward} (self, image\+\_\+features, personalities, captions, personalities\+\_\+tensor=None)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5d48e4824c4b82e8c7eb25431952e988}{forward\+\_\+personality} (self, personalities, personalities\+\_\+tensor)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aee5f9d98e2c82024cc76dd1227c63f9e}{forward\+\_\+image} (self, image\+\_\+features)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a65f01ee6cdfb2d516e1e9be77e3d141a}{train\+\_\+batch} (self, image\+\_\+features, personalities, captions)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5ae5dc90e1def32a45262dc7705e07a3}{eval\+\_\+batch} (self, image\+\_\+features, personalities, captions)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a9f2a69ead8d29f468ec6c87fbf950b57}{choose\+\_\+best\+\_\+caption} (self, image\+\_\+features, personalities, candidates, candidates\+\_\+encoded=None, k=1)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a0d96cec932912a3e06a44dc95259010a}{eval\+\_\+batch\+\_\+of\+\_\+100} (self, context\+\_\+encoded, captions\+\_\+encoded)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aeabd7be189bc8127923aa8b424615110}{evaluate\+\_\+one\+\_\+batch} (self, context\+\_\+encoded, captions\+\_\+encoded, during\+\_\+train=False)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aace67e437e969262f0173158743e74ce}{freeze\+\_\+text\+\_\+encoder} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a7a9e68b5978bb8b9c681a9ce0015d3c3}{unfreeze\+\_\+text\+\_\+encoder} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a7e2f89c5290e2b0b13dd0891a07d761d}{sum\+\_\+encodings} (self, addends)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a3d8ccc4b989803cc17f5976730016c6c}{personalities\+\_\+to\+\_\+index} (self, personalities)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a923aaf397f8832bea4fcb82acc963465}{captions\+\_\+to\+\_\+tensor} (self, captions)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5d403cea2bcc3d1989bbd00c5d824d01}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ac0bab6b8757c151ca060ad7dee9c00a2}{use\+\_\+cuda}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a13919d02a75fa59aebcd81ac27c133f2}{opt}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a92f8c4f0826beac705e067625611a582}{dictionary}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ad2d8044f26091f54cc046eae2c897329}{truncate\+\_\+length}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ad8f93156abe79fccfb22f4984c0fe012}{text\+\_\+encoder\+\_\+frozen}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a8c4101b9ed0f557efba9480bc6b40a4c}{optimizer}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a166e8e99f9976b3774343ddc15a14fc7}{personalities\+\_\+list}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a37a1d2274c4ec9a990f95f2434d05bb5}{personality\+\_\+to\+\_\+id}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a11a6c307a016a1112fe6ddb9b55f4dbf}{num\+\_\+personalities}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a6bee1d7005766287de3088b0b50278dd}{embeddings}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_adb92caa86a26b054d3dfb0a33c53000d}{text\+\_\+encoder}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a3f25e3353c49c641266546dfd7bb086a}{additional\+\_\+layer}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aec6603866302a777495b211be700d57c}{image\+\_\+encoder}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a973e61da77569c929fb41e8868f26850}{personality\+\_\+encoder}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Actual model code for the Transresnet Agent.
\end{DoxyVerb}
 

Definition at line 17 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ae1904b5e3a520e4637dd39d378a8419d}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ae1904b5e3a520e4637dd39d378a8419d}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{personalities\+\_\+list,  }\item[{}]{dictionary }\end{DoxyParamCaption})}



Definition at line 100 of file modules.\+py.


\begin{DoxyCode}
100     \textcolor{keyword}{def }\_\_init\_\_(self, opt, personalities\_list, dictionary):
101         super().\_\_init\_\_()
102         self.use\_cuda = \textcolor{keywordflow}{not} opt[\textcolor{stringliteral}{'no\_cuda'}] \textcolor{keywordflow}{and} torch.cuda.is\_available()
103         self.opt = opt
104         self.dictionary = dictionary
105         self.truncate\_length = opt[\textcolor{stringliteral}{'truncate'}]
106         \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'num\_layers\_all'}] != -1:
107             n\_layers\_text = n\_layers\_img = opt[\textcolor{stringliteral}{'num\_layers\_all'}]
108         \textcolor{keywordflow}{else}:
109             n\_layers\_text = opt[\textcolor{stringliteral}{'num\_layers\_text\_encoder'}]
110             n\_layers\_img = opt[\textcolor{stringliteral}{'num\_layers\_image\_encoder'}]
111         self.text\_encoder\_frozen = \textcolor{keyword}{False}
112 
113         \textcolor{comment}{# Initialize personalities dictionary}
114         self.\_build\_personality\_dictionary(personalities\_list)
115 
116         \textcolor{comment}{# Text encoder}
117         self.\_build\_text\_encoder(n\_layers\_text)
118 
119         \textcolor{comment}{# Image encoder}
120         self.\_build\_image\_encoder(n\_layers\_img)
121 
122         \textcolor{comment}{# Personality Encoder}
123         self.\_build\_personality\_encoder()
124 
125         \textcolor{comment}{# optimizer}
126         self.optimizer = optim.Adam(
127             filter(\textcolor{keyword}{lambda} p: p.requires\_grad, self.parameters()),
128             self.opt[\textcolor{stringliteral}{'learningrate'}],
129         )
130 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5d403cea2bcc3d1989bbd00c5d824d01}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5d403cea2bcc3d1989bbd00c5d824d01}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Add command line arguments.
\end{DoxyVerb}
 

Definition at line 23 of file modules.\+py.


\begin{DoxyCode}
23     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
24         \textcolor{stringliteral}{"""}
25 \textcolor{stringliteral}{        Add command line arguments.}
26 \textcolor{stringliteral}{        """}
27         Transformer.add\_common\_cmdline\_args(argparser)
28         agent = argparser.add\_argument\_group(\textcolor{stringliteral}{'TransresnetModel arguments'})
29         agent.add\_argument(
30             \textcolor{stringliteral}{'--truncate'},
31             type=int,
32             default=32,
33             help=\textcolor{stringliteral}{'Max amount of tokens allowed in a text sequence'},
34         )
35         agent.add\_argument(
36             \textcolor{stringliteral}{'--image-features-dim'},
37             type=int,
38             default=2048,
39             help=\textcolor{stringliteral}{'dimensionality of image features'},
40         )
41         agent.add\_argument(
42             \textcolor{stringliteral}{'--embedding-type'},
43             type=str,
44             default=\textcolor{keywordtype}{None},
45             choices=[\textcolor{keywordtype}{None}, \textcolor{stringliteral}{'fasttext\_cc'}],
46             help=\textcolor{stringliteral}{'Specify if using pretrained embeddings'},
47         )
48         agent.add\_argument(
49             \textcolor{stringliteral}{'--load-encoder-from'},
50             type=str,
51             default=\textcolor{keywordtype}{None},
52             help=\textcolor{stringliteral}{'Specify if using a pretrained transformer encoder'},
53         )
54         agent.add\_argument(
55             \textcolor{stringliteral}{'--hidden-dim'},
56             type=int,
57             default=300,
58             help=\textcolor{stringliteral}{'Hidden dimesionality of personality and image encoder'},
59         )
60         agent.add\_argument(
61             \textcolor{stringliteral}{'--num-layers-all'},
62             type=int,
63             default=-1,
64             help=\textcolor{stringliteral}{'If >= 1, number of layers for both the text '} \textcolor{stringliteral}{'and image encoders.'},
65         )
66         agent.add\_argument(
67             \textcolor{stringliteral}{'--num-layers-text-encoder'},
68             type=int,
69             default=1,
70             help=\textcolor{stringliteral}{'Number of layers for the text encoder'},
71         )
72         agent.add\_argument(
73             \textcolor{stringliteral}{'--num-layers-image-encoder'},
74             type=int,
75             default=1,
76             help=\textcolor{stringliteral}{'Number of layers for the image encoder'},
77         )
78         agent.add\_argument(
79             \textcolor{stringliteral}{'--no-cuda'},
80             dest=\textcolor{stringliteral}{'no\_cuda'},
81             action=\textcolor{stringliteral}{'store\_true'},
82             help=\textcolor{stringliteral}{'If True, perform ops on CPU only'},
83         )
84         agent.add\_argument(
85             \textcolor{stringliteral}{'--learningrate'},
86             type=float,
87             default=0.0005,
88             help=\textcolor{stringliteral}{'learning rate for optimizer'},
89         )
90         agent.add\_argument(
91             \textcolor{stringliteral}{'--additional-layer-dropout'},
92             type=float,
93             default=0.2,
94             help=\textcolor{stringliteral}{'dropout for additional linear layer'},
95         )
96         argparser.set\_params(
97             ffn\_size=1200, attention\_dropout=0.2, relu\_dropout=0.2, n\_positions=1000
98         )
99 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a923aaf397f8832bea4fcb82acc963465}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a923aaf397f8832bea4fcb82acc963465}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!captions\+\_\+to\+\_\+tensor@{captions\+\_\+to\+\_\+tensor}}
\index{captions\+\_\+to\+\_\+tensor@{captions\+\_\+to\+\_\+tensor}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{captions\+\_\+to\+\_\+tensor()}{captions\_to\_tensor()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+captions\+\_\+to\+\_\+tensor (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{captions }\end{DoxyParamCaption})}

\begin{DoxyVerb}Tokenize a list of sentences into a 2D float tensor.

:param captions:
    list of sentences to tokenize

:return:
    a (batchsize X truncate_length) tensor representation of the captions,
    and a similarly sized mask tensor
\end{DoxyVerb}
 

Definition at line 518 of file modules.\+py.


\begin{DoxyCode}
518     \textcolor{keyword}{def }captions\_to\_tensor(self, captions):
519         \textcolor{stringliteral}{"""}
520 \textcolor{stringliteral}{        Tokenize a list of sentences into a 2D float tensor.}
521 \textcolor{stringliteral}{}
522 \textcolor{stringliteral}{        :param captions:}
523 \textcolor{stringliteral}{            list of sentences to tokenize}
524 \textcolor{stringliteral}{}
525 \textcolor{stringliteral}{        :return:}
526 \textcolor{stringliteral}{            a (batchsize X truncate\_length) tensor representation of the captions,}
527 \textcolor{stringliteral}{            and a similarly sized mask tensor}
528 \textcolor{stringliteral}{        """}
529         max\_length = self.truncate\_length
530         indexes = []
531         \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} captions:
532             vec = self.dictionary.txt2vec(c)
533             \textcolor{keywordflow}{if} len(vec) > max\_length:
534                 vec = vec[:max\_length]
535             indexes.append(self.dictionary.txt2vec(c))
536         longest = max([len(v) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} indexes])
537         res = torch.LongTensor(len(captions), longest).fill\_(
538             self.dictionary.tok2ind[self.dictionary.null\_token]
539         )
540         mask = torch.FloatTensor(len(captions), longest).fill\_(0)
541         \textcolor{keywordflow}{for} i, inds \textcolor{keywordflow}{in} enumerate(indexes):
542             res[i, 0 : len(inds)] = torch.LongTensor(inds)
543             mask[i, 0 : len(inds)] = torch.FloatTensor([1] * len(inds))
544         \textcolor{keywordflow}{if} self.use\_cuda:
545             res = res.cuda()
546             mask = mask.cuda()
547         \textcolor{keywordflow}{return} res, mask
548 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a9f2a69ead8d29f468ec6c87fbf950b57}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a9f2a69ead8d29f468ec6c87fbf950b57}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!choose\+\_\+best\+\_\+caption@{choose\+\_\+best\+\_\+caption}}
\index{choose\+\_\+best\+\_\+caption@{choose\+\_\+best\+\_\+caption}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{choose\+\_\+best\+\_\+caption()}{choose\_best\_caption()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+choose\+\_\+best\+\_\+caption (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image\+\_\+features,  }\item[{}]{personalities,  }\item[{}]{candidates,  }\item[{}]{candidates\+\_\+encoded = {\ttfamily None},  }\item[{}]{k = {\ttfamily 1} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Choose the best caption for each example.

:param image_features:
    list of tensors of image features
:param personalities:
    list of personalities
:param candidates:
    list of candidates, one set per example
:param candidates_encoded:
    optional; if specified, a fixed set of encoded candidates that is
    used for each example
:param k:
    number of ranked candidates to return. if < 1, we return the ranks
    of all candidates in the set.

:return:
    a set of ranked candidates for each example
\end{DoxyVerb}
 

Definition at line 369 of file modules.\+py.


\begin{DoxyCode}
369     ):
370         \textcolor{stringliteral}{"""}
371 \textcolor{stringliteral}{        Choose the best caption for each example.}
372 \textcolor{stringliteral}{}
373 \textcolor{stringliteral}{        :param image\_features:}
374 \textcolor{stringliteral}{            list of tensors of image features}
375 \textcolor{stringliteral}{        :param personalities:}
376 \textcolor{stringliteral}{            list of personalities}
377 \textcolor{stringliteral}{        :param candidates:}
378 \textcolor{stringliteral}{            list of candidates, one set per example}
379 \textcolor{stringliteral}{        :param candidates\_encoded:}
380 \textcolor{stringliteral}{            optional; if specified, a fixed set of encoded candidates that is}
381 \textcolor{stringliteral}{            used for each example}
382 \textcolor{stringliteral}{        :param k:}
383 \textcolor{stringliteral}{            number of ranked candidates to return. if < 1, we return the ranks}
384 \textcolor{stringliteral}{            of all candidates in the set.}
385 \textcolor{stringliteral}{}
386 \textcolor{stringliteral}{        :return:}
387 \textcolor{stringliteral}{            a set of ranked candidates for each example}
388 \textcolor{stringliteral}{        """}
389         self.eval()
390         context\_encoded, \_ = self.forward(image\_features, personalities, \textcolor{keywordtype}{None})
391         context\_encoded = context\_encoded.detach()
392         one\_cand\_set = \textcolor{keyword}{True}
393         \textcolor{keywordflow}{if} candidates\_encoded \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
394             one\_cand\_set = \textcolor{keyword}{False}
395             candidates\_encoded = [
396                 self.forward(\textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, c)[1].detach() \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} candidates
397             ]
398         chosen = []
399         \textcolor{keywordflow}{for} img\_index \textcolor{keywordflow}{in} range(len(context\_encoded)):
400             context\_encoding = context\_encoded[img\_index : img\_index + 1, :]
401             scores = torch.mm(
402                 candidates\_encoded[img\_index]
403                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} one\_cand\_set
404                 \textcolor{keywordflow}{else} candidates\_encoded,
405                 context\_encoding.transpose(0, 1),
406             )
407             \textcolor{keywordflow}{if} k >= 1:
408                 \_, index\_top = torch.topk(scores, k, dim=0)
409             \textcolor{keywordflow}{else}:
410                 \_, index\_top = torch.topk(scores, scores.size(0), dim=0)
411             chosen.append(
412                 [
413                     candidates[img\_index][idx] \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} one\_cand\_set \textcolor{keywordflow}{else} candidates[idx]
414                     \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} index\_top.unsqueeze(1)
415                 ]
416             )
417 
418         \textcolor{keywordflow}{return} chosen
419 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5ae5dc90e1def32a45262dc7705e07a3}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5ae5dc90e1def32a45262dc7705e07a3}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!eval\+\_\+batch@{eval\+\_\+batch}}
\index{eval\+\_\+batch@{eval\+\_\+batch}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{eval\+\_\+batch()}{eval\_batch()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+eval\+\_\+batch (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image\+\_\+features,  }\item[{}]{personalities,  }\item[{}]{captions }\end{DoxyParamCaption})}

\begin{DoxyVerb}Evaluate performance of model on one batch.

Batch is split into chunks of 100 to evaluate hits@1/100

:param image_features:
    list of tensors of image features
:param personalities:
    list of personalities
:param captions:
    list of captions

:return:
    the total loss, the number of correct examples, and the number of
    examples trained on
\end{DoxyVerb}
 

Definition at line 337 of file modules.\+py.


\begin{DoxyCode}
337     \textcolor{keyword}{def }eval\_batch(self, image\_features, personalities, captions):
338         \textcolor{stringliteral}{"""}
339 \textcolor{stringliteral}{        Evaluate performance of model on one batch.}
340 \textcolor{stringliteral}{}
341 \textcolor{stringliteral}{        Batch is split into chunks of 100 to evaluate hits@1/100}
342 \textcolor{stringliteral}{}
343 \textcolor{stringliteral}{        :param image\_features:}
344 \textcolor{stringliteral}{            list of tensors of image features}
345 \textcolor{stringliteral}{        :param personalities:}
346 \textcolor{stringliteral}{            list of personalities}
347 \textcolor{stringliteral}{        :param captions:}
348 \textcolor{stringliteral}{            list of captions}
349 \textcolor{stringliteral}{}
350 \textcolor{stringliteral}{        :return:}
351 \textcolor{stringliteral}{            the total loss, the number of correct examples, and the number of}
352 \textcolor{stringliteral}{            examples trained on}
353 \textcolor{stringliteral}{        """}
354         \textcolor{keywordflow}{if} personalities \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
355             personalities = [\textcolor{stringliteral}{''}] * len(image\_features)
356         \textcolor{keywordflow}{if} len(image\_features) == 0:
357             \textcolor{keywordflow}{return} 0, 0, 1
358         self.eval()
359         context\_encoded, captions\_encoded = self.forward(
360             image\_features, personalities, captions
361         )
362         loss, num\_correct, num\_examples = self.eval\_batch\_of\_100(
363             context\_encoded, captions\_encoded
364         )
365         \textcolor{keywordflow}{return} loss, num\_correct, num\_examples
366 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a0d96cec932912a3e06a44dc95259010a}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a0d96cec932912a3e06a44dc95259010a}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!eval\+\_\+batch\+\_\+of\+\_\+100@{eval\+\_\+batch\+\_\+of\+\_\+100}}
\index{eval\+\_\+batch\+\_\+of\+\_\+100@{eval\+\_\+batch\+\_\+of\+\_\+100}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{eval\+\_\+batch\+\_\+of\+\_\+100()}{eval\_batch\_of\_100()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+eval\+\_\+batch\+\_\+of\+\_\+100 (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{context\+\_\+encoded,  }\item[{}]{captions\+\_\+encoded }\end{DoxyParamCaption})}

\begin{DoxyVerb}Evaluate a batch of 100 examples.

The captions of the other examples are used as negatives.

:param context_encoded:
    the encoded context
:param captions_encoded:
    the encoded captions

:return:
    the total loss, the total number of correct examples, and the
    total number of examples evaluated.
\end{DoxyVerb}
 

Definition at line 420 of file modules.\+py.


\begin{DoxyCode}
420     \textcolor{keyword}{def }eval\_batch\_of\_100(self, context\_encoded, captions\_encoded):
421         \textcolor{stringliteral}{"""}
422 \textcolor{stringliteral}{        Evaluate a batch of 100 examples.}
423 \textcolor{stringliteral}{}
424 \textcolor{stringliteral}{        The captions of the other examples are used as negatives.}
425 \textcolor{stringliteral}{}
426 \textcolor{stringliteral}{        :param context\_encoded:}
427 \textcolor{stringliteral}{            the encoded context}
428 \textcolor{stringliteral}{        :param captions\_encoded:}
429 \textcolor{stringliteral}{            the encoded captions}
430 \textcolor{stringliteral}{}
431 \textcolor{stringliteral}{        :return:}
432 \textcolor{stringliteral}{            the total loss, the total number of correct examples, and the}
433 \textcolor{stringliteral}{            total number of examples evaluated.}
434 \textcolor{stringliteral}{        """}
435         total\_loss = 0
436         total\_ok = 0
437         num\_examples = 0
438         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0, len(context\_encoded), 100):
439             \textcolor{keywordflow}{if} i + 100 > len(context\_encoded):
440                 \textcolor{keywordflow}{break}
441             num\_examples += 100
442             loss, num\_correct = self.evaluate\_one\_batch(
443                 context\_encoded[i : i + 100, :], captions\_encoded[i : i + 100, :]
444             )
445             total\_loss += loss.data.cpu().item()
446             total\_ok += num\_correct.data.cpu().item()
447         \textcolor{keywordflow}{return} total\_loss, total\_ok, num\_examples
448 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aeabd7be189bc8127923aa8b424615110}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aeabd7be189bc8127923aa8b424615110}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!evaluate\+\_\+one\+\_\+batch@{evaluate\+\_\+one\+\_\+batch}}
\index{evaluate\+\_\+one\+\_\+batch@{evaluate\+\_\+one\+\_\+batch}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{evaluate\+\_\+one\+\_\+batch()}{evaluate\_one\_batch()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+evaluate\+\_\+one\+\_\+batch (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{context\+\_\+encoded,  }\item[{}]{captions\+\_\+encoded,  }\item[{}]{during\+\_\+train = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute loss - and number of correct examples - for one batch.

:param context_encoded:
    the encoded context
:param captions_encoded:
    the encoded captions
:param during_train:
    true if training, else False

:return:
    the batch loss and the number of correct examples
\end{DoxyVerb}
 

Definition at line 449 of file modules.\+py.


\begin{DoxyCode}
449     \textcolor{keyword}{def }evaluate\_one\_batch(self, context\_encoded, captions\_encoded, during\_train=False):
450         \textcolor{stringliteral}{"""}
451 \textcolor{stringliteral}{        Compute loss - and number of correct examples - for one batch.}
452 \textcolor{stringliteral}{}
453 \textcolor{stringliteral}{        :param context\_encoded:}
454 \textcolor{stringliteral}{            the encoded context}
455 \textcolor{stringliteral}{        :param captions\_encoded:}
456 \textcolor{stringliteral}{            the encoded captions}
457 \textcolor{stringliteral}{        :param during\_train:}
458 \textcolor{stringliteral}{            true if training, else False}
459 \textcolor{stringliteral}{}
460 \textcolor{stringliteral}{        :return:}
461 \textcolor{stringliteral}{            the batch loss and the number of correct examples}
462 \textcolor{stringliteral}{        """}
463         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} during\_train:
464             self.zero\_grad()
465             self.eval()
466         dot\_products = context\_encoded.mm(captions\_encoded.t())
467         log\_prob = torch.nn.functional.log\_softmax(dot\_products, dim=1)
468         targets = torch.arange(0, len(context\_encoded), dtype=torch.long)
469         \textcolor{keywordflow}{if} self.use\_cuda:
470             targets = targets.cuda()
471         loss = torch.nn.functional.nll\_loss(log\_prob, targets)
472         num\_correct = (log\_prob.max(dim=1)[1] == targets).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().sum()
473         \textcolor{keywordflow}{return} loss, num\_correct
474 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a1a0d7d70271cf1cb881f3166bfd7bf10}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a1a0d7d70271cf1cb881f3166bfd7bf10}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!forward@{forward}}
\index{forward@{forward}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image\+\_\+features,  }\item[{}]{personalities,  }\item[{}]{captions,  }\item[{}]{personalities\+\_\+tensor = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Model forward pass.

:param image_features:
    list of tensors of image features, one per example
:param personalities:
    list of personalities, one per example
:param captions:
    list of captions, one per example
:param personalities_tensor:
    (optional) list of personality representations, usually a one-hot
    vector if specified

:return:
    the encoded context and the encoded captions.
\end{DoxyVerb}
 

Definition at line 215 of file modules.\+py.


\begin{DoxyCode}
215     ):
216         \textcolor{stringliteral}{"""}
217 \textcolor{stringliteral}{        Model forward pass.}
218 \textcolor{stringliteral}{}
219 \textcolor{stringliteral}{        :param image\_features:}
220 \textcolor{stringliteral}{            list of tensors of image features, one per example}
221 \textcolor{stringliteral}{        :param personalities:}
222 \textcolor{stringliteral}{            list of personalities, one per example}
223 \textcolor{stringliteral}{        :param captions:}
224 \textcolor{stringliteral}{            list of captions, one per example}
225 \textcolor{stringliteral}{        :param personalities\_tensor:}
226 \textcolor{stringliteral}{            (optional) list of personality representations, usually a one-hot}
227 \textcolor{stringliteral}{            vector if specified}
228 \textcolor{stringliteral}{}
229 \textcolor{stringliteral}{        :return:}
230 \textcolor{stringliteral}{            the encoded context and the encoded captions.}
231 \textcolor{stringliteral}{        """}
232         captions\_encoded = \textcolor{keywordtype}{None}
233         context\_encoded = \textcolor{keywordtype}{None}
234         img\_encoded = \textcolor{keywordtype}{None}
235 
236         \textcolor{comment}{# encode captions}
237         \textcolor{keywordflow}{if} captions \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
238             indexes, mask = self.captions\_to\_tensor(captions)
239             captions\_encoded = self.text\_encoder(indexes)
240             \textcolor{keywordflow}{if} self.text\_encoder\_frozen:
241                 captions\_encoded = captions\_encoded.detach()
242             captions\_encoded = self.additional\_layer(captions\_encoded)
243 
244         \textcolor{comment}{# encode personalities}
245         pers\_encoded = self.forward\_personality(personalities, personalities\_tensor)
246 
247         \textcolor{comment}{# encode images}
248         img\_encoded = self.forward\_image(image\_features)
249 
250         context\_encoded = self.sum\_encodings([pers\_encoded, img\_encoded])
251         \textcolor{keywordflow}{return} context\_encoded, captions\_encoded
252 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aee5f9d98e2c82024cc76dd1227c63f9e}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aee5f9d98e2c82024cc76dd1227c63f9e}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!forward\+\_\+image@{forward\+\_\+image}}
\index{forward\+\_\+image@{forward\+\_\+image}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{forward\+\_\+image()}{forward\_image()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+forward\+\_\+image (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image\+\_\+features }\end{DoxyParamCaption})}

\begin{DoxyVerb}Encode image features.

:param image_features:
    list of image features

:return:
    encoded representation of the image features
\end{DoxyVerb}
 

Definition at line 284 of file modules.\+py.


\begin{DoxyCode}
284     \textcolor{keyword}{def }forward\_image(self, image\_features):
285         \textcolor{stringliteral}{"""}
286 \textcolor{stringliteral}{        Encode image features.}
287 \textcolor{stringliteral}{}
288 \textcolor{stringliteral}{        :param image\_features:}
289 \textcolor{stringliteral}{            list of image features}
290 \textcolor{stringliteral}{}
291 \textcolor{stringliteral}{        :return:}
292 \textcolor{stringliteral}{            encoded representation of the image features}
293 \textcolor{stringliteral}{        """}
294         img\_encoded = \textcolor{keywordtype}{None}
295         \textcolor{keywordflow}{if} image\_features \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
296             stacked = torch.stack(image\_features)
297             \textcolor{keywordflow}{if} self.use\_cuda:
298                 stacked = stacked.cuda()
299             img\_encoded = self.image\_encoder(stacked)
300 
301         \textcolor{keywordflow}{return} img\_encoded
302 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5d48e4824c4b82e8c7eb25431952e988}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a5d48e4824c4b82e8c7eb25431952e988}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!forward\+\_\+personality@{forward\+\_\+personality}}
\index{forward\+\_\+personality@{forward\+\_\+personality}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{forward\+\_\+personality()}{forward\_personality()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+forward\+\_\+personality (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{personalities,  }\item[{}]{personalities\+\_\+tensor }\end{DoxyParamCaption})}

\begin{DoxyVerb}Encode personalities.

:param personalities:
    list of personalities, one per example
:param personalities_tensor:
    (optional) list of personality representations, usually a one-hot
    vector if specified

:return:
    encoded representation of the personalities
\end{DoxyVerb}
 

Definition at line 253 of file modules.\+py.


\begin{DoxyCode}
253     \textcolor{keyword}{def }forward\_personality(self, personalities, personalities\_tensor):
254         \textcolor{stringliteral}{"""}
255 \textcolor{stringliteral}{        Encode personalities.}
256 \textcolor{stringliteral}{}
257 \textcolor{stringliteral}{        :param personalities:}
258 \textcolor{stringliteral}{            list of personalities, one per example}
259 \textcolor{stringliteral}{        :param personalities\_tensor:}
260 \textcolor{stringliteral}{            (optional) list of personality representations, usually a one-hot}
261 \textcolor{stringliteral}{            vector if specified}
262 \textcolor{stringliteral}{}
263 \textcolor{stringliteral}{        :return:}
264 \textcolor{stringliteral}{            encoded representation of the personalities}
265 \textcolor{stringliteral}{        """}
266         pers\_encoded = \textcolor{keywordtype}{None}
267         \textcolor{keywordflow}{if} personalities \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
268             \textcolor{keywordflow}{if} personalities\_tensor \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
269                 pers\_feature = personalities\_tensor
270             \textcolor{keywordflow}{else}:
271                 res = torch.FloatTensor(
272                     len(personalities), self.num\_personalities
273                 ).fill\_(0)
274                 p\_to\_i = self.personalities\_to\_index(personalities)
275                 \textcolor{keywordflow}{for} i, index \textcolor{keywordflow}{in} enumerate(p\_to\_i):
276                     res[i, index] = 1  \textcolor{comment}{# no personality corresponds to 0}
277                 \textcolor{keywordflow}{if} self.use\_cuda:
278                     res = res.cuda()
279                 pers\_feature = res
280             pers\_encoded = self.personality\_encoder(pers\_feature)
281 
282         \textcolor{keywordflow}{return} pers\_encoded
283 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aace67e437e969262f0173158743e74ce}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aace67e437e969262f0173158743e74ce}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!freeze\+\_\+text\+\_\+encoder@{freeze\+\_\+text\+\_\+encoder}}
\index{freeze\+\_\+text\+\_\+encoder@{freeze\+\_\+text\+\_\+encoder}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{freeze\+\_\+text\+\_\+encoder()}{freeze\_text\_encoder()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+freeze\+\_\+text\+\_\+encoder (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Freeze the text (candidate) encoder.
\end{DoxyVerb}
 

Definition at line 475 of file modules.\+py.


\begin{DoxyCode}
475     \textcolor{keyword}{def }freeze\_text\_encoder(self):
476         \textcolor{stringliteral}{"""}
477 \textcolor{stringliteral}{        Freeze the text (candidate) encoder.}
478 \textcolor{stringliteral}{        """}
479         self.text\_encoder\_frozen = \textcolor{keyword}{True}
480 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a3d8ccc4b989803cc17f5976730016c6c}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a3d8ccc4b989803cc17f5976730016c6c}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!personalities\+\_\+to\+\_\+index@{personalities\+\_\+to\+\_\+index}}
\index{personalities\+\_\+to\+\_\+index@{personalities\+\_\+to\+\_\+index}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{personalities\+\_\+to\+\_\+index()}{personalities\_to\_index()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+personalities\+\_\+to\+\_\+index (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{personalities }\end{DoxyParamCaption})}

\begin{DoxyVerb}Map personalities to their index in the personality dictionary.

:param personalities:
    list of personalities

:return:
    list of personality ids
\end{DoxyVerb}
 

Definition at line 500 of file modules.\+py.


\begin{DoxyCode}
500     \textcolor{keyword}{def }personalities\_to\_index(self, personalities):
501         \textcolor{stringliteral}{"""}
502 \textcolor{stringliteral}{        Map personalities to their index in the personality dictionary.}
503 \textcolor{stringliteral}{}
504 \textcolor{stringliteral}{        :param personalities:}
505 \textcolor{stringliteral}{            list of personalities}
506 \textcolor{stringliteral}{}
507 \textcolor{stringliteral}{        :return:}
508 \textcolor{stringliteral}{            list of personality ids}
509 \textcolor{stringliteral}{        """}
510         res = []
511         \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} personalities:
512             \textcolor{keywordflow}{if} p \textcolor{keywordflow}{in} self.personality\_to\_id:
513                 res.append(self.personality\_to\_id[p] + 1)
514             \textcolor{keywordflow}{else}:
515                 res.append(0)
516         \textcolor{keywordflow}{return} res
517 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a7e2f89c5290e2b0b13dd0891a07d761d}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a7e2f89c5290e2b0b13dd0891a07d761d}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!sum\+\_\+encodings@{sum\+\_\+encodings}}
\index{sum\+\_\+encodings@{sum\+\_\+encodings}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{sum\+\_\+encodings()}{sum\_encodings()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+sum\+\_\+encodings (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{addends }\end{DoxyParamCaption})}

\begin{DoxyVerb}Add up a list of encodings, some of which may be `None`.

:param addends:
    tensors to add

:return:
    sum of non-`None` addends
\end{DoxyVerb}
 

Definition at line 487 of file modules.\+py.


\begin{DoxyCode}
487     \textcolor{keyword}{def }sum\_encodings(self, addends):
488         \textcolor{stringliteral}{"""}
489 \textcolor{stringliteral}{        Add up a list of encodings, some of which may be `None`.}
490 \textcolor{stringliteral}{}
491 \textcolor{stringliteral}{        :param addends:}
492 \textcolor{stringliteral}{            tensors to add}
493 \textcolor{stringliteral}{}
494 \textcolor{stringliteral}{        :return:}
495 \textcolor{stringliteral}{            sum of non-`None` addends}
496 \textcolor{stringliteral}{        """}
497         addends = [a \textcolor{keywordflow}{for} a \textcolor{keywordflow}{in} addends \textcolor{keywordflow}{if} a \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}]
498         \textcolor{keywordflow}{return} sum(addends) \textcolor{keywordflow}{if} len(addends) > 0 \textcolor{keywordflow}{else} \textcolor{keywordtype}{None}
499 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a65f01ee6cdfb2d516e1e9be77e3d141a}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a65f01ee6cdfb2d516e1e9be77e3d141a}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!train\+\_\+batch@{train\+\_\+batch}}
\index{train\+\_\+batch@{train\+\_\+batch}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{train\+\_\+batch()}{train\_batch()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+train\+\_\+batch (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{image\+\_\+features,  }\item[{}]{personalities,  }\item[{}]{captions }\end{DoxyParamCaption})}

\begin{DoxyVerb}Batch train on a set of examples.

Uses captions from other examples as negatives during training

:param image_features:
    list of tensors of image features
:param personalities:
    list of personalities
:param captions:
    list of captions

:return:
    the total loss, the number of correct examples, and the number of
    examples trained on
\end{DoxyVerb}
 

Definition at line 303 of file modules.\+py.


\begin{DoxyCode}
303     \textcolor{keyword}{def }train\_batch(self, image\_features, personalities, captions):
304         \textcolor{stringliteral}{"""}
305 \textcolor{stringliteral}{        Batch train on a set of examples.}
306 \textcolor{stringliteral}{}
307 \textcolor{stringliteral}{        Uses captions from other examples as negatives during training}
308 \textcolor{stringliteral}{}
309 \textcolor{stringliteral}{        :param image\_features:}
310 \textcolor{stringliteral}{            list of tensors of image features}
311 \textcolor{stringliteral}{        :param personalities:}
312 \textcolor{stringliteral}{            list of personalities}
313 \textcolor{stringliteral}{        :param captions:}
314 \textcolor{stringliteral}{            list of captions}
315 \textcolor{stringliteral}{}
316 \textcolor{stringliteral}{        :return:}
317 \textcolor{stringliteral}{            the total loss, the number of correct examples, and the number of}
318 \textcolor{stringliteral}{            examples trained on}
319 \textcolor{stringliteral}{        """}
320         self.zero\_grad()
321         self.train()
322         context\_encoded, captions\_encoded = self.forward(
323             image\_features, personalities, captions
324         )
325         loss, num\_correct = self.evaluate\_one\_batch(
326             context\_encoded, captions\_encoded, during\_train=\textcolor{keyword}{True}
327         )
328         loss.backward()
329         self.optimizer.step()
330 
331         \textcolor{comment}{# re-run forward pass to compute hits@1 metrics}
332         loss, num\_correct, num\_examples = self.eval\_batch\_of\_100(
333             context\_encoded, captions\_encoded
334         )
335         \textcolor{keywordflow}{return} loss, num\_correct, num\_examples
336 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a7a9e68b5978bb8b9c681a9ce0015d3c3}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a7a9e68b5978bb8b9c681a9ce0015d3c3}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!unfreeze\+\_\+text\+\_\+encoder@{unfreeze\+\_\+text\+\_\+encoder}}
\index{unfreeze\+\_\+text\+\_\+encoder@{unfreeze\+\_\+text\+\_\+encoder}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{unfreeze\+\_\+text\+\_\+encoder()}{unfreeze\_text\_encoder()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+unfreeze\+\_\+text\+\_\+encoder (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Unfreeze the text (candidate) encoder.
\end{DoxyVerb}
 

Definition at line 481 of file modules.\+py.


\begin{DoxyCode}
481     \textcolor{keyword}{def }unfreeze\_text\_encoder(self):
482         \textcolor{stringliteral}{"""}
483 \textcolor{stringliteral}{        Unfreeze the text (candidate) encoder.}
484 \textcolor{stringliteral}{        """}
485         self.text\_encoder\_frozen = \textcolor{keyword}{False}
486 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a3f25e3353c49c641266546dfd7bb086a}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a3f25e3353c49c641266546dfd7bb086a}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!additional\+\_\+layer@{additional\+\_\+layer}}
\index{additional\+\_\+layer@{additional\+\_\+layer}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{additional\+\_\+layer}{additional\_layer}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+additional\+\_\+layer}



Definition at line 179 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a92f8c4f0826beac705e067625611a582}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a92f8c4f0826beac705e067625611a582}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!dictionary@{dictionary}}
\index{dictionary@{dictionary}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{dictionary}{dictionary}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+dictionary}



Definition at line 104 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a6bee1d7005766287de3088b0b50278dd}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a6bee1d7005766287de3088b0b50278dd}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!embeddings@{embeddings}}
\index{embeddings@{embeddings}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{embeddings}{embeddings}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+embeddings}



Definition at line 149 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aec6603866302a777495b211be700d57c}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_aec6603866302a777495b211be700d57c}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!image\+\_\+encoder@{image\+\_\+encoder}}
\index{image\+\_\+encoder@{image\+\_\+encoder}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{image\+\_\+encoder}{image\_encoder}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+image\+\_\+encoder}



Definition at line 203 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a11a6c307a016a1112fe6ddb9b55f4dbf}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a11a6c307a016a1112fe6ddb9b55f4dbf}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!num\+\_\+personalities@{num\+\_\+personalities}}
\index{num\+\_\+personalities@{num\+\_\+personalities}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{num\+\_\+personalities}{num\_personalities}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+num\+\_\+personalities}



Definition at line 140 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a13919d02a75fa59aebcd81ac27c133f2}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a13919d02a75fa59aebcd81ac27c133f2}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!opt@{opt}}
\index{opt@{opt}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+opt}



Definition at line 103 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a8c4101b9ed0f557efba9480bc6b40a4c}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a8c4101b9ed0f557efba9480bc6b40a4c}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+optimizer}



Definition at line 126 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a166e8e99f9976b3774343ddc15a14fc7}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a166e8e99f9976b3774343ddc15a14fc7}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!personalities\+\_\+list@{personalities\+\_\+list}}
\index{personalities\+\_\+list@{personalities\+\_\+list}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{personalities\+\_\+list}{personalities\_list}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+personalities\+\_\+list}



Definition at line 138 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a973e61da77569c929fb41e8868f26850}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a973e61da77569c929fb41e8868f26850}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!personality\+\_\+encoder@{personality\+\_\+encoder}}
\index{personality\+\_\+encoder@{personality\+\_\+encoder}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{personality\+\_\+encoder}{personality\_encoder}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+personality\+\_\+encoder}



Definition at line 211 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a37a1d2274c4ec9a990f95f2434d05bb5}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_a37a1d2274c4ec9a990f95f2434d05bb5}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!personality\+\_\+to\+\_\+id@{personality\+\_\+to\+\_\+id}}
\index{personality\+\_\+to\+\_\+id@{personality\+\_\+to\+\_\+id}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{personality\+\_\+to\+\_\+id}{personality\_to\_id}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+personality\+\_\+to\+\_\+id}



Definition at line 139 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_adb92caa86a26b054d3dfb0a33c53000d}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_adb92caa86a26b054d3dfb0a33c53000d}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!text\+\_\+encoder@{text\+\_\+encoder}}
\index{text\+\_\+encoder@{text\+\_\+encoder}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{text\+\_\+encoder}{text\_encoder}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+text\+\_\+encoder}



Definition at line 158 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ad8f93156abe79fccfb22f4984c0fe012}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ad8f93156abe79fccfb22f4984c0fe012}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!text\+\_\+encoder\+\_\+frozen@{text\+\_\+encoder\+\_\+frozen}}
\index{text\+\_\+encoder\+\_\+frozen@{text\+\_\+encoder\+\_\+frozen}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{text\+\_\+encoder\+\_\+frozen}{text\_encoder\_frozen}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+text\+\_\+encoder\+\_\+frozen}



Definition at line 111 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ad2d8044f26091f54cc046eae2c897329}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ad2d8044f26091f54cc046eae2c897329}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!truncate\+\_\+length@{truncate\+\_\+length}}
\index{truncate\+\_\+length@{truncate\+\_\+length}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{truncate\+\_\+length}{truncate\_length}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+truncate\+\_\+length}



Definition at line 105 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ac0bab6b8757c151ca060ad7dee9c00a2}\label{classprojects_1_1personality__captions_1_1transresnet_1_1modules_1_1TransresnetModel_ac0bab6b8757c151ca060ad7dee9c00a2}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model@{projects\+::personality\+\_\+captions\+::transresnet\+::modules\+::\+Transresnet\+Model}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+modules.\+Transresnet\+Model.\+use\+\_\+cuda}



Definition at line 102 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/personality\+\_\+captions/transresnet/\hyperlink{projects_2personality__captions_2transresnet_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
