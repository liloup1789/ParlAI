\hypertarget{namespaceparlai_1_1utils_1_1misc}{}\section{parlai.\+utils.\+misc Namespace Reference}
\label{namespaceparlai_1_1utils_1_1misc}\index{parlai.\+utils.\+misc@{parlai.\+utils.\+misc}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1AttrDict}{Attr\+Dict}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1NoLock}{No\+Lock}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1Opt}{Opt}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1PaddingUtils}{Padding\+Utils}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1Predictor}{Predictor}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1TimeLogger}{Time\+Logger}
\item 
class \hyperlink{classparlai_1_1utils_1_1misc_1_1Timer}{Timer}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a68c44ca571de7149b683539db659c330}{neginf} (dtype)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_ac8ca45e62ca906d9b6e5026588a5d2a2}{maintain\+\_\+dialog\+\_\+history} (history, observation, reply=\textquotesingle{}\textquotesingle{}, history\+Length=1, use\+Replies=\textquotesingle{}label\+\_\+else\+\_\+model\textquotesingle{}, dict=None, use\+Start\+End\+Indices=True, split\+Sentences=False)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_ad935ab0a9d49b897c5e3efdbe1c46c4d}{load\+\_\+cands} (path, lines\+\_\+have\+\_\+ids=False, cands\+\_\+are\+\_\+replies=False)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a7c97ef3250327bc549ac652a481be0cf}{load\+\_\+opt\+\_\+file} (optfile)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_af245c261b10f36175f6d88fce852c552}{round\+\_\+sigfigs} (x, sigfigs=4)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a38a23cfa0fc3dbed42846787d1c04b57}{no\+\_\+lock} ()
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a219b248f4399036a381ca859aa97433e}{clip\+\_\+text} (text, max\+\_\+len)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a146f303a4c4b34993458968c74b55d2f}{display\+\_\+messages} (msgs, prettify=False, ignore\+\_\+fields=\textquotesingle{}\textquotesingle{}, max\+\_\+len=1000)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a1b053cd9c56e6fa79b058fff587b3a48}{str\+\_\+to\+\_\+msg} (txt, ignore\+\_\+fields=\textquotesingle{}\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_ae5db473b41d3b49814e2566e866282b6}{msg\+\_\+to\+\_\+str} (msg, ignore\+\_\+fields=\textquotesingle{}\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a8781cc03272b3a118fcd9e5a9f4ca1dd}{set\+\_\+namedtuple\+\_\+defaults} (namedtuple, default=None)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_ad3f3c350e8b394482f73a240e19ec3ac}{padded\+\_\+tensor} (items, pad\+\_\+idx=0, use\+\_\+cuda=False, left\+\_\+padded=False, max\+\_\+len=None, fp16friendly=False)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_ad96b0c9ef6237d9ca051251089faf2c7}{padded\+\_\+3d} (tensors, pad\+\_\+idx=0, use\+\_\+cuda=0, dtype=\hyperlink{namespaceparlai_1_1utils_1_1misc_ac49ec9bcd5fe586085eb9fab8f40fdb5}{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}, fp16friendly=False)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a9e330c9119522333c738a3175e0b4396}{argsort} (keys, lists, descending=False)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_acf146e70ea7f6867969a7c2b545d4b4b}{warn\+\_\+once} (msg, warningtype=None)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1misc_a7836ac7469dc5744e0ad9e5e54da2396}{fp16\+\_\+optimizer\+\_\+wrapper} (optimizer, verbose=False, dynamic\+\_\+loss\+\_\+scale=True, loss\+\_\+initial\+\_\+scale=2.\+0 $\ast$$\ast$17)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1misc_ac49ec9bcd5fe586085eb9fab8f40fdb5}{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1misc_a8e586e6abf9e695442a00ac47424ad31}{N\+E\+A\+R\+\_\+\+I\+NF}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1misc_affd7d3c0575a748a52a66e092fb31a35}{N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1misc_a122146c75d0e6910340a6a851d097bdc}{D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1misc_a5d6ad7f3aef96f16bb9060f5a41fc39b}{single\+\_\+nolock}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a9e330c9119522333c738a3175e0b4396}\label{namespaceparlai_1_1utils_1_1misc_a9e330c9119522333c738a3175e0b4396}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!argsort@{argsort}}
\index{argsort@{argsort}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{argsort()}{argsort()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+argsort (\begin{DoxyParamCaption}\item[{}]{keys,  }\item[{}]{lists,  }\item[{}]{descending = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reorder each list in lists by the (descending) sorted order of keys.

:param iter keys:
    Keys to order by.
:param list[list] lists:
    Lists to reordered by keys's order.  Correctly handles lists and 1-D
    tensors.
:param bool descending:
    Use descending order if true.

:returns:
    The reordered items.
\end{DoxyVerb}
 

Definition at line 1033 of file misc.\+py.


\begin{DoxyCode}
1033 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a9e330c9119522333c738a3175e0b4396}{argsort}(keys, *lists, descending=False):
1034     \textcolor{stringliteral}{"""}
1035 \textcolor{stringliteral}{    Reorder each list in lists by the (descending) sorted order of keys.}
1036 \textcolor{stringliteral}{}
1037 \textcolor{stringliteral}{    :param iter keys:}
1038 \textcolor{stringliteral}{        Keys to order by.}
1039 \textcolor{stringliteral}{    :param list[list] lists:}
1040 \textcolor{stringliteral}{        Lists to reordered by keys's order.  Correctly handles lists and 1-D}
1041 \textcolor{stringliteral}{        tensors.}
1042 \textcolor{stringliteral}{    :param bool descending:}
1043 \textcolor{stringliteral}{        Use descending order if true.}
1044 \textcolor{stringliteral}{}
1045 \textcolor{stringliteral}{    :returns:}
1046 \textcolor{stringliteral}{        The reordered items.}
1047 \textcolor{stringliteral}{    """}
1048     ind\_sorted = sorted(range(len(keys)), key=\textcolor{keyword}{lambda} k: keys[k])
1049     \textcolor{keywordflow}{if} descending:
1050         ind\_sorted = list(reversed(ind\_sorted))
1051     output = []
1052     \textcolor{keywordflow}{for} lst \textcolor{keywordflow}{in} lists:
1053         \textcolor{comment}{# watch out in case we don't have torch installed}
1054         \textcolor{keywordflow}{if} \_\_TORCH\_AVAILABLE \textcolor{keywordflow}{and} isinstance(lst, torch.Tensor):
1055             output.append(lst[ind\_sorted])
1056         \textcolor{keywordflow}{else}:
1057             output.append([lst[i] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} ind\_sorted])
1058     \textcolor{keywordflow}{return} output
1059 
1060 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a219b248f4399036a381ca859aa97433e}\label{namespaceparlai_1_1utils_1_1misc_a219b248f4399036a381ca859aa97433e}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!clip\+\_\+text@{clip\+\_\+text}}
\index{clip\+\_\+text@{clip\+\_\+text}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{clip\+\_\+text()}{clip\_text()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+clip\+\_\+text (\begin{DoxyParamCaption}\item[{}]{text,  }\item[{}]{max\+\_\+len }\end{DoxyParamCaption})}

\begin{DoxyVerb}Clip text to max length, adding ellipses.
\end{DoxyVerb}
 

Definition at line 682 of file misc.\+py.


\begin{DoxyCode}
682 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a219b248f4399036a381ca859aa97433e}{clip\_text}(text, max\_len):
683     \textcolor{stringliteral}{"""}
684 \textcolor{stringliteral}{    Clip text to max length, adding ellipses.}
685 \textcolor{stringliteral}{    """}
686     \textcolor{keywordflow}{if} len(text) > max\_len:
687         begin\_text = \textcolor{stringliteral}{' '}.join(text[: math.floor(0.8 * max\_len)].split(\textcolor{stringliteral}{' '})[:-1])
688         end\_text = \textcolor{stringliteral}{' '}.join(
689             text[(len(text) - math.floor(0.2 * max\_len)) :].split(\textcolor{stringliteral}{' '})[1:]
690         )
691         \textcolor{keywordflow}{if} len(end\_text) > 0:
692             text = begin\_text + \textcolor{stringliteral}{' ...\(\backslash\)n'} + end\_text
693         \textcolor{keywordflow}{else}:
694             text = begin\_text + \textcolor{stringliteral}{' ...'}
695     \textcolor{keywordflow}{return} text
696 
697 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a146f303a4c4b34993458968c74b55d2f}\label{namespaceparlai_1_1utils_1_1misc_a146f303a4c4b34993458968c74b55d2f}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!display\+\_\+messages@{display\+\_\+messages}}
\index{display\+\_\+messages@{display\+\_\+messages}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{display\+\_\+messages()}{display\_messages()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+display\+\_\+messages (\begin{DoxyParamCaption}\item[{}]{msgs,  }\item[{}]{prettify = {\ttfamily False},  }\item[{}]{ignore\+\_\+fields = {\ttfamily \textquotesingle{}\textquotesingle{}},  }\item[{}]{max\+\_\+len = {\ttfamily 1000} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return a string describing the set of messages provided.

If prettify is true, candidates are displayed using prettytable. ignore_fields
provides a list of fields in the msgs which should not be displayed.
\end{DoxyVerb}
 

Definition at line 716 of file misc.\+py.


\begin{DoxyCode}
716 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a146f303a4c4b34993458968c74b55d2f}{display\_messages}(msgs, prettify=False, ignore\_fields='', max\_len=1000):
717     \textcolor{stringliteral}{"""}
718 \textcolor{stringliteral}{    Return a string describing the set of messages provided.}
719 \textcolor{stringliteral}{}
720 \textcolor{stringliteral}{    If prettify is true, candidates are displayed using prettytable. ignore\_fields}
721 \textcolor{stringliteral}{    provides a list of fields in the msgs which should not be displayed.}
722 \textcolor{stringliteral}{    """}
723 
724     \textcolor{keyword}{def }\_token\_losses\_line(
725         msg: Dict[str, Any], ignore\_fields: List[str], space: str
726     ) -> str:
727         \textcolor{stringliteral}{"""}
728 \textcolor{stringliteral}{        Displays the loss associated with each token. Can be used for debugging}
729 \textcolor{stringliteral}{        generative models.}
730 \textcolor{stringliteral}{}
731 \textcolor{stringliteral}{        See TorchGeneratorAgent.\_construct\_token\_losses for an example implementation.}
732 \textcolor{stringliteral}{        """}
733         key = \textcolor{stringliteral}{'token\_losses'}
734         token\_losses = msg.get(key, \textcolor{keywordtype}{None})
735         \textcolor{keywordflow}{if} key \textcolor{keywordflow}{in} ignore\_fields \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} token\_losses:
736             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
737         \textcolor{comment}{# Reduce losses to 4 significant figures}
738         formatted\_tl = \textcolor{stringliteral}{' | '}.join(
739             [f\textcolor{stringliteral}{"\{tl[0]\} \{float('\{:.4g\}'.format(tl[1]))\}"} \textcolor{keywordflow}{for} tl \textcolor{keywordflow}{in} token\_losses]
740         )
741         \textcolor{keywordflow}{return} f\textcolor{stringliteral}{'\{space\}[\{key\}]: \{formatted\_tl\}'}
742 
743     lines = []
744     episode\_done = \textcolor{keyword}{False}
745     ignore\_fields = ignore\_fields.split(\textcolor{stringliteral}{','})
746     \textcolor{keywordflow}{for} index, msg \textcolor{keywordflow}{in} enumerate(msgs):
747         \textcolor{keywordflow}{if} msg \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} (index == 1 \textcolor{keywordflow}{and} \textcolor{stringliteral}{'agent\_reply'} \textcolor{keywordflow}{in} ignore\_fields):
748             \textcolor{comment}{# We only display the first agent (typically the teacher) if we}
749             \textcolor{comment}{# are ignoring the agent reply.}
750             \textcolor{keywordflow}{continue}
751         \textcolor{keywordflow}{if} msg.get(\textcolor{stringliteral}{'episode\_done'}):
752             episode\_done = \textcolor{keyword}{True}
753         \textcolor{comment}{# Possibly indent the text (for the second speaker, if two).}
754         space = \textcolor{stringliteral}{''}
755         \textcolor{keywordflow}{if} len(msgs) == 2 \textcolor{keywordflow}{and} index == 1:
756             space = \textcolor{stringliteral}{'   '}
757         \textcolor{comment}{# Only display rewards !=0 as they are confusing in non-RL tasks.}
758         \textcolor{keywordflow}{if} msg.get(\textcolor{stringliteral}{'reward'}, 0) != 0:
759             lines.append(space + \textcolor{stringliteral}{'[reward: \{r\}]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(r=msg[\textcolor{stringliteral}{'reward'}]))
760         \textcolor{keywordflow}{for} key \textcolor{keywordflow}{in} msg:
761             \textcolor{keywordflow}{if} key \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} DISPLAY\_MESSAGE\_DEFAULT\_FIELDS \textcolor{keywordflow}{and} key \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} ignore\_fields:
762                 \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(msg[key]) \textcolor{keywordflow}{is} list:
763                     line = \textcolor{stringliteral}{'['} + key + \textcolor{stringliteral}{']:\(\backslash\)n  '} + \_ellipse(msg[key], sep=\textcolor{stringliteral}{'\(\backslash\)n  '})
764                 \textcolor{keywordflow}{else}:
765                     line = \textcolor{stringliteral}{'['} + key + \textcolor{stringliteral}{']: '} + \hyperlink{namespaceparlai_1_1utils_1_1misc_a219b248f4399036a381ca859aa97433e}{clip\_text}(\hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(msg.get(key)), max\_len)
766                 lines.append(space + line)
767         \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(msg.get(\textcolor{stringliteral}{'image'})) == str:
768             lines.append(msg[\textcolor{stringliteral}{'image'}])
769         \textcolor{keywordflow}{if} msg.get(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{''}):
770             text = \hyperlink{namespaceparlai_1_1utils_1_1misc_a219b248f4399036a381ca859aa97433e}{clip\_text}(msg[\textcolor{stringliteral}{'text'}], max\_len)
771             ID = \textcolor{stringliteral}{'['} + msg[\textcolor{stringliteral}{'id'}] + \textcolor{stringliteral}{']: '} \textcolor{keywordflow}{if} \textcolor{stringliteral}{'id'} \textcolor{keywordflow}{in} msg \textcolor{keywordflow}{else} \textcolor{stringliteral}{''}
772             lines.append(space + ID + text)
773         \textcolor{keywordflow}{for} field \textcolor{keywordflow}{in} \{\textcolor{stringliteral}{'labels'}, \textcolor{stringliteral}{'eval\_labels'}, \textcolor{stringliteral}{'label\_candidates'}, \textcolor{stringliteral}{'text\_candidates'}\}:
774             \textcolor{keywordflow}{if} msg.get(field) \textcolor{keywordflow}{and} field \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} ignore\_fields:
775                 lines.append(\textcolor{stringliteral}{'\{\}[\{\}: \{\}]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(space, field, \_ellipse(msg[field])))
776         \textcolor{comment}{# Handling this separately since we need to clean up the raw output before displaying.}
777         token\_loss\_line = \_token\_losses\_line(msg, ignore\_fields, space)
778         \textcolor{keywordflow}{if} token\_loss\_line:
779             lines.append(token\_loss\_line)
780 
781     \textcolor{keywordflow}{if} episode\_done:
782         lines.append(\textcolor{stringliteral}{'- - - - - - - - - - - - - - - - - - - - -'})
783 
784     \textcolor{keywordflow}{return} \textcolor{stringliteral}{'\(\backslash\)n'}.join(lines)
785 
786 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a7836ac7469dc5744e0ad9e5e54da2396}\label{namespaceparlai_1_1utils_1_1misc_a7836ac7469dc5744e0ad9e5e54da2396}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!fp16\+\_\+optimizer\+\_\+wrapper@{fp16\+\_\+optimizer\+\_\+wrapper}}
\index{fp16\+\_\+optimizer\+\_\+wrapper@{fp16\+\_\+optimizer\+\_\+wrapper}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{fp16\+\_\+optimizer\+\_\+wrapper()}{fp16\_optimizer\_wrapper()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+fp16\+\_\+optimizer\+\_\+wrapper (\begin{DoxyParamCaption}\item[{}]{optimizer,  }\item[{}]{verbose = {\ttfamily False},  }\item[{}]{dynamic\+\_\+loss\+\_\+scale = {\ttfamily True},  }\item[{}]{loss\+\_\+initial\+\_\+scale = {\ttfamily 2.0~$\ast$$\ast$~17} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Wrap the an optimizer with FP16 loss scaling protection.

Requires apex to be installed. Will throw an ImportError if it is not.

:param optimizer:
    Any torch optimizer
:param bool verbose:
    Enables verbose output in the FP16 optimizer. Turning this on can help
    debug when FP16 is underperforming.
:param bool dynamic_loss_scaling:
    FP16 requires loss scaling to avoid underflows. It is recommended this
    stays on, but advanced users may want it off.
:param float loss_initial_scale:
    Initial loss scaling. Default chosen empirically, but models with very low
    or high loss values may need this adjusted. Stick with powers of 2.

:returns:
    An APEX FP16 optimizer. Please note this has different requirements on
    how backward() and step() are called.
\end{DoxyVerb}
 

Definition at line 1079 of file misc.\+py.


\begin{DoxyCode}
1079 ):
1080     \textcolor{stringliteral}{"""}
1081 \textcolor{stringliteral}{    Wrap the an optimizer with FP16 loss scaling protection.}
1082 \textcolor{stringliteral}{}
1083 \textcolor{stringliteral}{    Requires apex to be installed. Will throw an ImportError if it is not.}
1084 \textcolor{stringliteral}{}
1085 \textcolor{stringliteral}{    :param optimizer:}
1086 \textcolor{stringliteral}{        Any torch optimizer}
1087 \textcolor{stringliteral}{    :param bool verbose:}
1088 \textcolor{stringliteral}{        Enables verbose output in the FP16 optimizer. Turning this on can help}
1089 \textcolor{stringliteral}{        debug when FP16 is underperforming.}
1090 \textcolor{stringliteral}{    :param bool dynamic\_loss\_scaling:}
1091 \textcolor{stringliteral}{        FP16 requires loss scaling to avoid underflows. It is recommended this}
1092 \textcolor{stringliteral}{        stays on, but advanced users may want it off.}
1093 \textcolor{stringliteral}{    :param float loss\_initial\_scale:}
1094 \textcolor{stringliteral}{        Initial loss scaling. Default chosen empirically, but models with very low}
1095 \textcolor{stringliteral}{        or high loss values may need this adjusted. Stick with powers of 2.}
1096 \textcolor{stringliteral}{}
1097 \textcolor{stringliteral}{    :returns:}
1098 \textcolor{stringliteral}{        An APEX FP16 optimizer. Please note this has different requirements on}
1099 \textcolor{stringliteral}{        how backward() and step() are called.}
1100 \textcolor{stringliteral}{    """}
1101     \textcolor{keywordflow}{try}:
1102         \textcolor{keyword}{import} apex.fp16\_utils
1103     \textcolor{keywordflow}{except} ImportError:
1104         \textcolor{keywordflow}{raise} ImportError(
1105             \textcolor{stringliteral}{'No fp16 support without apex. Please install it from '}
1106             \textcolor{stringliteral}{'https://github.com/NVIDIA/apex'}
1107         )
1108     \textcolor{keywordflow}{return} apex.fp16\_utils.FP16\_Optimizer(
1109         optimizer,
1110         dynamic\_loss\_scale=dynamic\_loss\_scale,
1111         verbose=verbose,
1112         \textcolor{comment}{# TODO: We may later want to remove this flag. Right now it}
1113         \textcolor{comment}{# empirically improves the first few backward passes, but future APEX}
1114         \textcolor{comment}{# improvements may make this unnecessary.}
1115         dynamic\_loss\_args=\{\textcolor{stringliteral}{'init\_scale'}: loss\_initial\_scale\},
1116     )
1117 \end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_ad935ab0a9d49b897c5e3efdbe1c46c4d}\label{namespaceparlai_1_1utils_1_1misc_ad935ab0a9d49b897c5e3efdbe1c46c4d}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!load\+\_\+cands@{load\+\_\+cands}}
\index{load\+\_\+cands@{load\+\_\+cands}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{load\+\_\+cands()}{load\_cands()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+load\+\_\+cands (\begin{DoxyParamCaption}\item[{}]{path,  }\item[{}]{lines\+\_\+have\+\_\+ids = {\ttfamily False},  }\item[{}]{cands\+\_\+are\+\_\+replies = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Load global fixed set of candidate labels that the teacher provides.

Every example will include these as candidates. The true labels for a specific
example are also added to this set, so that it's possible to get the right answer.
\end{DoxyVerb}
 

Definition at line 138 of file misc.\+py.


\begin{DoxyCode}
138 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_ad935ab0a9d49b897c5e3efdbe1c46c4d}{load\_cands}(path, lines\_have\_ids=False, cands\_are\_replies=False):
139     \textcolor{stringliteral}{"""}
140 \textcolor{stringliteral}{    Load global fixed set of candidate labels that the teacher provides.}
141 \textcolor{stringliteral}{}
142 \textcolor{stringliteral}{    Every example will include these as candidates. The true labels for a specific}
143 \textcolor{stringliteral}{    example are also added to this set, so that it's possible to get the right answer.}
144 \textcolor{stringliteral}{    """}
145     \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
146         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
147     cands = []
148     cnt = 0
149     with open(path) \textcolor{keyword}{as} read:
150         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} read:
151             line = line.strip().replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'}, \textcolor{stringliteral}{'\(\backslash\)n'})
152             \textcolor{keywordflow}{if} len(line) > 0:
153                 cnt = cnt + 1
154                 \textcolor{comment}{# If lines are numbered we strip them of numbers.}
155                 \textcolor{keywordflow}{if} cnt == 1 \textcolor{keywordflow}{and} line[0:2] == \textcolor{stringliteral}{'1 '}:
156                     lines\_have\_ids = \textcolor{keyword}{True}
157                 \textcolor{comment}{# If tabs then the label\_candidates are all the replies.}
158                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'\(\backslash\)t'} \textcolor{keywordflow}{in} line \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} cands\_are\_replies:
159                     cands\_are\_replies = \textcolor{keyword}{True}
160                     cands = []
161                 \textcolor{keywordflow}{if} lines\_have\_ids:
162                     space\_idx = line.find(\textcolor{stringliteral}{' '})
163                     line = line[space\_idx + 1 :]
164                     \textcolor{keywordflow}{if} cands\_are\_replies:
165                         sp = line.split(\textcolor{stringliteral}{'\(\backslash\)t'})
166                         \textcolor{keywordflow}{if} len(sp) > 1 \textcolor{keywordflow}{and} sp[1] != \textcolor{stringliteral}{''}:
167                             cands.append(sp[1])
168                     \textcolor{keywordflow}{else}:
169                         cands.append(line)
170                 \textcolor{keywordflow}{else}:
171                     cands.append(line)
172     \textcolor{keywordflow}{return} cands
173 
174 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a7c97ef3250327bc549ac652a481be0cf}\label{namespaceparlai_1_1utils_1_1misc_a7c97ef3250327bc549ac652a481be0cf}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!load\+\_\+opt\+\_\+file@{load\+\_\+opt\+\_\+file}}
\index{load\+\_\+opt\+\_\+file@{load\+\_\+opt\+\_\+file}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{load\+\_\+opt\+\_\+file()}{load\_opt\_file()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+load\+\_\+opt\+\_\+file (\begin{DoxyParamCaption}\item[{}]{optfile }\end{DoxyParamCaption})}

\begin{DoxyVerb}Load an Opt from disk.
\end{DoxyVerb}
 

Definition at line 175 of file misc.\+py.


\begin{DoxyCode}
175 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a7c97ef3250327bc549ac652a481be0cf}{load\_opt\_file}(optfile):
176     \textcolor{stringliteral}{"""}
177 \textcolor{stringliteral}{    Load an Opt from disk.}
178 \textcolor{stringliteral}{    """}
179     \textcolor{keywordflow}{try}:
180         \textcolor{comment}{# try json first}
181         with open(optfile, \textcolor{stringliteral}{'r') as handle:}
182 \textcolor{stringliteral}{            opt = json.load(handle)}
183 \textcolor{stringliteral}{    }\textcolor{keywordflow}{except} UnicodeDecodeError:
184         \textcolor{comment}{# oops it's pickled}
185         with open(optfile, \textcolor{stringliteral}{'rb'}) \textcolor{keyword}{as} handle:
186             opt = pickle.load(handle)
187     \textcolor{keywordflow}{return} Opt(opt)
188 
189 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_ac8ca45e62ca906d9b6e5026588a5d2a2}\label{namespaceparlai_1_1utils_1_1misc_ac8ca45e62ca906d9b6e5026588a5d2a2}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!maintain\+\_\+dialog\+\_\+history@{maintain\+\_\+dialog\+\_\+history}}
\index{maintain\+\_\+dialog\+\_\+history@{maintain\+\_\+dialog\+\_\+history}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{maintain\+\_\+dialog\+\_\+history()}{maintain\_dialog\_history()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+maintain\+\_\+dialog\+\_\+history (\begin{DoxyParamCaption}\item[{}]{history,  }\item[{}]{observation,  }\item[{}]{reply = {\ttfamily \textquotesingle{}\textquotesingle{}},  }\item[{}]{history\+Length = {\ttfamily 1},  }\item[{}]{use\+Replies = {\ttfamily \textquotesingle{}label\+\_\+else\+\_\+model\textquotesingle{}},  }\item[{}]{dict = {\ttfamily None},  }\item[{}]{use\+Start\+End\+Indices = {\ttfamily True},  }\item[{}]{split\+Sentences = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Keep track of dialog history, up to a truncation length.

Either includes replies from the labels, model, or not all using param
'replies'.

DEPRECATED. USE PARLAI.CORE.TORCH_AGENT INSTEAD.
\end{DoxyVerb}
 

Definition at line 77 of file misc.\+py.


\begin{DoxyCode}
77 ):
78     \textcolor{stringliteral}{"""}
79 \textcolor{stringliteral}{    Keep track of dialog history, up to a truncation length.}
80 \textcolor{stringliteral}{}
81 \textcolor{stringliteral}{    Either includes replies from the labels, model, or not all using param}
82 \textcolor{stringliteral}{    'replies'.}
83 \textcolor{stringliteral}{}
84 \textcolor{stringliteral}{    DEPRECATED. USE PARLAI.CORE.TORCH\_AGENT INSTEAD.}
85 \textcolor{stringliteral}{    """}
86 
87     \textcolor{keyword}{def }parse(txt, splitSentences):
88         \textcolor{keywordflow}{if} dict \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
89             \textcolor{keywordflow}{if} splitSentences:
90                 vec = [dict.txt2vec(t) \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} txt.split(\textcolor{stringliteral}{'\(\backslash\)n'})]
91             \textcolor{keywordflow}{else}:
92                 vec = dict.txt2vec(txt)
93             \textcolor{keywordflow}{return} vec
94         \textcolor{keywordflow}{else}:
95             \textcolor{keywordflow}{return} [txt]
96 
97     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'dialog'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} history:
98         history[\textcolor{stringliteral}{'dialog'}] = deque(maxlen=historyLength)
99         history[\textcolor{stringliteral}{'episode\_done'}] = \textcolor{keyword}{False}
100         history[\textcolor{stringliteral}{'labels'}] = []
101 
102     \textcolor{keywordflow}{if} history[\textcolor{stringliteral}{'episode\_done'}]:
103         history[\textcolor{stringliteral}{'dialog'}].clear()
104         history[\textcolor{stringliteral}{'labels'}] = []
105         useReplies = \textcolor{stringliteral}{'none'}
106         history[\textcolor{stringliteral}{'episode\_done'}] = \textcolor{keyword}{False}
107 
108     \textcolor{keywordflow}{if} useReplies != \textcolor{stringliteral}{'none'}:
109         \textcolor{keywordflow}{if} useReplies == \textcolor{stringliteral}{'model'} \textcolor{keywordflow}{or} (
110             useReplies == \textcolor{stringliteral}{'label\_else\_model'} \textcolor{keywordflow}{and} len(history[\textcolor{stringliteral}{'labels'}]) == 0
111         ):
112             \textcolor{keywordflow}{if} reply:
113                 \textcolor{keywordflow}{if} useStartEndIndices:
114                     reply = dict.start\_token + \textcolor{stringliteral}{' '} + reply
115                 history[\textcolor{stringliteral}{'dialog'}].extend(parse(reply, splitSentences))
116         \textcolor{keywordflow}{elif} len(history[\textcolor{stringliteral}{'labels'}]) > 0:
117             r = history[\textcolor{stringliteral}{'labels'}][0]
118             history[\textcolor{stringliteral}{'dialog'}].extend(parse(r, splitSentences))
119 
120     obs = observation
121     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} obs:
122         \textcolor{keywordflow}{if} useStartEndIndices:
123             obs[\textcolor{stringliteral}{'text'}] = dict.end\_token + \textcolor{stringliteral}{' '} + obs[\textcolor{stringliteral}{'text'}]
124         history[\textcolor{stringliteral}{'dialog'}].extend(parse(obs[\textcolor{stringliteral}{'text'}], splitSentences))
125 
126     history[\textcolor{stringliteral}{'episode\_done'}] = obs[\textcolor{stringliteral}{'episode\_done'}]
127 
128     labels = obs.get(\textcolor{stringliteral}{'labels'}, obs.get(\textcolor{stringliteral}{'eval\_labels'}, \textcolor{keywordtype}{None}))
129     \textcolor{keywordflow}{if} labels \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
130         \textcolor{keywordflow}{if} useStartEndIndices:
131             history[\textcolor{stringliteral}{'labels'}] = [dict.start\_token + \textcolor{stringliteral}{' '} + l \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} labels]
132         \textcolor{keywordflow}{else}:
133             history[\textcolor{stringliteral}{'labels'}] = labels
134 
135     \textcolor{keywordflow}{return} history[\textcolor{stringliteral}{'dialog'}]
136 
137 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_ae5db473b41d3b49814e2566e866282b6}\label{namespaceparlai_1_1utils_1_1misc_ae5db473b41d3b49814e2566e866282b6}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!msg\+\_\+to\+\_\+str@{msg\+\_\+to\+\_\+str}}
\index{msg\+\_\+to\+\_\+str@{msg\+\_\+to\+\_\+str}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{msg\+\_\+to\+\_\+str()}{msg\_to\_str()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+msg\+\_\+to\+\_\+str (\begin{DoxyParamCaption}\item[{}]{msg,  }\item[{}]{ignore\+\_\+fields = {\ttfamily \textquotesingle{}\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert ParlAI message dict to string.

:param msg:
    dict to convert into a string.
:param ignore_fields:
    (default '') comma-separated field names to not include in the string
    even if they're in the msg dict.
\end{DoxyVerb}
 

Definition at line 841 of file misc.\+py.


\begin{DoxyCode}
841 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_ae5db473b41d3b49814e2566e866282b6}{msg\_to\_str}(msg, ignore\_fields=''):
842     \textcolor{stringliteral}{"""}
843 \textcolor{stringliteral}{    Convert ParlAI message dict to string.}
844 \textcolor{stringliteral}{}
845 \textcolor{stringliteral}{    :param msg:}
846 \textcolor{stringliteral}{        dict to convert into a string.}
847 \textcolor{stringliteral}{    :param ignore\_fields:}
848 \textcolor{stringliteral}{        (default '') comma-separated field names to not include in the string}
849 \textcolor{stringliteral}{        even if they're in the msg dict.}
850 \textcolor{stringliteral}{    """}
851 
852     \textcolor{keyword}{def }filter(txt):
853         txt = \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(txt)
854         txt = txt.replace(\textcolor{stringliteral}{'\(\backslash\)t'}, \textcolor{stringliteral}{'\(\backslash\)\(\backslash\)t'})
855         txt = txt.replace(\textcolor{stringliteral}{'\(\backslash\)n'}, \textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'})
856         txt = txt.replace(\textcolor{stringliteral}{'|'}, \textcolor{stringliteral}{'\_\_PIPE\_\_'})
857         \textcolor{keywordflow}{return} txt
858 
859     \textcolor{keyword}{def }add\_field(name, data):
860         \textcolor{keywordflow}{if} name == \textcolor{stringliteral}{'reward'} \textcolor{keywordflow}{and} data == 0:
861             \textcolor{keywordflow}{return} \textcolor{stringliteral}{''}
862         \textcolor{keywordflow}{if} name == \textcolor{stringliteral}{'episode\_done'} \textcolor{keywordflow}{and} data \textcolor{keywordflow}{is} \textcolor{keyword}{False}:
863             \textcolor{keywordflow}{return} \textcolor{stringliteral}{''}
864         txt = \textcolor{stringliteral}{''}
865         \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(data) == tuple \textcolor{keywordflow}{or} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(data) == set \textcolor{keywordflow}{or} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(data) == list:
866             \textcolor{comment}{# list entries}
867             \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} data:
868                 txt += filter(c) + \textcolor{stringliteral}{"|"}
869             txt = txt[:-1]
870         \textcolor{keywordflow}{else}:
871             \textcolor{comment}{# single fields}
872             txt = filter(data)
873         \textcolor{keywordflow}{return} name + \textcolor{stringliteral}{":"} + txt + \textcolor{stringliteral}{'\(\backslash\)t'}
874 
875     default\_fields = [
876         \textcolor{stringliteral}{'id'},
877         \textcolor{stringliteral}{'text'},
878         \textcolor{stringliteral}{'labels'},
879         \textcolor{stringliteral}{'label\_candidates'},
880         \textcolor{stringliteral}{'episode\_done'},
881         \textcolor{stringliteral}{'reward'},
882     ]
883     txt = \textcolor{stringliteral}{""}
884     ignore\_fields = ignore\_fields.split(\textcolor{stringliteral}{','})
885     \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} default\_fields:
886         \textcolor{keywordflow}{if} f \textcolor{keywordflow}{in} msg \textcolor{keywordflow}{and} f \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} ignore\_fields:
887             txt += add\_field(f, msg[f])
888     \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} msg.keys():
889         \textcolor{keywordflow}{if} f \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} default\_fields \textcolor{keywordflow}{and} f \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} ignore\_fields:
890             txt += add\_field(f, msg[f])
891     \textcolor{keywordflow}{return} txt.rstrip(\textcolor{stringliteral}{'\(\backslash\)t'})
892 
893 
894 \textcolor{comment}{# DEPRECATION DAY: DELETE}
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a68c44ca571de7149b683539db659c330}\label{namespaceparlai_1_1utils_1_1misc_a68c44ca571de7149b683539db659c330}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!neginf@{neginf}}
\index{neginf@{neginf}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{neginf()}{neginf()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+neginf (\begin{DoxyParamCaption}\item[{}]{dtype }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return a representable finite number near -inf for a dtype.
\end{DoxyVerb}
 

Definition at line 58 of file misc.\+py.


\begin{DoxyCode}
58 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a68c44ca571de7149b683539db659c330}{neginf}(dtype):
59     \textcolor{stringliteral}{"""}
60 \textcolor{stringliteral}{    Return a representable finite number near -inf for a dtype.}
61 \textcolor{stringliteral}{    """}
62     \textcolor{keywordflow}{if} dtype \textcolor{keywordflow}{is} torch.float16:
63         \textcolor{keywordflow}{return} -NEAR\_INF\_FP16
64     \textcolor{keywordflow}{else}:
65         \textcolor{keywordflow}{return} -NEAR\_INF
66 
67 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a38a23cfa0fc3dbed42846787d1c04b57}\label{namespaceparlai_1_1utils_1_1misc_a38a23cfa0fc3dbed42846787d1c04b57}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!no\+\_\+lock@{no\+\_\+lock}}
\index{no\+\_\+lock@{no\+\_\+lock}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{no\+\_\+lock()}{no\_lock()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+no\+\_\+lock (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Build a nolock for other classes to use for no-op locking.
\end{DoxyVerb}
 

Definition at line 485 of file misc.\+py.


\begin{DoxyCode}
485 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a38a23cfa0fc3dbed42846787d1c04b57}{no\_lock}():
486     \textcolor{stringliteral}{"""}
487 \textcolor{stringliteral}{    Build a nolock for other classes to use for no-op locking.}
488 \textcolor{stringliteral}{    """}
489     \textcolor{keywordflow}{return} single\_nolock
490 
491 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_ad96b0c9ef6237d9ca051251089faf2c7}\label{namespaceparlai_1_1utils_1_1misc_ad96b0c9ef6237d9ca051251089faf2c7}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!padded\+\_\+3d@{padded\+\_\+3d}}
\index{padded\+\_\+3d@{padded\+\_\+3d}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{padded\+\_\+3d()}{padded\_3d()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+padded\+\_\+3d (\begin{DoxyParamCaption}\item[{}]{tensors,  }\item[{}]{pad\+\_\+idx = {\ttfamily 0},  }\item[{}]{use\+\_\+cuda = {\ttfamily 0},  }\item[{}]{dtype = {\ttfamily \hyperlink{namespaceparlai_1_1utils_1_1misc_ac49ec9bcd5fe586085eb9fab8f40fdb5}{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}},  }\item[{}]{fp16friendly = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Make 3D padded tensor for list of lists of 1D tensors or lists.

:param tensors:
    list of lists of 1D tensors (or lists)
:param pad_idx:
    padding to fill tensor with
:param use_cuda:
    whether to call cuda() before returning
:param bool fp16friendly:
    if True, pads the final dimension to be a multiple of 8.

:returns:
    3D tensor with the maximum dimensions of the inputs
\end{DoxyVerb}
 

Definition at line 992 of file misc.\+py.


\begin{DoxyCode}
992 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_ad96b0c9ef6237d9ca051251089faf2c7}{padded\_3d}(tensors, pad\_idx=0, use\_cuda=0, dtype=TORCH\_LONG, fp16friendly=False):
993     \textcolor{stringliteral}{"""}
994 \textcolor{stringliteral}{    Make 3D padded tensor for list of lists of 1D tensors or lists.}
995 \textcolor{stringliteral}{}
996 \textcolor{stringliteral}{    :param tensors:}
997 \textcolor{stringliteral}{        list of lists of 1D tensors (or lists)}
998 \textcolor{stringliteral}{    :param pad\_idx:}
999 \textcolor{stringliteral}{        padding to fill tensor with}
1000 \textcolor{stringliteral}{    :param use\_cuda:}
1001 \textcolor{stringliteral}{        whether to call cuda() before returning}
1002 \textcolor{stringliteral}{    :param bool fp16friendly:}
1003 \textcolor{stringliteral}{        if True, pads the final dimension to be a multiple of 8.}
1004 \textcolor{stringliteral}{}
1005 \textcolor{stringliteral}{    :returns:}
1006 \textcolor{stringliteral}{        3D tensor with the maximum dimensions of the inputs}
1007 \textcolor{stringliteral}{    """}
1008     a = len(tensors)
1009     b = max(len(row) \textcolor{keywordflow}{for} row \textcolor{keywordflow}{in} tensors)
1010     c = max(len(item) \textcolor{keywordflow}{for} row \textcolor{keywordflow}{in} tensors \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} row)
1011 
1012     \textcolor{comment}{# pad empty tensors}
1013     \textcolor{keywordflow}{if} fp16friendly \textcolor{keywordflow}{and} c % 8 != 0:
1014         c += 8 - (c % 8)
1015     c = max(c, 1)
1016 
1017     output = torch.full((a, b, c), pad\_idx, dtype=dtype)
1018 
1019     \textcolor{keywordflow}{for} i, row \textcolor{keywordflow}{in} enumerate(tensors):
1020         \textcolor{keywordflow}{for} j, item \textcolor{keywordflow}{in} enumerate(row):
1021             \textcolor{keywordflow}{if} len(item) == 0:
1022                 \textcolor{keywordflow}{continue}
1023             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(item, torch.Tensor):
1024                 item = torch.Tensor(item, dtype=dtype)
1025             output[i, j, : len(item)] = item
1026 
1027     \textcolor{keywordflow}{if} use\_cuda:
1028         output = output.cuda()
1029 
1030     \textcolor{keywordflow}{return} output
1031 
1032 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_ad3f3c350e8b394482f73a240e19ec3ac}\label{namespaceparlai_1_1utils_1_1misc_ad3f3c350e8b394482f73a240e19ec3ac}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!padded\+\_\+tensor@{padded\+\_\+tensor}}
\index{padded\+\_\+tensor@{padded\+\_\+tensor}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{padded\+\_\+tensor()}{padded\_tensor()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+padded\+\_\+tensor (\begin{DoxyParamCaption}\item[{}]{items,  }\item[{}]{pad\+\_\+idx = {\ttfamily 0},  }\item[{}]{use\+\_\+cuda = {\ttfamily False},  }\item[{}]{left\+\_\+padded = {\ttfamily False},  }\item[{}]{max\+\_\+len = {\ttfamily None},  }\item[{}]{fp16friendly = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a right-padded matrix from an uneven list of lists.

Returns (padded, lengths), where padded is the padded matrix, and lengths
is a list containing the lengths of each row.

Matrix is right-padded (filled to the right) by default, but can be
left padded if the flag is set to True.

Matrix can also be placed on cuda automatically.

:param list[iter[int]] items: List of items
:param bool sort: If True, orders by the length
:param int pad_idx: the value to use for padding
:param bool use_cuda: if true, places `padded` on GPU
:param bool left_padded:
:param int max_len: if None, the max length is the maximum item length
:param bool fp16friendly: if True, pads the time dimension to be a multiple of 8.

:returns: (padded, lengths) tuple
:rtype: (Tensor[int64], list[int])
\end{DoxyVerb}
 

Definition at line 923 of file misc.\+py.


\begin{DoxyCode}
923 ):
924     \textcolor{stringliteral}{"""}
925 \textcolor{stringliteral}{    Create a right-padded matrix from an uneven list of lists.}
926 \textcolor{stringliteral}{}
927 \textcolor{stringliteral}{    Returns (padded, lengths), where padded is the padded matrix, and lengths}
928 \textcolor{stringliteral}{    is a list containing the lengths of each row.}
929 \textcolor{stringliteral}{}
930 \textcolor{stringliteral}{    Matrix is right-padded (filled to the right) by default, but can be}
931 \textcolor{stringliteral}{    left padded if the flag is set to True.}
932 \textcolor{stringliteral}{}
933 \textcolor{stringliteral}{    Matrix can also be placed on cuda automatically.}
934 \textcolor{stringliteral}{}
935 \textcolor{stringliteral}{    :param list[iter[int]] items: List of items}
936 \textcolor{stringliteral}{    :param bool sort: If True, orders by the length}
937 \textcolor{stringliteral}{    :param int pad\_idx: the value to use for padding}
938 \textcolor{stringliteral}{    :param bool use\_cuda: if true, places `padded` on GPU}
939 \textcolor{stringliteral}{    :param bool left\_padded:}
940 \textcolor{stringliteral}{    :param int max\_len: if None, the max length is the maximum item length}
941 \textcolor{stringliteral}{    :param bool fp16friendly: if True, pads the time dimension to be a multiple of 8.}
942 \textcolor{stringliteral}{}
943 \textcolor{stringliteral}{    :returns: (padded, lengths) tuple}
944 \textcolor{stringliteral}{    :rtype: (Tensor[int64], list[int])}
945 \textcolor{stringliteral}{    """}
946     \textcolor{comment}{# hard fail if we don't have torch}
947     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \_\_TORCH\_AVAILABLE:
948         \textcolor{keywordflow}{raise} ImportError(
949             \textcolor{stringliteral}{"Cannot use padded\_tensor without torch; go to http://pytorch.org"}
950         )
951 
952     \textcolor{comment}{# number of items}
953     n = len(items)
954     \textcolor{comment}{# length of each item}
955     lens = [len(item) \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} items]
956     \textcolor{comment}{# max in time dimension}
957     t = max(lens) \textcolor{keywordflow}{if} max\_len \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} max\_len
958 
959     \textcolor{comment}{# if input tensors are empty, we should expand to nulls}
960     t = max(t, 1)
961 
962     \textcolor{keywordflow}{if} fp16friendly \textcolor{keywordflow}{and} (t % 8 != 0):
963         \textcolor{comment}{# pad to be a multiple of 8 to ensure we use the tensor cores}
964         t += 8 - (t % 8)
965 
966     \textcolor{keywordflow}{if} isinstance(items[0], torch.Tensor):
967         \textcolor{comment}{# keep type of input tensors, they may already be cuda ones}
968         output = items[0].new(n, t)
969     \textcolor{keywordflow}{else}:
970         output = torch.LongTensor(n, t)
971     output.fill\_(pad\_idx)
972 
973     \textcolor{keywordflow}{for} i, (item, length) \textcolor{keywordflow}{in} enumerate(zip(items, lens)):
974         \textcolor{keywordflow}{if} length == 0:
975             \textcolor{comment}{# skip empty items}
976             \textcolor{keywordflow}{continue}
977         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(item, torch.Tensor):
978             \textcolor{comment}{# put non-tensors into a tensor}
979             item = torch.LongTensor(item)
980         \textcolor{keywordflow}{if} left\_padded:
981             \textcolor{comment}{# place at end}
982             output[i, t - length :] = item
983         \textcolor{keywordflow}{else}:
984             \textcolor{comment}{# place at beginning}
985             output[i, :length] = item
986 
987     \textcolor{keywordflow}{if} use\_cuda:
988         output = output.cuda()
989     \textcolor{keywordflow}{return} output, lens
990 
991 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_af245c261b10f36175f6d88fce852c552}\label{namespaceparlai_1_1utils_1_1misc_af245c261b10f36175f6d88fce852c552}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!round\+\_\+sigfigs@{round\+\_\+sigfigs}}
\index{round\+\_\+sigfigs@{round\+\_\+sigfigs}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{round\+\_\+sigfigs()}{round\_sigfigs()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+round\+\_\+sigfigs (\begin{DoxyParamCaption}\item[{}]{x,  }\item[{}]{sigfigs = {\ttfamily 4} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Round value to specified significant figures.

:param x: input number
:param sigfigs: number of significant figures to return

:returns: float number rounded to specified sigfigs
\end{DoxyVerb}
 

Definition at line 435 of file misc.\+py.


\begin{DoxyCode}
435 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_af245c261b10f36175f6d88fce852c552}{round\_sigfigs}(x, sigfigs=4):
436     \textcolor{stringliteral}{"""}
437 \textcolor{stringliteral}{    Round value to specified significant figures.}
438 \textcolor{stringliteral}{}
439 \textcolor{stringliteral}{    :param x: input number}
440 \textcolor{stringliteral}{    :param sigfigs: number of significant figures to return}
441 \textcolor{stringliteral}{}
442 \textcolor{stringliteral}{    :returns: float number rounded to specified sigfigs}
443 \textcolor{stringliteral}{    """}
444     \textcolor{keywordflow}{try}:
445         \textcolor{keywordflow}{if} x == 0:
446             \textcolor{keywordflow}{return} 0
447         \textcolor{keywordflow}{return} round(x, -math.floor(math.log10(abs(x)) - sigfigs + 1))
448     \textcolor{keywordflow}{except} (RuntimeError, TypeError):
449         \textcolor{comment}{# handle 1D torch tensors}
450         \textcolor{comment}{# if anything else breaks here please file an issue on Github}
451         \textcolor{keywordflow}{if} hasattr(x, \textcolor{stringliteral}{'item'}):
452             \textcolor{keywordflow}{return} \hyperlink{namespaceparlai_1_1utils_1_1misc_af245c261b10f36175f6d88fce852c552}{round\_sigfigs}(x.item(), sigfigs)
453         \textcolor{keywordflow}{else}:
454             \textcolor{keywordflow}{return} \hyperlink{namespaceparlai_1_1utils_1_1misc_af245c261b10f36175f6d88fce852c552}{round\_sigfigs}(x[0], sigfigs)
455     \textcolor{keywordflow}{except} (ValueError, OverflowError) \textcolor{keyword}{as} ex:
456         \textcolor{keywordflow}{if} x \textcolor{keywordflow}{in} [\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}(\textcolor{stringliteral}{'inf'}), \hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}(\textcolor{stringliteral}{'-inf'})] \textcolor{keywordflow}{or} x != x:  \textcolor{comment}{# inf or nan}
457             \textcolor{keywordflow}{return} x
458         \textcolor{keywordflow}{else}:
459             \textcolor{keywordflow}{raise} ex
460 
461 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a8781cc03272b3a118fcd9e5a9f4ca1dd}\label{namespaceparlai_1_1utils_1_1misc_a8781cc03272b3a118fcd9e5a9f4ca1dd}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!set\+\_\+namedtuple\+\_\+defaults@{set\+\_\+namedtuple\+\_\+defaults}}
\index{set\+\_\+namedtuple\+\_\+defaults@{set\+\_\+namedtuple\+\_\+defaults}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{set\+\_\+namedtuple\+\_\+defaults()}{set\_namedtuple\_defaults()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+set\+\_\+namedtuple\+\_\+defaults (\begin{DoxyParamCaption}\item[{}]{namedtuple,  }\item[{}]{default = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Set *all* of the fields for a given nametuple to a singular value.

Additionally removes the default docstring for each field.
Modifies the tuple in place, but returns it anyway.

More info:
https://stackoverflow.com/a/18348004

:param namedtuple: A constructed collections.namedtuple
:param default: The default value to set.

:returns: the modified namedtuple
\end{DoxyVerb}
 

Definition at line 895 of file misc.\+py.


\begin{DoxyCode}
895 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a8781cc03272b3a118fcd9e5a9f4ca1dd}{set\_namedtuple\_defaults}(namedtuple, default=None):
896     \textcolor{stringliteral}{"""}
897 \textcolor{stringliteral}{    Set *all* of the fields for a given nametuple to a singular value.}
898 \textcolor{stringliteral}{}
899 \textcolor{stringliteral}{    Additionally removes the default docstring for each field.}
900 \textcolor{stringliteral}{    Modifies the tuple in place, but returns it anyway.}
901 \textcolor{stringliteral}{}
902 \textcolor{stringliteral}{    More info:}
903 \textcolor{stringliteral}{    https://stackoverflow.com/a/18348004}
904 \textcolor{stringliteral}{}
905 \textcolor{stringliteral}{    :param namedtuple: A constructed collections.namedtuple}
906 \textcolor{stringliteral}{    :param default: The default value to set.}
907 \textcolor{stringliteral}{}
908 \textcolor{stringliteral}{    :returns: the modified namedtuple}
909 \textcolor{stringliteral}{    """}
910     namedtuple.\_\_new\_\_.\_\_defaults\_\_ = (default,) * len(namedtuple.\_fields)
911     \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} namedtuple.\_fields:
912         del getattr(namedtuple, f).\_\_doc\_\_
913     \textcolor{keywordflow}{return} namedtuple
914 
915 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a1b053cd9c56e6fa79b058fff587b3a48}\label{namespaceparlai_1_1utils_1_1misc_a1b053cd9c56e6fa79b058fff587b3a48}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!str\+\_\+to\+\_\+msg@{str\+\_\+to\+\_\+msg}}
\index{str\+\_\+to\+\_\+msg@{str\+\_\+to\+\_\+msg}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{str\+\_\+to\+\_\+msg()}{str\_to\_msg()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+str\+\_\+to\+\_\+msg (\begin{DoxyParamCaption}\item[{}]{txt,  }\item[{}]{ignore\+\_\+fields = {\ttfamily \textquotesingle{}\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert formatted string to ParlAI message dict.

:param txt:
    formatted string to convert. String format is tab-separated fields,
    with colon separating field name and contents.
:param ignore_fields:
    (default '') comma-separated field names to not
    include in the msg dict even if they're in the string.
\end{DoxyVerb}
 

Definition at line 787 of file misc.\+py.


\begin{DoxyCode}
787 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_a1b053cd9c56e6fa79b058fff587b3a48}{str\_to\_msg}(txt, ignore\_fields=''):
788     \textcolor{stringliteral}{"""}
789 \textcolor{stringliteral}{    Convert formatted string to ParlAI message dict.}
790 \textcolor{stringliteral}{}
791 \textcolor{stringliteral}{    :param txt:}
792 \textcolor{stringliteral}{        formatted string to convert. String format is tab-separated fields,}
793 \textcolor{stringliteral}{        with colon separating field name and contents.}
794 \textcolor{stringliteral}{    :param ignore\_fields:}
795 \textcolor{stringliteral}{        (default '') comma-separated field names to not}
796 \textcolor{stringliteral}{        include in the msg dict even if they're in the string.}
797 \textcolor{stringliteral}{    """}
798 
799     \textcolor{keyword}{def }tostr(txt):
800         txt = \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(txt)
801         txt = txt.replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)t'}, \textcolor{stringliteral}{'\(\backslash\)t'})
802         txt = txt.replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'}, \textcolor{stringliteral}{'\(\backslash\)n'})
803         txt = txt.replace(\textcolor{stringliteral}{'\_\_PIPE\_\_'}, \textcolor{stringliteral}{'|'})
804         \textcolor{keywordflow}{return} txt
805 
806     \textcolor{keyword}{def }tolist(txt):
807         vals = txt.split(\textcolor{stringliteral}{'|'})
808         \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} vals:
809             v = tostr(v)
810         \textcolor{keywordflow}{return} vals
811 
812     \textcolor{keyword}{def }convert(key, value):
813         \textcolor{keywordflow}{if} key == \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{or} key == \textcolor{stringliteral}{'id'}:
814             \textcolor{keywordflow}{return} tostr(value)
815         \textcolor{keywordflow}{elif} (
816             key == \textcolor{stringliteral}{'label\_candidates'}
817             \textcolor{keywordflow}{or} key == \textcolor{stringliteral}{'labels'}
818             \textcolor{keywordflow}{or} key == \textcolor{stringliteral}{'eval\_labels'}
819             \textcolor{keywordflow}{or} key == \textcolor{stringliteral}{'text\_candidates'}
820         ):
821             \textcolor{keywordflow}{return} tolist(value)
822         \textcolor{keywordflow}{elif} key == \textcolor{stringliteral}{'episode\_done'}:
823             \textcolor{keywordflow}{return} \hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a6fc0c9b519a36f82b65bcd398f1fbb9d}{bool}(value)
824         \textcolor{keywordflow}{else}:
825             \textcolor{keywordflow}{return} tostr(value)
826 
827     \textcolor{keywordflow}{if} txt == \textcolor{stringliteral}{''} \textcolor{keywordflow}{or} txt \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
828         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
829 
830     msg = \{\}
831     \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} txt.split(\textcolor{stringliteral}{'\(\backslash\)t'}):
832         ind = t.find(\textcolor{stringliteral}{':'})
833         key = t[:ind]
834         value = t[ind + 1 :]
835         \textcolor{keywordflow}{if} key \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} ignore\_fields.split(\textcolor{stringliteral}{','}):
836             msg[key] = convert(key, value)
837     msg[\textcolor{stringliteral}{'episode\_done'}] = msg.get(\textcolor{stringliteral}{'episode\_done'}, \textcolor{keyword}{False})
838     \textcolor{keywordflow}{return} Message(msg)
839 
840 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_acf146e70ea7f6867969a7c2b545d4b4b}\label{namespaceparlai_1_1utils_1_1misc_acf146e70ea7f6867969a7c2b545d4b4b}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!warn\+\_\+once@{warn\+\_\+once}}
\index{warn\+\_\+once@{warn\+\_\+once}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{warn\+\_\+once()}{warn\_once()}}
{\footnotesize\ttfamily def parlai.\+utils.\+misc.\+warn\+\_\+once (\begin{DoxyParamCaption}\item[{}]{msg,  }\item[{}]{warningtype = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Raise a warning, but only once.

:param str msg: Message to display
:param Warning warningtype: Type of warning, e.g. DeprecationWarning
\end{DoxyVerb}
 

Definition at line 1064 of file misc.\+py.


\begin{DoxyCode}
1064 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_acf146e70ea7f6867969a7c2b545d4b4b}{warn\_once}(msg, warningtype=None):
1065     \textcolor{stringliteral}{"""}
1066 \textcolor{stringliteral}{    Raise a warning, but only once.}
1067 \textcolor{stringliteral}{}
1068 \textcolor{stringliteral}{    :param str msg: Message to display}
1069 \textcolor{stringliteral}{    :param Warning warningtype: Type of warning, e.g. DeprecationWarning}
1070 \textcolor{stringliteral}{    """}
1071     \textcolor{keyword}{global} \_seen\_warnings
1072     \textcolor{keywordflow}{if} msg \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} \_seen\_warnings:
1073         \_seen\_warnings.add(msg)
1074         warnings.warn(msg, warningtype, stacklevel=2)
1075 
1076 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a122146c75d0e6910340a6a851d097bdc}\label{namespaceparlai_1_1utils_1_1misc_a122146c75d0e6910340a6a851d097bdc}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS@{D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS}}
\index{D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS@{D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS}{DISPLAY\_MESSAGE\_DEFAULT\_FIELDS}}
{\footnotesize\ttfamily parlai.\+utils.\+misc.\+D\+I\+S\+P\+L\+A\+Y\+\_\+\+M\+E\+S\+S\+A\+G\+E\+\_\+\+D\+E\+F\+A\+U\+L\+T\+\_\+\+F\+I\+E\+L\+DS}



Definition at line 41 of file misc.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a8e586e6abf9e695442a00ac47424ad31}\label{namespaceparlai_1_1utils_1_1misc_a8e586e6abf9e695442a00ac47424ad31}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!N\+E\+A\+R\+\_\+\+I\+NF@{N\+E\+A\+R\+\_\+\+I\+NF}}
\index{N\+E\+A\+R\+\_\+\+I\+NF@{N\+E\+A\+R\+\_\+\+I\+NF}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{N\+E\+A\+R\+\_\+\+I\+NF}{NEAR\_INF}}
{\footnotesize\ttfamily parlai.\+utils.\+misc.\+N\+E\+A\+R\+\_\+\+I\+NF}



Definition at line 37 of file misc.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_affd7d3c0575a748a52a66e092fb31a35}\label{namespaceparlai_1_1utils_1_1misc_affd7d3c0575a748a52a66e092fb31a35}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16@{N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16}}
\index{N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16@{N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16}{NEAR\_INF\_FP16}}
{\footnotesize\ttfamily parlai.\+utils.\+misc.\+N\+E\+A\+R\+\_\+\+I\+N\+F\+\_\+\+F\+P16}



Definition at line 38 of file misc.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_a5d6ad7f3aef96f16bb9060f5a41fc39b}\label{namespaceparlai_1_1utils_1_1misc_a5d6ad7f3aef96f16bb9060f5a41fc39b}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!single\+\_\+nolock@{single\+\_\+nolock}}
\index{single\+\_\+nolock@{single\+\_\+nolock}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{single\+\_\+nolock}{single\_nolock}}
{\footnotesize\ttfamily parlai.\+utils.\+misc.\+single\+\_\+nolock}



Definition at line 482 of file misc.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1misc_ac49ec9bcd5fe586085eb9fab8f40fdb5}\label{namespaceparlai_1_1utils_1_1misc_ac49ec9bcd5fe586085eb9fab8f40fdb5}} 
\index{parlai\+::utils\+::misc@{parlai\+::utils\+::misc}!T\+O\+R\+C\+H\+\_\+\+L\+O\+NG@{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}}
\index{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG@{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}!parlai\+::utils\+::misc@{parlai\+::utils\+::misc}}
\subsubsection{\texorpdfstring{T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}{TORCH\_LONG}}
{\footnotesize\ttfamily parlai.\+utils.\+misc.\+T\+O\+R\+C\+H\+\_\+\+L\+O\+NG}



Definition at line 29 of file misc.\+py.

