\hypertarget{namespaceparlai_1_1tasks_1_1coqa_1_1build}{}\section{parlai.\+tasks.\+coqa.\+build Namespace Reference}
\label{namespaceparlai_1_1tasks_1_1coqa_1_1build}\index{parlai.\+tasks.\+coqa.\+build@{parlai.\+tasks.\+coqa.\+build}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1tasks_1_1coqa_1_1build_ae2bc52f1ecab4681f1c2ebf013629aec}{make\+\_\+parlai\+\_\+format} (outpath, dtype, data)
\item 
def \hyperlink{namespaceparlai_1_1tasks_1_1coqa_1_1build_ae49969fbac6726d7510f9cefd4b8450a}{build} (opt)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1tasks_1_1coqa_1_1build_a4cfa3a79a92a4f15856764f4972588bc}{V\+E\+R\+S\+I\+ON}
\item 
\hyperlink{namespaceparlai_1_1tasks_1_1coqa_1_1build_a4c14e148e955a0ccc3be41de469e7cc1}{R\+E\+S\+O\+U\+R\+C\+ES}
\item 
\hyperlink{namespaceparlai_1_1tasks_1_1coqa_1_1build_a78f25f9e7c11df29e572cf30a3973f49}{zipped}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1coqa_1_1build_ae49969fbac6726d7510f9cefd4b8450a}\label{namespaceparlai_1_1tasks_1_1coqa_1_1build_ae49969fbac6726d7510f9cefd4b8450a}} 
\index{parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}!build@{build}}
\index{build@{build}!parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}}
\subsubsection{\texorpdfstring{build()}{build()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+coqa.\+build.\+build (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 55 of file build.\+py.


\begin{DoxyCode}
55 \textcolor{keyword}{def }\hyperlink{namespacedialog__babi__feedback_1_1build_a7a9d289f7493a5ded13c4b7f071b6184}{build}(opt):
56     dpath = os.path.join(opt[\textcolor{stringliteral}{'datapath'}], \textcolor{stringliteral}{'CoQA'})
57     version = VERSION
58 
59     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} build\_data.built(dpath, version\_string=version):
60         print(\textcolor{stringliteral}{'[building data: '} + dpath + \textcolor{stringliteral}{']'})
61         \textcolor{keywordflow}{if} build\_data.built(dpath):
62             \textcolor{comment}{# An older version exists, so remove these outdated files.}
63             build\_data.remove\_dir(dpath)
64         build\_data.make\_dir(dpath)
65 
66         \textcolor{comment}{# Download the data.}
67         \textcolor{keywordflow}{for} downloadable\_file \textcolor{keywordflow}{in} RESOURCES:
68             downloadable\_file.download\_file(dpath)
69 
70         with open(os.path.join(dpath, \textcolor{stringliteral}{'coqa-train-v1.0.json'})) \textcolor{keyword}{as} f:
71             data = json.load(f)[\textcolor{stringliteral}{'data'}]
72             \hyperlink{namespaceparlai_1_1tasks_1_1quac_1_1build_a08c212462b5c58cde91192d35f24f0cc}{make\_parlai\_format}(dpath, \textcolor{stringliteral}{'train'}, data)
73 
74         with open(os.path.join(dpath, \textcolor{stringliteral}{'coqa-dev-v1.0.json'})) \textcolor{keyword}{as} f:
75             data = json.load(f)[\textcolor{stringliteral}{'data'}]
76             \hyperlink{namespaceparlai_1_1tasks_1_1quac_1_1build_a08c212462b5c58cde91192d35f24f0cc}{make\_parlai\_format}(dpath, \textcolor{stringliteral}{'valid'}, data)
77 
78         \textcolor{comment}{# Mark the data as built.}
79         build\_data.mark\_done(dpath, version\_string=version)
80 \end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1coqa_1_1build_ae2bc52f1ecab4681f1c2ebf013629aec}\label{namespaceparlai_1_1tasks_1_1coqa_1_1build_ae2bc52f1ecab4681f1c2ebf013629aec}} 
\index{parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}!make\+\_\+parlai\+\_\+format@{make\+\_\+parlai\+\_\+format}}
\index{make\+\_\+parlai\+\_\+format@{make\+\_\+parlai\+\_\+format}!parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}}
\subsubsection{\texorpdfstring{make\+\_\+parlai\+\_\+format()}{make\_parlai\_format()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+coqa.\+build.\+make\+\_\+parlai\+\_\+format (\begin{DoxyParamCaption}\item[{}]{outpath,  }\item[{}]{dtype,  }\item[{}]{data }\end{DoxyParamCaption})}



Definition at line 30 of file build.\+py.


\begin{DoxyCode}
30 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1tasks_1_1quac_1_1build_a08c212462b5c58cde91192d35f24f0cc}{make\_parlai\_format}(outpath, dtype, data):
31     print(\textcolor{stringliteral}{'building parlai:'} + dtype)
32     with open(os.path.join(outpath, dtype + \textcolor{stringliteral}{'.txt'}), \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} fout:
33         \textcolor{keywordflow}{for} each \textcolor{keywordflow}{in} data:
34             output = []
35             story = each[\textcolor{stringliteral}{'story'}].replace(\textcolor{stringliteral}{'\(\backslash\)n'}, \textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'})
36             \textcolor{keywordflow}{for} question, ans \textcolor{keywordflow}{in} zip(each[\textcolor{stringliteral}{'questions'}], each[\textcolor{stringliteral}{'answers'}]):
37                 question\_txt = \textcolor{stringliteral}{''}
38                 \textcolor{keywordflow}{if} question[\textcolor{stringliteral}{'turn\_id'}] == 1:
39                     \textcolor{comment}{# include the context in the very first turn}
40                     question\_txt = story + \textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'} + question[\textcolor{stringliteral}{'input\_text'}]
41                 \textcolor{keywordflow}{else}:
42                     question\_txt = question[\textcolor{stringliteral}{'input\_text'}]
43                 output.append(
44                     \textcolor{stringliteral}{'text:\{question\}\(\backslash\)tlabels:\{labels\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
45                         question=question\_txt,
46                         labels=ans[\textcolor{stringliteral}{'input\_text'}].replace(\textcolor{stringliteral}{'|'}, \textcolor{stringliteral}{' \_\_PIPE\_\_ '}),
47                     )
48                 )
49                 \textcolor{keywordflow}{if} question[\textcolor{stringliteral}{'turn\_id'}] < len(each[\textcolor{stringliteral}{'questions'}]):
50                     output.append(\textcolor{stringliteral}{'\(\backslash\)n'})
51             output.append(\textcolor{stringliteral}{'\(\backslash\)t\(\backslash\)tepisode\_done:True\(\backslash\)n'})
52             fout.write(\textcolor{stringliteral}{''}.join(output))
53 
54 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1coqa_1_1build_a4c14e148e955a0ccc3be41de469e7cc1}\label{namespaceparlai_1_1tasks_1_1coqa_1_1build_a4c14e148e955a0ccc3be41de469e7cc1}} 
\index{parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}!R\+E\+S\+O\+U\+R\+C\+ES@{R\+E\+S\+O\+U\+R\+C\+ES}}
\index{R\+E\+S\+O\+U\+R\+C\+ES@{R\+E\+S\+O\+U\+R\+C\+ES}!parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}}
\subsubsection{\texorpdfstring{R\+E\+S\+O\+U\+R\+C\+ES}{RESOURCES}}
{\footnotesize\ttfamily parlai.\+tasks.\+coqa.\+build.\+R\+E\+S\+O\+U\+R\+C\+ES}



Definition at line 14 of file build.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1coqa_1_1build_a4cfa3a79a92a4f15856764f4972588bc}\label{namespaceparlai_1_1tasks_1_1coqa_1_1build_a4cfa3a79a92a4f15856764f4972588bc}} 
\index{parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}!V\+E\+R\+S\+I\+ON@{V\+E\+R\+S\+I\+ON}}
\index{V\+E\+R\+S\+I\+ON@{V\+E\+R\+S\+I\+ON}!parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}}
\subsubsection{\texorpdfstring{V\+E\+R\+S\+I\+ON}{VERSION}}
{\footnotesize\ttfamily parlai.\+tasks.\+coqa.\+build.\+V\+E\+R\+S\+I\+ON}



Definition at line 13 of file build.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1coqa_1_1build_a78f25f9e7c11df29e572cf30a3973f49}\label{namespaceparlai_1_1tasks_1_1coqa_1_1build_a78f25f9e7c11df29e572cf30a3973f49}} 
\index{parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}!zipped@{zipped}}
\index{zipped@{zipped}!parlai\+::tasks\+::coqa\+::build@{parlai\+::tasks\+::coqa\+::build}}
\subsubsection{\texorpdfstring{zipped}{zipped}}
{\footnotesize\ttfamily parlai.\+tasks.\+coqa.\+build.\+zipped}



Definition at line 19 of file build.\+py.

