\hypertarget{classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever}{}\section{tests.\+test\+\_\+tfidf\+\_\+retriever.\+Test\+Tfidf\+Retriever Class Reference}
\label{classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever}\index{tests.\+test\+\_\+tfidf\+\_\+retriever.\+Test\+Tfidf\+Retriever@{tests.\+test\+\_\+tfidf\+\_\+retriever.\+Test\+Tfidf\+Retriever}}


Inheritance diagram for tests.\+test\+\_\+tfidf\+\_\+retriever.\+Test\+Tfidf\+Retriever\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=203pt]{d7/dd5/classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for tests.\+test\+\_\+tfidf\+\_\+retriever.\+Test\+Tfidf\+Retriever\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=203pt]{d7/d54/classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever_ad323cddfeb021a3b38a7eb4810d6ecdd}{test\+\_\+sparse\+\_\+tfidf\+\_\+retriever} (self)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Basic tests on the display_data.py example.
\end{DoxyVerb}
 

Definition at line 26 of file test\+\_\+tfidf\+\_\+retriever.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever_ad323cddfeb021a3b38a7eb4810d6ecdd}\label{classtests_1_1test__tfidf__retriever_1_1TestTfidfRetriever_ad323cddfeb021a3b38a7eb4810d6ecdd}} 
\index{tests\+::test\+\_\+tfidf\+\_\+retriever\+::\+Test\+Tfidf\+Retriever@{tests\+::test\+\_\+tfidf\+\_\+retriever\+::\+Test\+Tfidf\+Retriever}!test\+\_\+sparse\+\_\+tfidf\+\_\+retriever@{test\+\_\+sparse\+\_\+tfidf\+\_\+retriever}}
\index{test\+\_\+sparse\+\_\+tfidf\+\_\+retriever@{test\+\_\+sparse\+\_\+tfidf\+\_\+retriever}!tests\+::test\+\_\+tfidf\+\_\+retriever\+::\+Test\+Tfidf\+Retriever@{tests\+::test\+\_\+tfidf\+\_\+retriever\+::\+Test\+Tfidf\+Retriever}}
\subsubsection{\texorpdfstring{test\+\_\+sparse\+\_\+tfidf\+\_\+retriever()}{test\_sparse\_tfidf\_retriever()}}
{\footnotesize\ttfamily def tests.\+test\+\_\+tfidf\+\_\+retriever.\+Test\+Tfidf\+Retriever.\+test\+\_\+sparse\+\_\+tfidf\+\_\+retriever (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 32 of file test\+\_\+tfidf\+\_\+retriever.\+py.


\begin{DoxyCode}
32     \textcolor{keyword}{def }test\_sparse\_tfidf\_retriever(self):
33         MODEL\_FILE = \textcolor{stringliteral}{'/tmp/tmp\_test\_babi'}
34         DB\_PATH = \textcolor{stringliteral}{'/tmp/tmp\_test\_babi.db'}
35         TFIDF\_PATH = \textcolor{stringliteral}{'/tmp/tmp\_test\_babi.tfidf'}
36         \textcolor{comment}{# keep things quiet}
37         logger.setLevel(ERROR)
38         \textcolor{keywordflow}{try}:
39             parser = ParlaiParser(\textcolor{keyword}{True}, \textcolor{keyword}{True})
40             parser.set\_defaults(
41                 model=\textcolor{stringliteral}{'tfidf\_retriever'},
42                 task=\textcolor{stringliteral}{'babi:task1k:1'},
43                 model\_file=MODEL\_FILE,
44                 retriever\_numworkers=4,
45                 retriever\_hashsize=2 ** 8,
46                 datatype=\textcolor{stringliteral}{'train:ordered'},
47                 num\_epochs=1,
48             )
49             opt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
50             with contextlib.redirect\_stdout(io.StringIO()):
51                 agent = \hyperlink{namespaceparlai_1_1core_1_1agents_a00d77a7e26fb89e8bd900f7b2a02982a}{create\_agent}(opt)
52                 train\_world = \hyperlink{namespaceparlai_1_1core_1_1worlds_a79969c7ba76d4b3c500f5bb776444dc6}{create\_task}(opt, agent)
53             \textcolor{comment}{# pass examples to dictionary}
54             \textcolor{keywordflow}{while} \textcolor{keywordflow}{not} train\_world.epoch\_done():
55                 train\_world.parley()
56 
57             obs = \{
58                 \textcolor{stringliteral}{'text'}: (
59                     \textcolor{stringliteral}{'Mary moved to the bathroom. John went to the hallway. '}
60                     \textcolor{stringliteral}{'Where is Mary?'}
61                 ),
62                 \textcolor{stringliteral}{'episode\_done'}: \textcolor{keyword}{True},
63             \}
64             agent.observe(obs)
65             reply = agent.act()
66             \textcolor{keyword}{assert} reply[\textcolor{stringliteral}{'text'}] == \textcolor{stringliteral}{'bathroom'}
67 
68             ANS = \textcolor{stringliteral}{'The one true label.'}
69             new\_example = \{
70                 \textcolor{stringliteral}{'text'}: \textcolor{stringliteral}{'A bunch of new words that are not in the other task, '}
71                 \textcolor{stringliteral}{'which the model should be able to use to identify '}
72                 \textcolor{stringliteral}{'this label.'},
73                 \textcolor{stringliteral}{'labels'}: [ANS],
74                 \textcolor{stringliteral}{'episode\_done'}: \textcolor{keyword}{True},
75             \}
76             agent.observe(new\_example)
77             reply = agent.act()
78             \textcolor{keyword}{assert} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} reply \textcolor{keywordflow}{and} reply[\textcolor{stringliteral}{'text'}] == ANS
79 
80             new\_example.pop(\textcolor{stringliteral}{'labels'})
81             agent.observe(new\_example)
82             reply = agent.act()
83             \textcolor{keyword}{assert} reply[\textcolor{stringliteral}{'text'}] == ANS
84         \textcolor{keywordflow}{finally}:
85             \textcolor{comment}{# clean up files}
86             \textcolor{keywordflow}{if} os.path.exists(DB\_PATH):
87                 os.remove(DB\_PATH)
88             \textcolor{keywordflow}{if} os.path.exists(TFIDF\_PATH + \textcolor{stringliteral}{'.npz'}):
89                 os.remove(TFIDF\_PATH + \textcolor{stringliteral}{'.npz'})
90 
91 
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
tests/\hyperlink{test__tfidf__retriever_8py}{test\+\_\+tfidf\+\_\+retriever.\+py}\end{DoxyCompactItemize}
