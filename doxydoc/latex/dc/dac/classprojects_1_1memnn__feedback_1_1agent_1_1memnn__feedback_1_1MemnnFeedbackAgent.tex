\hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent}{}\section{projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent Class Reference}
\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent}\index{projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent@{projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent}}


Inheritance diagram for projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{db/d72/classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=274pt]{dd/dd6/classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a08f6869824b3663c1cb76206daa07942}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9aef833617afc1637860f936e9f375a9}{opt}, shared=None)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a77c9550f6fa662fb4631150f391103b3}{share} (self)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2913695371d86863bcbc948505c3182f}{observe} (self, \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a096b4343510a89d11973b402879d54e4}{observation})
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a190948d766ed7c0fa025ec194ed1ff97}{reset} (self)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a79db903bd9937e09ba96eee4ba9ceb6d}{backward} (self, loss, retain\+\_\+graph=False)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a785f2bba986bca5cee12463a66b34889}{parse\+\_\+cands} (self, cand\+\_\+answers)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0da73c85ed6219edf8583a89a05eb8f2}{get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta} (self, cands, selected\+\_\+answer\+\_\+inds)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2e75fe3eda586069de1a2435ba7fae16}{predict} (self, xs, answer\+\_\+cands, ys=None, \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a28d975fb10cf1f644556b3a54df23b53}{feedback\+\_\+cands}=None)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a1f4d9fba4c0ebf00025f328421a9af55}{ranked\+\_\+predictions} (self, cands, scores)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a8e62a0326b38fe1ec6b7ef785638fd98}{decode} (self, output\+\_\+embeddings, ys=None)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a094d93392d7c4954d4762cde09cf8b0a}{generated\+\_\+predictions} (self, output\+\_\+lines)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_abe550254c04f404d488de04a0def4df1}{parse} (self, text)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9fafb9b83a4dcb66d07f40a70826b594}{batchify} (self, obs)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_af47447adf3b049849603021a9aa03fef}{batch\+\_\+act} (self, observations)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ac5b3aecbd5c3b8e5cd4771d892274e7b}{act} (self)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2e17ab619266912c4294886a57645399}{save} (self, path=None)
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ad641f1d7c6d29c713c48a41ad8369c49}{load} (self, path)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ac77a63329c6421026ee33f56d1169c5c}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a67efbdc90aa929ffe6a439e6017fae63}{id}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a7c8a6f6deb9e4d860f3f1eb9de2f2195}{dict}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2006613edb55be12760eb1feabf2dd97}{decoder}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a6284cf09dc90bd4a9993b0f3c6ea01ab}{beta\+\_\+word}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a3a3edf6d4996d4660deffadd70ebe8c8}{model}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_afa2e8e1127ca26929a6d02018375054e}{optimizers}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9aef833617afc1637860f936e9f375a9}{opt}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0bee70e6c12e3bbe1067e38b3cf7dd27}{mem\+\_\+size}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a4a334c65b438e85ed7a850e21bda08b7}{loss\+\_\+fn}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aadc3848c644eb9a4b0bff200d901ce4d}{gradient\+\_\+clip}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aa9ec76c92943750147652aa7dd32f589}{model\+\_\+setting}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a28d975fb10cf1f644556b3a54df23b53}{feedback\+\_\+cands}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a248a6c548087c1e306b8c8d5b4de2192}{num\+\_\+feedback\+\_\+cands}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aa061f22b3516dbcd222f9bcb776f2b74}{longest\+\_\+label}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a23918461677d3da30ecdee627a7bbfc2}{E\+ND}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a3c12ae68b9af8cc5096f5c354aee6ece}{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_afc7d804a7d2b7b3976b2982d3fafe63e}{S\+T\+A\+RT}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a7ddd60e422ae2badc5120b5961a1f369}{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a12e23e00184c43ee673313347b19236c}{last\+\_\+cands\+\_\+list}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a096b4343510a89d11973b402879d54e4}{observation}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a637d040242e00548efc94ac6b28e89d8}{episode\+\_\+done}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a94915476f2ef5185c25ea198cf9cd17f}{rewarded\+\_\+examples\+\_\+inds}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0c533f33dc2fadca9725b08b320031e9}{labels}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a8a0af27be11c110900642f272f7206ab}{feedback\+\_\+labels}
\item 
\hyperlink{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a13df1406ae2129175bf1319ac27b0895}{last\+\_\+cands}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Memory Network agent for question answering that supports reward-based learning
(RBI), forward prediction (FP), and imitation learning (IM).

For more details on settings see: https://arxiv.org/abs/1604.06045.

Models settings 'FP', 'RBI', 'RBI+FP', and 'IM_feedback' assume that
feedback and reward for the current example immediatly follow the query
(add ':feedback' argument when specifying task name).

python examples/train_model.py --setting 'FP'
-m "projects.memnn_feedback.agent.memnn_feedback:MemnnFeedbackAgent"
-t "projects.memnn_feedback.tasks.dbll_babi.agents:taskTeacher:3_p0.5:feedback"
\end{DoxyVerb}
 

Definition at line 22 of file memnn\+\_\+feedback.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a08f6869824b3663c1cb76206daa07942}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a08f6869824b3663c1cb76206daa07942}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 119 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
119     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
120         super().\_\_init\_\_(opt, shared)
121 
122         opt[\textcolor{stringliteral}{'cuda'}] = \textcolor{keywordflow}{not} opt[\textcolor{stringliteral}{'no\_cuda'}] \textcolor{keywordflow}{and} torch.cuda.is\_available()
123         \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'cuda'}]:
124             print(\textcolor{stringliteral}{'[ Using CUDA ]'})
125             torch.cuda.device(opt[\textcolor{stringliteral}{'gpu'}])
126 
127         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} shared:
128             self.id = \textcolor{stringliteral}{'MemNN'}
129             self.dict = DictionaryAgent(opt)
130             self.decoder = \textcolor{keywordtype}{None}
131             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'output'}] == \textcolor{stringliteral}{'generate'} \textcolor{keywordflow}{or} opt[\textcolor{stringliteral}{'output'}] == \textcolor{stringliteral}{'g'}:
132                 self.decoder = Decoder(
133                     opt[\textcolor{stringliteral}{'embedding\_size'}],
134                     opt[\textcolor{stringliteral}{'embedding\_size'}],
135                     opt[\textcolor{stringliteral}{'rnn\_layers'}],
136                     opt,
137                     self.dict,
138                 )
139             \textcolor{keywordflow}{elif} opt[\textcolor{stringliteral}{'output'}] != \textcolor{stringliteral}{'rank'} \textcolor{keywordflow}{and} opt[\textcolor{stringliteral}{'output'}] != \textcolor{stringliteral}{'r':}
140 \textcolor{stringliteral}{                }\textcolor{keywordflow}{raise} NotImplementedError(\textcolor{stringliteral}{'Output type not supported.'})
141 
142             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'setting'}]:
143                 \textcolor{comment}{# add extra beta-word to indicate learner's answer}
144                 self.beta\_word = \textcolor{stringliteral}{'betaword'}
145                 self.dict.add\_to\_dict([self.beta\_word])
146 
147             self.model = MemNN(opt, self.dict)
148 
149             optim\_params = [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} self.model.parameters() \textcolor{keywordflow}{if} p.requires\_grad]
150             lr = opt[\textcolor{stringliteral}{'learning\_rate'}]
151             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'sgd'}:
152                 self.optimizers = \{\textcolor{stringliteral}{'memnn'}: optim.SGD(optim\_params, lr=lr)\}
153                 \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
154                     self.optimizers[\textcolor{stringliteral}{'decoder'}] = optim.SGD(
155                         self.decoder.parameters(), lr=lr
156                     )
157             \textcolor{keywordflow}{elif} opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'adam'}:
158                 self.optimizers = \{\textcolor{stringliteral}{'memnn'}: optim.Adam(optim\_params, lr=lr)\}
159                 \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
160                     self.optimizers[\textcolor{stringliteral}{'decoder'}] = optim.Adam(
161                         self.decoder.parameters(), lr=lr
162                     )
163             \textcolor{keywordflow}{else}:
164                 \textcolor{keywordflow}{raise} NotImplementedError(\textcolor{stringliteral}{'Optimizer not supported.'})
165 
166             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'cuda'}]:
167                 self.model.share\_memory()
168                 \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
169                     self.decoder.cuda()
170 
171             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'model\_file'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'model\_file'}]):
172                 print(\textcolor{stringliteral}{'Loading existing model parameters from '} + opt[\textcolor{stringliteral}{'model\_file'}])
173                 self.load(opt[\textcolor{stringliteral}{'model\_file'}])
174         \textcolor{keywordflow}{else}:
175             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'model'} \textcolor{keywordflow}{in} shared:
176                 \textcolor{comment}{# model is shared during hogwild}
177                 self.model = shared[\textcolor{stringliteral}{'model'}]
178                 self.dict = shared[\textcolor{stringliteral}{'dict'}]
179                 self.decoder = shared[\textcolor{stringliteral}{'decoder'}]
180                 self.optimizers = shared[\textcolor{stringliteral}{'optimizer'}]
181                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'setting'}]:
182                     self.beta\_word = shared[\textcolor{stringliteral}{'betaword'}]
183 
184         \textcolor{keywordflow}{if} hasattr(self, \textcolor{stringliteral}{'model'}):
185             self.opt = opt
186             self.mem\_size = opt[\textcolor{stringliteral}{'mem\_size'}]
187             self.loss\_fn = CrossEntropyLoss()
188             self.gradient\_clip = opt.get(\textcolor{stringliteral}{'gradient\_clip'}, 0.2)
189 
190             self.model\_setting = opt[\textcolor{stringliteral}{'setting'}]
191             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'setting'}]:
192                 self.feedback\_cands = set([])
193                 self.num\_feedback\_cands = opt[\textcolor{stringliteral}{'num\_feedback\_cands'}]
194 
195             self.longest\_label = 1
196             self.END = self.dict.end\_token
197             self.END\_TENSOR = torch.LongTensor(self.dict.parse(self.END))
198             self.START = self.dict.start\_token
199             self.START\_TENSOR = torch.LongTensor(self.dict.parse(self.START))
200 
201         self.reset()
202         self.last\_cands, self.last\_cands\_list = \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}
203 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ac5b3aecbd5c3b8e5cd4771d892274e7b}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ac5b3aecbd5c3b8e5cd4771d892274e7b}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!act@{act}}
\index{act@{act}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 592 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
592     \textcolor{keyword}{def }act(self):
593         \textcolor{keywordflow}{return} self.batch\_act([self.observation])[0]
594 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ac77a63329c6421026ee33f56d1169c5c}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ac77a63329c6421026ee33f56d1169c5c}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 39 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
39     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
40         DictionaryAgent.add\_cmdline\_args(argparser)
41         arg\_group = argparser.add\_argument\_group(\textcolor{stringliteral}{'MemNN Arguments'})
42         arg\_group.add\_argument(
43             \textcolor{stringliteral}{'-lr'}, \textcolor{stringliteral}{'--learning-rate'}, type=float, default=0.01, help=\textcolor{stringliteral}{'learning rate'}
44         )
45         arg\_group.add\_argument(
46             \textcolor{stringliteral}{'--embedding-size'}, type=int, default=128, help=\textcolor{stringliteral}{'size of token embeddings'}
47         )
48         arg\_group.add\_argument(
49             \textcolor{stringliteral}{'--hops'}, type=int, default=3, help=\textcolor{stringliteral}{'number of memory hops'}
50         )
51         arg\_group.add\_argument(
52             \textcolor{stringliteral}{'--mem-size'}, type=int, default=100, help=\textcolor{stringliteral}{'size of memory'}
53         )
54         arg\_group.add\_argument(
55             \textcolor{stringliteral}{'--time-features'},
56             type=\textcolor{stringliteral}{'bool'},
57             default=\textcolor{keyword}{True},
58             help=\textcolor{stringliteral}{'use time features for memory embeddings'},
59         )
60         arg\_group.add\_argument(
61             \textcolor{stringliteral}{'--position-encoding'},
62             type=\textcolor{stringliteral}{'bool'},
63             default=\textcolor{keyword}{False},
64             help=\textcolor{stringliteral}{'use position encoding instead of bag of words embedding'},
65         )
66         arg\_group.add\_argument(
67             \textcolor{stringliteral}{'-clip'},
68             \textcolor{stringliteral}{'--gradient-clip'},
69             type=float,
70             default=0.2,
71             help=\textcolor{stringliteral}{'gradient clipping using l2 norm'},
72         )
73         arg\_group.add\_argument(
74             \textcolor{stringliteral}{'--output'}, type=str, default=\textcolor{stringliteral}{'rank'}, help=\textcolor{stringliteral}{'type of output (rank|generate)'}
75         )
76         arg\_group.add\_argument(
77             \textcolor{stringliteral}{'--rnn-layers'},
78             type=int,
79             default=2,
80             help=\textcolor{stringliteral}{'number of hidden layers in RNN decoder for generative output'},
81         )
82         arg\_group.add\_argument(
83             \textcolor{stringliteral}{'--dropout'},
84             type=float,
85             default=0.1,
86             help=\textcolor{stringliteral}{'dropout probability for RNN decoder training'},
87         )
88         arg\_group.add\_argument(
89             \textcolor{stringliteral}{'--optimizer'}, default=\textcolor{stringliteral}{'sgd'}, help=\textcolor{stringliteral}{'optimizer type (sgd|adam)'}
90         )
91         arg\_group.add\_argument(
92             \textcolor{stringliteral}{'--no-cuda'},
93             action=\textcolor{stringliteral}{'store\_true'},
94             default=\textcolor{keyword}{False},
95             help=\textcolor{stringliteral}{'disable GPUs even if available'},
96         )
97         arg\_group.add\_argument(
98             \textcolor{stringliteral}{'--gpu'}, type=int, default=-1, help=\textcolor{stringliteral}{'which GPU device to use'}
99         )
100         arg\_group.add\_argument(
101             \textcolor{stringliteral}{'--setting'},
102             type=str,
103             default=\textcolor{stringliteral}{'IM'},
104             help=\textcolor{stringliteral}{'choose among IM, IM\_feedback, RBI, FP, RBI+FP'},
105         )
106         arg\_group.add\_argument(
107             \textcolor{stringliteral}{'--num-feedback-cands'},
108             type=int,
109             default=6,
110             help=\textcolor{stringliteral}{'number of feedback candidates'},
111         )
112         arg\_group.add\_argument(
113             \textcolor{stringliteral}{'--single\_embedder'},
114             type=\textcolor{stringliteral}{'bool'},
115             default=\textcolor{keyword}{False},
116             help=\textcolor{stringliteral}{'number of embedding matrices in the model'},
117         )
118 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a79db903bd9937e09ba96eee4ba9ceb6d}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a79db903bd9937e09ba96eee4ba9ceb6d}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!backward@{backward}}
\index{backward@{backward}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{backward()}{backward()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+backward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{loss,  }\item[{}]{retain\+\_\+graph = {\ttfamily False} }\end{DoxyParamCaption})}



Definition at line 256 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
256     \textcolor{keyword}{def }backward(self, loss, retain\_graph=False):
257         \textcolor{comment}{# zero out optimizer and take one optimization step}
258         \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} self.optimizers.values():
259             o.zero\_grad()
260         loss.backward(retain\_graph=retain\_graph)
261 
262         torch.nn.utils.clip\_grad\_norm(self.model.parameters(), self.gradient\_clip)
263         \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} self.optimizers.values():
264             o.step()
265 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_af47447adf3b049849603021a9aa03fef}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_af47447adf3b049849603021a9aa03fef}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!batch\+\_\+act@{batch\+\_\+act}}
\index{batch\+\_\+act@{batch\+\_\+act}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+act()}{batch\_act()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+batch\+\_\+act (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}



Definition at line 575 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
575     \textcolor{keyword}{def }batch\_act(self, observations):
576         batchsize = len(observations)
577         batch\_reply = [\{\textcolor{stringliteral}{'id'}: self.getID()\} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
578 
579         xs, ys, cands, valid\_inds, feedback\_cands = self.batchify(observations)
580 
581         \textcolor{keywordflow}{if} xs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} len(xs[1]) == 0:
582             \textcolor{keywordflow}{return} batch\_reply
583 
584         \textcolor{comment}{# Either train or predict}
585         predictions = self.predict(xs, cands, ys, feedback\_cands)
586 
587         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(valid\_inds)):
588             batch\_reply[valid\_inds[i]][\textcolor{stringliteral}{'text'}] = predictions[i][0]
589             batch\_reply[valid\_inds[i]][\textcolor{stringliteral}{'text\_candidates'}] = predictions[i]
590         \textcolor{keywordflow}{return} batch\_reply
591 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9fafb9b83a4dcb66d07f40a70826b594}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9fafb9b83a4dcb66d07f40a70826b594}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!batchify@{batchify}}
\index{batchify@{batchify}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{batchify()}{batchify()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+batchify (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns:
    xs = [memories, queries, memory_lengths, query_lengths]
    ys = [labels, label_lengths] (if available, else None)
    cands = list of candidates for each example in batch
    valid_inds = list of indices for examples with valid observations
\end{DoxyVerb}
 

Definition at line 490 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
490     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_aca22dd97c5b6dcda2a7479c1cb22ef1e}{batchify}(self, obs):
491         \textcolor{stringliteral}{"""Returns:}
492 \textcolor{stringliteral}{            xs = [memories, queries, memory\_lengths, query\_lengths]}
493 \textcolor{stringliteral}{            ys = [labels, label\_lengths] (if available, else None)}
494 \textcolor{stringliteral}{            cands = list of candidates for each example in batch}
495 \textcolor{stringliteral}{            valid\_inds = list of indices for examples with valid observations}
496 \textcolor{stringliteral}{        """}
497         exs = [ex \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} obs \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} ex]
498         valid\_inds = [i \textcolor{keywordflow}{for} i, ex \textcolor{keywordflow}{in} enumerate(obs) \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} ex]
499         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} exs:
500             \textcolor{keywordflow}{return} [\textcolor{keywordtype}{None}] * 5
501 
502         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'RBI'} \textcolor{keywordflow}{in} self.model\_setting:
503             self.rewarded\_examples\_inds = [
504                 i
505                 \textcolor{keywordflow}{for} i, ex \textcolor{keywordflow}{in} enumerate(obs)
506                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} ex \textcolor{keywordflow}{and} ex.get(\textcolor{stringliteral}{'reward'}, 0) > 0
507             ]
508 
509         parsed = [self.parse(ex[\textcolor{stringliteral}{'text'}]) \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs]
510         queries = torch.cat([x[0] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed])
511         memories = torch.cat([x[1] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed])
512         query\_lengths = torch.cat([x[2] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed])
513         memory\_lengths = torch.LongTensor(len(exs), self.mem\_size).zero\_()
514         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(exs)):
515             \textcolor{keywordflow}{if} len(parsed[i][3]) > 0:
516                 memory\_lengths[i, -len(parsed[i][3]) :] = parsed[i][3]
517         xs = [memories, queries, memory\_lengths, query\_lengths]
518 
519         ys = \textcolor{keywordtype}{None}
520         self.labels = [random.choice(ex[\textcolor{stringliteral}{'labels'}]) \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs \textcolor{keywordflow}{if} \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} ex]
521 
522         \textcolor{keywordflow}{if} len(self.labels) == len(exs):
523             parsed = [self.dict.txt2vec(l) \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} self.labels]
524             parsed = [torch.LongTensor(p) \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} parsed]
525             label\_lengths = torch.LongTensor([len(p) \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} parsed]).unsqueeze(1)
526             self.longest\_label = max(self.longest\_label, label\_lengths.max())
527             padded = [
528                 torch.cat(
529                     (
530                         p,
531                         torch.LongTensor(self.longest\_label - len(p)).fill\_(
532                             self.END\_TENSOR[0]
533                         ),
534                     )
535                 )
536                 \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} parsed
537             ]
538             labels = torch.stack(padded)
539             ys = [labels, label\_lengths]
540 
541         feedback\_cands = []
542         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{in} self.model\_setting:
543             self.feedback\_labels = [
544                 ex[\textcolor{stringliteral}{'feedback'}]
545                 \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs
546                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'feedback'} \textcolor{keywordflow}{in} ex \textcolor{keywordflow}{and} ex[\textcolor{stringliteral}{'feedback'}] \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}
547             ]
548             self.feedback\_cands = self.feedback\_cands | set(self.feedback\_labels)
549 
550             \textcolor{keywordflow}{if} (
551                 len(self.feedback\_labels) == len(exs)
552                 \textcolor{keywordflow}{and} len(self.feedback\_cands) > self.num\_feedback\_cands
553             ):
554                 feedback\_cands = [
555                     list(
556                         set(
557                             random.sample(self.feedback\_cands, self.num\_feedback\_cands)
558                             + [feedback]
559                         )
560                     )
561                     \textcolor{keywordflow}{for} feedback \textcolor{keywordflow}{in} self.feedback\_labels
562                 ]
563 
564         cands = [ex[\textcolor{stringliteral}{'label\_candidates'}] \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs \textcolor{keywordflow}{if} \textcolor{stringliteral}{'label\_candidates'} \textcolor{keywordflow}{in} ex]
565         \textcolor{comment}{# Use words in dict as candidates if no candidates are provided}
566         \textcolor{keywordflow}{if} len(cands) < len(exs):
567             cands = \hyperlink{namespaceprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_a098f9dace138acef711a30ce16831284}{build\_cands}(exs, self.dict)
568         \textcolor{comment}{# Avoid rebuilding candidate list every batch if its the same}
569         \textcolor{keywordflow}{if} self.last\_cands != cands:
570             self.last\_cands = cands
571             self.last\_cands\_list = [list(c) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cands]
572         cands = self.last\_cands\_list
573         \textcolor{keywordflow}{return} xs, ys, cands, valid\_inds, feedback\_cands
574 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a8e62a0326b38fe1ec6b7ef785638fd98}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a8e62a0326b38fe1ec6b7ef785638fd98}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!decode@{decode}}
\index{decode@{decode}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{decode()}{decode()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+decode (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{output\+\_\+embeddings,  }\item[{}]{ys = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 413 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
413     \textcolor{keyword}{def }decode(self, output\_embeddings, ys=None):
414         batchsize = output\_embeddings.size(0)
415         hn = output\_embeddings.unsqueeze(0).expand(
416             self.opt[\textcolor{stringliteral}{'rnn\_layers'}], batchsize, output\_embeddings.size(1)
417         )
418         x = self.model.answer\_embedder(
419             Variable(torch.LongTensor([1])), Variable(self.START\_TENSOR)
420         )
421         xes = x.unsqueeze(1).expand(x.size(0), batchsize, x.size(1))
422 
423         loss = 0
424         output\_lines = [[] \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
425         done = [\textcolor{keyword}{False} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
426         total\_done = 0
427         idx = 0
428         \textcolor{keywordflow}{while} (total\_done < batchsize) \textcolor{keywordflow}{and} idx < self.longest\_label:
429             \textcolor{comment}{# keep producing tokens until we hit END or max length for each ex}
430             \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'cuda'}]:
431                 xes = xes.cuda()
432                 hn = hn.contiguous()
433             preds, scores = self.decoder(xes, hn)
434             \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
435                 y = Variable(ys[0][:, idx])
436                 temp\_y = y.cuda() \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'cuda'}] \textcolor{keywordflow}{else} y
437                 loss += self.loss\_fn(scores, temp\_y)
438             \textcolor{keywordflow}{else}:
439                 y = preds
440             \textcolor{comment}{# use the true token as the next input for better training}
441             xes = self.model.answer\_embedder(
442                 Variable(torch.LongTensor(preds.numel()).fill\_(1)), y
443             ).unsqueeze(0)
444 
445             \textcolor{keywordflow}{for} b \textcolor{keywordflow}{in} range(batchsize):
446                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} done[b]:
447                     token = self.dict.vec2txt(preds.data[b])
448                     \textcolor{keywordflow}{if} token == self.END:
449                         done[b] = \textcolor{keyword}{True}
450                         total\_done += 1
451                     \textcolor{keywordflow}{else}:
452                         output\_lines[b].append(token)
453             idx += 1
454         \textcolor{keywordflow}{return} output\_lines, loss
455 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a094d93392d7c4954d4762cde09cf8b0a}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a094d93392d7c4954d4762cde09cf8b0a}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!generated\+\_\+predictions@{generated\+\_\+predictions}}
\index{generated\+\_\+predictions@{generated\+\_\+predictions}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{generated\+\_\+predictions()}{generated\_predictions()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+generated\+\_\+predictions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{output\+\_\+lines }\end{DoxyParamCaption})}



Definition at line 456 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
456     \textcolor{keyword}{def }generated\_predictions(self, output\_lines):
457         \textcolor{keywordflow}{return} [
458             [\textcolor{stringliteral}{' '}.join(c \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} o \textcolor{keywordflow}{if} c != self.END \textcolor{keywordflow}{and} c != self.dict.null\_token)]
459             \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} output\_lines
460         ]
461 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0da73c85ed6219edf8583a89a05eb8f2}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0da73c85ed6219edf8583a89a05eb8f2}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta@{get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta}}
\index{get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta@{get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta()}{get\_cand\_embeddings\_with\_added\_beta()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+get\+\_\+cand\+\_\+embeddings\+\_\+with\+\_\+added\+\_\+beta (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{cands,  }\item[{}]{selected\+\_\+answer\+\_\+inds }\end{DoxyParamCaption})}



Definition at line 284 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
284     \textcolor{keyword}{def }get\_cand\_embeddings\_with\_added\_beta(self, cands, selected\_answer\_inds):
285         \textcolor{comment}{# add beta\_word to the candidate selected by the learner to indicate learner's answer}
286         cand\_answers\_with\_beta = copy.deepcopy(cands)
287 
288         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(cand\_answers\_with\_beta)):
289             cand\_answers\_with\_beta[i][selected\_answer\_inds[i]] += \textcolor{stringliteral}{' '} + self.beta\_word
290 
291         \textcolor{comment}{# get candidate embeddings after adding beta\_word to the selected candidate}
292         (
293             cand\_answers\_tensor\_with\_beta,
294             cand\_answers\_lengths\_with\_beta,
295         ) = self.parse\_cands(cand\_answers\_with\_beta)
296         cands\_embeddings\_with\_beta = self.model.answer\_embedder(
297             cand\_answers\_lengths\_with\_beta, cand\_answers\_tensor\_with\_beta
298         )
299         \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'cuda'}]:
300             cands\_embeddings\_with\_beta = cands\_embeddings\_with\_beta.cuda()
301         \textcolor{keywordflow}{return} cands\_embeddings\_with\_beta
302 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ad641f1d7c6d29c713c48a41ad8369c49}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_ad641f1d7c6d29c713c48a41ad8369c49}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!load@{load}}
\index{load@{load}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}



Definition at line 609 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
609     \textcolor{keyword}{def }load(self, path):
610         with open(path, \textcolor{stringliteral}{'rb'}) \textcolor{keyword}{as} read:
611             checkpoint = torch.load(read)
612         self.model.load\_state\_dict(checkpoint[\textcolor{stringliteral}{'memnn'}])
613         self.optimizers[\textcolor{stringliteral}{'memnn'}].load\_state\_dict(checkpoint[\textcolor{stringliteral}{'memnn\_optim'}])
614         \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
615             self.decoder.load\_state\_dict(checkpoint[\textcolor{stringliteral}{'decoder'}])
616             self.optimizers[\textcolor{stringliteral}{'decoder'}].load\_state\_dict(checkpoint[\textcolor{stringliteral}{'decoder\_optim'}])
617             self.longest\_label = checkpoint[\textcolor{stringliteral}{'longest\_label'}]
618 
619 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2913695371d86863bcbc948505c3182f}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2913695371d86863bcbc948505c3182f}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!observe@{observe}}
\index{observe@{observe}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}



Definition at line 218 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
218     \textcolor{keyword}{def }observe(self, observation):
219         observation = copy.copy(observation)
220 
221         \textcolor{comment}{# extract feedback for forward prediction}
222         \textcolor{comment}{# IM setting - no feedback provided in the dataset}
223         \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'setting'}] != \textcolor{stringliteral}{'IM'}:
224             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} observation:
225                 split = observation[\textcolor{stringliteral}{'text'}].split(\textcolor{stringliteral}{'\(\backslash\)n'})
226                 feedback = split[-1]
227                 observation[\textcolor{stringliteral}{'feedback'}] = feedback
228                 observation[\textcolor{stringliteral}{'text'}] = \textcolor{stringliteral}{'\(\backslash\)n'}.join(split[:-1])
229 
230         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.episode\_done:
231             \textcolor{comment}{# if the last example wasn't the end of an episode, then we need to}
232             \textcolor{comment}{# recall what was said in that example}
233             prev\_dialogue = (
234                 self.observation[\textcolor{stringliteral}{'text'}] \textcolor{keywordflow}{if} self.observation \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} \textcolor{stringliteral}{''}
235             )
236 
237             \textcolor{comment}{# append answer and feedback (if available) given in the previous example to the previous
       dialog}
238             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'eval\_labels'} \textcolor{keywordflow}{in} self.observation:
239                 prev\_dialogue += \textcolor{stringliteral}{'\(\backslash\)n'} + random.choice(self.observation[\textcolor{stringliteral}{'eval\_labels'}])
240             \textcolor{keywordflow}{elif} \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} self.observation:
241                 prev\_dialogue += \textcolor{stringliteral}{'\(\backslash\)n'} + random.choice(self.observation[\textcolor{stringliteral}{'labels'}])
242             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'feedback'} \textcolor{keywordflow}{in} self.observation:
243                 prev\_dialogue += \textcolor{stringliteral}{'\(\backslash\)n'} + self.observation[\textcolor{stringliteral}{'feedback'}]
244 
245             observation[\textcolor{stringliteral}{'text'}] = prev\_dialogue + \textcolor{stringliteral}{'\(\backslash\)n'} + observation[\textcolor{stringliteral}{'text'}]
246 
247         self.observation = observation
248         self.episode\_done = observation[\textcolor{stringliteral}{'episode\_done'}]
249         \textcolor{keywordflow}{return} observation
250 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_abe550254c04f404d488de04a0def4df1}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_abe550254c04f404d488de04a0def4df1}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!parse@{parse}}
\index{parse@{parse}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{parse()}{parse()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+parse (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns:
    query = tensor (vector) of token indices for query
    query_length = length of query
    memory = tensor (matrix) where each row contains token indices for a memory
    memory_lengths = tensor (vector) with lengths of each memory
\end{DoxyVerb}
 

Definition at line 462 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
462     \textcolor{keyword}{def }parse(self, text):
463         \textcolor{stringliteral}{"""Returns:}
464 \textcolor{stringliteral}{            query = tensor (vector) of token indices for query}
465 \textcolor{stringliteral}{            query\_length = length of query}
466 \textcolor{stringliteral}{            memory = tensor (matrix) where each row contains token indices for a memory}
467 \textcolor{stringliteral}{            memory\_lengths = tensor (vector) with lengths of each memory}
468 \textcolor{stringliteral}{        """}
469         sp = text.split(\textcolor{stringliteral}{'\(\backslash\)n'})
470         query\_sentence = sp[-1]
471         query = self.dict.txt2vec(query\_sentence)
472         query = torch.LongTensor(query)
473         query\_length = torch.LongTensor([len(query)])
474 
475         sp = sp[:-1]
476         sentences = []
477         \textcolor{keywordflow}{for} s \textcolor{keywordflow}{in} sp:
478             sentences.extend(s.split(\textcolor{stringliteral}{'\(\backslash\)t'}))
479         \textcolor{keywordflow}{if} len(sentences) == 0:
480             sentences.append(self.dict.null\_token)
481 
482         num\_mems = min(self.mem\_size, len(sentences))
483         memory\_sentences = sentences[-num\_mems:]
484         memory = [self.dict.txt2vec(s) \textcolor{keywordflow}{for} s \textcolor{keywordflow}{in} memory\_sentences]
485         memory = [torch.LongTensor(m) \textcolor{keywordflow}{for} m \textcolor{keywordflow}{in} memory]
486         memory\_lengths = torch.LongTensor([len(m) \textcolor{keywordflow}{for} m \textcolor{keywordflow}{in} memory])
487         memory = torch.cat(memory)
488         \textcolor{keywordflow}{return} (query, memory, query\_length, memory\_lengths)
489 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a785f2bba986bca5cee12463a66b34889}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a785f2bba986bca5cee12463a66b34889}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!parse\+\_\+cands@{parse\+\_\+cands}}
\index{parse\+\_\+cands@{parse\+\_\+cands}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{parse\+\_\+cands()}{parse\_cands()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+parse\+\_\+cands (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{cand\+\_\+answers }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns:
    cand_answers = tensor (vector) of token indices for answer candidates
    cand_answers_lengths = tensor (vector) with lengths of each answer candidate
\end{DoxyVerb}
 

Definition at line 266 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
266     \textcolor{keyword}{def }parse\_cands(self, cand\_answers):
267         \textcolor{stringliteral}{"""Returns:}
268 \textcolor{stringliteral}{            cand\_answers = tensor (vector) of token indices for answer candidates}
269 \textcolor{stringliteral}{            cand\_answers\_lengths = tensor (vector) with lengths of each answer candidate}
270 \textcolor{stringliteral}{        """}
271         parsed\_cands = [\hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_a8bf19c6993b40602c1d86a848b30c5a1}{to\_tensors}(c, self.dict) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cand\_answers]
272         cand\_answers\_tensor = torch.cat([x[1] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed\_cands])
273         max\_cands\_len = max([len(c) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cand\_answers])
274         cand\_answers\_lengths = torch.LongTensor(
275             len(cand\_answers), max\_cands\_len
276         ).zero\_()
277         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(cand\_answers)):
278             \textcolor{keywordflow}{if} len(parsed\_cands[i][0]) > 0:
279                 cand\_answers\_lengths[i, -len(parsed\_cands[i][0]) :] = parsed\_cands[i][0]
280         cand\_answers\_tensor = Variable(cand\_answers\_tensor)
281         cand\_answers\_lengths = Variable(cand\_answers\_lengths)
282         \textcolor{keywordflow}{return} cand\_answers\_tensor, cand\_answers\_lengths
283 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2e75fe3eda586069de1a2435ba7fae16}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2e75fe3eda586069de1a2435ba7fae16}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!predict@{predict}}
\index{predict@{predict}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{predict()}{predict()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+predict (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{xs,  }\item[{}]{answer\+\_\+cands,  }\item[{}]{ys = {\ttfamily None},  }\item[{}]{feedback\+\_\+cands = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 303 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
303     \textcolor{keyword}{def }predict(self, xs, answer\_cands, ys=None, feedback\_cands=None):
304         is\_training = ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}
305         \textcolor{keywordflow}{if} is\_training \textcolor{keywordflow}{and} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.model\_setting:
306             \textcolor{comment}{# Subsample to reduce training time}
307             answer\_cands = [
308                 list(set(random.sample(c, min(32, len(c))) + self.labels))
309                 \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} answer\_cands
310             ]
311         \textcolor{keywordflow}{else}:
312             \textcolor{comment}{# rank all cands to increase accuracy}
313             answer\_cands = [list(set(c)) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} answer\_cands]
314 
315         self.model.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}(mode=is\_training)
316 
317         \textcolor{comment}{# Organize inputs for network (see contents of xs and ys in batchify method)}
318         inputs = [Variable(x, volatile=is\_training) \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} xs]
319 
320         \textcolor{keywordflow}{if} self.decoder:
321             output\_embeddings = self.model(*inputs)
322             self.decoder.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}(mode=is\_training)
323             output\_lines, loss = self.decode(output\_embeddings, ys)
324             predictions = self.generated\_predictions(output\_lines)
325             self.backward(loss)
326             \textcolor{keywordflow}{return} predictions
327 
328         scores = \textcolor{keywordtype}{None}
329         \textcolor{keywordflow}{if} is\_training:
330             label\_inds = [
331                 cand\_list.index(self.labels[i])
332                 \textcolor{keywordflow}{for} i, cand\_list \textcolor{keywordflow}{in} enumerate(answer\_cands)
333             ]
334 
335             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{in} self.model\_setting:
336                 \textcolor{keywordflow}{if} len(feedback\_cands) == 0:
337                     print(
338                         \textcolor{stringliteral}{'FP is not training... waiting for negative feedback examples'}
339                     )
340                 \textcolor{keywordflow}{else}:
341                     cand\_answers\_embs\_with\_beta = self.get\_cand\_embeddings\_with\_added\_beta(
342                         answer\_cands, label\_inds
343                     )
344                     scores, forward\_prediction\_output = self.model(
345                         *inputs, answer\_cands, cand\_answers\_embs\_with\_beta
346                     )
347                     fp\_scores = self.model.get\_score(
348                         feedback\_cands, forward\_prediction\_output, forward\_predict=\textcolor{keyword}{True}
349                     )
350                     feedback\_label\_inds = [
351                         cand\_list.index(self.feedback\_labels[i])
352                         \textcolor{keywordflow}{for} i, cand\_list \textcolor{keywordflow}{in} enumerate(feedback\_cands)
353                     ]
354                     \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'cuda'}]:
355                         feedback\_label\_inds = Variable(
356                             torch.cuda.LongTensor(feedback\_label\_inds)
357                         )
358                     \textcolor{keywordflow}{else}:
359                         feedback\_label\_inds = Variable(
360                             torch.LongTensor(feedback\_label\_inds)
361                         )
362                     loss\_fp = self.loss\_fn(fp\_scores, feedback\_label\_inds)
363                     \textcolor{keywordflow}{if} loss\_fp.data[0] > 100000:
364                         \textcolor{keywordflow}{raise} Exception(
365                             \textcolor{stringliteral}{"Loss might be diverging. Loss:"}, loss\_fp.data[0]
366                         )
367                     self.backward(loss\_fp, retain\_graph=\textcolor{keyword}{True})
368 
369             \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'cuda'}]:
370                 label\_inds = Variable(torch.cuda.LongTensor(label\_inds))
371             \textcolor{keywordflow}{else}:
372                 label\_inds = Variable(torch.LongTensor(label\_inds))
373 
374         \textcolor{keywordflow}{if} scores \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
375             output\_embeddings = self.model(*inputs)
376             scores = self.model.get\_score(answer\_cands, output\_embeddings)
377 
378         predictions = self.ranked\_predictions(answer\_cands, scores)
379 
380         \textcolor{keywordflow}{if} is\_training:
381             update\_params = \textcolor{keyword}{True}
382             \textcolor{comment}{# don't perform regular training if in FP mode}
383             \textcolor{keywordflow}{if} self.model\_setting == \textcolor{stringliteral}{'FP'}:
384                 update\_params = \textcolor{keyword}{False}
385             \textcolor{keywordflow}{elif} \textcolor{stringliteral}{'RBI'} \textcolor{keywordflow}{in} self.model\_setting:
386                 \textcolor{keywordflow}{if} len(self.rewarded\_examples\_inds) == 0:
387                     update\_params = \textcolor{keyword}{False}
388                 \textcolor{keywordflow}{else}:
389                     self.rewarded\_examples\_inds = torch.LongTensor(
390                         self.rewarded\_examples\_inds
391                     )
392                     \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'cuda'}]:
393                         self.rewarded\_examples\_inds = self.rewarded\_examples\_inds.cuda()
394                     \textcolor{comment}{# use only rewarded examples for training}
395                     loss = self.loss\_fn(
396                         scores[self.rewarded\_examples\_inds, :],
397                         label\_inds[self.rewarded\_examples\_inds],
398                     )
399             \textcolor{keywordflow}{else}:
400                 \textcolor{comment}{# regular IM training}
401                 loss = self.loss\_fn(scores, label\_inds)
402 
403             \textcolor{keywordflow}{if} update\_params:
404                 self.backward(loss)
405         \textcolor{keywordflow}{return} predictions
406 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a1f4d9fba4c0ebf00025f328421a9af55}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a1f4d9fba4c0ebf00025f328421a9af55}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!ranked\+\_\+predictions@{ranked\+\_\+predictions}}
\index{ranked\+\_\+predictions@{ranked\+\_\+predictions}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{ranked\+\_\+predictions()}{ranked\_predictions()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+ranked\+\_\+predictions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{cands,  }\item[{}]{scores }\end{DoxyParamCaption})}



Definition at line 407 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
407     \textcolor{keyword}{def }ranked\_predictions(self, cands, scores):
408         \_, inds = scores.data.sort(descending=\textcolor{keyword}{True}, dim=1)
409         \textcolor{keywordflow}{return} [
410             [cands[i][j] \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} r \textcolor{keywordflow}{if} j < len(cands[i])] \textcolor{keywordflow}{for} i, r \textcolor{keywordflow}{in} enumerate(inds)
411         ]
412 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a190948d766ed7c0fa025ec194ed1ff97}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a190948d766ed7c0fa025ec194ed1ff97}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!reset@{reset}}
\index{reset@{reset}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 251 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
251     \textcolor{keyword}{def }reset(self):
252         \textcolor{comment}{# reset observation and episode\_done}
253         self.observation = \textcolor{keywordtype}{None}
254         self.episode\_done = \textcolor{keyword}{True}
255 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2e17ab619266912c4294886a57645399}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2e17ab619266912c4294886a57645399}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!save@{save}}
\index{save@{save}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 595 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
595     \textcolor{keyword}{def }save(self, path=None):
596         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} path
597 
598         \textcolor{keywordflow}{if} path:
599             checkpoint = \{\}
600             checkpoint[\textcolor{stringliteral}{'memnn'}] = self.model.state\_dict()
601             checkpoint[\textcolor{stringliteral}{'memnn\_optim'}] = self.optimizers[\textcolor{stringliteral}{'memnn'}].state\_dict()
602             \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
603                 checkpoint[\textcolor{stringliteral}{'decoder'}] = self.decoder.state\_dict()
604                 checkpoint[\textcolor{stringliteral}{'decoder\_optim'}] = self.optimizers[\textcolor{stringliteral}{'decoder'}].state\_dict()
605                 checkpoint[\textcolor{stringliteral}{'longest\_label'}] = self.longest\_label
606             with open(path, \textcolor{stringliteral}{'wb'}) \textcolor{keyword}{as} write:
607                 torch.save(checkpoint, write)
608 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a77c9550f6fa662fb4631150f391103b3}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a77c9550f6fa662fb4631150f391103b3}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!share@{share}}
\index{share@{share}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 204 of file memnn\+\_\+feedback.\+py.


\begin{DoxyCode}
204     \textcolor{keyword}{def }share(self):
205         \textcolor{comment}{# Share internal states between parent and child instances}
206         shared = super().share()
207 
208         \textcolor{keywordflow}{if} self.opt.get(\textcolor{stringliteral}{'numthreads'}, 1) > 1:
209             shared[\textcolor{stringliteral}{'model'}] = self.model
210             self.model.share\_memory()
211             shared[\textcolor{stringliteral}{'optimizer'}] = self.optimizers
212             shared[\textcolor{stringliteral}{'dict'}] = self.dict
213             shared[\textcolor{stringliteral}{'decoder'}] = self.decoder
214             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'FP'} \textcolor{keywordflow}{in} self.model\_setting:
215                 shared[\textcolor{stringliteral}{'betaword'}] = self.beta\_word
216         \textcolor{keywordflow}{return} shared
217 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a6284cf09dc90bd4a9993b0f3c6ea01ab}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a6284cf09dc90bd4a9993b0f3c6ea01ab}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!beta\+\_\+word@{beta\+\_\+word}}
\index{beta\+\_\+word@{beta\+\_\+word}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{beta\+\_\+word}{beta\_word}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+beta\+\_\+word}



Definition at line 144 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2006613edb55be12760eb1feabf2dd97}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a2006613edb55be12760eb1feabf2dd97}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!decoder@{decoder}}
\index{decoder@{decoder}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{decoder}{decoder}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+decoder}



Definition at line 130 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a7c8a6f6deb9e4d860f3f1eb9de2f2195}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a7c8a6f6deb9e4d860f3f1eb9de2f2195}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!dict@{dict}}
\index{dict@{dict}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+dict}



Definition at line 129 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a23918461677d3da30ecdee627a7bbfc2}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a23918461677d3da30ecdee627a7bbfc2}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!E\+ND@{E\+ND}}
\index{E\+ND@{E\+ND}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{E\+ND}{END}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+E\+ND}



Definition at line 196 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a3c12ae68b9af8cc5096f5c354aee6ece}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a3c12ae68b9af8cc5096f5c354aee6ece}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!E\+N\+D\+\_\+\+T\+E\+N\+S\+OR@{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}}
\index{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR@{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}{END\_TENSOR}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}



Definition at line 197 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a637d040242e00548efc94ac6b28e89d8}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a637d040242e00548efc94ac6b28e89d8}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!episode\+\_\+done@{episode\+\_\+done}}
\index{episode\+\_\+done@{episode\+\_\+done}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{episode\+\_\+done}{episode\_done}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+episode\+\_\+done}



Definition at line 248 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a28d975fb10cf1f644556b3a54df23b53}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a28d975fb10cf1f644556b3a54df23b53}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!feedback\+\_\+cands@{feedback\+\_\+cands}}
\index{feedback\+\_\+cands@{feedback\+\_\+cands}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{feedback\+\_\+cands}{feedback\_cands}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+feedback\+\_\+cands}



Definition at line 192 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a8a0af27be11c110900642f272f7206ab}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a8a0af27be11c110900642f272f7206ab}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!feedback\+\_\+labels@{feedback\+\_\+labels}}
\index{feedback\+\_\+labels@{feedback\+\_\+labels}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{feedback\+\_\+labels}{feedback\_labels}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+feedback\+\_\+labels}



Definition at line 543 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aadc3848c644eb9a4b0bff200d901ce4d}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aadc3848c644eb9a4b0bff200d901ce4d}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!gradient\+\_\+clip@{gradient\+\_\+clip}}
\index{gradient\+\_\+clip@{gradient\+\_\+clip}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{gradient\+\_\+clip}{gradient\_clip}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+gradient\+\_\+clip}



Definition at line 188 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a67efbdc90aa929ffe6a439e6017fae63}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a67efbdc90aa929ffe6a439e6017fae63}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!id@{id}}
\index{id@{id}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+id}



Definition at line 128 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0c533f33dc2fadca9725b08b320031e9}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0c533f33dc2fadca9725b08b320031e9}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!labels@{labels}}
\index{labels@{labels}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{labels}{labels}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+labels}



Definition at line 520 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a13df1406ae2129175bf1319ac27b0895}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a13df1406ae2129175bf1319ac27b0895}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!last\+\_\+cands@{last\+\_\+cands}}
\index{last\+\_\+cands@{last\+\_\+cands}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{last\+\_\+cands}{last\_cands}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+last\+\_\+cands}



Definition at line 570 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a12e23e00184c43ee673313347b19236c}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a12e23e00184c43ee673313347b19236c}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!last\+\_\+cands\+\_\+list@{last\+\_\+cands\+\_\+list}}
\index{last\+\_\+cands\+\_\+list@{last\+\_\+cands\+\_\+list}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{last\+\_\+cands\+\_\+list}{last\_cands\_list}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+last\+\_\+cands\+\_\+list}



Definition at line 202 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aa061f22b3516dbcd222f9bcb776f2b74}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aa061f22b3516dbcd222f9bcb776f2b74}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!longest\+\_\+label@{longest\+\_\+label}}
\index{longest\+\_\+label@{longest\+\_\+label}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{longest\+\_\+label}{longest\_label}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+longest\+\_\+label}



Definition at line 195 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a4a334c65b438e85ed7a850e21bda08b7}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a4a334c65b438e85ed7a850e21bda08b7}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!loss\+\_\+fn@{loss\+\_\+fn}}
\index{loss\+\_\+fn@{loss\+\_\+fn}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{loss\+\_\+fn}{loss\_fn}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+loss\+\_\+fn}



Definition at line 187 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0bee70e6c12e3bbe1067e38b3cf7dd27}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a0bee70e6c12e3bbe1067e38b3cf7dd27}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!mem\+\_\+size@{mem\+\_\+size}}
\index{mem\+\_\+size@{mem\+\_\+size}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{mem\+\_\+size}{mem\_size}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+mem\+\_\+size}



Definition at line 186 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a3a3edf6d4996d4660deffadd70ebe8c8}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a3a3edf6d4996d4660deffadd70ebe8c8}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!model@{model}}
\index{model@{model}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+model}



Definition at line 147 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aa9ec76c92943750147652aa7dd32f589}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_aa9ec76c92943750147652aa7dd32f589}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!model\+\_\+setting@{model\+\_\+setting}}
\index{model\+\_\+setting@{model\+\_\+setting}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{model\+\_\+setting}{model\_setting}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+model\+\_\+setting}



Definition at line 190 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a248a6c548087c1e306b8c8d5b4de2192}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a248a6c548087c1e306b8c8d5b4de2192}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!num\+\_\+feedback\+\_\+cands@{num\+\_\+feedback\+\_\+cands}}
\index{num\+\_\+feedback\+\_\+cands@{num\+\_\+feedback\+\_\+cands}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{num\+\_\+feedback\+\_\+cands}{num\_feedback\_cands}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+num\+\_\+feedback\+\_\+cands}



Definition at line 193 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a096b4343510a89d11973b402879d54e4}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a096b4343510a89d11973b402879d54e4}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!observation@{observation}}
\index{observation@{observation}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+observation}



Definition at line 247 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9aef833617afc1637860f936e9f375a9}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a9aef833617afc1637860f936e9f375a9}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!opt@{opt}}
\index{opt@{opt}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+opt}



Definition at line 185 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_afa2e8e1127ca26929a6d02018375054e}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_afa2e8e1127ca26929a6d02018375054e}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!optimizers@{optimizers}}
\index{optimizers@{optimizers}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{optimizers}{optimizers}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+optimizers}



Definition at line 152 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a94915476f2ef5185c25ea198cf9cd17f}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a94915476f2ef5185c25ea198cf9cd17f}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!rewarded\+\_\+examples\+\_\+inds@{rewarded\+\_\+examples\+\_\+inds}}
\index{rewarded\+\_\+examples\+\_\+inds@{rewarded\+\_\+examples\+\_\+inds}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{rewarded\+\_\+examples\+\_\+inds}{rewarded\_examples\_inds}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+rewarded\+\_\+examples\+\_\+inds}



Definition at line 389 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_afc7d804a7d2b7b3976b2982d3fafe63e}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_afc7d804a7d2b7b3976b2982d3fafe63e}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!S\+T\+A\+RT@{S\+T\+A\+RT}}
\index{S\+T\+A\+RT@{S\+T\+A\+RT}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{S\+T\+A\+RT}{START}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+S\+T\+A\+RT}



Definition at line 198 of file memnn\+\_\+feedback.\+py.

\mbox{\Hypertarget{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a7ddd60e422ae2badc5120b5961a1f369}\label{classprojects_1_1memnn__feedback_1_1agent_1_1memnn__feedback_1_1MemnnFeedbackAgent_a7ddd60e422ae2badc5120b5961a1f369}} 
\index{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}!S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR@{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}}
\index{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR@{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}!projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent@{projects\+::memnn\+\_\+feedback\+::agent\+::memnn\+\_\+feedback\+::\+Memnn\+Feedback\+Agent}}
\subsubsection{\texorpdfstring{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}{START\_TENSOR}}
{\footnotesize\ttfamily projects.\+memnn\+\_\+feedback.\+agent.\+memnn\+\_\+feedback.\+Memnn\+Feedback\+Agent.\+S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}



Definition at line 199 of file memnn\+\_\+feedback.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/memnn\+\_\+feedback/agent/\hyperlink{memnn__feedback_8py}{memnn\+\_\+feedback.\+py}\end{DoxyCompactItemize}
