\hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher}{}\section{parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher Class Reference}
\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher}\index{parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher@{parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher}}


Inheritance diagram for parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{d7/de5/classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=215pt]{d1/d26/classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_afabbebdbb464879554723b2b3af62493}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1core_1_1agents_1_1Teacher_a3ce6243860ce978a897922863ed32fa4}{opt}, shared=None)
\item 
def \hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_ac640a241c4e9ac29feddd1ecbbb35509}{setup\+\_\+data} (self, input\+\_\+path)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a343d704bea4fc5c096000b73b2796e03}{dt}
\item 
\hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_acac9910a97f5b0ee9af7e9bd8a7e2d78}{agg\+\_\+ops}
\item 
\hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a8d6572adccf79dd778ec80ec14647980}{cond\+\_\+ops}
\item 
\hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a1a67c761791a412586131dd7dd595a7c}{syms}
\item 
\hyperlink{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_aec62053f23dd71f7db3997534f631136}{id}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 33 of file agents.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_afabbebdbb464879554723b2b3af62493}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_afabbebdbb464879554723b2b3af62493}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 34 of file agents.\+py.


\begin{DoxyCode}
34     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
35         \textcolor{comment}{# store datatype}
36         self.dt = \_datatype(opt)
37 
38         self.agg\_ops = [\textcolor{stringliteral}{''}, \textcolor{stringliteral}{'MAX'}, \textcolor{stringliteral}{'MIN'}, \textcolor{stringliteral}{'COUNT'}, \textcolor{stringliteral}{'SUM'}, \textcolor{stringliteral}{'AVG'}]
39         self.cond\_ops = [\textcolor{stringliteral}{'='}, \textcolor{stringliteral}{'>'}, \textcolor{stringliteral}{'<'}, \textcolor{stringliteral}{'OP'}]
40         self.syms = [
41             \textcolor{stringliteral}{'SELECT'},
42             \textcolor{stringliteral}{'WHERE'},
43             \textcolor{stringliteral}{'AND'},
44             \textcolor{stringliteral}{'COL'},
45             \textcolor{stringliteral}{'TABLE'},
46             \textcolor{stringliteral}{'CAPTION'},
47             \textcolor{stringliteral}{'PAGE'},
48             \textcolor{stringliteral}{'SECTION'},
49             \textcolor{stringliteral}{'OP'},
50             \textcolor{stringliteral}{'COND'},
51             \textcolor{stringliteral}{'QUESTION'},
52             \textcolor{stringliteral}{'AGG'},
53             \textcolor{stringliteral}{'AGGOPS'},
54             \textcolor{stringliteral}{'CONDOPS'},
55         ]
56 
57         \textcolor{comment}{# store identifier for the teacher in the dialog}
58         self.id = \textcolor{stringliteral}{'wikisql'}
59 
60         \hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1talkthewalk_1_1download_a8c0fbb9b6dfe127cb8c1bd6e7c4e33fd}{build}(opt)
61         opt[\textcolor{stringliteral}{'datafile'}] = os.path.join(opt[\textcolor{stringliteral}{'datapath'}], \textcolor{stringliteral}{'WikiSQL'})
62 
63         super().\_\_init\_\_(opt, shared)
64 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_ac640a241c4e9ac29feddd1ecbbb35509}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_ac640a241c4e9ac29feddd1ecbbb35509}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!setup\+\_\+data@{setup\+\_\+data}}
\index{setup\+\_\+data@{setup\+\_\+data}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{setup\+\_\+data()}{setup\_data()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+setup\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{input\+\_\+path }\end{DoxyParamCaption})}



Definition at line 65 of file agents.\+py.


\begin{DoxyCode}
65     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1tasks_1_1multinli_1_1agents_a4fa2cb0ba1ed745336ad8bceed36b841}{setup\_data}(self, input\_path):
66 
67         print(\textcolor{stringliteral}{'loading: '} + input\_path)
68 
69         new\_episode = \textcolor{keyword}{True}
70 
71         table\_file\_path = os.path.join(
72             input\_path, \textcolor{stringliteral}{'data'}, \textcolor{stringliteral}{'\{\}.tables.jsonl'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(self.dt)
73         )
74         qa\_file\_path = os.path.join(input\_path, \textcolor{stringliteral}{'data'}, \textcolor{stringliteral}{'\{\}.jsonl'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(self.dt))
75         with open(table\_file\_path) \textcolor{keyword}{as} table\_file:
76             table\_data = [json.loads(jline) \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} table\_file]
77             table\_data = \{table[\textcolor{stringliteral}{'id'}]: table \textcolor{keywordflow}{for} table \textcolor{keywordflow}{in} table\_data\}
78 
79         with open(qa\_file\_path) \textcolor{keyword}{as} qa\_file:
80             qa\_data = [json.loads(jline) \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} qa\_file]
81 
82         \textcolor{keyword}{def }parse\_into\_sql(table, query):
83             header = table[\textcolor{stringliteral}{'header'}]
84 
85             sql\_query = \textcolor{stringliteral}{'SELECT \{agg\} \{sel\} FROM table'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
86                 agg=self.agg\_ops[query[\textcolor{stringliteral}{'agg'}]], sel=header[query[\textcolor{stringliteral}{'sel'}]]
87             )
88             \textcolor{keywordflow}{if} query[\textcolor{stringliteral}{'conds'}]:
89                 sql\_query += \textcolor{stringliteral}{' WHERE '} + \textcolor{stringliteral}{' AND '}.join(
90                     [
91                         \textcolor{stringliteral}{'\{\} \{\} \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(header[i], self.cond\_ops[o], v)
92                         \textcolor{keywordflow}{for} i, o, v \textcolor{keywordflow}{in} query[\textcolor{stringliteral}{'conds'}]
93                     ]
94                 )
95             \textcolor{keywordflow}{return} sql\_query
96 
97         \textcolor{keyword}{def }table\_into\_context(table):
98             header = table[\textcolor{stringliteral}{'header'}]
99             \textcolor{keywordflow}{if} len(header) == 0:
100                 \textcolor{keywordflow}{return} \textcolor{stringliteral}{'The table has no columns'}
101             \textcolor{keywordflow}{elif} len(header) == 1:
102                 \textcolor{keywordflow}{return} \textcolor{stringliteral}{'The table has column \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(header[0])
103             \textcolor{keywordflow}{else}:
104                 \textcolor{keywordflow}{return} \textcolor{stringliteral}{'The table has column names \{\} and \{\}.'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
105                     \textcolor{stringliteral}{', '}.join(header[:-1]), header[-1]
106                 )
107 
108         \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} qa\_data:
109             id = line[\textcolor{stringliteral}{"table\_id"}]
110             question = line[\textcolor{stringliteral}{"question"}]
111             table = table\_data[id]
112 
113             context = table\_into\_context(table)
114             sql = parse\_into\_sql(table, line[\textcolor{stringliteral}{"sql"}])
115 
116             \textcolor{keywordflow}{yield} (context + \textcolor{stringliteral}{'\(\backslash\)n'} + question, [sql], \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}), new\_episode
117 
118 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_acac9910a97f5b0ee9af7e9bd8a7e2d78}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_acac9910a97f5b0ee9af7e9bd8a7e2d78}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!agg\+\_\+ops@{agg\+\_\+ops}}
\index{agg\+\_\+ops@{agg\+\_\+ops}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{agg\+\_\+ops}{agg\_ops}}
{\footnotesize\ttfamily parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+agg\+\_\+ops}



Definition at line 38 of file agents.\+py.

\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a8d6572adccf79dd778ec80ec14647980}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a8d6572adccf79dd778ec80ec14647980}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!cond\+\_\+ops@{cond\+\_\+ops}}
\index{cond\+\_\+ops@{cond\+\_\+ops}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{cond\+\_\+ops}{cond\_ops}}
{\footnotesize\ttfamily parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+cond\+\_\+ops}



Definition at line 39 of file agents.\+py.

\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a343d704bea4fc5c096000b73b2796e03}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a343d704bea4fc5c096000b73b2796e03}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!dt@{dt}}
\index{dt@{dt}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{dt}{dt}}
{\footnotesize\ttfamily parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+dt}



Definition at line 36 of file agents.\+py.

\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_aec62053f23dd71f7db3997534f631136}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_aec62053f23dd71f7db3997534f631136}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!id@{id}}
\index{id@{id}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+id}



Definition at line 58 of file agents.\+py.

\mbox{\Hypertarget{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a1a67c761791a412586131dd7dd595a7c}\label{classparlai_1_1tasks_1_1wikisql_1_1agents_1_1WikiSQLTeacher_a1a67c761791a412586131dd7dd595a7c}} 
\index{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}!syms@{syms}}
\index{syms@{syms}!parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher@{parlai\+::tasks\+::wikisql\+::agents\+::\+Wiki\+S\+Q\+L\+Teacher}}
\subsubsection{\texorpdfstring{syms}{syms}}
{\footnotesize\ttfamily parlai.\+tasks.\+wikisql.\+agents.\+Wiki\+S\+Q\+L\+Teacher.\+syms}



Definition at line 40 of file agents.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/tasks/wikisql/\hyperlink{parlai_2tasks_2wikisql_2agents_8py}{agents.\+py}\end{DoxyCompactItemize}
