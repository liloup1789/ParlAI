\hypertarget{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder}{}\section{projects.\+personachat.\+kvmemnn.\+modules.\+Encoder Class Reference}
\label{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder}\index{projects.\+personachat.\+kvmemnn.\+modules.\+Encoder@{projects.\+personachat.\+kvmemnn.\+modules.\+Encoder}}


Inheritance diagram for projects.\+personachat.\+kvmemnn.\+modules.\+Encoder\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{de/d16/classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+personachat.\+kvmemnn.\+modules.\+Encoder\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=276pt]{dc/d75/classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_a9ec8df457392023bb1d823f204ca645f}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, shared\+\_\+lt, dict)
\item 
def \hyperlink{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_a06627a5af4545ab9baad60440ad4e9bb}{forward} (self, xs)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_aaeceefba978096fa670e5b2b598a2d1c}{lt}
\item 
\hyperlink{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_ae221f1c7a7a3d2b946b4d9961259a6d3}{freqs}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 117 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_a9ec8df457392023bb1d823f204ca645f}\label{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_a9ec8df457392023bb1d823f204ca645f}} 
\index{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+personachat.\+kvmemnn.\+modules.\+Encoder.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{shared\+\_\+lt,  }\item[{}]{dict }\end{DoxyParamCaption})}



Definition at line 118 of file modules.\+py.


\begin{DoxyCode}
118     \textcolor{keyword}{def }\_\_init\_\_(self, shared\_lt, dict):
119         super().\_\_init\_\_()
120         self.lt = shared\_lt
121         \textcolor{keywordflow}{if} dict \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
122             l = len(dict)
123             freqs = torch.Tensor(l)
124             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(l):
125                 ind = dict.ind2tok[i]
126                 freq = dict.freq[ind]
127                 freqs[i] = 1.0 / (1.0 + math.log(1.0 + freq))
128             self.freqs = freqs
129         \textcolor{keywordflow}{else}:
130             self.freqs = \textcolor{keywordtype}{None}
131 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_a06627a5af4545ab9baad60440ad4e9bb}\label{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_a06627a5af4545ab9baad60440ad4e9bb}} 
\index{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}!forward@{forward}}
\index{forward@{forward}!projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def projects.\+personachat.\+kvmemnn.\+modules.\+Encoder.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{xs }\end{DoxyParamCaption})}



Definition at line 132 of file modules.\+py.


\begin{DoxyCode}
132     \textcolor{keyword}{def }forward(self, xs):
133         xs\_emb = self.lt(xs)
134         \textcolor{keywordflow}{if} self.freqs \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
135             \textcolor{comment}{# tfidf embeddings}
136             l = xs.size(1)
137             w = Variable(torch.Tensor(l))
138             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(l):
139                 w[i] = self.freqs[xs.data[0][i]]
140             w = w.mul(1 / w.norm())
141             xs\_emb = xs\_emb.squeeze(0).t().matmul(w.unsqueeze(1)).t()
142         \textcolor{keywordflow}{else}:
143             \textcolor{comment}{# basic embeddings (faster)}
144             xs\_emb = xs\_emb.mean(1)
145         \textcolor{keywordflow}{return} xs\_emb
146 \end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_ae221f1c7a7a3d2b946b4d9961259a6d3}\label{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_ae221f1c7a7a3d2b946b4d9961259a6d3}} 
\index{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}!freqs@{freqs}}
\index{freqs@{freqs}!projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}}
\subsubsection{\texorpdfstring{freqs}{freqs}}
{\footnotesize\ttfamily projects.\+personachat.\+kvmemnn.\+modules.\+Encoder.\+freqs}



Definition at line 128 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_aaeceefba978096fa670e5b2b598a2d1c}\label{classprojects_1_1personachat_1_1kvmemnn_1_1modules_1_1Encoder_aaeceefba978096fa670e5b2b598a2d1c}} 
\index{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}!lt@{lt}}
\index{lt@{lt}!projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder@{projects\+::personachat\+::kvmemnn\+::modules\+::\+Encoder}}
\subsubsection{\texorpdfstring{lt}{lt}}
{\footnotesize\ttfamily projects.\+personachat.\+kvmemnn.\+modules.\+Encoder.\+lt}



Definition at line 120 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/personachat/kvmemnn/\hyperlink{projects_2personachat_2kvmemnn_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
