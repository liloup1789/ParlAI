\hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent}{}\section{parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent Class Reference}
\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent}\index{parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent@{parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent}}


Inheritance diagram for parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{da/d86/classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=244pt]{df/de6/classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_acf817e32b90b835347cdddc019b90b15}{set\+Up} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a7a8fde13675083b70c386a1572907040}{tear\+Down} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aefc023b6bc037dfa7450a4b07721e1ef}{test\+\_\+init} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aae09a73d8a3a81db8bbd0a03f45948ab}{test\+\_\+state\+\_\+wrappers} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a37efa552f4eceee94c74a3203e1a629c}{test\+\_\+connection\+\_\+id} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a9b5a89daa42f7c6b978912c5cdb2d558}{test\+\_\+inactive\+\_\+data} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_af125929ec3a33b4e9a631f2c89f3460a}{test\+\_\+status\+\_\+change} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a6ff1c8e1a13eba40115b08e7d1267de1}{test\+\_\+message\+\_\+queue} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a0835afc555b43ee116569e8c8e6aee6c}{test\+\_\+message\+\_\+acts} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aa521feef50660ecffb5299ebc2ddcdb7}{opt}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a41e7f3413127521839d97699f2f6c5e6}{mturk\+\_\+manager}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aabae177920d5fcae1ba0b7291792be06}{worker\+\_\+manager}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a1f3d020994d94713b72e63632b27a64f}{turk\+\_\+agent}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Various unit tests for the MTurkAgent class.
\end{DoxyVerb}
 

Definition at line 151 of file test\+\_\+mturk\+\_\+agent.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_acf817e32b90b835347cdddc019b90b15}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_acf817e32b90b835347cdddc019b90b15}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!set\+Up@{set\+Up}}
\index{set\+Up@{set\+Up}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{set\+Up()}{setUp()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+set\+Up (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 156 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
156     \textcolor{keyword}{def }setUp(self):
157         argparser = ParlaiParser(\textcolor{keyword}{False}, \textcolor{keyword}{False})
158         argparser.add\_parlai\_data\_path()
159         argparser.add\_mturk\_args()
160         self.opt = argparser.parse\_args(print\_args=\textcolor{keyword}{False})
161         self.opt[\textcolor{stringliteral}{'task'}] = \textcolor{stringliteral}{'unittest'}
162         self.opt[\textcolor{stringliteral}{'assignment\_duration\_in\_seconds'}] = 6
163         mturk\_agent\_ids = [\textcolor{stringliteral}{'mturk\_agent\_1'}]
164         self.mturk\_manager = MTurkManager(
165             opt=self.opt.copy(), mturk\_agent\_ids=mturk\_agent\_ids
166         )
167         self.worker\_manager = self.mturk\_manager.worker\_manager
168 
169         self.turk\_agent = MTurkAgent(
170             self.opt.copy(),
171             self.mturk\_manager,
172             TEST\_HIT\_ID\_1,
173             TEST\_ASSIGNMENT\_ID\_1,
174             TEST\_WORKER\_ID\_1,
175         )
176 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a7a8fde13675083b70c386a1572907040}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a7a8fde13675083b70c386a1572907040}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!tear\+Down@{tear\+Down}}
\index{tear\+Down@{tear\+Down}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{tear\+Down()}{tearDown()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+tear\+Down (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 177 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
177     \textcolor{keyword}{def }tearDown(self):
178         self.mturk\_manager.shutdown()
179 
180         disconnect\_path = os.path.join(parent\_dir, \textcolor{stringliteral}{'disconnect-test.pickle'})
181         \textcolor{keywordflow}{if} os.path.exists(disconnect\_path):
182             os.remove(disconnect\_path)
183 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a37efa552f4eceee94c74a3203e1a629c}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a37efa552f4eceee94c74a3203e1a629c}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+connection\+\_\+id@{test\+\_\+connection\+\_\+id}}
\index{test\+\_\+connection\+\_\+id@{test\+\_\+connection\+\_\+id}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+connection\+\_\+id()}{test\_connection\_id()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+connection\+\_\+id (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Ensure the connection_id hasn't changed.
\end{DoxyVerb}
 

Definition at line 241 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
241     \textcolor{keyword}{def }test\_connection\_id(self):
242         \textcolor{stringliteral}{"""}
243 \textcolor{stringliteral}{        Ensure the connection\_id hasn't changed.}
244 \textcolor{stringliteral}{        """}
245         connection\_id = \textcolor{stringliteral}{"\{\}\_\{\}"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
246             self.turk\_agent.worker\_id, self.turk\_agent.assignment\_id
247         )
248         self.assertEqual(self.turk\_agent.get\_connection\_id(), connection\_id)
249 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a9b5a89daa42f7c6b978912c5cdb2d558}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a9b5a89daa42f7c6b978912c5cdb2d558}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+inactive\+\_\+data@{test\+\_\+inactive\+\_\+data}}
\index{test\+\_\+inactive\+\_\+data@{test\+\_\+inactive\+\_\+data}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+inactive\+\_\+data()}{test\_inactive\_data()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+inactive\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Ensure data packet generated for inactive commands is valid.
\end{DoxyVerb}
 

Definition at line 250 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
250     \textcolor{keyword}{def }test\_inactive\_data(self):
251         \textcolor{stringliteral}{"""}
252 \textcolor{stringliteral}{        Ensure data packet generated for inactive commands is valid.}
253 \textcolor{stringliteral}{        """}
254         \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} complete\_statuses:
255             self.turk\_agent.set\_status(status)
256             data = self.turk\_agent.get\_inactive\_command\_data()
257             self.assertIsNotNone(data[\textcolor{stringliteral}{'text'}])
258             self.assertIsNotNone(data[\textcolor{stringliteral}{'inactive\_text'}])
259             self.assertEqual(data[\textcolor{stringliteral}{'conversation\_id'}], self.turk\_agent.conversation\_id)
260             self.assertEqual(data[\textcolor{stringliteral}{'agent\_id'}], TEST\_WORKER\_ID\_1)
261 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aefc023b6bc037dfa7450a4b07721e1ef}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aefc023b6bc037dfa7450a4b07721e1ef}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+init@{test\+\_\+init}}
\index{test\+\_\+init@{test\+\_\+init}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+init()}{test\_init()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+init (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Test initialization of an agent.
\end{DoxyVerb}
 

Definition at line 184 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
184     \textcolor{keyword}{def }test\_init(self):
185         \textcolor{stringliteral}{"""}
186 \textcolor{stringliteral}{        Test initialization of an agent.}
187 \textcolor{stringliteral}{        """}
188         self.assertIsNotNone(self.turk\_agent.creation\_time)
189         self.assertIsNone(self.turk\_agent.id)
190         self.assertIsNone(self.turk\_agent.message\_request\_time)
191         self.assertIsNone(self.turk\_agent.conversation\_id)
192         self.assertFalse(self.turk\_agent.some\_agent\_disconnected)
193         self.assertFalse(self.turk\_agent.hit\_is\_expired)
194         self.assertFalse(self.turk\_agent.hit\_is\_abandoned)
195         self.assertFalse(self.turk\_agent.hit\_is\_returned)
196         self.assertFalse(self.turk\_agent.hit\_is\_complete)
197         self.assertFalse(self.turk\_agent.disconnected)
198         self.assertTrue(self.turk\_agent.alived)
199 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a0835afc555b43ee116569e8c8e6aee6c}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a0835afc555b43ee116569e8c8e6aee6c}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+message\+\_\+acts@{test\+\_\+message\+\_\+acts}}
\index{test\+\_\+message\+\_\+acts@{test\+\_\+message\+\_\+acts}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+message\+\_\+acts()}{test\_message\_acts()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+message\+\_\+acts (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 329 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
329     \textcolor{keyword}{def }test\_message\_acts(self):
330         self.mturk\_manager.send\_command = mock.MagicMock()
331         self.mturk\_manager.handle\_turker\_timeout = mock.MagicMock()
332 
333         \textcolor{comment}{# non-Blocking check}
334         self.assertIsNone(self.turk\_agent.message\_request\_time)
335         returned\_act = self.turk\_agent.act(blocking=\textcolor{keyword}{False})
336         self.assertIsNotNone(self.turk\_agent.message\_request\_time)
337         self.assertIsNone(returned\_act)
338         self.turk\_agent.id = AGENT\_ID
339         self.turk\_agent.put\_data(MESSAGE\_ID\_1, ACT\_1)
340         returned\_act = self.turk\_agent.act(blocking=\textcolor{keyword}{False})
341         self.assertIsNone(self.turk\_agent.message\_request\_time)
342         self.assertEqual(returned\_act, ACT\_1)
343         self.mturk\_manager.send\_command.assert\_called\_once()
344 
345         \textcolor{comment}{# non-Blocking timeout check}
346         self.mturk\_manager.send\_command = mock.MagicMock()
347         returned\_act = self.turk\_agent.act(timeout=0.07, blocking=\textcolor{keyword}{False})
348         self.assertIsNotNone(self.turk\_agent.message\_request\_time)
349         self.assertIsNone(returned\_act)
350         \textcolor{keywordflow}{while} returned\_act \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
351             returned\_act = self.turk\_agent.act(timeout=0.07, blocking=\textcolor{keyword}{False})
352         self.mturk\_manager.send\_command.assert\_called\_once()
353         self.mturk\_manager.handle\_turker\_timeout.assert\_called\_once()
354         self.assertEqual(returned\_act[\textcolor{stringliteral}{'text'}], self.turk\_agent.TIMEOUT\_MESSAGE)
355 
356         \textcolor{comment}{# Blocking timeout check}
357         self.mturk\_manager.send\_command = mock.MagicMock()
358         self.mturk\_manager.handle\_turker\_timeout = mock.MagicMock()
359         returned\_act = self.turk\_agent.act(timeout=0.07)
360         self.mturk\_manager.send\_command.assert\_called\_once()
361         self.mturk\_manager.handle\_turker\_timeout.assert\_called\_once()
362         self.assertEqual(returned\_act[\textcolor{stringliteral}{'text'}], self.turk\_agent.TIMEOUT\_MESSAGE)
363 
364 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a6ff1c8e1a13eba40115b08e7d1267de1}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a6ff1c8e1a13eba40115b08e7d1267de1}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+message\+\_\+queue@{test\+\_\+message\+\_\+queue}}
\index{test\+\_\+message\+\_\+queue@{test\+\_\+message\+\_\+queue}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+message\+\_\+queue()}{test\_message\_queue()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+message\+\_\+queue (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Ensure observations and acts work as expected.
\end{DoxyVerb}
 

Definition at line 280 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
280     \textcolor{keyword}{def }test\_message\_queue(self):
281         \textcolor{stringliteral}{"""}
282 \textcolor{stringliteral}{        Ensure observations and acts work as expected.}
283 \textcolor{stringliteral}{        """}
284         self.mturk\_manager.send\_message = mock.MagicMock()
285         self.turk\_agent.observe(ACT\_1)
286         self.mturk\_manager.send\_message.assert\_called\_with(
287             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1, ACT\_1
288         )
289 
290         \textcolor{comment}{# First act comes through the queue and returns properly}
291         self.assertTrue(self.turk\_agent.msg\_queue.empty())
292         self.turk\_agent.id = AGENT\_ID
293         self.turk\_agent.put\_data(MESSAGE\_ID\_1, ACT\_1)
294         self.assertTrue(self.turk\_agent.recieved\_packets[MESSAGE\_ID\_1])
295         self.assertFalse(self.turk\_agent.msg\_queue.empty())
296         returned\_act = self.turk\_agent.get\_new\_act\_message()
297         self.assertEqual(returned\_act, ACT\_1)
298 
299         \textcolor{comment}{# Repeat act is ignored}
300         self.turk\_agent.put\_data(MESSAGE\_ID\_1, ACT\_1)
301         self.assertTrue(self.turk\_agent.msg\_queue.empty())
302 
303         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(100):
304             self.turk\_agent.put\_data(\hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(i), ACT\_1)
305         self.assertEqual(self.turk\_agent.msg\_queue.qsize(), 100)
306         self.turk\_agent.flush\_msg\_queue()
307         self.assertTrue(self.turk\_agent.msg\_queue.empty())
308 
309         \textcolor{comment}{# Test non-act messages}
310         blank\_message = self.turk\_agent.get\_new\_act\_message()
311         self.assertIsNone(blank\_message)
312 
313         self.turk\_agent.disconnected = \textcolor{keyword}{True}
314         disconnect\_message = self.turk\_agent.get\_new\_act\_message()
315         self.turk\_agent.disconnected = \textcolor{keyword}{False}
316         self.assertEqual(
317             disconnect\_message[\textcolor{stringliteral}{'text'}], self.turk\_agent.MTURK\_DISCONNECT\_MESSAGE
318         )
319         self.turk\_agent.hit\_is\_returned = \textcolor{keyword}{True}
320         return\_message = self.turk\_agent.get\_new\_act\_message()
321         self.assertEqual(return\_message[\textcolor{stringliteral}{'text'}], self.turk\_agent.RETURN\_MESSAGE)
322         self.turk\_agent.hit\_is\_returned = \textcolor{keyword}{False}
323 
324         \textcolor{comment}{# Reduce state}
325         self.turk\_agent.reduce\_state()
326         self.assertIsNone(self.turk\_agent.msg\_queue)
327         self.assertIsNone(self.turk\_agent.recieved\_packets)
328 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aae09a73d8a3a81db8bbd0a03f45948ab}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aae09a73d8a3a81db8bbd0a03f45948ab}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+state\+\_\+wrappers@{test\+\_\+state\+\_\+wrappers}}
\index{test\+\_\+state\+\_\+wrappers@{test\+\_\+state\+\_\+wrappers}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+state\+\_\+wrappers()}{test\_state\_wrappers()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+state\+\_\+wrappers (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Test the mturk agent wrappers around its state.
\end{DoxyVerb}
 

Definition at line 200 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
200     \textcolor{keyword}{def }test\_state\_wrappers(self):
201         \textcolor{stringliteral}{"""}
202 \textcolor{stringliteral}{        Test the mturk agent wrappers around its state.}
203 \textcolor{stringliteral}{        """}
204         \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} statuses:
205             self.turk\_agent.set\_status(status)
206             self.assertEqual(self.turk\_agent.get\_status(), status)
207         \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} [AssignState.STATUS\_DONE, AssignState.STATUS\_PARTNER\_DISCONNECT]:
208             self.turk\_agent.set\_status(status)
209             self.assertTrue(self.turk\_agent.submitted\_hit())
210 
211         \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} active\_statuses:
212             self.turk\_agent.set\_status(status)
213             self.assertFalse(self.turk\_agent.is\_final())
214 
215         \textcolor{keywordflow}{for} status \textcolor{keywordflow}{in} complete\_statuses:
216             self.turk\_agent.set\_status(status)
217             self.assertTrue(self.turk\_agent.is\_final())
218 
219         self.turk\_agent.append\_message(MESSAGE\_1)
220         self.assertEqual(len(self.turk\_agent.get\_messages()), 1)
221         self.turk\_agent.append\_message(MESSAGE\_2)
222         self.assertEqual(len(self.turk\_agent.get\_messages()), 2)
223         self.turk\_agent.append\_message(MESSAGE\_1)
224         self.assertEqual(len(self.turk\_agent.get\_messages()), 2)
225         self.assertIn(MESSAGE\_1, self.turk\_agent.get\_messages())
226         self.assertIn(MESSAGE\_2, self.turk\_agent.get\_messages())
227 
228         \textcolor{comment}{# Ensure command interactions work as expected}
229         self.turk\_agent.set\_last\_command(COMMAND\_1)
230         self.assertEqual(self.turk\_agent.get\_last\_command(), COMMAND\_1)
231 
232         self.turk\_agent.clear\_messages()
233         self.assertEqual(len(self.turk\_agent.get\_messages()), 0)
234 
235         \textcolor{comment}{# In task checks}
236         self.turk\_agent.conversation\_id = \textcolor{stringliteral}{'t\_12345'}
237         self.assertTrue(self.turk\_agent.is\_in\_task())
238         self.turk\_agent.conversation\_id = \textcolor{stringliteral}{'b\_12345'}
239         self.assertFalse(self.turk\_agent.is\_in\_task())
240 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_af125929ec3a33b4e9a631f2c89f3460a}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_af125929ec3a33b4e9a631f2c89f3460a}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!test\+\_\+status\+\_\+change@{test\+\_\+status\+\_\+change}}
\index{test\+\_\+status\+\_\+change@{test\+\_\+status\+\_\+change}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{test\+\_\+status\+\_\+change()}{test\_status\_change()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+test\+\_\+status\+\_\+change (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 262 of file test\+\_\+mturk\+\_\+agent.\+py.


\begin{DoxyCode}
262     \textcolor{keyword}{def }test\_status\_change(self):
263         has\_changed = \textcolor{keyword}{False}
264         self.turk\_agent.set\_status(AssignState.STATUS\_ONBOARDING)
265 
266         \textcolor{keyword}{def }wait\_for\_status\_wrap():
267             nonlocal has\_changed  \textcolor{comment}{# noqa 999 we don't use python2}
268             self.turk\_agent.wait\_for\_status(AssignState.STATUS\_WAITING)
269             has\_changed = \textcolor{keyword}{True}
270 
271         t = threading.Thread(target=wait\_for\_status\_wrap, daemon=\textcolor{keyword}{True})
272         t.start()
273         self.assertFalse(has\_changed)
274         time.sleep(0.07)
275         self.assertFalse(has\_changed)
276         self.turk\_agent.set\_status(AssignState.STATUS\_WAITING)
277         time.sleep(0.07)
278         self.assertTrue(has\_changed)
279 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a41e7f3413127521839d97699f2f6c5e6}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a41e7f3413127521839d97699f2f6c5e6}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!mturk\+\_\+manager@{mturk\+\_\+manager}}
\index{mturk\+\_\+manager@{mturk\+\_\+manager}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{mturk\+\_\+manager}{mturk\_manager}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+mturk\+\_\+manager}



Definition at line 164 of file test\+\_\+mturk\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aa521feef50660ecffb5299ebc2ddcdb7}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aa521feef50660ecffb5299ebc2ddcdb7}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!opt@{opt}}
\index{opt@{opt}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+opt}



Definition at line 160 of file test\+\_\+mturk\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a1f3d020994d94713b72e63632b27a64f}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_a1f3d020994d94713b72e63632b27a64f}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!turk\+\_\+agent@{turk\+\_\+agent}}
\index{turk\+\_\+agent@{turk\+\_\+agent}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{turk\+\_\+agent}{turk\_agent}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+turk\+\_\+agent}



Definition at line 169 of file test\+\_\+mturk\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aabae177920d5fcae1ba0b7291792be06}\label{classparlai_1_1mturk_1_1core_1_1legacy__2018_1_1test_1_1test__mturk__agent_1_1TestMTurkAgent_aabae177920d5fcae1ba0b7291792be06}} 
\index{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}!worker\+\_\+manager@{worker\+\_\+manager}}
\index{worker\+\_\+manager@{worker\+\_\+manager}!parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent@{parlai\+::mturk\+::core\+::legacy\+\_\+2018\+::test\+::test\+\_\+mturk\+\_\+agent\+::\+Test\+M\+Turk\+Agent}}
\subsubsection{\texorpdfstring{worker\+\_\+manager}{worker\_manager}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+legacy\+\_\+2018.\+test.\+test\+\_\+mturk\+\_\+agent.\+Test\+M\+Turk\+Agent.\+worker\+\_\+manager}



Definition at line 167 of file test\+\_\+mturk\+\_\+agent.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/mturk/core/legacy\+\_\+2018/test/\hyperlink{legacy__2018_2test_2test__mturk__agent_8py}{test\+\_\+mturk\+\_\+agent.\+py}\end{DoxyCompactItemize}
