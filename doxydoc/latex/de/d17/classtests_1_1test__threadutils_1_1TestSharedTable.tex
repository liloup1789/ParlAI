\hypertarget{classtests_1_1test__threadutils_1_1TestSharedTable}{}\section{tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table Class Reference}
\label{classtests_1_1test__threadutils_1_1TestSharedTable}\index{tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table@{tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table}}


Inheritance diagram for tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{d5/d23/classtests_1_1test__threadutils_1_1TestSharedTable__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{d7/d93/classtests_1_1test__threadutils_1_1TestSharedTable__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classtests_1_1test__threadutils_1_1TestSharedTable_a877c1284bd99fe9f44c4b744b4bae9d8}{test\+\_\+init\+\_\+from\+\_\+dict} (self)
\item 
def \hyperlink{classtests_1_1test__threadutils_1_1TestSharedTable_a5afcb2be145212a9d06f2f2ecd45da68}{test\+\_\+get\+\_\+set\+\_\+del} (self)
\item 
def \hyperlink{classtests_1_1test__threadutils_1_1TestSharedTable_ad83a5fe7bed1811264f41406c3ec8976}{test\+\_\+iter\+\_\+keys} (self)
\item 
def \hyperlink{classtests_1_1test__threadutils_1_1TestSharedTable_ad8ca4e7c8fbc4e8ddb170158fe01c861}{test\+\_\+concurrent\+\_\+access} (self)
\item 
def \hyperlink{classtests_1_1test__threadutils_1_1TestSharedTable_a44071985cd8526645fb0f2c41fddbff9}{test\+\_\+torch} (self)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Make sure the package is alive.
\end{DoxyVerb}
 

Definition at line 15 of file test\+\_\+threadutils.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classtests_1_1test__threadutils_1_1TestSharedTable_ad8ca4e7c8fbc4e8ddb170158fe01c861}\label{classtests_1_1test__threadutils_1_1TestSharedTable_ad8ca4e7c8fbc4e8ddb170158fe01c861}} 
\index{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}!test\+\_\+concurrent\+\_\+access@{test\+\_\+concurrent\+\_\+access}}
\index{test\+\_\+concurrent\+\_\+access@{test\+\_\+concurrent\+\_\+access}!tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}}
\subsubsection{\texorpdfstring{test\+\_\+concurrent\+\_\+access()}{test\_concurrent\_access()}}
{\footnotesize\ttfamily def tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table.\+test\+\_\+concurrent\+\_\+access (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 65 of file test\+\_\+threadutils.\+py.


\begin{DoxyCode}
65     \textcolor{keyword}{def }test\_concurrent\_access(self):
66         st = SharedTable(\{\textcolor{stringliteral}{'cnt'}: 0\})
67 
68         \textcolor{keyword}{def }inc():
69             \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(50):
70                 with st.get\_lock():
71                     st[\textcolor{stringliteral}{'cnt'}] += 1
72                 time.sleep(random.randint(1, 5) / 10000)
73 
74         threads = []
75         \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(5):  \textcolor{comment}{# numthreads}
76             threads.append(Process(target=inc))
77         \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} threads:
78             t.start()
79         \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} threads:
80             t.join()
81         \textcolor{keyword}{assert} st[\textcolor{stringliteral}{'cnt'}] == 250
82 
\end{DoxyCode}
\mbox{\Hypertarget{classtests_1_1test__threadutils_1_1TestSharedTable_a5afcb2be145212a9d06f2f2ecd45da68}\label{classtests_1_1test__threadutils_1_1TestSharedTable_a5afcb2be145212a9d06f2f2ecd45da68}} 
\index{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}!test\+\_\+get\+\_\+set\+\_\+del@{test\+\_\+get\+\_\+set\+\_\+del}}
\index{test\+\_\+get\+\_\+set\+\_\+del@{test\+\_\+get\+\_\+set\+\_\+del}!tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}}
\subsubsection{\texorpdfstring{test\+\_\+get\+\_\+set\+\_\+del()}{test\_get\_set\_del()}}
{\footnotesize\ttfamily def tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table.\+test\+\_\+get\+\_\+set\+\_\+del (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 26 of file test\+\_\+threadutils.\+py.


\begin{DoxyCode}
26     \textcolor{keyword}{def }test\_get\_set\_del(self):
27         st = SharedTable(\{\textcolor{stringliteral}{'key'}: 0\})
28         \textcolor{keywordflow}{try}:
29             st[\textcolor{stringliteral}{'none'}]
30             self.fail(\textcolor{stringliteral}{'did not fail on nonexistent key'})
31         \textcolor{keywordflow}{except} KeyError:
32             \textcolor{keywordflow}{pass}
33 
34         st[\textcolor{stringliteral}{'key'}] = 1
35         \textcolor{keyword}{assert} st[\textcolor{stringliteral}{'key'}] == 1
36 
37         st[\textcolor{stringliteral}{'key'}] += 1
38         \textcolor{keyword}{assert} st[\textcolor{stringliteral}{'key'}] == 2
39 
40         \textcolor{keywordflow}{try}:
41             st[\textcolor{stringliteral}{'key'}] = 2.1
42             self.fail(\textcolor{stringliteral}{'cannot change type of value for set keys'})
43         \textcolor{keywordflow}{except} TypeError:
44             \textcolor{keywordflow}{pass}
45 
46         del st[\textcolor{stringliteral}{'key'}]
47         \textcolor{keyword}{assert} \textcolor{stringliteral}{'key'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} st, \textcolor{stringliteral}{'key should have been removed from table'}
48 
49         \textcolor{keywordflow}{try}:
50             st[\textcolor{stringliteral}{'key'}] = \textcolor{keyword}{True}
51             self.fail(\textcolor{stringliteral}{'cannot change removed key'})
52         \textcolor{keywordflow}{except} KeyError:
53             \textcolor{keywordflow}{pass}
54 
\end{DoxyCode}
\mbox{\Hypertarget{classtests_1_1test__threadutils_1_1TestSharedTable_a877c1284bd99fe9f44c4b744b4bae9d8}\label{classtests_1_1test__threadutils_1_1TestSharedTable_a877c1284bd99fe9f44c4b744b4bae9d8}} 
\index{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}!test\+\_\+init\+\_\+from\+\_\+dict@{test\+\_\+init\+\_\+from\+\_\+dict}}
\index{test\+\_\+init\+\_\+from\+\_\+dict@{test\+\_\+init\+\_\+from\+\_\+dict}!tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}}
\subsubsection{\texorpdfstring{test\+\_\+init\+\_\+from\+\_\+dict()}{test\_init\_from\_dict()}}
{\footnotesize\ttfamily def tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table.\+test\+\_\+init\+\_\+from\+\_\+dict (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 20 of file test\+\_\+threadutils.\+py.


\begin{DoxyCode}
20     \textcolor{keyword}{def }test\_init\_from\_dict(self):
21         d = \{\textcolor{stringliteral}{'a'}: 0, \textcolor{stringliteral}{'b'}: 1, \textcolor{stringliteral}{'c'}: 1.0, \textcolor{stringliteral}{'d'}: \textcolor{keyword}{True}, 1: \textcolor{keyword}{False}, 2: 2.0\}
22         st = SharedTable(d)
23         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} d.items():
24             \textcolor{keyword}{assert} st[k] == v
25 
\end{DoxyCode}
\mbox{\Hypertarget{classtests_1_1test__threadutils_1_1TestSharedTable_ad83a5fe7bed1811264f41406c3ec8976}\label{classtests_1_1test__threadutils_1_1TestSharedTable_ad83a5fe7bed1811264f41406c3ec8976}} 
\index{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}!test\+\_\+iter\+\_\+keys@{test\+\_\+iter\+\_\+keys}}
\index{test\+\_\+iter\+\_\+keys@{test\+\_\+iter\+\_\+keys}!tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}}
\subsubsection{\texorpdfstring{test\+\_\+iter\+\_\+keys()}{test\_iter\_keys()}}
{\footnotesize\ttfamily def tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table.\+test\+\_\+iter\+\_\+keys (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 55 of file test\+\_\+threadutils.\+py.


\begin{DoxyCode}
55     \textcolor{keyword}{def }test\_iter\_keys(self):
56         st = SharedTable(\{\textcolor{stringliteral}{'key'}: 0, \textcolor{stringliteral}{'ctr'}: 0.0, \textcolor{stringliteral}{'val'}: \textcolor{keyword}{False}, \textcolor{stringliteral}{'other'}: 1\})
57         \textcolor{keyword}{assert} len(st) == 4
58         del st[\textcolor{stringliteral}{'key'}]
59         \textcolor{keyword}{assert} len(st) == 3, \textcolor{stringliteral}{'length should decrease after deleting key'}
60         keyset1 = set(iter(st))
61         keyset2 = set(st.keys())
62         \textcolor{keyword}{assert} keyset1 == keyset2, \textcolor{stringliteral}{'iterating should return keys'}
63         \textcolor{keyword}{assert} len(keyset1) == 3, \textcolor{stringliteral}{''}
64 
\end{DoxyCode}
\mbox{\Hypertarget{classtests_1_1test__threadutils_1_1TestSharedTable_a44071985cd8526645fb0f2c41fddbff9}\label{classtests_1_1test__threadutils_1_1TestSharedTable_a44071985cd8526645fb0f2c41fddbff9}} 
\index{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}!test\+\_\+torch@{test\+\_\+torch}}
\index{test\+\_\+torch@{test\+\_\+torch}!tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table@{tests\+::test\+\_\+threadutils\+::\+Test\+Shared\+Table}}
\subsubsection{\texorpdfstring{test\+\_\+torch()}{test\_torch()}}
{\footnotesize\ttfamily def tests.\+test\+\_\+threadutils.\+Test\+Shared\+Table.\+test\+\_\+torch (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 83 of file test\+\_\+threadutils.\+py.


\begin{DoxyCode}
83     \textcolor{keyword}{def }test\_torch(self):
84         \textcolor{keywordflow}{try}:
85             \textcolor{keyword}{import} torch
86         \textcolor{keywordflow}{except} ImportError:
87             \textcolor{comment}{# pass by default if no torch available}
88             \textcolor{keywordflow}{return}
89 
90         st = SharedTable(\{\textcolor{stringliteral}{'a'}: torch.FloatTensor([1]), \textcolor{stringliteral}{'b'}: torch.LongTensor(2)\})
91         \textcolor{keyword}{assert} st[\textcolor{stringliteral}{'a'}][0] == 1.0
92         \textcolor{keyword}{assert} len(st) == 2
93         \textcolor{keyword}{assert} \textcolor{stringliteral}{'b'} \textcolor{keywordflow}{in} st
94         del st[\textcolor{stringliteral}{'b'}]
95         \textcolor{keyword}{assert} \textcolor{stringliteral}{'b'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} st
96         \textcolor{keyword}{assert} len(st) == 1
97 
98         \textcolor{keywordflow}{if} torch.cuda.is\_available():
99             st = SharedTable(
100                 \{\textcolor{stringliteral}{'a'}: torch.cuda.FloatTensor([1]), \textcolor{stringliteral}{'b'}: torch.cuda.LongTensor(2)\}
101             )
102             \textcolor{keyword}{assert} st[\textcolor{stringliteral}{'a'}][0] == 1.0
103             \textcolor{keyword}{assert} len(st) == 2
104             \textcolor{keyword}{assert} \textcolor{stringliteral}{'b'} \textcolor{keywordflow}{in} st
105             del st[\textcolor{stringliteral}{'b'}]
106             \textcolor{keyword}{assert} \textcolor{stringliteral}{'b'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} st
107             \textcolor{keyword}{assert} len(st) == 1
108 
109 
\end{DoxyCode}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
tests/\hyperlink{test__threadutils_8py}{test\+\_\+threadutils.\+py}\end{DoxyCompactItemize}
