\hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent}{}\section{parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent Class Reference}
\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent}\index{parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent@{parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent}}


Inheritance diagram for parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d5/d0b/classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{d7/d70/classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a086eb865c3a6586372671ec1254f0d66}{\+\_\+\+\_\+init\+\_\+\+\_\+}
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_adeab756c0b58667aaf417575c23d1dfb}{build\+\_\+criterion} (self)
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a33e56566ee5e81b257b049bd6a3c1cd6}{share} (self)
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a3baacdb005c5f5a6367c45c93d21d398}{train\+\_\+step} (self, batch)
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a5d456df843180fb32ca574dc2a33cc80}{eval\+\_\+step} (self, batch)
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac96e55ac13019eace0641a7efcf6dc44}{reset\+\_\+metrics} (self)
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_acf3aabdf7a98e434614c4da20c599df2}{report} (self)
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a04e97e79ef7e497c0927c10b31e42337}{score} (self, batch)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac1dcd540b081131810d3472e91920fa7}{add\+\_\+cmdline\+\_\+args} (parser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a9d5bac9fe43ddf4129d486e3061a7a69}{is\+\_\+finetune}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a98e1aad7d454f0ef1a971b60db1bcd18}{class\+\_\+list}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a80b1b3e0162c2dca36a1e1763cf3cad9}{class\+\_\+dict}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac4c098a9fe13fcbb279cb388059fbdb7}{class\+\_\+weights}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a830ed9662779e824cc9596695b04e985}{ref\+\_\+class}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_aba6e1d0ef53762f5930c271c3ae8d63a}{threshold}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_acf08c5622edd3627fbe993730f16baa4}{model}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_aa59eee6c442bfb02846661fba0904a3d}{criterion}
\item 
\hyperlink{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_af7bc3e7b011e16ae3e75617c4773a1a4}{optimizer}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
\begin{DoxyVerb}Abstract Classifier agent. Only meant to be extended.

TorchClassifierAgent aims to handle much of the bookkeeping any classification
model.
\end{DoxyVerb}
 

Definition at line 22 of file torch\+\_\+classifier\+\_\+agent.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a086eb865c3a6586372671ec1254f0d66}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a086eb865c3a6586372671ec1254f0d66}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 96 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
96     \textcolor{keyword}{def }\_\_init\_\_(self, opt: Opt, shared=\textcolor{keywordtype}{None}):
97         init\_model, self.is\_finetune = self.\_get\_init\_model(opt, shared)
98         super().\_\_init\_\_(opt, shared)
99 
100         \textcolor{comment}{# set up classes}
101         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'classes'}) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} opt.get(\textcolor{stringliteral}{'classes\_from\_file'}) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
102             \textcolor{keywordflow}{raise} RuntimeError(
103                 \textcolor{stringliteral}{'Must specify --classes or --classes-from-file argument.'}
104             )
105         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} shared:
106             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'classes\_from\_file'}] \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
107                 with open(opt[\textcolor{stringliteral}{'classes\_from\_file'}]) \textcolor{keyword}{as} f:
108                     self.class\_list = f.read().splitlines()
109             \textcolor{keywordflow}{else}:
110                 self.class\_list = opt[\textcolor{stringliteral}{'classes'}]
111             self.class\_dict = \{val: i \textcolor{keywordflow}{for} i, val \textcolor{keywordflow}{in} enumerate(self.class\_list)\}
112             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'class\_weights'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
113                 self.class\_weights = opt[\textcolor{stringliteral}{'class\_weights'}]
114             \textcolor{keywordflow}{else}:
115                 self.class\_weights = [1.0 \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} self.class\_list]
116             self.reset\_metrics()
117         \textcolor{keywordflow}{else}:
118             self.class\_list = shared[\textcolor{stringliteral}{'class\_list'}]
119             self.class\_dict = shared[\textcolor{stringliteral}{'class\_dict'}]
120             self.class\_weights = shared[\textcolor{stringliteral}{'class\_weights'}]
121 
122         \textcolor{comment}{# get reference class; if opt['get\_all\_metrics'] is False, this is}
123         \textcolor{comment}{# used to compute metrics}
124         \textcolor{comment}{# in binary classfication, opt['threshold'] applies to ref class}
125         \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'ref\_class'}] \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} opt[\textcolor{stringliteral}{'ref\_class'}] \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.class\_dict:
126             self.ref\_class = self.class\_list[0]
127         \textcolor{keywordflow}{else}:
128             self.ref\_class = opt[\textcolor{stringliteral}{'ref\_class'}]
129             ref\_class\_id = self.class\_list.index(self.ref\_class)
130             \textcolor{keywordflow}{if} ref\_class\_id != 0:
131                 \textcolor{comment}{# move to the front of the class list}
132                 self.class\_list.insert(0, self.class\_list.pop(ref\_class\_id))
133         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} opt[\textcolor{stringliteral}{'get\_all\_metrics'}]:
134             \hyperlink{namespaceparlai_1_1utils_1_1misc_a884a3aefa90581f53bc592fa6a78dc43}{warn\_once}(
135                 \textcolor{stringliteral}{'Using %s as the class for computing P, R, and F1'} % self.ref\_class
136             )
137 
138         \textcolor{comment}{# set up threshold, only used in binary classification}
139         \textcolor{keywordflow}{if} len(self.class\_list) == 2 \textcolor{keywordflow}{and} opt.get(\textcolor{stringliteral}{'threshold'}, 0.5) != 0.5:
140             self.threshold = opt[\textcolor{stringliteral}{'threshold'}]
141         \textcolor{keywordflow}{else}:
142             self.threshold = \textcolor{keywordtype}{None}
143 
144         \textcolor{comment}{# set up model and optimizers}
145 
146         \textcolor{keywordflow}{if} shared:
147             self.model = shared[\textcolor{stringliteral}{'model'}]
148         \textcolor{keywordflow}{else}:
149             self.model = self.build\_model()
150             self.criterion = self.build\_criterion()
151             \textcolor{keywordflow}{if} self.model \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} self.criterion \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
152                 \textcolor{keywordflow}{raise} AttributeError(
153                     \textcolor{stringliteral}{'build\_model() and build\_criterion() need to return the model or criterion'}
154                 )
155             \textcolor{keywordflow}{if} self.use\_cuda:
156                 self.model.cuda()
157                 self.criterion.cuda()
158             \textcolor{keywordflow}{if} init\_model:
159                 print(\textcolor{stringliteral}{'Loading existing model parameters from '} + init\_model)
160                 self.load(init\_model)
161             \textcolor{keywordflow}{if} self.use\_cuda:
162                 \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'data\_parallel'}]:
163                     \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1utils_1_1distributed_a023acb5e3b66e1f27e21247c35661279}{is\_distributed}():
164                         \textcolor{keywordflow}{raise} ValueError(
165                             \textcolor{stringliteral}{'Cannot combine --data-parallel and distributed mode'}
166                         )
167                     self.model = torch.nn.DataParallel(self.model)
168         \textcolor{keywordflow}{if} shared:
169             \textcolor{comment}{# We don't use get here because hasattr is used on optimizer later.}
170             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'optimizer'} \textcolor{keywordflow}{in} shared:
171                 self.optimizer = shared[\textcolor{stringliteral}{'optimizer'}]
172         \textcolor{keywordflow}{else}:
173             optim\_params = [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} self.model.parameters() \textcolor{keywordflow}{if} p.requires\_grad]
174             self.init\_optim(optim\_params)
175             self.build\_lr\_scheduler()
176 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac1dcd540b081131810d3472e91920fa7}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac1dcd540b081131810d3472e91920fa7}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{parser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Add CLI args.
\end{DoxyVerb}
 

Definition at line 31 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
31     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(parser):
32         \textcolor{stringliteral}{"""}
33 \textcolor{stringliteral}{        Add CLI args.}
34 \textcolor{stringliteral}{        """}
35         TorchAgent.add\_cmdline\_args(parser)
36         parser = parser.add\_argument\_group(\textcolor{stringliteral}{'Torch Classifier Arguments'})
37         \textcolor{comment}{# class arguments}
38         parser.add\_argument(
39             \textcolor{stringliteral}{'--classes'},
40             type=str,
41             nargs=\textcolor{stringliteral}{'*'},
42             default=\textcolor{keywordtype}{None},
43             help=\textcolor{stringliteral}{'the name of the classes.'},
44         )
45         parser.add\_argument(
46             \textcolor{stringliteral}{'--class-weights'},
47             type=float,
48             nargs=\textcolor{stringliteral}{'*'},
49             default=\textcolor{keywordtype}{None},
50             help=\textcolor{stringliteral}{'weight of each of the classes for the softmax'},
51         )
52         parser.add\_argument(
53             \textcolor{stringliteral}{'--ref-class'},
54             type=str,
55             default=\textcolor{keywordtype}{None},
56             hidden=\textcolor{keyword}{True},
57             help=\textcolor{stringliteral}{'the class that will be used to compute '}
58             \textcolor{stringliteral}{'precision and recall. By default the first '}
59             \textcolor{stringliteral}{'class.'},
60         )
61         parser.add\_argument(
62             \textcolor{stringliteral}{'--threshold'},
63             type=float,
64             default=0.5,
65             help=\textcolor{stringliteral}{'during evaluation, threshold for choosing '}
66             \textcolor{stringliteral}{'ref class; only applies to binary '}
67             \textcolor{stringliteral}{'classification'},
68         )
69         \textcolor{comment}{# interactive mode}
70         parser.add\_argument(
71             \textcolor{stringliteral}{'--print-scores'},
72             type=\textcolor{stringliteral}{'bool'},
73             default=\textcolor{keyword}{False},
74             help=\textcolor{stringliteral}{'print probability of chosen class during '} \textcolor{stringliteral}{'interactive mode'},
75         )
76         \textcolor{comment}{# miscellaneous arguments}
77         parser.add\_argument(
78             \textcolor{stringliteral}{'--data-parallel'},
79             type=\textcolor{stringliteral}{'bool'},
80             default=\textcolor{keyword}{False},
81             help=\textcolor{stringliteral}{'uses nn.DataParallel for multi GPU'},
82         )
83         parser.add\_argument(
84             \textcolor{stringliteral}{'--get-all-metrics'},
85             type=\textcolor{stringliteral}{'bool'},
86             default=\textcolor{keyword}{True},
87             help=\textcolor{stringliteral}{'give prec/recall metrics for all classes'},
88         )
89         parser.add\_argument(
90             \textcolor{stringliteral}{'--classes-from-file'},
91             type=str,
92             default=\textcolor{keywordtype}{None},
93             help=\textcolor{stringliteral}{'loads the list of classes from a file'},
94         )
95 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_adeab756c0b58667aaf417575c23d1dfb}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_adeab756c0b58667aaf417575c23d1dfb}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!build\+\_\+criterion@{build\+\_\+criterion}}
\index{build\+\_\+criterion@{build\+\_\+criterion}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{build\+\_\+criterion()}{build\_criterion()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+build\+\_\+criterion (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 177 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
177     \textcolor{keyword}{def }build\_criterion(self):
178         weight\_tensor = torch.FloatTensor(self.class\_weights)
179         \textcolor{keywordflow}{return} torch.nn.CrossEntropyLoss(weight\_tensor)
180 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a5d456df843180fb32ca574dc2a33cc80}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a5d456df843180fb32ca574dc2a33cc80}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!eval\+\_\+step@{eval\+\_\+step}}
\index{eval\+\_\+step@{eval\+\_\+step}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{eval\+\_\+step()}{eval\_step()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+eval\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Train on a single batch of examples.
\end{DoxyVerb}
 

Definition at line 264 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
264     \textcolor{keyword}{def }eval\_step(self, batch):
265         \textcolor{stringliteral}{"""}
266 \textcolor{stringliteral}{        Train on a single batch of examples.}
267 \textcolor{stringliteral}{        """}
268         \textcolor{keywordflow}{if} batch.text\_vec \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
269             \textcolor{keywordflow}{return}
270 
271         self.model.eval()
272         scores = self.score(batch)
273         probs = F.softmax(scores, dim=1)
274         \textcolor{keywordflow}{if} self.threshold \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
275             \_, prediction\_id = torch.max(probs.cpu(), 1)
276         \textcolor{keywordflow}{else}:
277             ref\_prob = probs.cpu()[:, 0]
278             \textcolor{comment}{# choose ref class if Prob(ref class) > threshold}
279             prediction\_id = ref\_prob <= self.threshold
280         preds = [self.class\_list[idx] \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} prediction\_id]
281 
282         \textcolor{keywordflow}{if} batch.labels \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
283             \textcolor{comment}{# interactive mode}
284             \textcolor{keywordflow}{if} self.opt.get(\textcolor{stringliteral}{'print\_scores'}, \textcolor{keyword}{False}):
285                 preds = self.\_format\_interactive\_output(probs, prediction\_id)
286         \textcolor{keywordflow}{else}:
287             labels = self.\_get\_labels(batch)
288             loss = self.criterion(scores, labels)
289             self.metrics[\textcolor{stringliteral}{'loss'}] += loss.item()
290             self.metrics[\textcolor{stringliteral}{'examples'}] += len(batch.text\_vec)
291             self.\_update\_confusion\_matrix(batch, preds)
292 
293         \textcolor{keywordflow}{return} \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_a2689006ea97d09413fb242f984bd8016}{Output}(preds)
294 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_acf3aabdf7a98e434614c4da20c599df2}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_acf3aabdf7a98e434614c4da20c599df2}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!report@{report}}
\index{report@{report}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{report()}{report()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+report (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Report loss as well as precision, recall, and F1 metrics.
\end{DoxyVerb}
 

Definition at line 341 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
341     \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}(self):
342         \textcolor{stringliteral}{"""}
343 \textcolor{stringliteral}{        Report loss as well as precision, recall, and F1 metrics.}
344 \textcolor{stringliteral}{        """}
345         m = super().\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}()
346         examples = self.metrics[\textcolor{stringliteral}{'examples'}]
347         \textcolor{keywordflow}{if} examples > 0:
348             m[\textcolor{stringliteral}{'examples'}] = examples
349             m[\textcolor{stringliteral}{'mean\_loss'}] = self.metrics[\textcolor{stringliteral}{'loss'}] / examples
350 
351             \textcolor{comment}{# get prec/recall metrics}
352             confmat = self.metrics[\textcolor{stringliteral}{'confusion\_matrix'}]
353             \textcolor{keywordflow}{if} self.opt.get(\textcolor{stringliteral}{'get\_all\_metrics'}):
354                 metrics\_list = self.class\_list
355             \textcolor{keywordflow}{else}:
356                 \textcolor{comment}{# only give prec/recall metrics for ref class}
357                 metrics\_list = [self.ref\_class]
358 
359             examples\_per\_class = []
360             \textcolor{keywordflow}{for} class\_i \textcolor{keywordflow}{in} metrics\_list:
361                 class\_total = self.\_report\_prec\_recall\_metrics(confmat, class\_i, m)
362                 examples\_per\_class.append(class\_total)
363 
364             \textcolor{keywordflow}{if} len(examples\_per\_class) > 1:
365                 \textcolor{comment}{# get weighted f1}
366                 f1 = 0
367                 total\_exs = sum(examples\_per\_class)
368                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(self.class\_list)):
369                     f1 += (examples\_per\_class[i] / total\_exs) * m[
370                         \textcolor{stringliteral}{'class\_\{\}\_f1'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(self.class\_list[i])
371                     ]
372                 m[\textcolor{stringliteral}{'weighted\_f1'}] = f1
373 
374         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} m.items():
375             m[k] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(v, 4)
376 
377         \textcolor{keywordflow}{return} m
378 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac96e55ac13019eace0641a7efcf6dc44}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac96e55ac13019eace0641a7efcf6dc44}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!reset\+\_\+metrics@{reset\+\_\+metrics}}
\index{reset\+\_\+metrics@{reset\+\_\+metrics}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{reset\+\_\+metrics()}{reset\_metrics()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+reset\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset metrics.
\end{DoxyVerb}
 

Definition at line 295 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
295     \textcolor{keyword}{def }reset\_metrics(self):
296         \textcolor{stringliteral}{"""}
297 \textcolor{stringliteral}{        Reset metrics.}
298 \textcolor{stringliteral}{        """}
299         super().reset\_metrics()
300         self.metrics[\textcolor{stringliteral}{'confusion\_matrix'}] = defaultdict(int)
301         self.metrics[\textcolor{stringliteral}{'examples'}] = 0
302         self.metrics[\textcolor{stringliteral}{'loss'}] = 0.0
303 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a04e97e79ef7e497c0927c10b31e42337}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a04e97e79ef7e497c0927c10b31e42337}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!score@{score}}
\index{score@{score}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{score()}{score()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+score (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Given a batch and labels, returns the scores.

:param batch:
    a Batch object (defined in torch_agent.py)
:return:
    a [bsz, num_classes] FloatTensor containing the score of each
    class.
\end{DoxyVerb}
 

Definition at line 379 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
379     \textcolor{keyword}{def }score(self, batch):
380         \textcolor{stringliteral}{"""}
381 \textcolor{stringliteral}{        Given a batch and labels, returns the scores.}
382 \textcolor{stringliteral}{}
383 \textcolor{stringliteral}{        :param batch:}
384 \textcolor{stringliteral}{            a Batch object (defined in torch\_agent.py)}
385 \textcolor{stringliteral}{        :return:}
386 \textcolor{stringliteral}{            a [bsz, num\_classes] FloatTensor containing the score of each}
387 \textcolor{stringliteral}{            class.}
388 \textcolor{stringliteral}{        """}
389         \textcolor{keywordflow}{raise} NotImplementedError(\textcolor{stringliteral}{'Abstract class: user must implement score()'})
390 \end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a33e56566ee5e81b257b049bd6a3c1cd6}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a33e56566ee5e81b257b049bd6a3c1cd6}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!share@{share}}
\index{share@{share}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Share model parameters.
\end{DoxyVerb}
 

Definition at line 181 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
181     \textcolor{keyword}{def }share(self):
182         \textcolor{stringliteral}{"""}
183 \textcolor{stringliteral}{        Share model parameters.}
184 \textcolor{stringliteral}{        """}
185         shared = super().share()
186         shared[\textcolor{stringliteral}{'class\_dict'}] = self.class\_dict
187         shared[\textcolor{stringliteral}{'class\_list'}] = self.class\_list
188         shared[\textcolor{stringliteral}{'class\_weights'}] = self.class\_weights
189         shared[\textcolor{stringliteral}{'model'}] = self.model
190         shared[\textcolor{stringliteral}{'optimizer'}] = self.optimizer
191         \textcolor{keywordflow}{return} shared
192 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a3baacdb005c5f5a6367c45c93d21d398}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a3baacdb005c5f5a6367c45c93d21d398}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!train\+\_\+step@{train\+\_\+step}}
\index{train\+\_\+step@{train\+\_\+step}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{train\+\_\+step()}{train\_step()}}
{\footnotesize\ttfamily def parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+train\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Train on a single batch of examples.
\end{DoxyVerb}
 

Definition at line 237 of file torch\+\_\+classifier\+\_\+agent.\+py.


\begin{DoxyCode}
237     \textcolor{keyword}{def }train\_step(self, batch):
238         \textcolor{stringliteral}{"""}
239 \textcolor{stringliteral}{        Train on a single batch of examples.}
240 \textcolor{stringliteral}{        """}
241         \textcolor{keywordflow}{if} batch.text\_vec \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
242             \textcolor{keywordflow}{return} \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_a2689006ea97d09413fb242f984bd8016}{Output}()
243         self.model.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}()
244         self.optimizer.zero\_grad()
245 
246         \textcolor{comment}{# calculate loss}
247         labels = self.\_get\_labels(batch)
248         scores = self.score(batch)
249         loss = self.criterion(scores, labels)
250         loss.backward()
251         self.update\_params()
252 
253         \textcolor{comment}{# update metrics}
254         self.metrics[\textcolor{stringliteral}{'loss'}] += loss.item()
255         self.metrics[\textcolor{stringliteral}{'examples'}] += len(batch.text\_vec)
256 
257         \textcolor{comment}{# get predictions}
258         \_, prediction\_id = torch.max(scores.cpu(), 1)
259         preds = [self.class\_list[idx] \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} prediction\_id]
260         self.\_update\_confusion\_matrix(batch, preds)
261 
262         \textcolor{keywordflow}{return} \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_a2689006ea97d09413fb242f984bd8016}{Output}(preds)
263 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a80b1b3e0162c2dca36a1e1763cf3cad9}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a80b1b3e0162c2dca36a1e1763cf3cad9}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!class\+\_\+dict@{class\+\_\+dict}}
\index{class\+\_\+dict@{class\+\_\+dict}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{class\+\_\+dict}{class\_dict}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+class\+\_\+dict}



Definition at line 111 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a98e1aad7d454f0ef1a971b60db1bcd18}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a98e1aad7d454f0ef1a971b60db1bcd18}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!class\+\_\+list@{class\+\_\+list}}
\index{class\+\_\+list@{class\+\_\+list}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{class\+\_\+list}{class\_list}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+class\+\_\+list}



Definition at line 108 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac4c098a9fe13fcbb279cb388059fbdb7}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_ac4c098a9fe13fcbb279cb388059fbdb7}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!class\+\_\+weights@{class\+\_\+weights}}
\index{class\+\_\+weights@{class\+\_\+weights}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{class\+\_\+weights}{class\_weights}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+class\+\_\+weights}



Definition at line 113 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_aa59eee6c442bfb02846661fba0904a3d}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_aa59eee6c442bfb02846661fba0904a3d}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!criterion@{criterion}}
\index{criterion@{criterion}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{criterion}{criterion}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+criterion}



Definition at line 150 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a9d5bac9fe43ddf4129d486e3061a7a69}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a9d5bac9fe43ddf4129d486e3061a7a69}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!is\+\_\+finetune@{is\+\_\+finetune}}
\index{is\+\_\+finetune@{is\+\_\+finetune}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{is\+\_\+finetune}{is\_finetune}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+is\+\_\+finetune}



Definition at line 97 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_acf08c5622edd3627fbe993730f16baa4}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_acf08c5622edd3627fbe993730f16baa4}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!model@{model}}
\index{model@{model}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+model}



Definition at line 147 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_af7bc3e7b011e16ae3e75617c4773a1a4}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_af7bc3e7b011e16ae3e75617c4773a1a4}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+optimizer}



Definition at line 171 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a830ed9662779e824cc9596695b04e985}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_a830ed9662779e824cc9596695b04e985}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!ref\+\_\+class@{ref\+\_\+class}}
\index{ref\+\_\+class@{ref\+\_\+class}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{ref\+\_\+class}{ref\_class}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+ref\+\_\+class}



Definition at line 126 of file torch\+\_\+classifier\+\_\+agent.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_aba6e1d0ef53762f5930c271c3ae8d63a}\label{classparlai_1_1core_1_1torch__classifier__agent_1_1TorchClassifierAgent_aba6e1d0ef53762f5930c271c3ae8d63a}} 
\index{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}!threshold@{threshold}}
\index{threshold@{threshold}!parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent@{parlai\+::core\+::torch\+\_\+classifier\+\_\+agent\+::\+Torch\+Classifier\+Agent}}
\subsubsection{\texorpdfstring{threshold}{threshold}}
{\footnotesize\ttfamily parlai.\+core.\+torch\+\_\+classifier\+\_\+agent.\+Torch\+Classifier\+Agent.\+threshold}



Definition at line 140 of file torch\+\_\+classifier\+\_\+agent.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/core/\hyperlink{torch__classifier__agent_8py}{torch\+\_\+classifier\+\_\+agent.\+py}\end{DoxyCompactItemize}
