\hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher}{}\section{parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher Class Reference}
\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher}\index{parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher@{parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher}}


Inherits \hyperlink{classparlai_1_1core_1_1teachers_1_1DialogTeacher}{parlai.\+core.\+teachers.\+Dialog\+Teacher}.



Inherited by \hyperlink{classdbll__babi_1_1agents_1_1DefaultTeacher}{dbll\+\_\+babi.\+agents.\+Default\+Teacher}, \hyperlink{classdbll__babi_1_1agents_1_1TaskTeacher}{dbll\+\_\+babi.\+agents.\+Task\+Teacher}, \hyperlink{classdialog__babi__feedback_1_1agents_1_1KBTeacher}{dialog\+\_\+babi\+\_\+feedback.\+agents.\+K\+B\+Teacher}, \hyperlink{classdialog__babi__feedback_1_1agents_1_1TaskTeacher}{dialog\+\_\+babi\+\_\+feedback.\+agents.\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1babi_1_1agents_1_1Task10kTeacher}{parlai.\+tasks.\+babi.\+agents.\+Task10k\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1babi_1_1agents_1_1Task1kTeacher}{parlai.\+tasks.\+babi.\+agents.\+Task1k\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1booktest_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+booktest.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1cbt_1_1agents_1_1CNTeacher}{parlai.\+tasks.\+cbt.\+agents.\+C\+N\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1cbt_1_1agents_1_1NETeacher}{parlai.\+tasks.\+cbt.\+agents.\+N\+E\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1cbt_1_1agents_1_1PTeacher}{parlai.\+tasks.\+cbt.\+agents.\+P\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1cbt_1_1agents_1_1VTeacher}{parlai.\+tasks.\+cbt.\+agents.\+V\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1convai2_1_1agents_1_1BothTeacher}{parlai.\+tasks.\+convai2.\+agents.\+Both\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1convai2_1_1agents_1_1NoneTeacher}{parlai.\+tasks.\+convai2.\+agents.\+None\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1convai2_1_1agents_1_1SelfOriginalTeacher}{parlai.\+tasks.\+convai2.\+agents.\+Self\+Original\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1convai2_1_1agents_1_1SelfRevisedTeacher}{parlai.\+tasks.\+convai2.\+agents.\+Self\+Revised\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1cornell__movie_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+cornell\+\_\+movie.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dbll__babi_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+dbll\+\_\+babi.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dbll__babi_1_1agents_1_1TaskTeacher}{parlai.\+tasks.\+dbll\+\_\+babi.\+agents.\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dbll__movie_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+dbll\+\_\+movie.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dbll__movie_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+dbll\+\_\+movie.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dbll__movie_1_1agents_1_1TaskTeacher}{parlai.\+tasks.\+dbll\+\_\+movie.\+agents.\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dialog__babi_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+dialog\+\_\+babi.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dialog__babi_1_1agents_1_1TaskTeacher}{parlai.\+tasks.\+dialog\+\_\+babi.\+agents.\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dialog__babi__plus_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+dialog\+\_\+babi\+\_\+plus.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1dialog__babi__plus_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+dialog\+\_\+babi\+\_\+plus.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1fromfile_1_1agents_1_1Fbformat2Teacher}{parlai.\+tasks.\+fromfile.\+agents.\+Fbformat2\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1fromfile_1_1agents_1_1FbformatTeacher}{parlai.\+tasks.\+fromfile.\+agents.\+Fbformat\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1insuranceqa_1_1agents_1_1V1Teacher}{parlai.\+tasks.\+insuranceqa.\+agents.\+V1\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1insuranceqa_1_1agents_1_1V2Teacher}{parlai.\+tasks.\+insuranceqa.\+agents.\+V2\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1mctest_1_1agents_1_1Task160Teacher}{parlai.\+tasks.\+mctest.\+agents.\+Task160\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1mctest_1_1agents_1_1Task500Teacher}{parlai.\+tasks.\+mctest.\+agents.\+Task500\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1moviedialog_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+moviedialog.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1moviedialog_1_1agents_1_1TaskTeacher}{parlai.\+tasks.\+moviedialog.\+agents.\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1ms__marco_1_1agents_1_1PassageTeacher}{parlai.\+tasks.\+ms\+\_\+marco.\+agents.\+Passage\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1mturkwikimovies_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+mturkwikimovies.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1opensubtitles_1_1agents_1_1FullTeacher}{parlai.\+tasks.\+opensubtitles.\+agents.\+Full\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1opensubtitles_1_1agents_1_1HalfTeacher}{parlai.\+tasks.\+opensubtitles.\+agents.\+Half\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1BothOriginalTeacher}{parlai.\+tasks.\+personachat.\+agents.\+Both\+Original\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1BothRevisedTeacher}{parlai.\+tasks.\+personachat.\+agents.\+Both\+Revised\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1NoneTeacher}{parlai.\+tasks.\+personachat.\+agents.\+None\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1OtherOriginalTeacher}{parlai.\+tasks.\+personachat.\+agents.\+Other\+Original\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1OtherRevisedTeacher}{parlai.\+tasks.\+personachat.\+agents.\+Other\+Revised\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1SelfOriginalTeacher}{parlai.\+tasks.\+personachat.\+agents.\+Self\+Original\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personachat_1_1agents_1_1SelfRevisedTeacher}{parlai.\+tasks.\+personachat.\+agents.\+Self\+Revised\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personalized__dialog_1_1agents_1_1FullTaskTeacher}{parlai.\+tasks.\+personalized\+\_\+dialog.\+agents.\+Full\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personalized__dialog_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+personalized\+\_\+dialog.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1personalized__dialog_1_1agents_1_1SmallTaskTeacher}{parlai.\+tasks.\+personalized\+\_\+dialog.\+agents.\+Small\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1qacnn_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+qacnn.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1qadailymail_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+qadailymail.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1scan_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+scan.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1shadock_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+shadock.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1shadock_1_1agents_1_1TaskTeacher}{parlai.\+tasks.\+shadock.\+agents.\+Task\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1simplequestions_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+simplequestions.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1webquestions_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+webquestions.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1wikimovies_1_1agents_1_1DefaultTeacher}{parlai.\+tasks.\+wikimovies.\+agents.\+Default\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1wikimovies_1_1agents_1_1KBTeacher}{parlai.\+tasks.\+wikimovies.\+agents.\+K\+B\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1wikiqa_1_1agents_1_1FilteredTeacher}{parlai.\+tasks.\+wikiqa.\+agents.\+Filtered\+Teacher}, \hyperlink{classparlai_1_1tasks_1_1wikiqa_1_1agents_1_1UnfilteredTeacher}{parlai.\+tasks.\+wikiqa.\+agents.\+Unfiltered\+Teacher}, and \hyperlink{classparlai_1_1tasks_1_1wmt_1_1agents_1_1EnDeTeacher}{parlai.\+tasks.\+wmt.\+agents.\+En\+De\+Teacher}.



Collaboration diagram for parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=224pt]{d5/d01/classparlai_1_1core_1_1teachers_1_1FbDialogTeacher__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a52316baa31ca0881d4cd98ec2fbebad5}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_af7a9ec497b9cd0292d7b8fa220da7c28}{opt}, shared=None)
\item 
def \hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a18a4ea7a7f21eeed7e087cb447a37c5a}{share} (self)
\item 
def \hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_ab3ff2f1a0707aae7bf888fb13ec49641}{label\+\_\+candidates} (self)
\item 
def \hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_ae6f10486ddf691ee868d33ea2c9dc295}{load\+\_\+cands} (self, path)
\item 
def \hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a6cb23867e396fac5fdcde509b5da3942}{setup\+\_\+data} (self, path)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_af7a9ec497b9cd0292d7b8fa220da7c28}{opt}
\item 
\hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a8505bfe962961b04961280a6e4c603f4}{cloze}
\item 
\hyperlink{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a3ec67545250d8a877038667e3f4ea158}{cands}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}This module provides access to data in the Facebook Dialog format.

Subclasses ``DialogTeacher`` for functionality and provides an
implementation of ``setup_data()`` which iterates over datasets in the
"fbdialog" format. If your data is in the format below, use this class to
handle file parsing for you.

The way FB Dialog data is set up is as follows:

::

    1 Sam went to the kitchen.
    2 Pat gave Sam the milk.
    3 Where is the milk?<TAB>kitchen<TAB>1<TAB>hallway|kitchen|bathroom
    4 Sam went to the hallway.
    5 Pat went to the bathroom.
    6 Where is the milk?<TAB>hallway<TAB>1<TAB>hallway|kitchen|bathroom

Lines 1-6 represent a single episode, with two different examples: the
first example is lines 1-3, and the second is lines 4-6.

Lines 1,2,4, and 5 represent contextual information.

Lines 3 and 6 contain a query, a label, a reward for getting the question
correct, and three label candidates.

Since both of these examples are part of the same episode, the information
provided in the first example is relevant to the query in the second
example and therefore the agent must remember the first example in order to
do well.

In general dialog in this format can contain any speech, not just QA pairs:

::

    1 Hi how's it going?<TAB>It's going great. What's new?
    2 Well I'm working on a new project at work.<TAB>Oh me too!
    3 Oh cool!<TAB>Tell me about yours.

etc.

Note that dialogs are interpreted as being one-way. For example, consider
this dialog:

::

    1 X1    Y1
    2 X2    Y2
    3 X3    Y3

A set of examples X1 => Y1, X2 => Y2, and X3 => Y3 will be generated.
However, Y1 => X2 and Y2 => X3 are not created as separate examples by
default. This makes sense for some data (we don't need to train on the idea
that "kitchen" should be followed by "Sam went to the hallway..." above),
but for other datasets it may be helpful to add additional examples in the
reverse direction ("Oh cool!" is a response to "Oh me too!" above).
\end{DoxyVerb}
 

Definition at line 970 of file teachers.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a52316baa31ca0881d4cd98ec2fbebad5}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a52316baa31ca0881d4cd98ec2fbebad5}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 1030 of file teachers.\+py.


\begin{DoxyCode}
1030     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
1031         self.opt = opt
1032         self.cloze = opt.get(\textcolor{stringliteral}{'cloze'}, \textcolor{keyword}{False})
1033         \textcolor{keywordflow}{if} shared \textcolor{keywordflow}{and} \textcolor{stringliteral}{'cands'} \textcolor{keywordflow}{in} shared:
1034             self.cands = shared[\textcolor{stringliteral}{'cands'}]
1035         \textcolor{keywordflow}{else}:
1036             self.cands = self.load\_cands(opt.get(\textcolor{stringliteral}{'cands\_datafile'}, \textcolor{keywordtype}{None}))
1037         super().\_\_init\_\_(opt, shared)
1038 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_ab3ff2f1a0707aae7bf888fb13ec49641}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_ab3ff2f1a0707aae7bf888fb13ec49641}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!label\+\_\+candidates@{label\+\_\+candidates}}
\index{label\+\_\+candidates@{label\+\_\+candidates}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{label\+\_\+candidates()}{label\_candidates()}}
{\footnotesize\ttfamily def parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+label\+\_\+candidates (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return the candidates.
\end{DoxyVerb}
 

Definition at line 1047 of file teachers.\+py.


\begin{DoxyCode}
1047     \textcolor{keyword}{def }label\_candidates(self):
1048         \textcolor{stringliteral}{"""}
1049 \textcolor{stringliteral}{        Return the candidates.}
1050 \textcolor{stringliteral}{        """}
1051         \textcolor{keywordflow}{return} self.cands
1052 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_ae6f10486ddf691ee868d33ea2c9dc295}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_ae6f10486ddf691ee868d33ea2c9dc295}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!load\+\_\+cands@{load\+\_\+cands}}
\index{load\+\_\+cands@{load\+\_\+cands}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{load\+\_\+cands()}{load\_cands()}}
{\footnotesize\ttfamily def parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+load\+\_\+cands (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Load a global fixed set of candidates.

The candidates will be provided by the teacher for every example (the true
labels for a specific example are also added to this set, so that it's possible
to get the right answer).
\end{DoxyVerb}
 

Definition at line 1053 of file teachers.\+py.


\begin{DoxyCode}
1053     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1misc_ad935ab0a9d49b897c5e3efdbe1c46c4d}{load\_cands}(self, path):
1054         \textcolor{stringliteral}{"""}
1055 \textcolor{stringliteral}{        Load a global fixed set of candidates.}
1056 \textcolor{stringliteral}{}
1057 \textcolor{stringliteral}{        The candidates will be provided by the teacher for every example (the true}
1058 \textcolor{stringliteral}{        labels for a specific example are also added to this set, so that it's possible}
1059 \textcolor{stringliteral}{        to get the right answer).}
1060 \textcolor{stringliteral}{        """}
1061         \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
1062             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
1063         cands = []
1064         lines\_have\_ids = \textcolor{keyword}{False}
1065         cands\_are\_replies = \textcolor{keyword}{False}
1066         cnt = 0
1067         with open(path) \textcolor{keyword}{as} read:
1068             \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} read:
1069                 line = line.strip().replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'}, \textcolor{stringliteral}{'\(\backslash\)n'})
1070                 \textcolor{keywordflow}{if} len(line) > 0:
1071                     cnt = cnt + 1
1072                     \textcolor{comment}{# If lines are numbered we strip them of numbers.}
1073                     \textcolor{keywordflow}{if} cnt == 1 \textcolor{keywordflow}{and} line[0:2] == \textcolor{stringliteral}{'1 '}:
1074                         lines\_have\_ids = \textcolor{keyword}{True}
1075                     \textcolor{comment}{# If tabs then the label\_candidates are all the replies.}
1076                     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'\(\backslash\)t'} \textcolor{keywordflow}{in} line \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} cands\_are\_replies:
1077                         cands\_are\_replies = \textcolor{keyword}{True}
1078                         cands = []
1079                     \textcolor{keywordflow}{if} lines\_have\_ids:
1080                         space\_idx = line.find(\textcolor{stringliteral}{' '})
1081                         line = line[space\_idx + 1 :]
1082                         \textcolor{keywordflow}{if} cands\_are\_replies:
1083                             sp = line.split(\textcolor{stringliteral}{'\(\backslash\)t'})
1084                             \textcolor{keywordflow}{if} len(sp) > 1 \textcolor{keywordflow}{and} sp[1] != \textcolor{stringliteral}{''}:
1085                                 cands.append(sp[1])
1086                         \textcolor{keywordflow}{else}:
1087                             cands.append(line)
1088                     \textcolor{keywordflow}{else}:
1089                         cands.append(line)
1090         \textcolor{keywordflow}{return} cands
1091 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a6cb23867e396fac5fdcde509b5da3942}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a6cb23867e396fac5fdcde509b5da3942}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!setup\+\_\+data@{setup\+\_\+data}}
\index{setup\+\_\+data@{setup\+\_\+data}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{setup\+\_\+data()}{setup\_data()}}
{\footnotesize\ttfamily def parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+setup\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Read data in the fbdialog format.

Returns ``((x,y,r,c), new_episode?)`` tuples.

``x`` represents a query, ``y`` represents the labels, ``r`` represents
any reward, and ``c`` represents any label_candidates.

The example above will be translated into the following tuples:

::

    x: 'Sam went to the kitchen\nPat gave Sam the milk\nWhere is the milk?'
    y: ['kitchen']
    r: '1'
    c: ['hallway', 'kitchen', 'bathroom']
    new_episode = True (this is the first example in the episode)


::

    x: 'Sam went to the hallway\\nPat went to the bathroom\\nWhere is the
milk?'
    y: ['hallway']
    r: '1'
    c: ['hallway', 'kitchen', 'bathroom']
    new_episode = False (this is the second example in the episode)
\end{DoxyVerb}
 

Definition at line 1092 of file teachers.\+py.


\begin{DoxyCode}
1092     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1tasks_1_1aqua_1_1agents_a2d4e9f4e80d4edc0646c7e3d52be9f25}{setup\_data}(self, path):
1093         \textcolor{stringliteral}{r"""}
1094 \textcolor{stringliteral}{        Read data in the fbdialog format.}
1095 \textcolor{stringliteral}{}
1096 \textcolor{stringliteral}{        Returns ``((x,y,r,c), new\_episode?)`` tuples.}
1097 \textcolor{stringliteral}{}
1098 \textcolor{stringliteral}{        ``x`` represents a query, ``y`` represents the labels, ``r`` represents}
1099 \textcolor{stringliteral}{        any reward, and ``c`` represents any label\_candidates.}
1100 \textcolor{stringliteral}{}
1101 \textcolor{stringliteral}{        The example above will be translated into the following tuples:}
1102 \textcolor{stringliteral}{}
1103 \textcolor{stringliteral}{        ::}
1104 \textcolor{stringliteral}{}
1105 \textcolor{stringliteral}{            x: 'Sam went to the kitchen\(\backslash\)nPat gave Sam the milk\(\backslash\)nWhere is the milk?'}
1106 \textcolor{stringliteral}{            y: ['kitchen']}
1107 \textcolor{stringliteral}{            r: '1'}
1108 \textcolor{stringliteral}{            c: ['hallway', 'kitchen', 'bathroom']}
1109 \textcolor{stringliteral}{            new\_episode = True (this is the first example in the episode)}
1110 \textcolor{stringliteral}{}
1111 \textcolor{stringliteral}{}
1112 \textcolor{stringliteral}{        ::}
1113 \textcolor{stringliteral}{}
1114 \textcolor{stringliteral}{            x: 'Sam went to the hallway\(\backslash\)\(\backslash\)nPat went to the bathroom\(\backslash\)\(\backslash\)nWhere is the}
1115 \textcolor{stringliteral}{                milk?'}
1116 \textcolor{stringliteral}{            y: ['hallway']}
1117 \textcolor{stringliteral}{            r: '1'}
1118 \textcolor{stringliteral}{            c: ['hallway', 'kitchen', 'bathroom']}
1119 \textcolor{stringliteral}{            new\_episode = False (this is the second example in the episode)}
1120 \textcolor{stringliteral}{        """}
1121         print(\textcolor{stringliteral}{"[loading fbdialog data:"} + path + \textcolor{stringliteral}{"]"})
1122         with open(path) \textcolor{keyword}{as} read:
1123             start = \textcolor{keyword}{True}
1124             x = \textcolor{stringliteral}{''}
1125             reward = 0
1126             last\_conv\_id = \textcolor{keywordtype}{None}
1127             \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} read:
1128                 line = line.strip().replace(\textcolor{stringliteral}{'\(\backslash\)\(\backslash\)n'}, \textcolor{stringliteral}{'\(\backslash\)n'})
1129                 \textcolor{keywordflow}{if} len(line) == 0:
1130                     \textcolor{comment}{# empty response}
1131                     \textcolor{keywordflow}{continue}
1132 
1133                 \textcolor{comment}{# first, get conversation index -- '1' means start of episode}
1134                 space\_idx = line.find(\textcolor{stringliteral}{' '})
1135                 \textcolor{keywordflow}{if} space\_idx == -1:
1136                     \textcolor{comment}{# empty line, both individuals are saying whitespace}
1137                     conv\_id = \hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(line)
1138                 \textcolor{keywordflow}{else}:
1139                     conv\_id = \hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(line[:space\_idx])
1140 
1141                 \textcolor{comment}{# split line into constituent parts, if available:}
1142                 \textcolor{comment}{# x<tab>y<tab>reward<tab>label\_candidates}
1143                 \textcolor{comment}{# where y, reward, and label\_candidates are optional}
1144                 split = line[space\_idx + 1 :].split(\textcolor{stringliteral}{'\(\backslash\)t'})
1145 
1146                 \textcolor{comment}{# remove empty items and strip each one}
1147                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(split)):
1148                     word = split[i].strip()
1149                     \textcolor{keywordflow}{if} len(word) == 0:
1150                         split[i] = \textcolor{stringliteral}{''}
1151                     \textcolor{keywordflow}{else}:
1152                         split[i] = word
1153                 \textcolor{comment}{# Empty reward string same as None}
1154                 \textcolor{keywordflow}{if} len(split) > 2 \textcolor{keywordflow}{and} split[2] == \textcolor{stringliteral}{''}:
1155                     split[2] = \textcolor{keywordtype}{None}
1156 
1157                 \textcolor{comment}{# now check if we're at a new episode}
1158                 \textcolor{keywordflow}{if} last\_conv\_id \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} conv\_id <= last\_conv\_id:
1159                     x = x.strip()
1160                     \textcolor{keywordflow}{if} x:
1161                         \textcolor{keywordflow}{yield} [x, \textcolor{keywordtype}{None}, reward], start
1162                     start = \textcolor{keyword}{True}
1163                     reward = 0
1164                     \textcolor{comment}{# start a new episode}
1165                     \textcolor{keywordflow}{if} self.cloze:
1166                         x = \textcolor{stringliteral}{'Fill in the blank in the last sentence.\(\backslash\)n\{x\}'}.
      \hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
1167                             x=split[0]
1168                         )
1169                     \textcolor{keywordflow}{else}:
1170                         x = split[0]
1171                 \textcolor{keywordflow}{else}:
1172                     \textcolor{keywordflow}{if} x:
1173                         \textcolor{comment}{# otherwise add current x to what we have so far}
1174                         x = \textcolor{stringliteral}{'\{x\}\(\backslash\)n\{next\_x\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(x=x, next\_x=split[0])
1175                     \textcolor{keywordflow}{else}:
1176                         x = split[0]
1177                 last\_conv\_id = conv\_id
1178                 \textcolor{keywordflow}{if} len(split) > 2 \textcolor{keywordflow}{and} split[2]:
1179                     reward += \hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}(split[2])
1180 
1181                 \textcolor{keywordflow}{if} len(split) > 1 \textcolor{keywordflow}{and} split[1]:
1182                     \textcolor{comment}{# only generate an example if we have a y}
1183                     split[0] = x
1184                     \textcolor{comment}{# split labels}
1185                     split[1] = split[1].split(\textcolor{stringliteral}{'|'})
1186                     \textcolor{keywordflow}{if} len(split) > 3:
1187                         \textcolor{comment}{# split label\_candidates}
1188                         split[3] = split[3].split(\textcolor{stringliteral}{'|'})
1189                     \textcolor{keywordflow}{if} len(split) > 2:
1190                         split[2] = reward
1191                     \textcolor{keywordflow}{else}:
1192                         split.append(reward)
1193                     \textcolor{keywordflow}{if} start:
1194                         \textcolor{keywordflow}{yield} split, \textcolor{keyword}{True}
1195                         start = \textcolor{keyword}{False}
1196                     \textcolor{keywordflow}{else}:
1197                         \textcolor{keywordflow}{yield} split, \textcolor{keyword}{False}
1198                     \textcolor{comment}{# reset x in case there is unlabeled data still left}
1199                     x = \textcolor{stringliteral}{''}
1200                     reward = 0
1201             \textcolor{keywordflow}{if} x:
1202                 \textcolor{keywordflow}{yield} [x, \textcolor{keywordtype}{None}, reward], start
1203 
1204 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a18a4ea7a7f21eeed7e087cb447a37c5a}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a18a4ea7a7f21eeed7e087cb447a37c5a}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!share@{share}}
\index{share@{share}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Share the data and canidates.
\end{DoxyVerb}
 

Definition at line 1039 of file teachers.\+py.


\begin{DoxyCode}
1039     \textcolor{keyword}{def }share(self):
1040         \textcolor{stringliteral}{"""}
1041 \textcolor{stringliteral}{        Share the data and canidates.}
1042 \textcolor{stringliteral}{        """}
1043         shared = super().share()
1044         shared[\textcolor{stringliteral}{'cands'}] = self.cands
1045         \textcolor{keywordflow}{return} shared
1046 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a3ec67545250d8a877038667e3f4ea158}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a3ec67545250d8a877038667e3f4ea158}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!cands@{cands}}
\index{cands@{cands}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{cands}{cands}}
{\footnotesize\ttfamily parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+cands}



Definition at line 1034 of file teachers.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a8505bfe962961b04961280a6e4c603f4}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_a8505bfe962961b04961280a6e4c603f4}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!cloze@{cloze}}
\index{cloze@{cloze}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{cloze}{cloze}}
{\footnotesize\ttfamily parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+cloze}



Definition at line 1032 of file teachers.\+py.

\mbox{\Hypertarget{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_af7a9ec497b9cd0292d7b8fa220da7c28}\label{classparlai_1_1core_1_1teachers_1_1FbDialogTeacher_af7a9ec497b9cd0292d7b8fa220da7c28}} 
\index{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}!opt@{opt}}
\index{opt@{opt}!parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher@{parlai\+::core\+::teachers\+::\+Fb\+Dialog\+Teacher}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+core.\+teachers.\+Fb\+Dialog\+Teacher.\+opt}



Definition at line 1031 of file teachers.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/core/\hyperlink{teachers_8py}{teachers.\+py}\end{DoxyCompactItemize}
