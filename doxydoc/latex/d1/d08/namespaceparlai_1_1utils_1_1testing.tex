\hypertarget{namespaceparlai_1_1utils_1_1testing}{}\section{parlai.\+utils.\+testing Namespace Reference}
\label{namespaceparlai_1_1utils_1_1testing}\index{parlai.\+utils.\+testing@{parlai.\+utils.\+testing}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classparlai_1_1utils_1_1testing_1_1retry}{retry}
\item 
class \hyperlink{classparlai_1_1utils_1_1testing_1_1TeeStringIO}{Tee\+String\+IO}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a2b1aba8cb2afc498691840f4b8999420}{is\+\_\+this\+\_\+circleci} ()
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a7b182622aebc6cdc41ee3b99ebe47432}{skip\+Unless\+Torch} (testfn, reason=\textquotesingle{}pytorch is not installed\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a2d3bb5013e210bf866032aedc812859b}{skip\+If\+G\+PU} (testfn, reason=\textquotesingle{}Test is C\+PU-\/only\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a2773d8b6d4631fa1f639dde415eb3e2b}{skip\+Unless\+G\+PU} (testfn, reason=\textquotesingle{}Test requires a G\+PU\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_ab04af7a525a569f29b936b54b32899b7}{skip\+Unless\+B\+PE} (testfn, reason=\textquotesingle{}Test requires a G\+PU\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a056ab7a9ad687500924a29001a7d9264}{skip\+If\+Circle\+CI} (testfn, reason=\textquotesingle{}Test disabled in Circle\+CI\textquotesingle{})
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a50b91b6f209eeedd93ae7ec0e790b121}{git\+\_\+ls\+\_\+files} (root=None, skip\+\_\+nonexisting=True)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a767a8ac6ea27697e6f782d7375d94933}{git\+\_\+ls\+\_\+dirs} (root=None)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a2e61f8f35b8ccf518e3561a224781ced}{git\+\_\+changed\+\_\+files} (skip\+\_\+nonexisting=True)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_aa9971204bea89f174596698b2e736214}{git\+\_\+commit\+\_\+messages} ()
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a18092382f94848a52ef19248aa39f7ca}{is\+\_\+new\+\_\+task\+\_\+filename} (filename)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\+\_\+output} ()
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a0945b769a10c0c844b29c02ff26445a5}{tempdir} ()
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_aa8539ab1d17813b0c17f08700b2c2c2e}{timeout}
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a005734981469efed8a992bf5edc3ca8a}{train\+\_\+model} (opt)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_ab5bd02c7b5ab42c393ddddf73d9c78d2}{eval\+\_\+model} (opt, skip\+\_\+valid=False, skip\+\_\+test=False, valid\+\_\+datatype=None)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a30c532f112f9beddd873382e649b3ecd}{display\+\_\+data} (opt)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_a1b41200277931b2e4e684dc9452889a9}{display\+\_\+model} (opt)
\item 
def \hyperlink{namespaceparlai_1_1utils_1_1testing_ae0c93fc8f4c3e079333dba0065fa4dd2}{download\+\_\+unittest\+\_\+models} ()
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1testing_a490429a10abf78b127acf5c8d05fe6a3}{T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1testing_a684675b731fae330593a7817c8649f27}{G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1testing_aee12f734544cd8a3dcb1c823aa51b2f0}{git\+\_\+}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1testing_a86172d8df39b9bd5f1df6d5d40cbcb84}{G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1testing_a3fb33ee5ae900d21c17886956cbe607a}{B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED}
\item 
\hyperlink{namespaceparlai_1_1utils_1_1testing_aefdde322d186e6a1136a5ca864048280}{D\+E\+B\+UG}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}\label{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!capture\+\_\+output@{capture\+\_\+output}}
\index{capture\+\_\+output@{capture\+\_\+output}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{capture\+\_\+output()}{capture\_output()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+capture\+\_\+output (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Suppress all logging output into a single buffer.

Use as a context manager.

>>> with capture_output() as output:
...     print('hello')
>>> output.getvalue()
'hello'
\end{DoxyVerb}
 

Definition at line 217 of file testing.\+py.


\begin{DoxyCode}
217 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}():
218     \textcolor{stringliteral}{"""}
219 \textcolor{stringliteral}{    Suppress all logging output into a single buffer.}
220 \textcolor{stringliteral}{}
221 \textcolor{stringliteral}{    Use as a context manager.}
222 \textcolor{stringliteral}{}
223 \textcolor{stringliteral}{    >>> with capture\_output() as output:}
224 \textcolor{stringliteral}{    ...     print('hello')}
225 \textcolor{stringliteral}{    >>> output.getvalue()}
226 \textcolor{stringliteral}{    'hello'}
227 \textcolor{stringliteral}{    """}
228     sio = TeeStringIO()
229     with contextlib.redirect\_stdout(sio), contextlib.redirect\_stderr(sio):
230         \textcolor{keywordflow}{yield} sio
231 
232 
233 @contextlib.contextmanager
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a30c532f112f9beddd873382e649b3ecd}\label{namespaceparlai_1_1utils_1_1testing_a30c532f112f9beddd873382e649b3ecd}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!display\+\_\+data@{display\+\_\+data}}
\index{display\+\_\+data@{display\+\_\+data}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{display\+\_\+data()}{display\_data()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+display\+\_\+data (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Run through a display data run.

:return: (stdout_train, stdout_valid, stdout_test)
:rtype: (str, str, str)
\end{DoxyVerb}
 

Definition at line 374 of file testing.\+py.


\begin{DoxyCode}
374 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a30c532f112f9beddd873382e649b3ecd}{display\_data}(opt):
375     \textcolor{stringliteral}{"""}
376 \textcolor{stringliteral}{    Run through a display data run.}
377 \textcolor{stringliteral}{}
378 \textcolor{stringliteral}{    :return: (stdout\_train, stdout\_valid, stdout\_test)}
379 \textcolor{stringliteral}{    :rtype: (str, str, str)}
380 \textcolor{stringliteral}{    """}
381     \textcolor{keyword}{import} \hyperlink{namespaceparlai_1_1scripts_1_1display__data}{parlai.scripts.display\_data} \textcolor{keyword}{as} dd
382 
383     parser = dd.setup\_args()
384     parser.set\_params(**opt)
385 <<<<<<< HEAD
386     popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
387 =======
388 <<<<<<< HEAD
389 <<<<<<< HEAD
390     popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
391 =======
392     popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
393 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
394 >>>>>>> origin/master
395 =======
396     popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
397 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
398 >>>>>>> ef574cebef2a8d5aa38b73176b1e71a919d6670f
399 
400     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} train\_output:
401         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'train:stream'}
402         dd.display\_data(popt)
403     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} valid\_output:
404         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'valid:stream'}
405         dd.display\_data(popt)
406     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} test\_output:
407         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'test:stream'}
408         dd.display\_data(popt)
409 
410     \textcolor{keywordflow}{return} (train\_output.getvalue(), valid\_output.getvalue(), test\_output.getvalue())
411 
412 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a1b41200277931b2e4e684dc9452889a9}\label{namespaceparlai_1_1utils_1_1testing_a1b41200277931b2e4e684dc9452889a9}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!display\+\_\+model@{display\+\_\+model}}
\index{display\+\_\+model@{display\+\_\+model}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{display\+\_\+model()}{display\_model()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+display\+\_\+model (\begin{DoxyParamCaption}\item[{}]{opt,  }\item[{}]{Tuple,  }\item[{}]{str,  }\item[{}]{str }\end{DoxyParamCaption})}

\begin{DoxyVerb}Run display_model.py.

:return: (stdout_valid, stdout_test)
\end{DoxyVerb}
 

Definition at line 413 of file testing.\+py.


\begin{DoxyCode}
413 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a1b41200277931b2e4e684dc9452889a9}{display\_model}(opt) -> Tuple[str, str]:
414     \textcolor{stringliteral}{"""}
415 \textcolor{stringliteral}{    Run display\_model.py.}
416 \textcolor{stringliteral}{}
417 \textcolor{stringliteral}{    :return: (stdout\_valid, stdout\_test)}
418 \textcolor{stringliteral}{    """}
419     \textcolor{keyword}{import} \hyperlink{namespaceparlai_1_1scripts_1_1display__model}{parlai.scripts.display\_model} \textcolor{keyword}{as} dm
420 
421     parser = dm.setup\_args()
422     parser.set\_params(**opt)
423 <<<<<<< HEAD
424     popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
425 =======
426 <<<<<<< HEAD
427 <<<<<<< HEAD
428     popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
429 =======
430     popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
431 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
432 >>>>>>> origin/master
433 =======
434     popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
435 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
436 >>>>>>> ef574cebef2a8d5aa38b73176b1e71a919d6670f
437     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} train\_output:
438         \textcolor{comment}{# evalmode so that we don't hit train\_step}
439         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'train:evalmode:stream'}
440         dm.display\_model(popt)
441     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} valid\_output:
442         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'valid:stream'}
443         dm.display\_model(popt)
444     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} test\_output:
445         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'test:stream'}
446         dm.display\_model(popt)
447     \textcolor{keywordflow}{return} (train\_output.getvalue(), valid\_output.getvalue(), test\_output.getvalue())
448 
449 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_ae0c93fc8f4c3e079333dba0065fa4dd2}\label{namespaceparlai_1_1utils_1_1testing_ae0c93fc8f4c3e079333dba0065fa4dd2}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!download\+\_\+unittest\+\_\+models@{download\+\_\+unittest\+\_\+models}}
\index{download\+\_\+unittest\+\_\+models@{download\+\_\+unittest\+\_\+models}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{download\+\_\+unittest\+\_\+models()}{download\_unittest\_models()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+download\+\_\+unittest\+\_\+models (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Download the unittest pretrained models.
\end{DoxyVerb}
 

Definition at line 450 of file testing.\+py.


\begin{DoxyCode}
450 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_ae0c93fc8f4c3e079333dba0065fa4dd2}{download\_unittest\_models}():
451     \textcolor{stringliteral}{"""}
452 \textcolor{stringliteral}{    Download the unittest pretrained models.}
453 \textcolor{stringliteral}{    """}
454     \textcolor{keyword}{from} \hyperlink{namespaceparlai_1_1core_1_1params}{parlai.core.params} \textcolor{keyword}{import} ParlaiParser
455     \textcolor{keyword}{from} \hyperlink{namespaceparlai_1_1core_1_1build__data}{parlai.core.build\_data} \textcolor{keyword}{import} download\_models
456 
457 <<<<<<< HEAD
458     opt = ParlaiParser().parse\_args([], print\_args=\textcolor{keyword}{False})
459 =======
460 <<<<<<< HEAD
461 <<<<<<< HEAD
462     opt = ParlaiParser().parse\_args([], print\_args=\textcolor{keyword}{False})
463 =======
464     opt = ParlaiParser().parse\_args(print\_args=\textcolor{keyword}{False})
465 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
466 >>>>>>> origin/master
467 =======
468     opt = ParlaiParser().parse\_args(print\_args=\textcolor{keyword}{False})
469 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
470 >>>>>>> ef574cebef2a8d5aa38b73176b1e71a919d6670f
471     model\_filenames = [
472         \textcolor{stringliteral}{'seq2seq.tar.gz'},
473         \textcolor{stringliteral}{'transformer\_ranker.tar.gz'},
474         \textcolor{stringliteral}{'transformer\_generator2.tar.gz'},
475         \textcolor{stringliteral}{'memnn.tar.gz'},
476     ]
477     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}():
478         \hyperlink{namespaceparlai_1_1core_1_1build__data_ab697f23f05d3e36d7979fe5e0ed7911e}{download\_models}(opt, model\_filenames, \textcolor{stringliteral}{'unittest'}, version=\textcolor{stringliteral}{'v3.0'})
479 \end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_ab5bd02c7b5ab42c393ddddf73d9c78d2}\label{namespaceparlai_1_1utils_1_1testing_ab5bd02c7b5ab42c393ddddf73d9c78d2}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!eval\+\_\+model@{eval\+\_\+model}}
\index{eval\+\_\+model@{eval\+\_\+model}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{eval\+\_\+model()}{eval\_model()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+eval\+\_\+model (\begin{DoxyParamCaption}\item[{}]{opt,  }\item[{}]{skip\+\_\+valid = {\ttfamily False},  }\item[{}]{skip\+\_\+test = {\ttfamily False},  }\item[{}]{valid\+\_\+datatype = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Run through an evaluation loop.

:param opt:
    Any non-default options you wish to set.
:param bool skip_valid:
    If true skips the valid evaluation, and the second return value will be None.
:param bool skip_test:
    If true skips the test evaluation, and the third return value will be None.
:param str valid_datatype:
    If custom datatype required for valid, e.g. train:evalmode, specify here

:return: (stdout, valid_results, test_results)
:rtype: (str, dict, dict)

If model_file is not in opt, then this helper will create a temporary directory
to store the model files, and clean up afterwards. You can keep the directory
by disabling autocleanup
\end{DoxyVerb}
 

Definition at line 322 of file testing.\+py.


\begin{DoxyCode}
322 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_ab5bd02c7b5ab42c393ddddf73d9c78d2}{eval\_model}(opt, skip\_valid=False, skip\_test=False, valid\_datatype=None):
323     \textcolor{stringliteral}{"""}
324 \textcolor{stringliteral}{    Run through an evaluation loop.}
325 \textcolor{stringliteral}{}
326 \textcolor{stringliteral}{    :param opt:}
327 \textcolor{stringliteral}{        Any non-default options you wish to set.}
328 \textcolor{stringliteral}{    :param bool skip\_valid:}
329 \textcolor{stringliteral}{        If true skips the valid evaluation, and the second return value will be None.}
330 \textcolor{stringliteral}{    :param bool skip\_test:}
331 \textcolor{stringliteral}{        If true skips the test evaluation, and the third return value will be None.}
332 \textcolor{stringliteral}{    :param str valid\_datatype:}
333 \textcolor{stringliteral}{        If custom datatype required for valid, e.g. train:evalmode, specify here}
334 \textcolor{stringliteral}{}
335 \textcolor{stringliteral}{    :return: (stdout, valid\_results, test\_results)}
336 \textcolor{stringliteral}{    :rtype: (str, dict, dict)}
337 \textcolor{stringliteral}{}
338 \textcolor{stringliteral}{    If model\_file is not in opt, then this helper will create a temporary directory}
339 \textcolor{stringliteral}{    to store the model files, and clean up afterwards. You can keep the directory}
340 \textcolor{stringliteral}{    by disabling autocleanup}
341 \textcolor{stringliteral}{    """}
342     \textcolor{keyword}{import} \hyperlink{namespaceparlai_1_1scripts_1_1eval__model}{parlai.scripts.eval\_model} \textcolor{keyword}{as} ems
343 
344     parser = ems.setup\_args()
345     parser.set\_params(**opt)
346     parser.set\_params(log\_every\_n\_secs=10)
347 <<<<<<< HEAD
348     popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
349 =======
350 <<<<<<< HEAD
351 <<<<<<< HEAD
352     popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
353 =======
354     popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
355 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
356 >>>>>>> origin/master
357 =======
358     popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
359 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
360 >>>>>>> ef574cebef2a8d5aa38b73176b1e71a919d6670f
361 
362     \textcolor{keywordflow}{if} popt.get(\textcolor{stringliteral}{'model\_file'}) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} popt.get(\textcolor{stringliteral}{'dict\_file'}):
363         popt[\textcolor{stringliteral}{'dict\_file'}] = popt[\textcolor{stringliteral}{'model\_file'}] + \textcolor{stringliteral}{'.dict'}
364 
365     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} output:
366         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'valid'} \textcolor{keywordflow}{if} valid\_datatype \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} valid\_datatype
367         valid = \textcolor{keywordtype}{None} \textcolor{keywordflow}{if} skip\_valid \textcolor{keywordflow}{else} ems.eval\_model(popt)
368         popt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'test'}
369         test = \textcolor{keywordtype}{None} \textcolor{keywordflow}{if} skip\_test \textcolor{keywordflow}{else} ems.eval\_model(popt)
370 
371     \textcolor{keywordflow}{return} (output.getvalue(), valid, test)
372 
373 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a2e61f8f35b8ccf518e3561a224781ced}\label{namespaceparlai_1_1utils_1_1testing_a2e61f8f35b8ccf518e3561a224781ced}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!git\+\_\+changed\+\_\+files@{git\+\_\+changed\+\_\+files}}
\index{git\+\_\+changed\+\_\+files@{git\+\_\+changed\+\_\+files}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{git\+\_\+changed\+\_\+files()}{git\_changed\_files()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+git\+\_\+changed\+\_\+files (\begin{DoxyParamCaption}\item[{}]{skip\+\_\+nonexisting = {\ttfamily True} }\end{DoxyParamCaption})}

\begin{DoxyVerb}List all the changed files in the git repository.

:param bool skip_nonexisting:
    If true, ignore files that don't exist on disk. This is useful for
    disregarding files created in master, but don't exist in HEAD.
\end{DoxyVerb}
 

Definition at line 156 of file testing.\+py.


\begin{DoxyCode}
156 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a2e61f8f35b8ccf518e3561a224781ced}{git\_changed\_files}(skip\_nonexisting=True):
157     \textcolor{stringliteral}{"""}
158 \textcolor{stringliteral}{    List all the changed files in the git repository.}
159 \textcolor{stringliteral}{}
160 \textcolor{stringliteral}{    :param bool skip\_nonexisting:}
161 \textcolor{stringliteral}{        If true, ignore files that don't exist on disk. This is useful for}
162 \textcolor{stringliteral}{        disregarding files created in master, but don't exist in HEAD.}
163 \textcolor{stringliteral}{    """}
164     fork\_point = git\_.merge\_base(\textcolor{stringliteral}{'origin/master'}, \textcolor{stringliteral}{'HEAD'}).strip()
165     filenames = git\_.diff(\textcolor{stringliteral}{'--name-only'}, fork\_point).split(\textcolor{stringliteral}{'\(\backslash\)n'})
166     \textcolor{keywordflow}{if} skip\_nonexisting:
167         filenames = [fn \textcolor{keywordflow}{for} fn \textcolor{keywordflow}{in} filenames \textcolor{keywordflow}{if} os.path.exists(fn)]
168     \textcolor{keywordflow}{return} filenames
169 
170 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_aa9971204bea89f174596698b2e736214}\label{namespaceparlai_1_1utils_1_1testing_aa9971204bea89f174596698b2e736214}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!git\+\_\+commit\+\_\+messages@{git\+\_\+commit\+\_\+messages}}
\index{git\+\_\+commit\+\_\+messages@{git\+\_\+commit\+\_\+messages}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{git\+\_\+commit\+\_\+messages()}{git\_commit\_messages()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+git\+\_\+commit\+\_\+messages (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Output each commit message between here and master.
\end{DoxyVerb}
 

Definition at line 171 of file testing.\+py.


\begin{DoxyCode}
171 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_aa9971204bea89f174596698b2e736214}{git\_commit\_messages}():
172     \textcolor{stringliteral}{"""}
173 \textcolor{stringliteral}{    Output each commit message between here and master.}
174 \textcolor{stringliteral}{    """}
175     fork\_point = git\_.merge\_base(\textcolor{stringliteral}{'origin/master'}, \textcolor{stringliteral}{'HEAD'}).strip()
176     messages = git\_.log(fork\_point + \textcolor{stringliteral}{'..HEAD'})
177     \textcolor{keywordflow}{return} messages
178 
179 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a767a8ac6ea27697e6f782d7375d94933}\label{namespaceparlai_1_1utils_1_1testing_a767a8ac6ea27697e6f782d7375d94933}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!git\+\_\+ls\+\_\+dirs@{git\+\_\+ls\+\_\+dirs}}
\index{git\+\_\+ls\+\_\+dirs@{git\+\_\+ls\+\_\+dirs}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{git\+\_\+ls\+\_\+dirs()}{git\_ls\_dirs()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+git\+\_\+ls\+\_\+dirs (\begin{DoxyParamCaption}\item[{}]{root = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}List all folders tracked by git.
\end{DoxyVerb}
 

Definition at line 146 of file testing.\+py.


\begin{DoxyCode}
146 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a767a8ac6ea27697e6f782d7375d94933}{git\_ls\_dirs}(root=None):
147     \textcolor{stringliteral}{"""}
148 \textcolor{stringliteral}{    List all folders tracked by git.}
149 \textcolor{stringliteral}{    """}
150     dirs = set()
151     \textcolor{keywordflow}{for} fn \textcolor{keywordflow}{in} \hyperlink{namespaceparlai_1_1utils_1_1testing_a50b91b6f209eeedd93ae7ec0e790b121}{git\_ls\_files}(root):
152         dirs.add(os.path.dirname(fn))
153     \textcolor{keywordflow}{return} list(dirs)
154 
155 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a50b91b6f209eeedd93ae7ec0e790b121}\label{namespaceparlai_1_1utils_1_1testing_a50b91b6f209eeedd93ae7ec0e790b121}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!git\+\_\+ls\+\_\+files@{git\+\_\+ls\+\_\+files}}
\index{git\+\_\+ls\+\_\+files@{git\+\_\+ls\+\_\+files}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{git\+\_\+ls\+\_\+files()}{git\_ls\_files()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+git\+\_\+ls\+\_\+files (\begin{DoxyParamCaption}\item[{}]{root = {\ttfamily None},  }\item[{}]{skip\+\_\+nonexisting = {\ttfamily True} }\end{DoxyParamCaption})}

\begin{DoxyVerb}List all files tracked by git.
\end{DoxyVerb}
 

Definition at line 136 of file testing.\+py.


\begin{DoxyCode}
136 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a50b91b6f209eeedd93ae7ec0e790b121}{git\_ls\_files}(root=None, skip\_nonexisting=True):
137     \textcolor{stringliteral}{"""}
138 \textcolor{stringliteral}{    List all files tracked by git.}
139 \textcolor{stringliteral}{    """}
140     filenames = git\_.ls\_files(root).split(\textcolor{stringliteral}{'\(\backslash\)n'})
141     \textcolor{keywordflow}{if} skip\_nonexisting:
142         filenames = [fn \textcolor{keywordflow}{for} fn \textcolor{keywordflow}{in} filenames \textcolor{keywordflow}{if} os.path.exists(fn)]
143     \textcolor{keywordflow}{return} filenames
144 
145 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a18092382f94848a52ef19248aa39f7ca}\label{namespaceparlai_1_1utils_1_1testing_a18092382f94848a52ef19248aa39f7ca}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!is\+\_\+new\+\_\+task\+\_\+filename@{is\+\_\+new\+\_\+task\+\_\+filename}}
\index{is\+\_\+new\+\_\+task\+\_\+filename@{is\+\_\+new\+\_\+task\+\_\+filename}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{is\+\_\+new\+\_\+task\+\_\+filename()}{is\_new\_task\_filename()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+is\+\_\+new\+\_\+task\+\_\+filename (\begin{DoxyParamCaption}\item[{}]{filename }\end{DoxyParamCaption})}

\begin{DoxyVerb}Check if a given filename counts as a new task.

Used in tests and test triggers, and only here to avoid redundancy.
\end{DoxyVerb}
 

Definition at line 180 of file testing.\+py.


\begin{DoxyCode}
180 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a18092382f94848a52ef19248aa39f7ca}{is\_new\_task\_filename}(filename):
181     \textcolor{stringliteral}{"""}
182 \textcolor{stringliteral}{    Check if a given filename counts as a new task.}
183 \textcolor{stringliteral}{}
184 \textcolor{stringliteral}{    Used in tests and test triggers, and only here to avoid redundancy.}
185 \textcolor{stringliteral}{    """}
186     \textcolor{keywordflow}{return} (
187         \textcolor{stringliteral}{'parlai/tasks'} \textcolor{keywordflow}{in} filename
188         \textcolor{keywordflow}{and} \textcolor{stringliteral}{'README'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} filename
189         \textcolor{keywordflow}{and} \textcolor{stringliteral}{'task\_list.py'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} filename
190     )
191 
192 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a2b1aba8cb2afc498691840f4b8999420}\label{namespaceparlai_1_1utils_1_1testing_a2b1aba8cb2afc498691840f4b8999420}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!is\+\_\+this\+\_\+circleci@{is\+\_\+this\+\_\+circleci}}
\index{is\+\_\+this\+\_\+circleci@{is\+\_\+this\+\_\+circleci}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{is\+\_\+this\+\_\+circleci()}{is\_this\_circleci()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+is\+\_\+this\+\_\+circleci (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return if we are currently running in CircleCI.
\end{DoxyVerb}
 

Definition at line 51 of file testing.\+py.


\begin{DoxyCode}
51 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a2b1aba8cb2afc498691840f4b8999420}{is\_this\_circleci}():
52     \textcolor{stringliteral}{"""}
53 \textcolor{stringliteral}{    Return if we are currently running in CircleCI.}
54 \textcolor{stringliteral}{    """}
55     \textcolor{keywordflow}{return} \hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a6fc0c9b519a36f82b65bcd398f1fbb9d}{bool}(os.environ.get(\textcolor{stringliteral}{'CIRCLECI'}))
56 
57 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a056ab7a9ad687500924a29001a7d9264}\label{namespaceparlai_1_1utils_1_1testing_a056ab7a9ad687500924a29001a7d9264}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!skip\+If\+Circle\+CI@{skip\+If\+Circle\+CI}}
\index{skip\+If\+Circle\+CI@{skip\+If\+Circle\+CI}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{skip\+If\+Circle\+C\+I()}{skipIfCircleCI()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+skip\+If\+Circle\+CI (\begin{DoxyParamCaption}\item[{}]{testfn,  }\item[{}]{reason = {\ttfamily \textquotesingle{}Test~disabled~in~CircleCI\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Decorate a test to skip if running on CircleCI.
\end{DoxyVerb}
 

Definition at line 88 of file testing.\+py.


\begin{DoxyCode}
88 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a056ab7a9ad687500924a29001a7d9264}{skipIfCircleCI}(testfn, reason='Test disabled in CircleCI'):
89     \textcolor{stringliteral}{"""}
90 \textcolor{stringliteral}{    Decorate a test to skip if running on CircleCI.}
91 \textcolor{stringliteral}{    """}
92     \textcolor{keywordflow}{return} unittest.skipIf(\hyperlink{namespaceparlai_1_1utils_1_1testing_a2b1aba8cb2afc498691840f4b8999420}{is\_this\_circleci}(), reason)(testfn)
93 
94 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a2d3bb5013e210bf866032aedc812859b}\label{namespaceparlai_1_1utils_1_1testing_a2d3bb5013e210bf866032aedc812859b}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!skip\+If\+G\+PU@{skip\+If\+G\+PU}}
\index{skip\+If\+G\+PU@{skip\+If\+G\+PU}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{skip\+If\+G\+P\+U()}{skipIfGPU()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+skip\+If\+G\+PU (\begin{DoxyParamCaption}\item[{}]{testfn,  }\item[{}]{reason = {\ttfamily \textquotesingle{}Test~is~CPU-\/only\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Decorate a test to skip if a GPU is available.

Useful for disabling hogwild tests.
\end{DoxyVerb}
 

Definition at line 65 of file testing.\+py.


\begin{DoxyCode}
65 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a2d3bb5013e210bf866032aedc812859b}{skipIfGPU}(testfn, reason='Test is CPU-only'):
66     \textcolor{stringliteral}{"""}
67 \textcolor{stringliteral}{    Decorate a test to skip if a GPU is available.}
68 \textcolor{stringliteral}{}
69 \textcolor{stringliteral}{    Useful for disabling hogwild tests.}
70 \textcolor{stringliteral}{    """}
71     \textcolor{keywordflow}{return} unittest.skipIf(GPU\_AVAILABLE, reason)(testfn)
72 
73 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_ab04af7a525a569f29b936b54b32899b7}\label{namespaceparlai_1_1utils_1_1testing_ab04af7a525a569f29b936b54b32899b7}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!skip\+Unless\+B\+PE@{skip\+Unless\+B\+PE}}
\index{skip\+Unless\+B\+PE@{skip\+Unless\+B\+PE}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{skip\+Unless\+B\+P\+E()}{skipUnlessBPE()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+skip\+Unless\+B\+PE (\begin{DoxyParamCaption}\item[{}]{testfn,  }\item[{}]{reason = {\ttfamily \textquotesingle{}Test~requires~a~GPU\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Decorate a test to skip if BPE is not installed.
\end{DoxyVerb}
 

Definition at line 81 of file testing.\+py.


\begin{DoxyCode}
81 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_ab04af7a525a569f29b936b54b32899b7}{skipUnlessBPE}(testfn, reason='Test requires a GPU'):
82     \textcolor{stringliteral}{"""}
83 \textcolor{stringliteral}{    Decorate a test to skip if BPE is not installed.}
84 \textcolor{stringliteral}{    """}
85     \textcolor{keywordflow}{return} unittest.skipUnless(BPE\_INSTALLED, reason)(testfn)
86 
87 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a2773d8b6d4631fa1f639dde415eb3e2b}\label{namespaceparlai_1_1utils_1_1testing_a2773d8b6d4631fa1f639dde415eb3e2b}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!skip\+Unless\+G\+PU@{skip\+Unless\+G\+PU}}
\index{skip\+Unless\+G\+PU@{skip\+Unless\+G\+PU}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{skip\+Unless\+G\+P\+U()}{skipUnlessGPU()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+skip\+Unless\+G\+PU (\begin{DoxyParamCaption}\item[{}]{testfn,  }\item[{}]{reason = {\ttfamily \textquotesingle{}Test~requires~a~GPU\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Decorate a test to skip if no GPU is available.
\end{DoxyVerb}
 

Definition at line 74 of file testing.\+py.


\begin{DoxyCode}
74 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a2773d8b6d4631fa1f639dde415eb3e2b}{skipUnlessGPU}(testfn, reason='Test requires a GPU'):
75     \textcolor{stringliteral}{"""}
76 \textcolor{stringliteral}{    Decorate a test to skip if no GPU is available.}
77 \textcolor{stringliteral}{    """}
78     \textcolor{keywordflow}{return} unittest.skipUnless(GPU\_AVAILABLE, reason)(testfn)
79 
80 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a7b182622aebc6cdc41ee3b99ebe47432}\label{namespaceparlai_1_1utils_1_1testing_a7b182622aebc6cdc41ee3b99ebe47432}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!skip\+Unless\+Torch@{skip\+Unless\+Torch}}
\index{skip\+Unless\+Torch@{skip\+Unless\+Torch}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{skip\+Unless\+Torch()}{skipUnlessTorch()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+skip\+Unless\+Torch (\begin{DoxyParamCaption}\item[{}]{testfn,  }\item[{}]{reason = {\ttfamily \textquotesingle{}pytorch~is~not~installed\textquotesingle{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Decorate a test to skip if torch is not installed.
\end{DoxyVerb}
 

Definition at line 58 of file testing.\+py.


\begin{DoxyCode}
58 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a7b182622aebc6cdc41ee3b99ebe47432}{skipUnlessTorch}(testfn, reason='pytorch is not installed'):
59     \textcolor{stringliteral}{"""}
60 \textcolor{stringliteral}{    Decorate a test to skip if torch is not installed.}
61 \textcolor{stringliteral}{    """}
62     \textcolor{keywordflow}{return} unittest.skipUnless(TORCH\_AVAILABLE, reason)(testfn)
63 
64 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a0945b769a10c0c844b29c02ff26445a5}\label{namespaceparlai_1_1utils_1_1testing_a0945b769a10c0c844b29c02ff26445a5}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!tempdir@{tempdir}}
\index{tempdir@{tempdir}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{tempdir()}{tempdir()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+tempdir (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create a temporary directory.

Use as a context manager so the directory is automatically cleaned up.

>>> with tempdir() as tmpdir:
...    print(tmpdir)  # prints a folder like /tmp/randomname
\end{DoxyVerb}
 

Definition at line 234 of file testing.\+py.


\begin{DoxyCode}
234 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a0945b769a10c0c844b29c02ff26445a5}{tempdir}():
235     \textcolor{stringliteral}{"""}
236 \textcolor{stringliteral}{    Create a temporary directory.}
237 \textcolor{stringliteral}{}
238 \textcolor{stringliteral}{    Use as a context manager so the directory is automatically cleaned up.}
239 \textcolor{stringliteral}{}
240 \textcolor{stringliteral}{    >>> with tempdir() as tmpdir:}
241 \textcolor{stringliteral}{    ...    print(tmpdir)  # prints a folder like /tmp/randomname}
242 \textcolor{stringliteral}{    """}
243     d = tempfile.mkdtemp()
244     \textcolor{keywordflow}{yield} d
245     shutil.rmtree(d)
246 
247 
248 @contextlib.contextmanager
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_aa8539ab1d17813b0c17f08700b2c2c2e}\label{namespaceparlai_1_1utils_1_1testing_aa8539ab1d17813b0c17f08700b2c2c2e}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!timeout@{timeout}}
\index{timeout@{timeout}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{timeout()}{timeout()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+timeout (\begin{DoxyParamCaption}\item[{}]{time }\end{DoxyParamCaption})}



Definition at line 249 of file testing.\+py.


\begin{DoxyCode}
249 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_aa8539ab1d17813b0c17f08700b2c2c2e}{timeout}(time: int = 30):
250     \textcolor{stringliteral}{"""}
251 \textcolor{stringliteral}{    Raise a timeout if a function does not return in time `time`.}
252 \textcolor{stringliteral}{}
253 \textcolor{stringliteral}{    Use as a context manager, so that the signal class can reset it's alarm for}
254 \textcolor{stringliteral}{    `SIGALARM`}
255 \textcolor{stringliteral}{}
256 \textcolor{stringliteral}{    :param int time:}
257 \textcolor{stringliteral}{        Time in seconds to wait for timeout. Default is 30 seconds.}
258 \textcolor{stringliteral}{    """}
259     \textcolor{keyword}{assert} time >= 0, \textcolor{stringliteral}{'Time specified in timeout must be nonnegative.'}
260 
261     \textcolor{keyword}{def }\_handler(signum, frame):
262         \textcolor{keywordflow}{raise} TimeoutError
263 
264     signal.signal(signal.SIGALRM, \_handler)
265     signal.alarm(time)
266 
267     \textcolor{keywordflow}{try}:
268         \textcolor{keywordflow}{yield}
269     \textcolor{keywordflow}{except} TimeoutError \textcolor{keyword}{as} e:
270         \textcolor{keywordflow}{raise} e
271     \textcolor{keywordflow}{finally}:
272         signal.signal(signal.SIGALRM, signal.SIG\_IGN)
273 
274 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a005734981469efed8a992bf5edc3ca8a}\label{namespaceparlai_1_1utils_1_1testing_a005734981469efed8a992bf5edc3ca8a}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!train\+\_\+model@{train\+\_\+model}}
\index{train\+\_\+model@{train\+\_\+model}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{train\+\_\+model()}{train\_model()}}
{\footnotesize\ttfamily def parlai.\+utils.\+testing.\+train\+\_\+model (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Run through a TrainLoop.

If model_file is not in opt, then this helper will create a temporary
directory to store the model, dict, etc.

:return: (stdout, valid_results, test_results)
:rtype: (str, dict, dict)
\end{DoxyVerb}
 

Definition at line 275 of file testing.\+py.


\begin{DoxyCode}
275 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1utils_1_1testing_a005734981469efed8a992bf5edc3ca8a}{train\_model}(opt):
276     \textcolor{stringliteral}{"""}
277 \textcolor{stringliteral}{    Run through a TrainLoop.}
278 \textcolor{stringliteral}{}
279 \textcolor{stringliteral}{    If model\_file is not in opt, then this helper will create a temporary}
280 \textcolor{stringliteral}{    directory to store the model, dict, etc.}
281 \textcolor{stringliteral}{}
282 \textcolor{stringliteral}{    :return: (stdout, valid\_results, test\_results)}
283 \textcolor{stringliteral}{    :rtype: (str, dict, dict)}
284 \textcolor{stringliteral}{    """}
285     \textcolor{keyword}{import} \hyperlink{namespaceparlai_1_1scripts_1_1train__model}{parlai.scripts.train\_model} \textcolor{keyword}{as} tms
286 
287     with \hyperlink{namespaceparlai_1_1utils_1_1testing_ab00d4d693202afab92c06387aa50699b}{capture\_output}() \textcolor{keyword}{as} output:
288         with \hyperlink{namespaceparlai_1_1utils_1_1testing_a0945b769a10c0c844b29c02ff26445a5}{tempdir}() \textcolor{keyword}{as} tmpdir:
289             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'model\_file'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} opt:
290                 opt[\textcolor{stringliteral}{'model\_file'}] = os.path.join(tmpdir, \textcolor{stringliteral}{'model'})
291             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'dict\_file'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} opt:
292                 opt[\textcolor{stringliteral}{'dict\_file'}] = os.path.join(tmpdir, \textcolor{stringliteral}{'model.dict'})
293             parser = tms.setup\_args()
294             \textcolor{comment}{# needed at the very least to set the overrides.}
295             parser.set\_params(**opt)
296             parser.set\_params(log\_every\_n\_secs=10)
297 <<<<<<< HEAD
298             popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
299 =======
300 <<<<<<< HEAD
301 <<<<<<< HEAD
302             popt = parser.parse\_args([], print\_args=\textcolor{keyword}{False})
303 =======
304             popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
305 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
306 >>>>>>> origin/master
307 =======
308             popt = parser.parse\_args(print\_args=\textcolor{keyword}{False})
309 >>>>>>> 4f6b99642d60aff1a41b9eae8bd2ccd9e40ebba4
310 >>>>>>> ef574cebef2a8d5aa38b73176b1e71a919d6670f
311             \textcolor{comment}{# in some rare cases, like for instance if the model class also}
312             \textcolor{comment}{# overrides its default params, the params override will not}
313             \textcolor{comment}{# be taken into account.}
314             \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} opt.items():
315                 popt[k] = v
316             tl = tms.TrainLoop(popt)
317             valid, test = tl.train()
318 
319     \textcolor{keywordflow}{return} (output.getvalue(), valid, test)
320 
321 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a3fb33ee5ae900d21c17886956cbe607a}\label{namespaceparlai_1_1utils_1_1testing_a3fb33ee5ae900d21c17886956cbe607a}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED@{B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED}}
\index{B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED@{B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED}{BPE\_INSTALLED}}
{\footnotesize\ttfamily parlai.\+utils.\+testing.\+B\+P\+E\+\_\+\+I\+N\+S\+T\+A\+L\+L\+ED}



Definition at line 43 of file testing.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_aefdde322d186e6a1136a5ca864048280}\label{namespaceparlai_1_1utils_1_1testing_aefdde322d186e6a1136a5ca864048280}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!D\+E\+B\+UG@{D\+E\+B\+UG}}
\index{D\+E\+B\+UG@{D\+E\+B\+UG}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{D\+E\+B\+UG}{DEBUG}}
{\footnotesize\ttfamily parlai.\+utils.\+testing.\+D\+E\+B\+UG}



Definition at line 48 of file testing.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_aee12f734544cd8a3dcb1c823aa51b2f0}\label{namespaceparlai_1_1utils_1_1testing_aee12f734544cd8a3dcb1c823aa51b2f0}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!git\+\_\+@{git\+\_\+}}
\index{git\+\_\+@{git\+\_\+}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{git\+\_\+}{git\_}}
{\footnotesize\ttfamily parlai.\+utils.\+testing.\+git\+\_\+}



Definition at line 34 of file testing.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a86172d8df39b9bd5f1df6d5d40cbcb84}\label{namespaceparlai_1_1utils_1_1testing_a86172d8df39b9bd5f1df6d5d40cbcb84}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE@{G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}}
\index{G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE@{G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}{GIT\_AVAILABLE}}
{\footnotesize\ttfamily parlai.\+utils.\+testing.\+G\+I\+T\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}



Definition at line 35 of file testing.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a684675b731fae330593a7817c8649f27}\label{namespaceparlai_1_1utils_1_1testing_a684675b731fae330593a7817c8649f27}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE@{G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}}
\index{G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE@{G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}{GPU\_AVAILABLE}}
{\footnotesize\ttfamily parlai.\+utils.\+testing.\+G\+P\+U\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}



Definition at line 26 of file testing.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1utils_1_1testing_a490429a10abf78b127acf5c8d05fe6a3}\label{namespaceparlai_1_1utils_1_1testing_a490429a10abf78b127acf5c8d05fe6a3}} 
\index{parlai\+::utils\+::testing@{parlai\+::utils\+::testing}!T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE@{T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}}
\index{T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE@{T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}!parlai\+::utils\+::testing@{parlai\+::utils\+::testing}}
\subsubsection{\texorpdfstring{T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}{TORCH\_AVAILABLE}}
{\footnotesize\ttfamily parlai.\+utils.\+testing.\+T\+O\+R\+C\+H\+\_\+\+A\+V\+A\+I\+L\+A\+B\+LE}



Definition at line 25 of file testing.\+py.

