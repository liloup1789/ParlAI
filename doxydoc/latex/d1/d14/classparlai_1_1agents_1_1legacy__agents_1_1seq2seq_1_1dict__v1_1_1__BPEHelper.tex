\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper}\index{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper@{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{d6/d97/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=190pt]{dd/d2a/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a95e6fa33247082a01355d39ee96fed39}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, codecs\+\_\+filename)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a4123dd721a13dc6607498ae29d7dd8a3}{tokenize} (self, text)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a90568a5897058075adae4b066693c0cc}{finalize} (self, frequencies, num\+\_\+symbols=30000, minfreq=2)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a354bb157f80cf8d87a1d0f87387f4cde}{splitter}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a610fc5289a22d9bfe229cd090f647d43}{codecs}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_ac6a1f3216616fc9ac78a4b5501693848}{bpe}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Helper class for performing BPE subword tokenization.

For technical details, please refer to https://arxiv.org/abs/1508.07909.
This class just wraps around the official subword-nmt repository.

This API expects the user to call tokenize() onto the training data,
then call finalize() to learn the encodings, and then iterate over the data
in a second pass, calling tokenize() again to get processed output.
\end{DoxyVerb}
 

Definition at line 712 of file dict\+\_\+v1.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a95e6fa33247082a01355d39ee96fed39}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a95e6fa33247082a01355d39ee96fed39}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{codecs\+\_\+filename }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize the BPE module.

If `codecs_filename` already exists, loads the pretrained codecs.
If it does not, codecs will be saved there after a call to `finalize()`.

:param codecs_filename: place to save/load codecs.
\end{DoxyVerb}
 

Definition at line 724 of file dict\+\_\+v1.\+py.


\begin{DoxyCode}
724     \textcolor{keyword}{def }\_\_init\_\_(self, codecs\_filename):
725         \textcolor{stringliteral}{"""}
726 \textcolor{stringliteral}{        Initialize the BPE module.}
727 \textcolor{stringliteral}{}
728 \textcolor{stringliteral}{        If `codecs\_filename` already exists, loads the pretrained codecs.}
729 \textcolor{stringliteral}{        If it does not, codecs will be saved there after a call to `finalize()`.}
730 \textcolor{stringliteral}{}
731 \textcolor{stringliteral}{        :param codecs\_filename: place to save/load codecs.}
732 \textcolor{stringliteral}{        """}
733         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} BPE\_INSTALLED:
734             \textcolor{keywordflow}{raise} RuntimeError(
735                 \textcolor{stringliteral}{"Please run \(\backslash\)"pip install 'git+https://github.com/rsennrich"}
736                 \textcolor{stringliteral}{"/subword-nmt.git#egg=subword-nmt'\(\backslash\)""}
737             )
738 
739         self.splitter = re.compile(\textcolor{stringliteral}{r'\(\backslash\)w+|[^\(\backslash\)w\(\backslash\)s]'}, re.UNICODE)
740 
741         self.codecs = codecs\_filename
742         \textcolor{keywordflow}{if} os.path.exists(self.codecs):
743             self.\_load\_from\_codecs()
744 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a90568a5897058075adae4b066693c0cc}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a90568a5897058075adae4b066693c0cc}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}!finalize@{finalize}}
\index{finalize@{finalize}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}}
\subsubsection{\texorpdfstring{finalize()}{finalize()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper.\+finalize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{frequencies,  }\item[{}]{num\+\_\+symbols = {\ttfamily 30000},  }\item[{}]{minfreq = {\ttfamily 2} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Build the codecs.

:param: dictionary of (token: frequency) pairs
:param num_symbols: Number of BPE symbols. Recommend 30000-40000.
    If <= 0, default 30000 will be used.
:param minfreq: Minimum frequency of a token before forced BPE
    decomposition. If <= 0 will use subword-nmt default of 2.
\end{DoxyVerb}
 

Definition at line 766 of file dict\+\_\+v1.\+py.


\begin{DoxyCode}
766     \textcolor{keyword}{def }finalize(self, frequencies, num\_symbols=30000, minfreq=2):
767         \textcolor{stringliteral}{"""}
768 \textcolor{stringliteral}{        Build the codecs.}
769 \textcolor{stringliteral}{}
770 \textcolor{stringliteral}{        :param: dictionary of (token: frequency) pairs}
771 \textcolor{stringliteral}{        :param num\_symbols: Number of BPE symbols. Recommend 30000-40000.}
772 \textcolor{stringliteral}{            If <= 0, default 30000 will be used.}
773 \textcolor{stringliteral}{        :param minfreq: Minimum frequency of a token before forced BPE}
774 \textcolor{stringliteral}{            decomposition. If <= 0 will use subword-nmt default of 2.}
775 \textcolor{stringliteral}{        """}
776         \textcolor{keywordflow}{if} hasattr(self, \textcolor{stringliteral}{'bpe'}):
777             \textcolor{comment}{# we already finalized the codecs}
778             \textcolor{keywordflow}{return} \textcolor{keyword}{False}
779 
780         print(\textcolor{stringliteral}{'Dictionary: saving bpe codecs to \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(self.codecs))
781 
782         dictionary = (\textcolor{stringliteral}{"\{\} \{\}"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(k, v) \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} frequencies.items())
783 
784         \textcolor{keywordflow}{if} num\_symbols <= 0:
785             num\_symbols = 30000
786         \textcolor{keywordflow}{if} minfreq <= 0:
787             minfreq = 2
788         with open(self.codecs, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} outstream:
789             learn\_bpe.learn\_bpe(
790                 dictionary,
791                 outstream,
792                 num\_symbols=num\_symbols,
793                 min\_frequency=minfreq,
794                 is\_dict=\textcolor{keyword}{True},
795             )
796 
797         self.\_load\_from\_codecs()
798         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
799 \end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a4123dd721a13dc6607498ae29d7dd8a3}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a4123dd721a13dc6607498ae29d7dd8a3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}!tokenize@{tokenize}}
\index{tokenize@{tokenize}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}}
\subsubsection{\texorpdfstring{tokenize()}{tokenize()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper.\+tokenize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Tokenize the text with bpe if codecs are already finalized.

Otherwise, returns the regularly split tokens that will train the bpe.

:param text: str. Raw text to tokenize.
:return: a list of tokens. Will use BPE once finalized.
\end{DoxyVerb}
 

Definition at line 749 of file dict\+\_\+v1.\+py.


\begin{DoxyCode}
749     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_a1fdb457e98eb4e4c26047e229686a616}{tokenize}(self, text):
750         \textcolor{stringliteral}{"""}
751 \textcolor{stringliteral}{        Tokenize the text with bpe if codecs are already finalized.}
752 \textcolor{stringliteral}{}
753 \textcolor{stringliteral}{        Otherwise, returns the regularly split tokens that will train the bpe.}
754 \textcolor{stringliteral}{}
755 \textcolor{stringliteral}{        :param text: str. Raw text to tokenize.}
756 \textcolor{stringliteral}{        :return: a list of tokens. Will use BPE once finalized.}
757 \textcolor{stringliteral}{        """}
758         text = text.replace(\textcolor{stringliteral}{'\(\backslash\)n'}, \textcolor{stringliteral}{' \_\_newln\_\_ '})
759         tokens = self.splitter.findall(text)
760 
761         \textcolor{keywordflow}{if} hasattr(self, \textcolor{stringliteral}{'bpe'}):
762             \textcolor{keywordflow}{return} self.bpe.segment\_tokens(tokens)
763         \textcolor{keywordflow}{else}:
764             \textcolor{keywordflow}{return} tokens
765 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_ac6a1f3216616fc9ac78a4b5501693848}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_ac6a1f3216616fc9ac78a4b5501693848}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}!bpe@{bpe}}
\index{bpe@{bpe}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}}
\subsubsection{\texorpdfstring{bpe}{bpe}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper.\+bpe}



Definition at line 747 of file dict\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a610fc5289a22d9bfe229cd090f647d43}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a610fc5289a22d9bfe229cd090f647d43}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}!codecs@{codecs}}
\index{codecs@{codecs}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}}
\subsubsection{\texorpdfstring{codecs}{codecs}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper.\+codecs}



Definition at line 741 of file dict\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a354bb157f80cf8d87a1d0f87387f4cde}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v1_1_1__BPEHelper_a354bb157f80cf8d87a1d0f87387f4cde}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}!splitter@{splitter}}
\index{splitter@{splitter}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::dict\+\_\+v1\+::\+\_\+\+B\+P\+E\+Helper}}
\subsubsection{\texorpdfstring{splitter}{splitter}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+dict\+\_\+v1.\+\_\+\+B\+P\+E\+Helper.\+splitter}



Definition at line 739 of file dict\+\_\+v1.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/seq2seq/\hyperlink{dict__v1_8py}{dict\+\_\+v1.\+py}\end{DoxyCompactItemize}
