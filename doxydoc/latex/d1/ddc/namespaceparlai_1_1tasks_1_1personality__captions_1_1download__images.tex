\hypertarget{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images}{}\section{parlai.\+tasks.\+personality\+\_\+captions.\+download\+\_\+images Namespace Reference}
\label{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images}\index{parlai.\+tasks.\+personality\+\_\+captions.\+download\+\_\+images@{parlai.\+tasks.\+personality\+\_\+captions.\+download\+\_\+images}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_a9d812a095ca6d48541b3d5cdc65a4bf3}{download\+\_\+images} (opt, task=\textquotesingle{}personality\+\_\+captions\textquotesingle{})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_ad569e6f3e90709b66c27bc16b83e9275}{parser}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_a9d812a095ca6d48541b3d5cdc65a4bf3}\label{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_a9d812a095ca6d48541b3d5cdc65a4bf3}} 
\index{parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images@{parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images}!download\+\_\+images@{download\+\_\+images}}
\index{download\+\_\+images@{download\+\_\+images}!parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images@{parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images}}
\subsubsection{\texorpdfstring{download\+\_\+images()}{download\_images()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+personality\+\_\+captions.\+download\+\_\+images.\+download\+\_\+images (\begin{DoxyParamCaption}\item[{}]{opt,  }\item[{}]{task = {\ttfamily \textquotesingle{}personality\+\_\+captions\textquotesingle{}} }\end{DoxyParamCaption})}



Definition at line 14 of file download\+\_\+images.\+py.


\begin{DoxyCode}
14 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_a9d812a095ca6d48541b3d5cdc65a4bf3}{download\_images}(opt, task='personality\_captions'):
15     dpath = os.path.join(opt[\textcolor{stringliteral}{'datapath'}], task)
16     image\_path = os.path.join(opt[\textcolor{stringliteral}{'datapath'}], \textcolor{stringliteral}{'yfcc\_images'})
17     version = \textcolor{stringliteral}{'1.0'}
18     response = input(
19         \textcolor{stringliteral}{'Please confirm that you have obtained permission '}
20         \textcolor{stringliteral}{'to work with the YFCC100m dataset, as outlined by the steps '}
21         \textcolor{stringliteral}{'listed at '}
22         \textcolor{stringliteral}{'https://multimediacommons.wordpress.com/yfcc100m-core-dataset/ [Y/y]: '}
23     )
24     \textcolor{keywordflow}{if} response.lower() != \textcolor{stringliteral}{'y'}:
25         \textcolor{keywordflow}{raise} RuntimeError(
26             \textcolor{stringliteral}{'In order to use the images from this dataset, '}
27             \textcolor{stringliteral}{'you must obtain permission from the webpage above.'}
28         )
29     response = input(
30         \textcolor{stringliteral}{'NOTE: This script will download each image individually from the '}
31         \textcolor{stringliteral}{'s3 server on which the images are hosted. This will take a *very '}
32         \textcolor{stringliteral}{'long* time. Are you sure you would like to continue? [Y/y]: '}
33     )
34     \textcolor{keywordflow}{if} response.lower() != \textcolor{stringliteral}{'y'}:
35         \textcolor{keywordflow}{raise} RuntimeError(
36             \textcolor{stringliteral}{'If you have access to the images, please specify '}
37             \textcolor{stringliteral}{'the path to the folder via the `--yfcc-path` '}
38             \textcolor{stringliteral}{'command line argument.'}
39         )
40     image\_prefix = \textcolor{stringliteral}{'https://multimedia-commons.s3-us-west-2.amazonaws.com/data/images'}
41     hashes = []
42     dts = [\textcolor{stringliteral}{'train'}, \textcolor{stringliteral}{'val'}, \textcolor{stringliteral}{'test'}]
43     \textcolor{keywordflow}{if} task == \textcolor{stringliteral}{'image\_chat'}:
44         dts[1] = \textcolor{stringliteral}{'valid'}
45     \textcolor{keywordflow}{for} dt \textcolor{keywordflow}{in} dts:
46         with open(os.path.join(dpath, \textcolor{stringliteral}{'\{\}.json'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(dt))) \textcolor{keyword}{as} f:
47             data = json.load(f)
48             hashes += [d[\textcolor{stringliteral}{'image\_hash'}] \textcolor{keywordflow}{for} d \textcolor{keywordflow}{in} data]
49     os.makedirs(image\_path, exist\_ok=\textcolor{keyword}{True})
50 
51     print(\textcolor{stringliteral}{'[downloading images to \{\}]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(image\_path))
52     \textcolor{keywordflow}{for} \_, (p\_hash) \textcolor{keywordflow}{in} enumerate(tqdm.tqdm(hashes, unit=\textcolor{stringliteral}{'img'})):
53         image\_url = \textcolor{stringliteral}{'\{\}/\{\}/\{\}/\{\}.jpg'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
54             image\_prefix, p\_hash[:3], p\_hash[3:6], p\_hash
55         )
56         \hyperlink{namespaceparlai_1_1core_1_1build__data_ab74f0e428f05e5d91fa93c8afb367622}{download}(image\_url, image\_path, \textcolor{stringliteral}{'\{\}.jpg'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(p\_hash))
57     build\_data.mark\_done(image\_path, version)
58 
59 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_ad569e6f3e90709b66c27bc16b83e9275}\label{namespaceparlai_1_1tasks_1_1personality__captions_1_1download__images_ad569e6f3e90709b66c27bc16b83e9275}} 
\index{parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images@{parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images}!parser@{parser}}
\index{parser@{parser}!parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images@{parlai\+::tasks\+::personality\+\_\+captions\+::download\+\_\+images}}
\subsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily parlai.\+tasks.\+personality\+\_\+captions.\+download\+\_\+images.\+parser}



Definition at line 61 of file download\+\_\+images.\+py.

