\hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions}{}\section{parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions Class Reference}
\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions}\index{parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions}}


Inheritance diagram for parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{d5/d60/classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=257pt]{d9/d8c/classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_af930e15dfec4de7c1b07b286ad2a4e07}{set\+Up} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a183e557fc6a0cc8e9942df9d9fb02445}{tear\+Down} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a178934378f2db3695c5999caccabd675}{test\+\_\+move\+\_\+to\+\_\+waiting} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a7ceaedc34a74f15a15c1f655038af139}{test\+\_\+socket\+\_\+setup} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a16cf4a9ae131a9c6bae2bcc07d804553}{test\+\_\+worker\+\_\+alive} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ab55e425b326e7f06365263ab155ae02c}{test\+\_\+mturk\+\_\+messages} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a6f4fb740af7a113e939b7db9979aac45}{test\+\_\+new\+\_\+message} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ab68de0fee2d4992a86b48994f0fa850c}{test\+\_\+onboarding\+\_\+function} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a29a5b916e9a3ac35c05e5b8d87e9b990}{test\+\_\+agents\+\_\+incomplete} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ae23e0218e51023445d2dc096086205c0}{test\+\_\+world\+\_\+types} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a7bf3c2117a8b24385602fd550626a6f7}{test\+\_\+turk\+\_\+timeout} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a5d1bc0457f0f695982606756490050ee}{test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations} (self)
\item 
def \hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a3eb6343f438b2bc7dcedee55c68363ad}{test\+\_\+mark\+\_\+workers\+\_\+done} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a15bb604fcd47c565499246fdcef30fc1}{fake\+\_\+socket}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_adf881ec4960ee5eacaa4b9784a48e8c2}{opt}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a82534c50942dca8e7b13b569d686a5a2}{mturk\+\_\+agent\+\_\+ids}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a12c98ab0a2684925081f30e6d7bbe0ee}{mturk\+\_\+manager}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a429b97c4910b2259402fb2fcaa46e4ea}{agent\+\_\+1}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_aa31d9ee8614b716bc07624fd4010782f}{agent\+\_\+2}
\item 
\hyperlink{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_afca9c68f641d642397a8b8f6167f38b9}{agent\+\_\+3}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Tests some of the simpler MTurkManager functions that don't require much additional
state to run.
\end{DoxyVerb}
 

Definition at line 199 of file test\+\_\+mturk\+\_\+manager.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_af930e15dfec4de7c1b07b286ad2a4e07}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_af930e15dfec4de7c1b07b286ad2a4e07}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!set\+Up@{set\+Up}}
\index{set\+Up@{set\+Up}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{set\+Up()}{setUp()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+set\+Up (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 205 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
205     \textcolor{keyword}{def }setUp(self):
206         self.fake\_socket = MockSocket()
207         time.sleep(0.1)
208         argparser = ParlaiParser(\textcolor{keyword}{False}, \textcolor{keyword}{False})
209         argparser.add\_parlai\_data\_path()
210         argparser.add\_mturk\_args()
211         self.opt = argparser.parse\_args(print\_args=\textcolor{keyword}{False})
212         self.opt[\textcolor{stringliteral}{'task'}] = \textcolor{stringliteral}{'unittest'}
213         self.opt[\textcolor{stringliteral}{'assignment\_duration\_in\_seconds'}] = 6
214         self.mturk\_agent\_ids = [\textcolor{stringliteral}{'mturk\_agent\_1'}, \textcolor{stringliteral}{'mturk\_agent\_2'}]
215         self.mturk\_manager = MTurkManager(
216             opt=self.opt, mturk\_agent\_ids=self.mturk\_agent\_ids, is\_test=\textcolor{keyword}{True}
217         )
218         self.mturk\_manager.\_init\_state()
219         self.mturk\_manager.port = self.fake\_socket.port
220         self.agent\_1 = MTurkAgent(
221             self.opt,
222             self.mturk\_manager,
223             TEST\_HIT\_ID\_1,
224             TEST\_ASSIGNMENT\_ID\_1,
225             TEST\_WORKER\_ID\_1,
226         )
227         self.agent\_2 = MTurkAgent(
228             self.opt,
229             self.mturk\_manager,
230             TEST\_HIT\_ID\_2,
231             TEST\_ASSIGNMENT\_ID\_2,
232             TEST\_WORKER\_ID\_2,
233         )
234         self.agent\_3 = MTurkAgent(
235             self.opt,
236             self.mturk\_manager,
237             TEST\_HIT\_ID\_3,
238             TEST\_ASSIGNMENT\_ID\_3,
239             TEST\_WORKER\_ID\_3,
240         )
241 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a183e557fc6a0cc8e9942df9d9fb02445}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a183e557fc6a0cc8e9942df9d9fb02445}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!tear\+Down@{tear\+Down}}
\index{tear\+Down@{tear\+Down}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{tear\+Down()}{tearDown()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+tear\+Down (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 242 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
242     \textcolor{keyword}{def }tearDown(self):
243         self.mturk\_manager.shutdown()
244         self.fake\_socket.close()
245 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a29a5b916e9a3ac35c05e5b8d87e9b990}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a29a5b916e9a3ac35c05e5b8d87e9b990}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+agents\+\_\+incomplete@{test\+\_\+agents\+\_\+incomplete}}
\index{test\+\_\+agents\+\_\+incomplete@{test\+\_\+agents\+\_\+incomplete}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+agents\+\_\+incomplete()}{test\_agents\_incomplete()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+agents\+\_\+incomplete (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 833 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
833     \textcolor{keyword}{def }test\_agents\_incomplete(self):
834         agents = [self.agent\_1, self.agent\_2, self.agent\_3]
835         manager = self.mturk\_manager
836         self.assertFalse(manager.\_no\_agents\_incomplete(agents))
837         self.agent\_1.set\_status(AssignState.STATUS\_DISCONNECT)
838         self.assertFalse(manager.\_no\_agents\_incomplete(agents))
839         self.agent\_2.set\_status(AssignState.STATUS\_DONE)
840         self.assertFalse(manager.\_no\_agents\_incomplete(agents))
841         self.agent\_3.set\_status(AssignState.STATUS\_PARTNER\_DISCONNECT)
842         self.assertFalse(manager.\_no\_agents\_incomplete(agents))
843         self.agent\_1.set\_status(AssignState.STATUS\_DONE)
844         self.assertFalse(manager.\_no\_agents\_incomplete(agents))
845         self.agent\_3.set\_status(AssignState.STATUS\_DONE)
846         self.assertTrue(manager.\_no\_agents\_incomplete(agents))
847 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a3eb6343f438b2bc7dcedee55c68363ad}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a3eb6343f438b2bc7dcedee55c68363ad}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+mark\+\_\+workers\+\_\+done@{test\+\_\+mark\+\_\+workers\+\_\+done}}
\index{test\+\_\+mark\+\_\+workers\+\_\+done@{test\+\_\+mark\+\_\+workers\+\_\+done}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+mark\+\_\+workers\+\_\+done()}{test\_mark\_workers\_done()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+mark\+\_\+workers\+\_\+done (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 900 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
900     \textcolor{keyword}{def }test\_mark\_workers\_done(self):
901         manager = self.mturk\_manager
902         manager.give\_worker\_qualification = mock.MagicMock()
903         manager.\_log\_working\_time = mock.MagicMock()
904         manager.has\_time\_limit = \textcolor{keyword}{False}
905 
906         \textcolor{comment}{# Assert finality doesn't change}
907         self.agent\_1.set\_status(AssignState.STATUS\_DISCONNECT)
908         manager.mark\_workers\_done([self.agent\_1])
909         self.assertEqual(AssignState.STATUS\_DISCONNECT, self.agent\_1.get\_status())
910 
911         \textcolor{comment}{# assert uniqueness works as expected}
912         manager.is\_unique = \textcolor{keyword}{True}
913         with self.assertRaises(AssertionError):
914             manager.mark\_workers\_done([self.agent\_2])
915         manager.give\_worker\_qualification.assert\_not\_called()
916         manager.unique\_qual\_name = \textcolor{stringliteral}{'fake\_qual\_name'}
917         manager.mark\_workers\_done([self.agent\_2])
918         manager.give\_worker\_qualification.assert\_called\_once\_with(
919             self.agent\_2.worker\_id, \textcolor{stringliteral}{'fake\_qual\_name'}
920         )
921         self.assertEqual(self.agent\_2.get\_status(), AssignState.STATUS\_DONE)
922         manager.is\_unique = \textcolor{keyword}{False}
923 
924         \textcolor{comment}{# Ensure working time is called if it's set}
925         manager.has\_time\_limit = \textcolor{keyword}{True}
926         manager.mark\_workers\_done([self.agent\_3])
927         self.assertEqual(self.agent\_3.get\_status(), AssignState.STATUS\_DONE)
928         manager.\_log\_working\_time.assert\_called\_once\_with(self.agent\_3)
929 
930 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a178934378f2db3695c5999caccabd675}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a178934378f2db3695c5999caccabd675}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+move\+\_\+to\+\_\+waiting@{test\+\_\+move\+\_\+to\+\_\+waiting}}
\index{test\+\_\+move\+\_\+to\+\_\+waiting@{test\+\_\+move\+\_\+to\+\_\+waiting}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+move\+\_\+to\+\_\+waiting()}{test\_move\_to\_waiting()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+move\+\_\+to\+\_\+waiting (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 246 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
246     \textcolor{keyword}{def }test\_move\_to\_waiting(self):
247         manager = self.mturk\_manager
248         manager.worker\_manager.change\_agent\_conversation = mock.MagicMock()
249         manager.socket\_manager = mock.MagicMock()
250         manager.socket\_manager.close\_channel = mock.MagicMock()
251         manager.force\_expire\_hit = mock.MagicMock()
252         self.agent\_1.set\_status(AssignState.STATUS\_DISCONNECT)
253         self.agent\_1.reduce\_state = mock.MagicMock()
254         self.agent\_2.reduce\_state = mock.MagicMock()
255         self.agent\_3.reduce\_state = mock.MagicMock()
256 
257         \textcolor{comment}{# Test with a disconnected agent, assert the channel is closed}
258         manager.\_move\_agents\_to\_waiting([self.agent\_1])
259         self.agent\_1.reduce\_state.assert\_called\_once()
260         manager.socket\_manager.close\_channel.assert\_called\_once\_with(
261             self.agent\_1.get\_connection\_id()
262         )
263         manager.worker\_manager.change\_agent\_conversation.assert\_not\_called()
264         manager.force\_expire\_hit.assert\_not\_called()
265         manager.socket\_manager.close\_channel.reset\_mock()
266 
267         \textcolor{comment}{# Test with a connected agent, should be moved to waiting}
268         manager.\_move\_agents\_to\_waiting([self.agent\_2])
269         self.agent\_2.reduce\_state.assert\_not\_called()
270         manager.socket\_manager.close\_channel.assert\_not\_called()
271         manager.worker\_manager.change\_agent\_conversation.assert\_called\_once()
272         args = manager.worker\_manager.change\_agent\_conversation.call\_args[1]
273         self.assertEqual(args[\textcolor{stringliteral}{'agent'}], self.agent\_2)
274         self.assertTrue(manager.is\_waiting\_world(args[\textcolor{stringliteral}{'conversation\_id'}]))
275         self.assertEqual(args[\textcolor{stringliteral}{'new\_agent\_id'}], \textcolor{stringliteral}{'waiting'})
276         manager.force\_expire\_hit.assert\_not\_called()
277         manager.worker\_manager.change\_agent\_conversation.reset\_mock()
278 
279         \textcolor{comment}{# Test when no longer accepting agents}
280         manager.accepting\_workers = \textcolor{keyword}{False}
281         manager.\_move\_agents\_to\_waiting([self.agent\_3])
282         self.agent\_3.reduce\_state.assert\_not\_called()
283         manager.socket\_manager.close\_channel.assert\_not\_called()
284         manager.worker\_manager.change\_agent\_conversation.assert\_not\_called()
285         manager.force\_expire\_hit.assert\_called\_once\_with(
286             self.agent\_3.worker\_id, self.agent\_3.assignment\_id
287         )
288 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ab55e425b326e7f06365263ab155ae02c}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ab55e425b326e7f06365263ab155ae02c}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+mturk\+\_\+messages@{test\+\_\+mturk\+\_\+messages}}
\index{test\+\_\+mturk\+\_\+messages@{test\+\_\+mturk\+\_\+messages}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+mturk\+\_\+messages()}{test\_mturk\_messages()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+mturk\+\_\+messages (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Ensure incoming messages work as expected.
\end{DoxyVerb}
 

Definition at line 660 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
660     \textcolor{keyword}{def }test\_mturk\_messages(self):
661         \textcolor{stringliteral}{"""}
662 \textcolor{stringliteral}{        Ensure incoming messages work as expected.}
663 \textcolor{stringliteral}{        """}
664         \textcolor{comment}{# Setup for test}
665         manager = self.mturk\_manager
666         manager.task\_group\_id = \textcolor{stringliteral}{'TEST\_GROUP\_ID'}
667         manager.server\_url = \textcolor{stringliteral}{'https://127.0.0.1'}
668         manager.task\_state = manager.STATE\_ACCEPTING\_WORKERS
669         manager.\_setup\_socket()
670         manager.force\_expire\_hit = mock.MagicMock()
671         manager.\_on\_socket\_dead = mock.MagicMock()
672 
673         alive\_packet = Packet(
674             \textcolor{stringliteral}{''},
675             \textcolor{stringliteral}{''},
676             \textcolor{stringliteral}{''},
677             \textcolor{stringliteral}{''},
678             \textcolor{stringliteral}{''},
679             \{
680                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
681                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
682                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
683                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
684             \},
685             \textcolor{stringliteral}{''},
686         )
687         manager.\_on\_alive(alive\_packet)
688         agent = manager.worker\_manager.get\_agent\_for\_assignment(TEST\_ASSIGNMENT\_ID\_1)
689         self.assertIsInstance(agent, MTurkAgent)
690         self.assertEqual(agent.get\_status(), AssignState.STATUS\_NONE)
691         agent.set\_hit\_is\_abandoned = mock.MagicMock()
692 
693         \textcolor{comment}{# Test SNS\_ASSIGN\_ABANDONDED}
694         message\_packet = Packet(
695             \textcolor{stringliteral}{''},
696             \textcolor{stringliteral}{''},
697             \textcolor{stringliteral}{''},
698             \textcolor{stringliteral}{''},
699             TEST\_ASSIGNMENT\_ID\_1,
700             \{\textcolor{stringliteral}{'text'}: MTurkManagerFile.SNS\_ASSIGN\_ABANDONDED\},
701             \textcolor{stringliteral}{''},
702         )
703         manager.\_handle\_mturk\_message(message\_packet)
704         agent.set\_hit\_is\_abandoned.assert\_called\_once()
705         agent.set\_hit\_is\_abandoned.reset\_mock()
706         manager.\_on\_socket\_dead.assert\_called\_once\_with(
707             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
708         )
709         manager.\_on\_socket\_dead.reset\_mock()
710 
711         \textcolor{comment}{# Test SNS\_ASSIGN\_RETURNED}
712         message\_packet = Packet(
713             \textcolor{stringliteral}{''},
714             \textcolor{stringliteral}{''},
715             \textcolor{stringliteral}{''},
716             \textcolor{stringliteral}{''},
717             TEST\_ASSIGNMENT\_ID\_1,
718             \{\textcolor{stringliteral}{'text'}: MTurkManagerFile.SNS\_ASSIGN\_RETURNED\},
719             \textcolor{stringliteral}{''},
720         )
721         agent.hit\_is\_returned = \textcolor{keyword}{False}
722         manager.\_handle\_mturk\_message(message\_packet)
723         manager.\_on\_socket\_dead.assert\_called\_once\_with(
724             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
725         )
726         manager.\_on\_socket\_dead.reset\_mock()
727         self.assertTrue(agent.hit\_is\_returned)
728 
729         \textcolor{comment}{# Test SNS\_ASSIGN\_SUBMITTED}
730         message\_packet = Packet(
731             \textcolor{stringliteral}{''},
732             \textcolor{stringliteral}{''},
733             \textcolor{stringliteral}{''},
734             \textcolor{stringliteral}{''},
735             TEST\_ASSIGNMENT\_ID\_1,
736             \{\textcolor{stringliteral}{'text'}: MTurkManagerFile.SNS\_ASSIGN\_SUBMITTED\},
737             \textcolor{stringliteral}{''},
738         )
739         agent.hit\_is\_complete = \textcolor{keyword}{False}
740         manager.\_handle\_mturk\_message(message\_packet)
741         manager.\_on\_socket\_dead.assert\_not\_called()
742         self.assertTrue(agent.hit\_is\_complete)
743 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a6f4fb740af7a113e939b7db9979aac45}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a6f4fb740af7a113e939b7db9979aac45}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+new\+\_\+message@{test\+\_\+new\+\_\+message}}
\index{test\+\_\+new\+\_\+message@{test\+\_\+new\+\_\+message}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+new\+\_\+message()}{test\_new\_message()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+new\+\_\+message (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}test on_new_message.
\end{DoxyVerb}
 

Definition at line 744 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
744     \textcolor{keyword}{def }test\_new\_message(self):
745         \textcolor{stringliteral}{"""}
746 \textcolor{stringliteral}{        test on\_new\_message.}
747 \textcolor{stringliteral}{        """}
748         alive\_packet = Packet(
749             \textcolor{stringliteral}{''},
750             TEST\_WORKER\_ID\_1,
751             \textcolor{stringliteral}{''},
752             \textcolor{stringliteral}{''},
753             \textcolor{stringliteral}{''},
754             \{
755                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
756                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
757                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
758                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
759             \},
760             \textcolor{stringliteral}{''},
761         )
762 
763         message\_packet = Packet(
764             \textcolor{stringliteral}{''},
765             \textcolor{stringliteral}{''},
766             MTurkManagerFile.AMAZON\_SNS\_NAME,
767             \textcolor{stringliteral}{''},
768             TEST\_ASSIGNMENT\_ID\_1,
769             \{\textcolor{stringliteral}{'text'}: MTurkManagerFile.SNS\_ASSIGN\_SUBMITTED\},
770             \textcolor{stringliteral}{''},
771         )
772 
773         manager = self.mturk\_manager
774         manager.\_handle\_mturk\_message = mock.MagicMock()
775         manager.worker\_manager.route\_packet = mock.MagicMock()
776 
777         \textcolor{comment}{# test mturk message}
778         manager.\_on\_new\_message(alive\_packet)
779         manager.\_handle\_mturk\_message.assert\_not\_called()
780         manager.worker\_manager.route\_packet.assert\_called\_once\_with(alive\_packet)
781         manager.worker\_manager.route\_packet.reset\_mock()
782 
783         \textcolor{comment}{# test non-mturk message}
784         manager.\_on\_new\_message(message\_packet)
785         manager.\_handle\_mturk\_message.assert\_called\_once\_with(message\_packet)
786         manager.worker\_manager.route\_packet.assert\_not\_called()
787 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ab68de0fee2d4992a86b48994f0fa850c}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ab68de0fee2d4992a86b48994f0fa850c}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+onboarding\+\_\+function@{test\+\_\+onboarding\+\_\+function}}
\index{test\+\_\+onboarding\+\_\+function@{test\+\_\+onboarding\+\_\+function}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+onboarding\+\_\+function()}{test\_onboarding\_function()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+onboarding\+\_\+function (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 788 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
788     \textcolor{keyword}{def }test\_onboarding\_function(self):
789         manager = self.mturk\_manager
790         manager.onboard\_function = mock.MagicMock()
791         manager.worker\_manager.change\_agent\_conversation = mock.MagicMock()
792         manager.\_move\_agents\_to\_waiting = mock.MagicMock()
793         manager.worker\_manager.get\_agent\_for\_assignment = mock.MagicMock(
794             return\_value=self.agent\_1
795         )
796 
797         onboard\_threads = manager.assignment\_to\_onboard\_thread
798         did\_launch = manager.\_onboard\_new\_agent(self.agent\_1)
799         \hyperlink{namespaceparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_a1fd7ac4fedefa65d2416601107dbe44c}{assert\_equal\_by}(onboard\_threads[self.agent\_1.assignment\_id].isAlive, \textcolor{keyword}{True}, 0.2)
800         time.sleep(0.1)
801         manager.worker\_manager.change\_agent\_conversation.assert\_called\_once()
802         manager.worker\_manager.change\_agent\_conversation.reset\_mock()
803         manager.onboard\_function.assert\_not\_called()
804         self.assertTrue(did\_launch)
805 
806         \textcolor{comment}{# Thread will be waiting for agent\_1 status to go to ONBOARDING, ensure}
807         \textcolor{comment}{# won't start new thread on a repeat call when first still alive}
808         did\_launch = manager.\_onboard\_new\_agent(self.agent\_1)
809         time.sleep(0.2)
810         manager.worker\_manager.change\_agent\_conversation.assert\_not\_called()
811         manager.worker\_manager.get\_agent\_for\_assignment.assert\_not\_called()
812         manager.onboard\_function.assert\_not\_called()
813         self.assertFalse(did\_launch)
814 
815         \textcolor{comment}{# Advance the worker to simulate a connection, assert onboarding goes}
816         self.agent\_1.set\_status(AssignState.STATUS\_ONBOARDING)
817         \hyperlink{namespaceparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_a1fd7ac4fedefa65d2416601107dbe44c}{assert\_equal\_by}(onboard\_threads[self.agent\_1.assignment\_id].isAlive, \textcolor{keyword}{False}, 0.6)
818         manager.onboard\_function.assert\_called\_with(self.agent\_1)
819         manager.\_move\_agents\_to\_waiting.assert\_called\_once()
820 
821         \textcolor{comment}{# Try to launch a new onboarding world for the same agent still in}
822         \textcolor{comment}{# onboarding, assert that this call is ignored.}
823         did\_launch = manager.\_onboard\_new\_agent(self.agent\_1)
824         self.assertFalse(did\_launch)
825 
826         \textcolor{comment}{# Try to launch with an agent that was in none but supposedly launched}
827         \textcolor{comment}{# before}
828         self.agent\_1.set\_status(AssignState.STATUS\_NONE)
829         did\_launch = manager.\_onboard\_new\_agent(self.agent\_1)
830         self.assertTrue(did\_launch)
831         self.agent\_1.set\_status(AssignState.STATUS\_ONBOARDING)
832 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a7ceaedc34a74f15a15c1f655038af139}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a7ceaedc34a74f15a15c1f655038af139}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+socket\+\_\+setup@{test\+\_\+socket\+\_\+setup}}
\index{test\+\_\+socket\+\_\+setup@{test\+\_\+socket\+\_\+setup}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+socket\+\_\+setup()}{test\_socket\_setup()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+socket\+\_\+setup (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Basic socket setup should fail when not in correct state, but succeed otherwise.
\end{DoxyVerb}
 

Definition at line 289 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
289     \textcolor{keyword}{def }test\_socket\_setup(self):
290         \textcolor{stringliteral}{"""}
291 \textcolor{stringliteral}{        Basic socket setup should fail when not in correct state, but succeed otherwise.}
292 \textcolor{stringliteral}{        """}
293         self.mturk\_manager.task\_state = self.mturk\_manager.STATE\_CREATED
294         with self.assertRaises(AssertionError):
295             self.mturk\_manager.\_setup\_socket()
296         self.mturk\_manager.task\_group\_id = \textcolor{stringliteral}{'TEST\_GROUP\_ID'}
297         self.mturk\_manager.server\_url = \textcolor{stringliteral}{'https://127.0.0.1'}
298         self.mturk\_manager.task\_state = self.mturk\_manager.STATE\_INIT\_RUN
299         self.mturk\_manager.\_setup\_socket()
300         self.assertIsInstance(self.mturk\_manager.socket\_manager, SocketManager)
301 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a7bf3c2117a8b24385602fd550626a6f7}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a7bf3c2117a8b24385602fd550626a6f7}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+turk\+\_\+timeout@{test\+\_\+turk\+\_\+timeout}}
\index{test\+\_\+turk\+\_\+timeout@{test\+\_\+turk\+\_\+timeout}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+turk\+\_\+timeout()}{test\_turk\_timeout()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+turk\+\_\+timeout (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Timeout should send expiration message to worker and be treated as a disconnect
event.
\end{DoxyVerb}
 

Definition at line 864 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
864     \textcolor{keyword}{def }test\_turk\_timeout(self):
865         \textcolor{stringliteral}{"""}
866 \textcolor{stringliteral}{        Timeout should send expiration message to worker and be treated as a disconnect}
867 \textcolor{stringliteral}{        event.}
868 \textcolor{stringliteral}{        """}
869         manager = self.mturk\_manager
870         manager.force\_expire\_hit = mock.MagicMock()
871         manager.\_handle\_agent\_disconnect = mock.MagicMock()
872 
873         manager.handle\_turker\_timeout(TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1)
874         manager.force\_expire\_hit.assert\_called\_once()
875         call\_args = manager.force\_expire\_hit.call\_args
876         self.assertEqual(call\_args[0][0], TEST\_WORKER\_ID\_1)
877         self.assertEqual(call\_args[0][1], TEST\_ASSIGNMENT\_ID\_1)
878         manager.\_handle\_agent\_disconnect.assert\_called\_once\_with(
879             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
880         )
881 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a5d1bc0457f0f695982606756490050ee}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a5d1bc0457f0f695982606756490050ee}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations@{test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations}}
\index{test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations@{test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations()}{test\_wait\_for\_task\_expirations()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+wait\+\_\+for\+\_\+task\+\_\+expirations (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Ensure waiting for expiration time actually works out.
\end{DoxyVerb}
 

Definition at line 882 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
882     \textcolor{keyword}{def }test\_wait\_for\_task\_expirations(self):
883         \textcolor{stringliteral}{"""}
884 \textcolor{stringliteral}{        Ensure waiting for expiration time actually works out.}
885 \textcolor{stringliteral}{        """}
886         manager = self.mturk\_manager
887         manager.opt[\textcolor{stringliteral}{'assignment\_duration\_in\_seconds'}] = 0.5
888         manager.expire\_all\_unassigned\_hits = mock.MagicMock()
889         manager.hit\_id\_list = [1, 2, 3]
890 
891         \textcolor{keyword}{def }run\_task\_wait():
892             manager.\_wait\_for\_task\_expirations()
893 
894         wait\_thread = threading.Thread(target=run\_task\_wait, daemon=\textcolor{keyword}{True})
895         wait\_thread.start()
896         time.sleep(0.1)
897         self.assertTrue(wait\_thread.isAlive())
898         \hyperlink{namespaceparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_a1fd7ac4fedefa65d2416601107dbe44c}{assert\_equal\_by}(wait\_thread.isAlive, \textcolor{keyword}{False}, 0.6)
899 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a16cf4a9ae131a9c6bae2bcc07d804553}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a16cf4a9ae131a9c6bae2bcc07d804553}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+worker\+\_\+alive@{test\+\_\+worker\+\_\+alive}}
\index{test\+\_\+worker\+\_\+alive@{test\+\_\+worker\+\_\+alive}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+worker\+\_\+alive()}{test\_worker\_alive()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+worker\+\_\+alive (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 302 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
302     \textcolor{keyword}{def }test\_worker\_alive(self):
303         \textcolor{comment}{# Setup for test}
304         manager = self.mturk\_manager
305         manager.task\_group\_id = \textcolor{stringliteral}{'TEST\_GROUP\_ID'}
306         manager.server\_url = \textcolor{stringliteral}{'https://127.0.0.1'}
307         manager.task\_state = manager.STATE\_ACCEPTING\_WORKERS
308         manager.\_setup\_socket()
309         manager.force\_expire\_hit = mock.MagicMock()
310         manager.\_onboard\_new\_agent = mock.MagicMock()
311         manager.socket\_manager.open\_channel = mock.MagicMock(
312             wraps=manager.socket\_manager.open\_channel
313         )
314         manager.worker\_manager.worker\_alive = mock.MagicMock(
315             wraps=manager.worker\_manager.worker\_alive
316         )
317         open\_channel = manager.socket\_manager.open\_channel
318         worker\_alive = manager.worker\_manager.worker\_alive
319 
320         \textcolor{comment}{# Test no assignment}
321         alive\_packet = Packet(
322             \textcolor{stringliteral}{''},
323             \textcolor{stringliteral}{''},
324             \textcolor{stringliteral}{''},
325             \textcolor{stringliteral}{''},
326             \textcolor{stringliteral}{''},
327             \{
328                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
329                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
330                 \textcolor{stringliteral}{'assignment\_id'}: \textcolor{keywordtype}{None},
331                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
332             \},
333             \textcolor{stringliteral}{''},
334         )
335         manager.\_on\_alive(alive\_packet)
336         open\_channel.assert\_not\_called()
337         worker\_alive.assert\_not\_called()
338         manager.\_onboard\_new\_agent.assert\_not\_called()
339 
340         \textcolor{comment}{# Test not accepting workers}
341         alive\_packet = Packet(
342             \textcolor{stringliteral}{''},
343             \textcolor{stringliteral}{''},
344             \textcolor{stringliteral}{''},
345             \textcolor{stringliteral}{''},
346             \textcolor{stringliteral}{''},
347             \{
348                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
349                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
350                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
351                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
352             \},
353             \textcolor{stringliteral}{''},
354         )
355         manager.accepting\_workers = \textcolor{keyword}{False}
356         manager.\_on\_alive(alive\_packet)
357         open\_channel.assert\_called\_once\_with(TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1)
358         worker\_alive.assert\_called\_once\_with(TEST\_WORKER\_ID\_1)
359         worker\_state = manager.worker\_manager.\_get\_worker(TEST\_WORKER\_ID\_1)
360         self.assertIsNotNone(worker\_state)
361         open\_channel.reset\_mock()
362         worker\_alive.reset\_mock()
363         manager.force\_expire\_hit.assert\_called\_once\_with(
364             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
365         )
366         manager.\_onboard\_new\_agent.assert\_not\_called()
367         manager.force\_expire\_hit.reset\_mock()
368 
369         \textcolor{comment}{# Test successful creation}
370         manager.accepting\_workers = \textcolor{keyword}{True}
371         manager.\_on\_alive(alive\_packet)
372         open\_channel.assert\_called\_once\_with(TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1)
373         worker\_alive.assert\_called\_once\_with(TEST\_WORKER\_ID\_1)
374         manager.\_onboard\_new\_agent.assert\_called\_once()
375         manager.\_onboard\_new\_agent.reset\_mock()
376         manager.force\_expire\_hit.assert\_not\_called()
377 
378         agent = manager.worker\_manager.get\_agent\_for\_assignment(TEST\_ASSIGNMENT\_ID\_1)
379         self.assertIsInstance(agent, MTurkAgent)
380         self.assertEqual(agent.get\_status(), AssignState.STATUS\_NONE)
381 
382         \textcolor{comment}{# Reconnect in various conditions}
383         agent.set\_status = mock.MagicMock(wraps=agent.set\_status)
384         manager.\_add\_agent\_to\_pool = mock.MagicMock()
385 
386         \textcolor{comment}{# Reconnect when none state no connection\_id}
387         agent.log\_reconnect = mock.MagicMock(wraps=agent.log\_reconnect)
388         manager.\_on\_alive(alive\_packet)
389         manager.force\_expire\_hit.assert\_called\_once\_with(
390             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
391         )
392         manager.force\_expire\_hit.reset\_mock()
393         agent.set\_status.assert\_not\_called()
394         manager.\_add\_agent\_to\_pool.assert\_not\_called()
395         agent.log\_reconnect.assert\_called\_once()
396         agent.log\_reconnect.reset\_mock()
397 
398         \textcolor{comment}{# Reconnect in None state onboarding conversation\_id}
399         alive\_packet = Packet(
400             \textcolor{stringliteral}{''},
401             \textcolor{stringliteral}{''},
402             \textcolor{stringliteral}{''},
403             \textcolor{stringliteral}{''},
404             \textcolor{stringliteral}{''},
405             \{
406                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
407                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
408                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
409                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{stringliteral}{'o\_1234'},
410             \},
411             \textcolor{stringliteral}{''},
412         )
413         manager.\_on\_alive(alive\_packet)
414         manager.force\_expire\_hit.assert\_not\_called()
415         agent.set\_status.assert\_called\_once\_with(AssignState.STATUS\_ONBOARDING)
416         manager.\_add\_agent\_to\_pool.assert\_not\_called()
417         agent.log\_reconnect.assert\_called\_once()
418         agent.log\_reconnect.reset\_mock()
419 
420         \textcolor{comment}{# Reconnect in None state waiting conversation\_id}
421         alive\_packet = Packet(
422             \textcolor{stringliteral}{''},
423             \textcolor{stringliteral}{''},
424             \textcolor{stringliteral}{''},
425             \textcolor{stringliteral}{''},
426             \textcolor{stringliteral}{''},
427             \{
428                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
429                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
430                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
431                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{stringliteral}{'w\_1234'},
432             \},
433             \textcolor{stringliteral}{''},
434         )
435         agent.set\_status(AssignState.STATUS\_NONE)
436         agent.set\_status.reset\_mock()
437         manager.\_on\_alive(alive\_packet)
438         manager.force\_expire\_hit.assert\_not\_called()
439         agent.set\_status.assert\_called\_once\_with(AssignState.STATUS\_WAITING)
440         manager.\_add\_agent\_to\_pool.assert\_called\_once\_with(agent)
441         manager.\_add\_agent\_to\_pool.reset\_mock()
442         agent.log\_reconnect.assert\_called\_once()
443         agent.log\_reconnect.reset\_mock()
444 
445         \textcolor{comment}{# Reconnect in onboarding with waiting conversation id}
446         agent.set\_status(AssignState.STATUS\_ONBOARDING)
447         agent.set\_status.reset\_mock()
448         manager.\_on\_alive(alive\_packet)
449         manager.force\_expire\_hit.assert\_not\_called()
450         agent.set\_status.assert\_called\_once\_with(AssignState.STATUS\_WAITING)
451         manager.\_add\_agent\_to\_pool.assert\_called\_once\_with(agent)
452         manager.\_add\_agent\_to\_pool.reset\_mock()
453         agent.log\_reconnect.assert\_called\_once()
454         agent.log\_reconnect.reset\_mock()
455 
456         \textcolor{comment}{# Reconnect in onboarding with no conversation id}
457         alive\_packet = Packet(
458             \textcolor{stringliteral}{''},
459             \textcolor{stringliteral}{''},
460             \textcolor{stringliteral}{''},
461             \textcolor{stringliteral}{''},
462             \textcolor{stringliteral}{''},
463             \{
464                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
465                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
466                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
467                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
468             \},
469             \textcolor{stringliteral}{''},
470         )
471         agent.set\_status(AssignState.STATUS\_ONBOARDING)
472         agent.set\_status.reset\_mock()
473         manager.\_restore\_agent\_state = mock.MagicMock()
474         manager.\_on\_alive(alive\_packet)
475         manager.force\_expire\_hit.assert\_not\_called()
476         manager.\_restore\_agent\_state.assert\_called\_once\_with(
477             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
478         )
479         agent.set\_status.assert\_not\_called()
480         manager.\_add\_agent\_to\_pool.assert\_not\_called()
481         agent.log\_reconnect.assert\_called\_once()
482         agent.log\_reconnect.reset\_mock()
483 
484         \textcolor{comment}{# Reconnect in onboarding but not accepting new workers}
485         manager.accepting\_workers = \textcolor{keyword}{False}
486         agent.set\_status(AssignState.STATUS\_ONBOARDING)
487         agent.set\_status.reset\_mock()
488         manager.\_restore\_agent\_state = mock.MagicMock()
489         manager.\_on\_alive(alive\_packet)
490         manager.force\_expire\_hit.assert\_called\_once\_with(
491             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
492         )
493         manager.force\_expire\_hit.reset\_mock()
494         manager.\_restore\_agent\_state.assert\_not\_called()
495         agent.set\_status.assert\_not\_called()
496         manager.\_add\_agent\_to\_pool.assert\_not\_called()
497         agent.log\_reconnect.assert\_called\_once()
498         agent.log\_reconnect.reset\_mock()
499 
500         \textcolor{comment}{# Reconnect in waiting no conv id}
501         manager.accepting\_workers = \textcolor{keyword}{True}
502         agent.set\_status(AssignState.STATUS\_WAITING)
503         agent.set\_status.reset\_mock()
504         manager.\_restore\_agent\_state = mock.MagicMock()
505         manager.\_on\_alive(alive\_packet)
506         manager.force\_expire\_hit.assert\_not\_called()
507         manager.\_restore\_agent\_state.assert\_called\_once\_with(
508             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
509         )
510         agent.set\_status.assert\_not\_called()
511         manager.\_add\_agent\_to\_pool.assert\_called\_once()
512         manager.\_add\_agent\_to\_pool.reset\_mock()
513         agent.log\_reconnect.assert\_called\_once()
514         agent.log\_reconnect.reset\_mock()
515 
516         \textcolor{comment}{# Reconnect in waiting with conv id}
517         alive\_packet = Packet(
518             \textcolor{stringliteral}{''},
519             \textcolor{stringliteral}{''},
520             \textcolor{stringliteral}{''},
521             \textcolor{stringliteral}{''},
522             \textcolor{stringliteral}{''},
523             \{
524                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
525                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
526                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
527                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{stringliteral}{'w\_1234'},
528             \},
529             \textcolor{stringliteral}{''},
530         )
531         agent.set\_status(AssignState.STATUS\_WAITING)
532         agent.set\_status.reset\_mock()
533         manager.\_restore\_agent\_state = mock.MagicMock()
534         manager.\_on\_alive(alive\_packet)
535         manager.force\_expire\_hit.assert\_not\_called()
536         manager.\_restore\_agent\_state.assert\_not\_called()
537         agent.set\_status.assert\_not\_called()
538         manager.\_add\_agent\_to\_pool.assert\_called\_once()
539         manager.\_add\_agent\_to\_pool.reset\_mock()
540         agent.log\_reconnect.assert\_called\_once()
541         agent.log\_reconnect.reset\_mock()
542 
543         \textcolor{comment}{# Reconnect in waiting with task id}
544         alive\_packet = Packet(
545             \textcolor{stringliteral}{''},
546             \textcolor{stringliteral}{''},
547             \textcolor{stringliteral}{''},
548             \textcolor{stringliteral}{''},
549             \textcolor{stringliteral}{''},
550             \{
551                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
552                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
553                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
554                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{stringliteral}{'t\_1234'},
555             \},
556             \textcolor{stringliteral}{''},
557         )
558         agent.set\_status(AssignState.STATUS\_WAITING)
559         agent.set\_status.reset\_mock()
560         manager.\_restore\_agent\_state = mock.MagicMock()
561         manager.\_on\_alive(alive\_packet)
562         manager.force\_expire\_hit.assert\_not\_called()
563         manager.\_restore\_agent\_state.assert\_not\_called()
564         agent.set\_status.assert\_called\_with(AssignState.STATUS\_IN\_TASK)
565         manager.\_add\_agent\_to\_pool.assert\_not\_called()
566         agent.log\_reconnect.assert\_called\_once()
567         agent.log\_reconnect.reset\_mock()
568 
569         \textcolor{comment}{# Test active convos failure}
570         agent.set\_status(AssignState.STATUS\_IN\_TASK)
571         agent.set\_status.reset\_mock()
572         alive\_packet = Packet(
573             \textcolor{stringliteral}{''},
574             \textcolor{stringliteral}{''},
575             \textcolor{stringliteral}{''},
576             \textcolor{stringliteral}{''},
577             \textcolor{stringliteral}{''},
578             \{
579                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
580                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
581                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_2,
582                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
583             \},
584             \textcolor{stringliteral}{''},
585         )
586         manager.opt[\textcolor{stringliteral}{'allowed\_conversations'}] = 1
587         manager.\_on\_alive(alive\_packet)
588         agent.set\_status.assert\_not\_called()
589         manager.force\_expire\_hit.assert\_called\_once()
590         manager.\_onboard\_new\_agent.assert\_not\_called()
591         manager.force\_expire\_hit.reset\_mock()
592 
593         \textcolor{comment}{# Test uniqueness failed}
594         agent.set\_status(AssignState.STATUS\_DONE)
595         agent.set\_status.reset\_mock()
596         alive\_packet = Packet(
597             \textcolor{stringliteral}{''},
598             \textcolor{stringliteral}{''},
599             \textcolor{stringliteral}{''},
600             \textcolor{stringliteral}{''},
601             \textcolor{stringliteral}{''},
602             \{
603                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
604                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
605                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_2,
606                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
607             \},
608             \textcolor{stringliteral}{''},
609         )
610         manager.is\_unique = \textcolor{keyword}{True}
611         manager.\_on\_alive(alive\_packet)
612         agent.set\_status.assert\_not\_called()
613         manager.force\_expire\_hit.assert\_called\_once()
614         manager.\_onboard\_new\_agent.assert\_not\_called()
615         manager.force\_expire\_hit.reset\_mock()
616 
617         \textcolor{comment}{# Test in task reconnects}
618         agent.set\_status(AssignState.STATUS\_IN\_TASK)
619         agent.set\_status.reset\_mock()
620         alive\_packet = Packet(
621             \textcolor{stringliteral}{''},
622             \textcolor{stringliteral}{''},
623             \textcolor{stringliteral}{''},
624             \textcolor{stringliteral}{''},
625             \textcolor{stringliteral}{''},
626             \{
627                 \textcolor{stringliteral}{'worker\_id'}: TEST\_WORKER\_ID\_1,
628                 \textcolor{stringliteral}{'hit\_id'}: TEST\_HIT\_ID\_1,
629                 \textcolor{stringliteral}{'assignment\_id'}: TEST\_ASSIGNMENT\_ID\_1,
630                 \textcolor{stringliteral}{'conversation\_id'}: \textcolor{keywordtype}{None},
631             \},
632             \textcolor{stringliteral}{''},
633         )
634         manager.\_on\_alive(alive\_packet)
635         manager.\_restore\_agent\_state.assert\_called\_once\_with(
636             TEST\_WORKER\_ID\_1, TEST\_ASSIGNMENT\_ID\_1
637         )
638         agent.set\_status.assert\_not\_called()
639         manager.\_add\_agent\_to\_pool.assert\_not\_called()
640         agent.log\_reconnect.assert\_called\_once()
641         agent.log\_reconnect.reset\_mock()
642 
643         \textcolor{comment}{# Test all final states}
644         \textcolor{keywordflow}{for} use\_state \textcolor{keywordflow}{in} [
645             AssignState.STATUS\_DISCONNECT,
646             AssignState.STATUS\_DONE,
647             AssignState.STATUS\_EXPIRED,
648             AssignState.STATUS\_RETURNED,
649             AssignState.STATUS\_PARTNER\_DISCONNECT,
650         ]:
651             manager.send\_command = mock.MagicMock()
652             agent.set\_status(use\_state)
653             agent.set\_status.reset\_mock()
654             manager.\_on\_alive(alive\_packet)
655             agent.set\_status.assert\_not\_called()
656             manager.\_add\_agent\_to\_pool.assert\_not\_called()
657             manager.force\_expire\_hit.assert\_not\_called()
658             manager.send\_command.assert\_called\_once()
659 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ae23e0218e51023445d2dc096086205c0}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_ae23e0218e51023445d2dc096086205c0}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!test\+\_\+world\+\_\+types@{test\+\_\+world\+\_\+types}}
\index{test\+\_\+world\+\_\+types@{test\+\_\+world\+\_\+types}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{test\+\_\+world\+\_\+types()}{test\_world\_types()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+test\+\_\+world\+\_\+types (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 848 of file test\+\_\+mturk\+\_\+manager.\+py.


\begin{DoxyCode}
848     \textcolor{keyword}{def }test\_world\_types(self):
849         onboard\_type = \textcolor{stringliteral}{'o\_12345'}
850         waiting\_type = \textcolor{stringliteral}{'w\_12345'}
851         task\_type = \textcolor{stringliteral}{'t\_12345'}
852         garbage\_type = \textcolor{stringliteral}{'g\_12345'}
853         manager = self.mturk\_manager
854         self.assertTrue(manager.is\_onboarding\_world(onboard\_type))
855         self.assertTrue(manager.is\_task\_world(task\_type))
856         self.assertTrue(manager.is\_waiting\_world(waiting\_type))
857         \textcolor{keywordflow}{for} world\_type \textcolor{keywordflow}{in} [waiting\_type, task\_type, garbage\_type]:
858             self.assertFalse(manager.is\_onboarding\_world(world\_type))
859         \textcolor{keywordflow}{for} world\_type \textcolor{keywordflow}{in} [onboard\_type, task\_type, garbage\_type]:
860             self.assertFalse(manager.is\_waiting\_world(world\_type))
861         \textcolor{keywordflow}{for} world\_type \textcolor{keywordflow}{in} [waiting\_type, onboard\_type, garbage\_type]:
862             self.assertFalse(manager.is\_task\_world(world\_type))
863 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a429b97c4910b2259402fb2fcaa46e4ea}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a429b97c4910b2259402fb2fcaa46e4ea}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!agent\+\_\+1@{agent\+\_\+1}}
\index{agent\+\_\+1@{agent\+\_\+1}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{agent\+\_\+1}{agent\_1}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+agent\+\_\+1}



Definition at line 220 of file test\+\_\+mturk\+\_\+manager.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_aa31d9ee8614b716bc07624fd4010782f}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_aa31d9ee8614b716bc07624fd4010782f}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!agent\+\_\+2@{agent\+\_\+2}}
\index{agent\+\_\+2@{agent\+\_\+2}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{agent\+\_\+2}{agent\_2}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+agent\+\_\+2}



Definition at line 227 of file test\+\_\+mturk\+\_\+manager.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_afca9c68f641d642397a8b8f6167f38b9}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_afca9c68f641d642397a8b8f6167f38b9}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!agent\+\_\+3@{agent\+\_\+3}}
\index{agent\+\_\+3@{agent\+\_\+3}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{agent\+\_\+3}{agent\_3}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+agent\+\_\+3}



Definition at line 234 of file test\+\_\+mturk\+\_\+manager.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a15bb604fcd47c565499246fdcef30fc1}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a15bb604fcd47c565499246fdcef30fc1}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!fake\+\_\+socket@{fake\+\_\+socket}}
\index{fake\+\_\+socket@{fake\+\_\+socket}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{fake\+\_\+socket}{fake\_socket}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+fake\+\_\+socket}



Definition at line 206 of file test\+\_\+mturk\+\_\+manager.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a82534c50942dca8e7b13b569d686a5a2}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a82534c50942dca8e7b13b569d686a5a2}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!mturk\+\_\+agent\+\_\+ids@{mturk\+\_\+agent\+\_\+ids}}
\index{mturk\+\_\+agent\+\_\+ids@{mturk\+\_\+agent\+\_\+ids}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{mturk\+\_\+agent\+\_\+ids}{mturk\_agent\_ids}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+mturk\+\_\+agent\+\_\+ids}



Definition at line 214 of file test\+\_\+mturk\+\_\+manager.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a12c98ab0a2684925081f30e6d7bbe0ee}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_a12c98ab0a2684925081f30e6d7bbe0ee}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!mturk\+\_\+manager@{mturk\+\_\+manager}}
\index{mturk\+\_\+manager@{mturk\+\_\+manager}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{mturk\+\_\+manager}{mturk\_manager}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+mturk\+\_\+manager}



Definition at line 215 of file test\+\_\+mturk\+\_\+manager.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_adf881ec4960ee5eacaa4b9784a48e8c2}\label{classparlai_1_1mturk_1_1core_1_1test_1_1test__mturk__manager_1_1TestMTurkManagerUnitFunctions_adf881ec4960ee5eacaa4b9784a48e8c2}} 
\index{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}!opt@{opt}}
\index{opt@{opt}!parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions@{parlai\+::mturk\+::core\+::test\+::test\+\_\+mturk\+\_\+manager\+::\+Test\+M\+Turk\+Manager\+Unit\+Functions}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+mturk.\+core.\+test.\+test\+\_\+mturk\+\_\+manager.\+Test\+M\+Turk\+Manager\+Unit\+Functions.\+opt}



Definition at line 211 of file test\+\_\+mturk\+\_\+manager.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/mturk/core/test/\hyperlink{test_2test__mturk__manager_8py}{test\+\_\+mturk\+\_\+manager.\+py}\end{DoxyCompactItemize}
