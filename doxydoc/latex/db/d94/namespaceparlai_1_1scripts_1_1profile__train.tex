\hypertarget{namespaceparlai_1_1scripts_1_1profile__train}{}\section{parlai.\+scripts.\+profile\+\_\+train Namespace Reference}
\label{namespaceparlai_1_1scripts_1_1profile__train}\index{parlai.\+scripts.\+profile\+\_\+train@{parlai.\+scripts.\+profile\+\_\+train}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1scripts_1_1profile__train_abc73daf8a16d21ce56906342ec15cda9}{setup\+\_\+args} (parser=None)
\item 
def \hyperlink{namespaceparlai_1_1scripts_1_1profile__train_a72ecdcc9932f8566d611093a2daeaa2a}{profile} (opt)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1scripts_1_1profile__train_a72ecdcc9932f8566d611093a2daeaa2a}\label{namespaceparlai_1_1scripts_1_1profile__train_a72ecdcc9932f8566d611093a2daeaa2a}} 
\index{parlai\+::scripts\+::profile\+\_\+train@{parlai\+::scripts\+::profile\+\_\+train}!profile@{profile}}
\index{profile@{profile}!parlai\+::scripts\+::profile\+\_\+train@{parlai\+::scripts\+::profile\+\_\+train}}
\subsubsection{\texorpdfstring{profile()}{profile()}}
{\footnotesize\ttfamily def parlai.\+scripts.\+profile\+\_\+train.\+profile (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 62 of file profile\+\_\+train.\+py.


\begin{DoxyCode}
62 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1scripts_1_1profile__train_a72ecdcc9932f8566d611093a2daeaa2a}{profile}(opt):
63     \textcolor{keywordflow}{if} isinstance(opt, ParlaiParser):
64         print(\textcolor{stringliteral}{'[ Deprecated Warning: profile should be passed opt not Parser ]'})
65         opt = opt.parse\_args()
66     \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'torch'}] \textcolor{keywordflow}{or} opt[\textcolor{stringliteral}{'torch\_cuda'}]:
67         with torch.autograd.profiler.profile(use\_cuda=opt[\textcolor{stringliteral}{'torch\_cuda'}]) \textcolor{keyword}{as} prof:
68             TrainLoop(opt).\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}()
69         print(prof.total\_average())
70 
71         sort\_cpu = sorted(prof.key\_averages(), key=\textcolor{keyword}{lambda} k: k.cpu\_time)
72         sort\_cuda = sorted(prof.key\_averages(), key=\textcolor{keyword}{lambda} k: k.cuda\_time)
73 
74         \textcolor{keyword}{def }cpu():
75             \textcolor{keywordflow}{for} e \textcolor{keywordflow}{in} sort\_cpu:
76                 print(e)
77 
78         \textcolor{keyword}{def }cuda():
79             \textcolor{keywordflow}{for} e \textcolor{keywordflow}{in} sort\_cuda:
80                 print(e)
81 
82         cpu()
83 
84         \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'debug'}]:
85             print(
86                 \textcolor{stringliteral}{'`cpu()` prints out cpu-sorted list, '}
87                 \textcolor{stringliteral}{'`cuda()` prints cuda-sorted list'}
88             )
89 
90             pdb.set\_trace()
91     \textcolor{keywordflow}{else}:
92         pr = cProfile.Profile()
93         pr.enable()
94         TrainLoop(opt).\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}()
95         pr.disable()
96         s = io.StringIO()
97         sortby = \textcolor{stringliteral}{'cumulative'}
98         ps = pstats.Stats(pr, stream=s).sort\_stats(sortby)
99         ps.print\_stats()
100         print(s.getvalue())
101         \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'debug'}]:
102             pdb.set\_trace()
103 
104 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1scripts_1_1profile__train_abc73daf8a16d21ce56906342ec15cda9}\label{namespaceparlai_1_1scripts_1_1profile__train_abc73daf8a16d21ce56906342ec15cda9}} 
\index{parlai\+::scripts\+::profile\+\_\+train@{parlai\+::scripts\+::profile\+\_\+train}!setup\+\_\+args@{setup\+\_\+args}}
\index{setup\+\_\+args@{setup\+\_\+args}!parlai\+::scripts\+::profile\+\_\+train@{parlai\+::scripts\+::profile\+\_\+train}}
\subsubsection{\texorpdfstring{setup\+\_\+args()}{setup\_args()}}
{\footnotesize\ttfamily def parlai.\+scripts.\+profile\+\_\+train.\+setup\+\_\+args (\begin{DoxyParamCaption}\item[{}]{parser = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 35 of file profile\+\_\+train.\+py.


\begin{DoxyCode}
35 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1scripts_1_1profile__train_abc73daf8a16d21ce56906342ec15cda9}{setup\_args}(parser=None):
36     \textcolor{keywordflow}{if} parser \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
37         parser = ParlaiParser(\textcolor{keyword}{True}, \textcolor{keyword}{True}, \textcolor{stringliteral}{'cProfile a training run'})
38     parser.add\_pytorch\_datateacher\_args()
39     parser = train\_args(parser)
40     profile = parser.add\_argument\_group(\textcolor{stringliteral}{'Profiler Arguments'})
41     profile.add\_argument(
42         \textcolor{stringliteral}{'--torch'},
43         type=\textcolor{stringliteral}{'bool'},
44         default=\textcolor{keyword}{False},
45         help=\textcolor{stringliteral}{'If true, use the torch profiler. Otherwise use cProfile.'},
46     )
47     profile.add\_argument(
48         \textcolor{stringliteral}{'--torch-cuda'},
49         type=\textcolor{stringliteral}{'bool'},
50         default=\textcolor{keyword}{False},
51         help=\textcolor{stringliteral}{'If true, use the torch cuda profiler. Otherwise use cProfile.'},
52     )
53     profile.add\_argument(
54         \textcolor{stringliteral}{'--debug'},
55         type=\textcolor{stringliteral}{'bool'},
56         default=\textcolor{keyword}{False},
57         help=\textcolor{stringliteral}{'If true, enter debugger at end of run.'},
58     )
59     \textcolor{keywordflow}{return} parser
60 
61 
\end{DoxyCode}
