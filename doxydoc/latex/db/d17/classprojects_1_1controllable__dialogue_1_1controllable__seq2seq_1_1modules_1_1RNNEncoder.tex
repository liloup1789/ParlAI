\hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder}{}\section{projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder Class Reference}
\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder}\index{projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder@{projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder}}


Inheritance diagram for projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{d4/d71/classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{dc/d08/classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a7b8489adad0cd4001a02a55caf861295}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, num\+\_\+features, embeddingsize, hiddensize, padding\+\_\+idx=0, rnn\+\_\+class=\textquotesingle{}lstm\textquotesingle{}, numlayers=2, \hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abe0afe1644874098ad77516fe47cbb9e}{dropout}=0.\+1, bidirectional=False, shared\+\_\+lt=None, shared\+\_\+rnn=None, \hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a0bd93798713f88e23d70e41348b5abe3}{input\+\_\+dropout}=0, unknown\+\_\+idx=None, sparse=False)
\item 
def \hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_aff331ac57c336c48e5853f16edacb6db}{forward} (self, xs)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abe0afe1644874098ad77516fe47cbb9e}{dropout}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abbf6aa6b5df53e8116febb2308e03ade}{layers}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a46ccf005ad266cc15e44dd91e750efe7}{dirs}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a76215180bc1ae888a11d97d859916081}{hsz}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a0bd93798713f88e23d70e41348b5abe3}{input\+\_\+dropout}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_acd1f76f553f88cea78092f794d07aebe}{lt}
\item 
\hyperlink{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_ada0cc7e5a52c869b2cab62f8df47b981}{rnn}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}RNN Encoder.
\end{DoxyVerb}
 

Definition at line 482 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a7b8489adad0cd4001a02a55caf861295}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a7b8489adad0cd4001a02a55caf861295}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{num\+\_\+features,  }\item[{}]{embeddingsize,  }\item[{}]{hiddensize,  }\item[{}]{padding\+\_\+idx = {\ttfamily 0},  }\item[{}]{rnn\+\_\+class = {\ttfamily \textquotesingle{}lstm\textquotesingle{}},  }\item[{}]{numlayers = {\ttfamily 2},  }\item[{}]{dropout = {\ttfamily 0.1},  }\item[{}]{bidirectional = {\ttfamily False},  }\item[{}]{shared\+\_\+lt = {\ttfamily None},  }\item[{}]{shared\+\_\+rnn = {\ttfamily None},  }\item[{}]{input\+\_\+dropout = {\ttfamily 0},  }\item[{}]{unknown\+\_\+idx = {\ttfamily None},  }\item[{}]{sparse = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Initialize recurrent encoder.
\end{DoxyVerb}
 

Definition at line 502 of file modules.\+py.


\begin{DoxyCode}
502     ):
503         \textcolor{stringliteral}{"""}
504 \textcolor{stringliteral}{        Initialize recurrent encoder.}
505 \textcolor{stringliteral}{        """}
506         super().\_\_init\_\_()
507 
508         self.dropout = nn.Dropout(p=dropout)
509         self.layers = numlayers
510         self.dirs = 2 \textcolor{keywordflow}{if} bidirectional \textcolor{keywordflow}{else} 1
511         self.hsz = hiddensize
512 
513         \textcolor{keywordflow}{if} input\_dropout > 0 \textcolor{keywordflow}{and} unknown\_idx \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
514             \textcolor{keywordflow}{raise} RuntimeError(\textcolor{stringliteral}{'input\_dropout > 0 but unknown\_idx not set'})
515         self.input\_dropout = UnknownDropout(unknown\_idx, input\_dropout)
516 
517         \textcolor{keywordflow}{if} shared\_lt \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
518             self.lt = nn.Embedding(
519                 num\_features, embeddingsize, padding\_idx=padding\_idx, sparse=sparse
520             )
521         \textcolor{keywordflow}{else}:
522             self.lt = shared\_lt
523 
524         \textcolor{keywordflow}{if} shared\_rnn \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
525             self.rnn = \hyperlink{namespaceseq2seq_1_1train_a46177da1cc74c4a2874e4a527d857f75}{rnn\_class}(
526                 embeddingsize,
527                 hiddensize,
528                 numlayers,
529                 dropout=dropout \textcolor{keywordflow}{if} numlayers > 1 \textcolor{keywordflow}{else} 0,
530                 batch\_first=\textcolor{keyword}{True},
531                 bidirectional=bidirectional,
532             )
533         \textcolor{keywordflow}{elif} bidirectional:
534             \textcolor{keywordflow}{raise} RuntimeError(\textcolor{stringliteral}{'Cannot share decoder with bidir encoder.'})
535         \textcolor{keywordflow}{else}:
536             self.rnn = shared\_rnn
537 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_aff331ac57c336c48e5853f16edacb6db}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_aff331ac57c336c48e5853f16edacb6db}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!forward@{forward}}
\index{forward@{forward}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{xs }\end{DoxyParamCaption})}

\begin{DoxyVerb}Encode sequence.

:param xs: (bsz x seqlen) LongTensor of input token indices

:returns: encoder outputs, hidden state, attention mask
    encoder outputs are the output state at each step of the encoding.
    the hidden state is the final hidden state of the encoder.
    the attention mask is a mask of which input values are nonzero.
\end{DoxyVerb}
 

Definition at line 538 of file modules.\+py.


\begin{DoxyCode}
538     \textcolor{keyword}{def }forward(self, xs):
539         \textcolor{stringliteral}{"""}
540 \textcolor{stringliteral}{        Encode sequence.}
541 \textcolor{stringliteral}{}
542 \textcolor{stringliteral}{        :param xs: (bsz x seqlen) LongTensor of input token indices}
543 \textcolor{stringliteral}{}
544 \textcolor{stringliteral}{        :returns: encoder outputs, hidden state, attention mask}
545 \textcolor{stringliteral}{            encoder outputs are the output state at each step of the encoding.}
546 \textcolor{stringliteral}{            the hidden state is the final hidden state of the encoder.}
547 \textcolor{stringliteral}{            the attention mask is a mask of which input values are nonzero.}
548 \textcolor{stringliteral}{        """}
549         bsz = len(xs)
550 
551         \textcolor{comment}{# embed input tokens}
552         xs = self.input\_dropout(xs)
553         xes = self.dropout(self.lt(xs))
554         attn\_mask = xs.ne(0)
555         \textcolor{keywordflow}{try}:
556             x\_lens = torch.sum(attn\_mask.int(), dim=1)
557             xes = pack\_padded\_sequence(xes, x\_lens, batch\_first=\textcolor{keyword}{True})
558             packed = \textcolor{keyword}{True}
559         \textcolor{keywordflow}{except} ValueError:
560             \textcolor{comment}{# packing failed, don't pack then}
561             packed = \textcolor{keyword}{False}
562 
563         encoder\_output, hidden = self.rnn(xes)
564         \textcolor{keywordflow}{if} packed:
565             encoder\_output, \_ = pad\_packed\_sequence(encoder\_output, batch\_first=\textcolor{keyword}{True})
566         \textcolor{keywordflow}{if} self.dirs > 1:
567             \textcolor{comment}{# project to decoder dimension by taking sum of forward and back}
568             \textcolor{keywordflow}{if} isinstance(self.rnn, nn.LSTM):
569                 hidden = (
570                     hidden[0].view(-1, self.dirs, bsz, self.hsz).sum(1),
571                     hidden[1].view(-1, self.dirs, bsz, self.hsz).sum(1),
572                 )
573             \textcolor{keywordflow}{else}:
574                 hidden = hidden.view(-1, self.dirs, bsz, self.hsz).sum(1)
575 
576         \textcolor{keywordflow}{return} encoder\_output, hidden, attn\_mask
577 
578 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a46ccf005ad266cc15e44dd91e750efe7}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a46ccf005ad266cc15e44dd91e750efe7}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!dirs@{dirs}}
\index{dirs@{dirs}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{dirs}{dirs}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+dirs}



Definition at line 510 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abe0afe1644874098ad77516fe47cbb9e}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abe0afe1644874098ad77516fe47cbb9e}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!dropout@{dropout}}
\index{dropout@{dropout}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{dropout}{dropout}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+dropout}



Definition at line 508 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a76215180bc1ae888a11d97d859916081}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a76215180bc1ae888a11d97d859916081}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!hsz@{hsz}}
\index{hsz@{hsz}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{hsz}{hsz}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+hsz}



Definition at line 511 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a0bd93798713f88e23d70e41348b5abe3}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_a0bd93798713f88e23d70e41348b5abe3}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!input\+\_\+dropout@{input\+\_\+dropout}}
\index{input\+\_\+dropout@{input\+\_\+dropout}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{input\+\_\+dropout}{input\_dropout}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+input\+\_\+dropout}



Definition at line 515 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abbf6aa6b5df53e8116febb2308e03ade}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_abbf6aa6b5df53e8116febb2308e03ade}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!layers@{layers}}
\index{layers@{layers}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{layers}{layers}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+layers}



Definition at line 509 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_acd1f76f553f88cea78092f794d07aebe}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_acd1f76f553f88cea78092f794d07aebe}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!lt@{lt}}
\index{lt@{lt}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{lt}{lt}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+lt}



Definition at line 518 of file modules.\+py.

\mbox{\Hypertarget{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_ada0cc7e5a52c869b2cab62f8df47b981}\label{classprojects_1_1controllable__dialogue_1_1controllable__seq2seq_1_1modules_1_1RNNEncoder_ada0cc7e5a52c869b2cab62f8df47b981}} 
\index{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}!rnn@{rnn}}
\index{rnn@{rnn}!projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder@{projects\+::controllable\+\_\+dialogue\+::controllable\+\_\+seq2seq\+::modules\+::\+R\+N\+N\+Encoder}}
\subsubsection{\texorpdfstring{rnn}{rnn}}
{\footnotesize\ttfamily projects.\+controllable\+\_\+dialogue.\+controllable\+\_\+seq2seq.\+modules.\+R\+N\+N\+Encoder.\+rnn}



Definition at line 525 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/controllable\+\_\+dialogue/controllable\+\_\+seq2seq/\hyperlink{projects_2controllable__dialogue_2controllable__seq2seq_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
