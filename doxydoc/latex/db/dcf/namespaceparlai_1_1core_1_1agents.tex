\hypertarget{namespaceparlai_1_1core_1_1agents}{}\section{parlai.\+core.\+agents Namespace Reference}
\label{namespaceparlai_1_1core_1_1agents}\index{parlai.\+core.\+agents@{parlai.\+core.\+agents}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classparlai_1_1core_1_1agents_1_1Agent}{Agent}
\item 
class \hyperlink{classparlai_1_1core_1_1agents_1_1MultiTaskTeacher}{Multi\+Task\+Teacher}
\item 
class \hyperlink{classparlai_1_1core_1_1agents_1_1Teacher}{Teacher}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1agents_a9761bb2314603dd92f5eee786930b21a}{compare\+\_\+init\+\_\+model\+\_\+opts}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1agents_a8dcf9aa8caf8fe1046ff4cac7f38b54c}{create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1agents_a00d77a7e26fb89e8bd900f7b2a02982a}{create\+\_\+agent}
\item 
def \hyperlink{namespaceparlai_1_1core_1_1agents_aa5af5dd1d2f9da491b60348d479b849f}{create\+\_\+agent\+\_\+from\+\_\+shared} (shared\+\_\+agent)
\item 
def \hyperlink{namespaceparlai_1_1core_1_1agents_a5600530545f5e60a79e2d657b5af1d8c}{create\+\_\+agents\+\_\+from\+\_\+shared} (shared)
\item 
def \hyperlink{namespaceparlai_1_1core_1_1agents_a76269fb567532a8fb7f29edcc20a6e47}{create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1agents_a9761bb2314603dd92f5eee786930b21a}\label{namespaceparlai_1_1core_1_1agents_a9761bb2314603dd92f5eee786930b21a}} 
\index{parlai\+::core\+::agents@{parlai\+::core\+::agents}!compare\+\_\+init\+\_\+model\+\_\+opts@{compare\+\_\+init\+\_\+model\+\_\+opts}}
\index{compare\+\_\+init\+\_\+model\+\_\+opts@{compare\+\_\+init\+\_\+model\+\_\+opts}!parlai\+::core\+::agents@{parlai\+::core\+::agents}}
\subsubsection{\texorpdfstring{compare\+\_\+init\+\_\+model\+\_\+opts()}{compare\_init\_model\_opts()}}
{\footnotesize\ttfamily def parlai.\+core.\+agents.\+compare\+\_\+init\+\_\+model\+\_\+opts (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 434 of file agents.\+py.


\begin{DoxyCode}
434 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1agents_a9761bb2314603dd92f5eee786930b21a}{compare\_init\_model\_opts}(opt: Opt, curr\_opt: Opt):
435     \textcolor{stringliteral}{"""}
436 \textcolor{stringliteral}{    Print loud warning when `init\_model` opts differ from previous configuration.}
437 \textcolor{stringliteral}{    """}
438     \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'init\_model'}) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
439         \textcolor{keywordflow}{return}
440     opt[\textcolor{stringliteral}{'init\_model'}] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_a5fbd3301b67f00d6d146fb01c7cd7626}{modelzoo\_path}(opt[\textcolor{stringliteral}{'datapath'}], opt[\textcolor{stringliteral}{'init\_model'}])
441     optfile = opt[\textcolor{stringliteral}{'init\_model'}] + \textcolor{stringliteral}{'.opt'}
442     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.isfile(optfile):
443         \textcolor{keywordflow}{return}
444     init\_model\_opt = \hyperlink{namespaceparlai_1_1core_1_1opt_a37f4d5498e9174737b7dab37a786c04f}{load\_opt\_file}(optfile)
445 
446     extra\_opts = \{\}
447     different\_opts = \{\}
448     exempt\_opts = [
449         \textcolor{stringliteral}{'model\_file'},
450         \textcolor{stringliteral}{'dict\_file'},
451         \textcolor{stringliteral}{'override'},
452         \textcolor{stringliteral}{'starttime'},
453         \textcolor{stringliteral}{'init\_model'},
454         \textcolor{stringliteral}{'batchindex'},
455     ]
456 
457     \textcolor{comment}{# search through init model opts}
458     \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} init\_model\_opt.items():
459         \textcolor{keywordflow}{if} (
460             k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} exempt\_opts
461             \textcolor{keywordflow}{and} k \textcolor{keywordflow}{in} init\_model\_opt
462             \textcolor{keywordflow}{and} init\_model\_opt[k] != curr\_opt.get(k)
463         ):
464             \textcolor{keywordflow}{if} isinstance(v, list):
465                 \textcolor{keywordflow}{if} init\_model\_opt[k] != list(curr\_opt[k]):
466                     different\_opts[k] = \textcolor{stringliteral}{','}.join([\hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(x) \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} v])
467             \textcolor{keywordflow}{else}:
468                 different\_opts[k] = v
469 
470     \textcolor{comment}{# search through opts to load}
471     \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} curr\_opt.items():
472         \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} exempt\_opts \textcolor{keywordflow}{and} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} init\_model\_opt:
473             \textcolor{keywordflow}{if} isinstance(v, list):
474                 extra\_opts[k] = \textcolor{stringliteral}{','}.join([\hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(x) \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} v])
475             \textcolor{keywordflow}{else}:
476                 extra\_opts[k] = v
477 
478     \textcolor{comment}{# print warnings}
479     extra\_strs = [\textcolor{stringliteral}{'\{\}: \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(k, v) \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} extra\_opts.items()]
480     \textcolor{keywordflow}{if} extra\_strs:
481         print(\textcolor{stringliteral}{'\(\backslash\)n'} + \textcolor{stringliteral}{'*'} * 75)
482         print(
483             \textcolor{stringliteral}{'[ WARNING ] : your model is being loaded with opts that do not '}
484             \textcolor{stringliteral}{'exist in the model you are initializing the weights with: '}
485             \textcolor{stringliteral}{'\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(\textcolor{stringliteral}{','}.join(extra\_strs))
486         )
487 
488     different\_strs = [
489         \textcolor{stringliteral}{'--\{\} \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(k, v).replace(\textcolor{stringliteral}{'\_'}, \textcolor{stringliteral}{'-'}) \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} different\_opts.items()
490     ]
491     \textcolor{keywordflow}{if} different\_strs:
492         print(\textcolor{stringliteral}{'\(\backslash\)n'} + \textcolor{stringliteral}{'*'} * 75)
493         print(
494             \textcolor{stringliteral}{'[ WARNING ] : your model is being loaded with opts that differ '}
495             \textcolor{stringliteral}{'from the model you are initializing the weights with. Add the '}
496             \textcolor{stringliteral}{'following args to your run command to change this: \(\backslash\)n'}
497             \textcolor{stringliteral}{'\(\backslash\)n\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(\textcolor{stringliteral}{' '}.join(different\_strs))
498         )
499         print(\textcolor{stringliteral}{'*'} * 75)
500 
501 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1agents_a00d77a7e26fb89e8bd900f7b2a02982a}\label{namespaceparlai_1_1core_1_1agents_a00d77a7e26fb89e8bd900f7b2a02982a}} 
\index{parlai\+::core\+::agents@{parlai\+::core\+::agents}!create\+\_\+agent@{create\+\_\+agent}}
\index{create\+\_\+agent@{create\+\_\+agent}!parlai\+::core\+::agents@{parlai\+::core\+::agents}}
\subsubsection{\texorpdfstring{create\+\_\+agent()}{create\_agent()}}
{\footnotesize\ttfamily def parlai.\+core.\+agents.\+create\+\_\+agent (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 588 of file agents.\+py.


\begin{DoxyCode}
588 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1agents_a00d77a7e26fb89e8bd900f7b2a02982a}{create\_agent}(opt: Opt, requireModelExists=\textcolor{keyword}{False}):
589     \textcolor{stringliteral}{"""}
590 \textcolor{stringliteral}{    Create an agent from the options ``model``, ``model\_params`` and ``model\_file``.}
591 \textcolor{stringliteral}{}
592 \textcolor{stringliteral}{    The input is either of the form}
593 \textcolor{stringliteral}{    ``parlai.agents.ir\_baseline.agents:IrBaselineAgent`` (i.e. the path}
594 \textcolor{stringliteral}{    followed by the class name) or else just ``ir\_baseline`` which}
595 \textcolor{stringliteral}{    assumes the path above, and a class name suffixed with 'Agent'.}
596 \textcolor{stringliteral}{}
597 \textcolor{stringliteral}{    If ``model-file`` is available in the options this function can also}
598 \textcolor{stringliteral}{    attempt to load the model from that location instead. This avoids having to}
599 \textcolor{stringliteral}{    specify all the other options necessary to set up the model including its}
600 \textcolor{stringliteral}{    name as they are all loaded from the options file if it exists (the file}
601 \textcolor{stringliteral}{    opt['model\_file'] + '.opt' must exist and contain a pickled or json dict}
602 \textcolor{stringliteral}{    containing the model's options).}
603 \textcolor{stringliteral}{    """}
604     \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'datapath'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
605         \textcolor{comment}{# add datapath, it is missing}
606         \textcolor{keyword}{from} \hyperlink{namespaceparlai_1_1core_1_1params}{parlai.core.params} \textcolor{keyword}{import} ParlaiParser, get\_model\_name
607 
608         parser = ParlaiParser(add\_parlai\_args=\textcolor{keyword}{False})
609         parser.add\_parlai\_data\_path()
610         \textcolor{comment}{# add model args if they are missing}
611         model = \hyperlink{namespaceparlai_1_1core_1_1params_a6d160324f6af84562334fd0698141074}{get\_model\_name}(opt)
612         \textcolor{keywordflow}{if} model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
613             parser.add\_model\_subargs(model)
614         opt\_parser = parser.parse\_args(\textcolor{stringliteral}{""}, print\_args=\textcolor{keyword}{False})
615         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} opt\_parser.items():
616             \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} opt:
617                 opt[k] = v
618 
619     \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'model\_file'}):
620         opt[\textcolor{stringliteral}{'model\_file'}] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_a5fbd3301b67f00d6d146fb01c7cd7626}{modelzoo\_path}(opt.get(\textcolor{stringliteral}{'datapath'}), opt[\textcolor{stringliteral}{'model\_file'}])
621         \textcolor{keywordflow}{if} requireModelExists \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} os.path.isfile(opt[\textcolor{stringliteral}{'model\_file'}]):
622             \textcolor{keywordflow}{raise} RuntimeError(
623                 \textcolor{stringliteral}{'WARNING: Model file does not exist, check to make '}
624                 \textcolor{stringliteral}{'sure it is correct: \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(opt[\textcolor{stringliteral}{'model\_file'}])
625             )
626         \textcolor{comment}{# Attempt to load the model from the model file first (this way we do}
627         \textcolor{comment}{# not even have to specify the model name as a parameter)}
628         model = \hyperlink{namespaceparlai_1_1core_1_1agents_a8dcf9aa8caf8fe1046ff4cac7f38b54c}{create\_agent\_from\_opt\_file}(opt)
629         \textcolor{keywordflow}{if} model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
630             \textcolor{keywordflow}{return} model
631         \textcolor{keywordflow}{else}:
632             print(f\textcolor{stringliteral}{"[ no model with opt yet at: \{opt['model\_file']\}(.opt) ]"})
633 
634     \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'model'}):
635         model\_class = \hyperlink{namespaceparlai_1_1core_1_1loader_a8e6a8f524cba24b80e9bd157c2e0ab8b}{load\_agent\_module}(opt[\textcolor{stringliteral}{'model'}])
636         \textcolor{comment}{# if we want to load weights from --init-model, compare opts with}
637         \textcolor{comment}{# loaded ones}
638         \hyperlink{namespaceparlai_1_1core_1_1agents_a9761bb2314603dd92f5eee786930b21a}{compare\_init\_model\_opts}(opt, opt)
639         model = model\_class(opt)
640         \textcolor{keywordflow}{if} requireModelExists \textcolor{keywordflow}{and} hasattr(model, \textcolor{stringliteral}{'load'}) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} opt.get(\textcolor{stringliteral}{'model\_file'}):
641             \textcolor{comment}{# double check that we didn't forget to set model\_file on loadable model}
642             print(\textcolor{stringliteral}{'WARNING: model\_file unset but model has a `load` function.'})
643         \textcolor{keywordflow}{return} model
644     \textcolor{keywordflow}{else}:
645         \textcolor{keywordflow}{raise} RuntimeError(\textcolor{stringliteral}{'Need to set `model` argument to use create\_agent.'})
646 
647 
648 \textcolor{comment}{# Helper functions to create agent/agents given shared parameters}
649 \textcolor{comment}{# returned from agent.share(). Useful for parallelism, sharing params, etc.}
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1agents_a8dcf9aa8caf8fe1046ff4cac7f38b54c}\label{namespaceparlai_1_1core_1_1agents_a8dcf9aa8caf8fe1046ff4cac7f38b54c}} 
\index{parlai\+::core\+::agents@{parlai\+::core\+::agents}!create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file@{create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file}}
\index{create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file@{create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file}!parlai\+::core\+::agents@{parlai\+::core\+::agents}}
\subsubsection{\texorpdfstring{create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file()}{create\_agent\_from\_opt\_file()}}
{\footnotesize\ttfamily def parlai.\+core.\+agents.\+create\+\_\+agent\+\_\+from\+\_\+opt\+\_\+file (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 502 of file agents.\+py.


\begin{DoxyCode}
502 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1agents_a8dcf9aa8caf8fe1046ff4cac7f38b54c}{create\_agent\_from\_opt\_file}(opt: Opt):
503     \textcolor{stringliteral}{"""}
504 \textcolor{stringliteral}{    Load agent options and module from file if opt file exists.}
505 \textcolor{stringliteral}{}
506 \textcolor{stringliteral}{    Checks to see if file exists opt['model\_file'] + ".opt"; if so, load up the}
507 \textcolor{stringliteral}{    options from the file and use that to create an agent, loading the model}
508 \textcolor{stringliteral}{    type from that file and overriding any options specified in that file when}
509 \textcolor{stringliteral}{    instantiating the agent.}
510 \textcolor{stringliteral}{}
511 \textcolor{stringliteral}{    If that file does not exist, return None.}
512 \textcolor{stringliteral}{    """}
513     model\_file = opt[\textcolor{stringliteral}{'model\_file'}]
514     optfile = model\_file + \textcolor{stringliteral}{'.opt'}
515     \textcolor{keywordflow}{if} os.path.isfile(optfile):
516         new\_opt = \hyperlink{namespaceparlai_1_1core_1_1opt_a37f4d5498e9174737b7dab37a786c04f}{load\_opt\_file}(optfile)
517         \textcolor{comment}{# TODO we need a better way to say these options are never copied...}
518         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'datapath'} \textcolor{keywordflow}{in} new\_opt:
519             \textcolor{comment}{# never use the datapath from an opt dump}
520             del new\_opt[\textcolor{stringliteral}{'datapath'}]
521         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'batchindex'} \textcolor{keywordflow}{in} new\_opt:
522             \textcolor{comment}{# This saved variable can cause trouble if we switch to BS=1 at test time}
523             del new\_opt[\textcolor{stringliteral}{'batchindex'}]
524         \textcolor{comment}{# only override opts specified in 'override' dict}
525         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'override'}):
526             \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'override'}].items():
527                 \textcolor{keywordflow}{if} \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(v) != \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(new\_opt.get(k, \textcolor{keywordtype}{None})):
528                     print(
529                         \textcolor{stringliteral}{"[ warning: overriding opt['\{\}'] to \{\} ("}
530                         \textcolor{stringliteral}{"previously: \{\} )]"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(k, v, new\_opt.get(k, \textcolor{keywordtype}{None}))
531                     )
532                 new\_opt[k] = v
533 
534         model\_class = \hyperlink{namespaceparlai_1_1core_1_1loader_a8e6a8f524cba24b80e9bd157c2e0ab8b}{load\_agent\_module}(new\_opt[\textcolor{stringliteral}{'model'}])
535 
536         \textcolor{comment}{# check for model version}
537         \textcolor{keywordflow}{if} hasattr(model\_class, \textcolor{stringliteral}{'model\_version'}):
538             curr\_version = new\_opt.get(\textcolor{stringliteral}{'model\_version'}, 0)
539             \textcolor{keywordflow}{if} curr\_version != model\_class.model\_version():
540                 model = new\_opt[\textcolor{stringliteral}{'model'}]
541                 m = (
542                     \textcolor{stringliteral}{'It looks like you are trying to load an older version of'}
543                     \textcolor{stringliteral}{' the selected model. Change your model argument to use '}
544                     \textcolor{stringliteral}{'the old version from parlai/agents/legacy\_agents: for '}
545                     \textcolor{stringliteral}{'example: `-m legacy:\{m\}:\{v\}` or '}
546                     \textcolor{stringliteral}{'`--model parlai.agents.legacy\_agents.\{m\}.\{m\}\_v\{v\}:\{c\}`'}
547                 )
548                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'.'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} model:
549                     \textcolor{comment}{# give specific error message if it's easy}
550                     \textcolor{keywordflow}{raise} RuntimeError(
551                         m.format(m=model, v=curr\_version, c=model\_class.\_\_name\_\_)
552                     )
553                 \textcolor{keywordflow}{else}:
554                     \textcolor{comment}{# otherwise generic one}
555                     \textcolor{keywordflow}{raise} RuntimeError(
556                         m.format(m=\textcolor{stringliteral}{'modelname'}, v=curr\_version, c=\textcolor{stringliteral}{'ModelAgent'})
557                     )
558 
559         \textcolor{keywordflow}{if} hasattr(model\_class, \textcolor{stringliteral}{'upgrade\_opt'}):
560             new\_opt = model\_class.upgrade\_opt(new\_opt)
561 
562         \textcolor{comment}{# add model arguments to new\_opt if they aren't in new\_opt already}
563         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} opt.items():
564             \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} new\_opt:
565                 new\_opt[k] = v
566         new\_opt[\textcolor{stringliteral}{'model\_file'}] = model\_file
567         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} new\_opt.get(\textcolor{stringliteral}{'dict\_file'}):
568             new\_opt[\textcolor{stringliteral}{'dict\_file'}] = model\_file + \textcolor{stringliteral}{'.dict'}
569         \textcolor{keywordflow}{elif} new\_opt.get(\textcolor{stringliteral}{'dict\_file'}) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} os.path.isfile(new\_opt[\textcolor{stringliteral}{'dict\_file'}]):
570             old\_dict\_file = new\_opt[\textcolor{stringliteral}{'dict\_file'}]
571             new\_opt[\textcolor{stringliteral}{'dict\_file'}] = model\_file + \textcolor{stringliteral}{'.dict'}
572         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.isfile(new\_opt[\textcolor{stringliteral}{'dict\_file'}]):
573             \hyperlink{namespaceparlai_1_1utils_1_1misc_a884a3aefa90581f53bc592fa6a78dc43}{warn\_once}(
574                 \textcolor{stringliteral}{'WARNING: Neither the specified dict file (\{\}) nor the '}
575                 \textcolor{stringliteral}{'`model\_file`.dict file (\{\}) exists, check to make sure either '}
576                 \textcolor{stringliteral}{'is correct. This may manifest as a shape mismatch later '}
577                 \textcolor{stringliteral}{'on.'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(old\_dict\_file, new\_opt[\textcolor{stringliteral}{'dict\_file'}])
578             )
579 
580         \textcolor{comment}{# if we want to load weights from --init-model, compare opts with}
581         \textcolor{comment}{# loaded ones}
582         \hyperlink{namespaceparlai_1_1core_1_1agents_a9761bb2314603dd92f5eee786930b21a}{compare\_init\_model\_opts}(opt, new\_opt)
583         \textcolor{keywordflow}{return} model\_class(new\_opt)
584     \textcolor{keywordflow}{else}:
585         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
586 
587 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1agents_aa5af5dd1d2f9da491b60348d479b849f}\label{namespaceparlai_1_1core_1_1agents_aa5af5dd1d2f9da491b60348d479b849f}} 
\index{parlai\+::core\+::agents@{parlai\+::core\+::agents}!create\+\_\+agent\+\_\+from\+\_\+shared@{create\+\_\+agent\+\_\+from\+\_\+shared}}
\index{create\+\_\+agent\+\_\+from\+\_\+shared@{create\+\_\+agent\+\_\+from\+\_\+shared}!parlai\+::core\+::agents@{parlai\+::core\+::agents}}
\subsubsection{\texorpdfstring{create\+\_\+agent\+\_\+from\+\_\+shared()}{create\_agent\_from\_shared()}}
{\footnotesize\ttfamily def parlai.\+core.\+agents.\+create\+\_\+agent\+\_\+from\+\_\+shared (\begin{DoxyParamCaption}\item[{}]{shared\+\_\+agent }\end{DoxyParamCaption})}

\begin{DoxyVerb}Instantiate an agent from the default `shared` params.

:param shared_agent:
    should include an `opt` dictionary and agent `class`, along with
    whatever other parameters the agent needs to instantiate.
\end{DoxyVerb}
 

Definition at line 650 of file agents.\+py.


\begin{DoxyCode}
650 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1agents_aa5af5dd1d2f9da491b60348d479b849f}{create\_agent\_from\_shared}(shared\_agent):
651     \textcolor{stringliteral}{"""}
652 \textcolor{stringliteral}{    Instantiate an agent from the default `shared` params.}
653 \textcolor{stringliteral}{}
654 \textcolor{stringliteral}{    :param shared\_agent:}
655 \textcolor{stringliteral}{        should include an `opt` dictionary and agent `class`, along with}
656 \textcolor{stringliteral}{        whatever other parameters the agent needs to instantiate.}
657 \textcolor{stringliteral}{    """}
658     opt = copy.deepcopy(shared\_agent[\textcolor{stringliteral}{'opt'}])
659     a = shared\_agent[\textcolor{stringliteral}{'class'}](opt, shared\_agent)
660     \textcolor{keywordflow}{return} a
661 
662 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1agents_a5600530545f5e60a79e2d657b5af1d8c}\label{namespaceparlai_1_1core_1_1agents_a5600530545f5e60a79e2d657b5af1d8c}} 
\index{parlai\+::core\+::agents@{parlai\+::core\+::agents}!create\+\_\+agents\+\_\+from\+\_\+shared@{create\+\_\+agents\+\_\+from\+\_\+shared}}
\index{create\+\_\+agents\+\_\+from\+\_\+shared@{create\+\_\+agents\+\_\+from\+\_\+shared}!parlai\+::core\+::agents@{parlai\+::core\+::agents}}
\subsubsection{\texorpdfstring{create\+\_\+agents\+\_\+from\+\_\+shared()}{create\_agents\_from\_shared()}}
{\footnotesize\ttfamily def parlai.\+core.\+agents.\+create\+\_\+agents\+\_\+from\+\_\+shared (\begin{DoxyParamCaption}\item[{}]{shared }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create agents based on shared data.

:param shared: `list` of `dict` objects created by calling e.g.
    [a.share() for a in agents].

Returns a list of instantiated agents.
\end{DoxyVerb}
 

Definition at line 663 of file agents.\+py.


\begin{DoxyCode}
663 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1agents_a5600530545f5e60a79e2d657b5af1d8c}{create\_agents\_from\_shared}(shared):
664     \textcolor{stringliteral}{"""}
665 \textcolor{stringliteral}{    Create agents based on shared data.}
666 \textcolor{stringliteral}{}
667 \textcolor{stringliteral}{    :param shared: `list` of `dict` objects created by calling e.g.}
668 \textcolor{stringliteral}{        [a.share() for a in agents].}
669 \textcolor{stringliteral}{}
670 \textcolor{stringliteral}{    Returns a list of instantiated agents.}
671 \textcolor{stringliteral}{    """}
672     shared\_agents = []
673     \textcolor{keywordflow}{for} shared\_agent \textcolor{keywordflow}{in} shared:
674         agent = \hyperlink{namespaceparlai_1_1core_1_1agents_aa5af5dd1d2f9da491b60348d479b849f}{create\_agent\_from\_shared}(shared\_agent)
675         shared\_agents.append(agent)
676     \textcolor{keywordflow}{return} shared\_agents
677 
678 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1core_1_1agents_a76269fb567532a8fb7f29edcc20a6e47}\label{namespaceparlai_1_1core_1_1agents_a76269fb567532a8fb7f29edcc20a6e47}} 
\index{parlai\+::core\+::agents@{parlai\+::core\+::agents}!create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname@{create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname}}
\index{create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname@{create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname}!parlai\+::core\+::agents@{parlai\+::core\+::agents}}
\subsubsection{\texorpdfstring{create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname()}{create\_task\_agent\_from\_taskname()}}
{\footnotesize\ttfamily def parlai.\+core.\+agents.\+create\+\_\+task\+\_\+agent\+\_\+from\+\_\+taskname (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 696 of file agents.\+py.


\begin{DoxyCode}
696 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1core_1_1agents_a76269fb567532a8fb7f29edcc20a6e47}{create\_task\_agent\_from\_taskname}(opt: Opt):
697     \textcolor{stringliteral}{"""}
698 \textcolor{stringliteral}{    Create task agent(s) assuming the input ``task\_dir:teacher\_class``.}
699 \textcolor{stringliteral}{}
700 \textcolor{stringliteral}{    e.g. def\_string is a shorthand path like ``babi:Task1k:1`` or ``#babi`` or a}
701 \textcolor{stringliteral}{    complete path like ``parlai.tasks.babi.agents:Task1kTeacher:1``, which essentially}
702 \textcolor{stringliteral}{    performs ``from parlai.tasks.babi import Task1kTeacher`` with the parameter ``1`` in}
703 \textcolor{stringliteral}{    ``opt['task']`` to be used by the class ``Task1kTeacher``.}
704 \textcolor{stringliteral}{    """}
705     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} (
706         opt.get(\textcolor{stringliteral}{'task'})
707         \textcolor{keywordflow}{or} opt.get(\textcolor{stringliteral}{'pytorch\_teacher\_task'})
708         \textcolor{keywordflow}{or} opt.get(\textcolor{stringliteral}{'pytorch\_teacher\_dataset'})
709     ):
710         \textcolor{keywordflow}{raise} RuntimeError(
711             \textcolor{stringliteral}{'No task specified. Please select a task with '} + \textcolor{stringliteral}{'--task \{task\_name\}.'}
712         )
713     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} opt.get(\textcolor{stringliteral}{'task'}):
714         opt[\textcolor{stringliteral}{'task'}] = \textcolor{stringliteral}{'pytorch\_teacher'}
715     \textcolor{keywordflow}{if} \textcolor{stringliteral}{','} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'task'}]:
716         \textcolor{comment}{# Single task}
717         teacher\_class = \hyperlink{namespaceparlai_1_1core_1_1loader_a9eed9fa0f15170da9d4de24c2c3d4e2a}{load\_teacher\_module}(opt[\textcolor{stringliteral}{'task'}])
718         \_add\_task\_flags\_to\_agent\_opt(teacher\_class, opt, opt[\textcolor{stringliteral}{'task'}])
719         task\_agents = teacher\_class(opt)
720         \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(task\_agents) != list:
721             task\_agents = [task\_agents]
722         \textcolor{keywordflow}{return} task\_agents
723     \textcolor{keywordflow}{else}:
724         \textcolor{comment}{# Multitask teacher/agent}
725         task\_agents = MultiTaskTeacher(opt)
726         \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(task\_agents) != list:
727             task\_agents = [task\_agents]
728         \textcolor{keywordflow}{return} task\_agents
729 \end{DoxyCode}
