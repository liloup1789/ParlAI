\hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent}{}\section{projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent Class Reference}
\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent}\index{projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent@{projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent}}


Inheritance diagram for projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{d1/d37/classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=318pt]{db/de1/classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ae3b4c4f4ef8e39b2a4ceac21bfbcb7d6}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1core_1_1torch__agent_1_1TorchAgent_a785bb920cf8c8afc3e9bf6a8b77e335a}{opt}, shared=None)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a68e719b6f68178e5bc3c26f6677fe152}{compute\+\_\+loss} (self, batch, return\+\_\+output=False)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a6c75fa85fe522f4e5e0c35b3db5dfebc}{reset\+\_\+metrics} (self)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad5961a34fbea934bf2298c77ac220571}{report} (self)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a66886694fb06a243c783d2b7902b46bb}{batchify} (self, obs\+\_\+batch)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad602e5c8fc8c07391faa8730b665eb7c}{add\+\_\+cmdline\+\_\+args} (cls, argparser)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a490f03b728556a5c89b86851ff81255d}{build\+\_\+model} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a4896f62ea9365cdc1a1de560be6a53c4}{knowledge\+\_\+truncate}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a83c844ac99f2a0dd37422e3c08477dd4}{max\+\_\+knowledge}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_aedbbe969af864f628e3b918b144eef7a}{knowledge\+\_\+alpha}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a9d99aa0740cb7d473e15dfd287122e92}{model}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 97 of file agents.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ae3b4c4f4ef8e39b2a4ceac21bfbcb7d6}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ae3b4c4f4ef8e39b2a4ceac21bfbcb7d6}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 98 of file agents.\+py.


\begin{DoxyCode}
98     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
99         super().\_\_init\_\_(opt, shared)
100         self.\_vectorize\_text = lru\_cache(\hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(2 ** 20))(self.\_vectorize\_text)
101 
102         \textcolor{comment}{# knowledge truncate defaults to the same as --truncate}
103         self.knowledge\_truncate = opt.get(\textcolor{stringliteral}{'knowledge\_truncate'})
104         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.knowledge\_truncate:
105             self.knowledge\_truncate = opt[\textcolor{stringliteral}{'truncate'}]
106         self.max\_knowledge = opt.get(\textcolor{stringliteral}{'max\_knowledge'})
107         self.knowledge\_alpha = opt[\textcolor{stringliteral}{'knowledge\_alpha'}]
108 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad602e5c8fc8c07391faa8730b665eb7c}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad602e5c8fc8c07391faa8730b665eb7c}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{cls,  }\item[{}]{argparser }\end{DoxyParamCaption})}



Definition at line 285 of file agents.\+py.


\begin{DoxyCode}
285     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(cls, argparser):
286         super(EndToEndAgent, cls).\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser)
287         group = argparser.add\_argument\_group(\textcolor{stringliteral}{"EndToEnd Agent"})
288         group.add\_argument(
289             \textcolor{stringliteral}{'--knowledge-alpha'},
290             type=float,
291             default=0.95,
292             help=\textcolor{stringliteral}{'Weight on the knowledge-attn loss'},
293         )
294         group.add\_argument(
295             \textcolor{stringliteral}{'--knowledge-truncate'},
296             type=int,
297             default=32,
298             help=\textcolor{stringliteral}{'Knowledge truncation field. Defaults to same as --truncate.'},
299         )
300         group.add\_argument(
301             \textcolor{stringliteral}{'--max-knowledge'},
302             type=int,
303             help=\textcolor{stringliteral}{'Reduce the amount of negative knowledge at train time.'},
304         )
305         argparser.add\_argument(
306             \textcolor{stringliteral}{'--knowledge-alpha'},
307             type=float,
308             default=0.95,
309             help=\textcolor{stringliteral}{'Weight on the knowledge-attn loss'},
310         )
311 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a66886694fb06a243c783d2b7902b46bb}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a66886694fb06a243c783d2b7902b46bb}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!batchify@{batchify}}
\index{batchify@{batchify}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{batchify()}{batchify()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+batchify (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs\+\_\+batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Wizard custom batchify, which passes along the knowledge/title.

Following the docstring of TorchAgent.batchify, it calls super, then
uses an extended version of the torch_agent.Batch namedtuple.

The purpose of extending the info is to keep track of some custom
metrics.
\end{DoxyVerb}
 

Definition at line 202 of file agents.\+py.


\begin{DoxyCode}
202     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_aca22dd97c5b6dcda2a7479c1cb22ef1e}{batchify}(self, obs\_batch):
203         \textcolor{stringliteral}{"""}
204 \textcolor{stringliteral}{        Wizard custom batchify, which passes along the knowledge/title.}
205 \textcolor{stringliteral}{}
206 \textcolor{stringliteral}{        Following the docstring of TorchAgent.batchify, it calls super, then}
207 \textcolor{stringliteral}{        uses an extended version of the torch\_agent.Batch namedtuple.}
208 \textcolor{stringliteral}{}
209 \textcolor{stringliteral}{        The purpose of extending the info is to keep track of some custom}
210 \textcolor{stringliteral}{        metrics.}
211 \textcolor{stringliteral}{        """}
212         batch = super().\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_aca22dd97c5b6dcda2a7479c1cb22ef1e}{batchify}(obs\_batch)
213         reordered\_observations = [obs\_batch[i] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} batch.valid\_indices]
214         is\_training = \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} reordered\_observations[0]
215 
216         \textcolor{comment}{# first parse and compile all the knowledge together}
217         all\_knowledges = []  \textcolor{comment}{# list-of-lists knowledge items for each observation}
218         knowledge\_counts = []  \textcolor{comment}{# how much knowledge each observation gets}
219         \textcolor{keywordflow}{for} obs \textcolor{keywordflow}{in} reordered\_observations:
220             obs\_know = self.\_parse\_knowledge(obs)
221             \textcolor{comment}{# downsample if desired}
222             \textcolor{keywordflow}{if} (
223                 is\_training
224                 \textcolor{keywordflow}{and} self.max\_knowledge
225                 \textcolor{keywordflow}{and} len(obs\_know) > self.max\_knowledge
226             ):
227                 \textcolor{comment}{# offset by one so that we don't choose 0}
228                 keepers = 1 + np.random.choice(
229                     len(obs\_know) - 1, self.max\_knowledge, \textcolor{keyword}{False}
230                 )
231                 \textcolor{comment}{# correct answer is always the first one}
232                 keepers[0] = 0
233                 obs\_know = [obs\_know[i] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} keepers]
234             all\_knowledges.append(obs\_know)
235             knowledge\_counts.append(len(obs\_know))
236 
237         \textcolor{comment}{# now we want to actually pack this into a tensor, along with the mask}
238         N = len(reordered\_observations)
239         K = max(knowledge\_counts)
240         \textcolor{comment}{# round out the array so everything is equally sized}
241         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(N):
242             all\_knowledges[i] += [\textcolor{stringliteral}{''}] * (K - knowledge\_counts[i])
243         flattened\_knowledge = list(chain(*all\_knowledges))
244 
245         knowledge\_vec = [
246             self.\_vectorize\_text(
247                 \textcolor{comment}{# the beginning of the sentence is more useful}
248                 k,
249                 truncate=self.knowledge\_truncate,
250                 add\_end=\textcolor{keyword}{True},
251                 truncate\_left=\textcolor{keyword}{False},
252             )
253             \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} flattened\_knowledge
254         ]
255         knowledge\_vec, \_ = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1_adb5a414ae439f14c54e8c760b91cc4c8}{padded\_tensor}(
256             knowledge\_vec, self.NULL\_IDX, self.use\_cuda, left\_padded=\textcolor{keyword}{True}
257         )
258         knowledge\_vec[:, -1] = self.END\_IDX
259         T = knowledge\_vec.size(-1)
260         knowledge\_vec = knowledge\_vec.view(N, K, T)
261 
262         \textcolor{comment}{# knowledge mask is a N x K tensor saying which items we're allowed to}
263         \textcolor{comment}{# attend over}
264         bsz = len(reordered\_observations)
265         ck\_mask = th.zeros(bsz, K, dtype=th.uint8)
266         \textcolor{keywordflow}{for} i, klen \textcolor{keywordflow}{in} enumerate(knowledge\_counts):
267             ck\_mask[i, :klen] = 1
268         ck\_mask = ck\_mask != 0  \textcolor{comment}{# for pytorch 1.0/1.2 uint8/bool compatibility}
269         \textcolor{comment}{# and the correct labels}
270         cs\_ids = th.LongTensor(bsz).zero\_()
271 
272         \textcolor{keywordflow}{if} self.use\_cuda:
273             knowledge\_vec = knowledge\_vec.cuda()
274             ck\_mask = ck\_mask.cuda()
275             cs\_ids = cs\_ids.cuda()
276 
277         batch[\textcolor{stringliteral}{'know\_vec'}] = knowledge\_vec
278         batch[\textcolor{stringliteral}{'ck\_mask'}] = ck\_mask
279         batch[\textcolor{stringliteral}{'cs\_ids'}] = cs\_ids
280         batch[\textcolor{stringliteral}{'use\_cs\_ids'}] = is\_training
281         batch[\textcolor{stringliteral}{'knowledge'}] = np.array(flattened\_knowledge).reshape(N, K)
282         \textcolor{keywordflow}{return} batch
283 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a490f03b728556a5c89b86851ff81255d}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a490f03b728556a5c89b86851ff81255d}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!build\+\_\+model@{build\+\_\+model}}
\index{build\+\_\+model@{build\+\_\+model}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{build\+\_\+model()}{build\_model()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+build\+\_\+model (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 321 of file agents.\+py.


\begin{DoxyCode}
321     \textcolor{keyword}{def }build\_model(self):
322         self.model = EndToEndModel(self.opt, self.dict)
323         \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'embedding\_type'}] != \textcolor{stringliteral}{'random'}:
324             self.\_copy\_embeddings(
325                 self.model.embeddings.weight, self.opt[\textcolor{stringliteral}{'embedding\_type'}]
326             )
327         \textcolor{keywordflow}{if} self.use\_cuda:
328             self.model = self.model.cuda()
329         \textcolor{keywordflow}{return} self.model
330 \end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a68e719b6f68178e5bc3c26f6677fe152}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a68e719b6f68178e5bc3c26f6677fe152}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!compute\+\_\+loss@{compute\+\_\+loss}}
\index{compute\+\_\+loss@{compute\+\_\+loss}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{compute\+\_\+loss()}{compute\_loss()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+compute\+\_\+loss (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch,  }\item[{}]{return\+\_\+output = {\ttfamily False} }\end{DoxyParamCaption})}



Definition at line 119 of file agents.\+py.


\begin{DoxyCode}
119     \textcolor{keyword}{def }compute\_loss(self, batch, return\_output=False):
120         \textcolor{comment}{# first compute our regular forced decoding loss}
121         token\_loss, model\_output = super().compute\_loss(batch, return\_output=\textcolor{keyword}{True})
122         notnull = batch.label\_vec.ne(self.NULL\_IDX)
123         num\_tokens = notnull.long().sum().item()
124 
125         encoder\_states = model\_output[2]
126         ctx\_know\_attn = encoder\_states[2]
127 
128         \textcolor{keywordflow}{if} self.knowledge\_alpha == 0.0:
129             loss = token\_loss
130         \textcolor{keywordflow}{else}:
131             \_, know\_pred = ctx\_know\_attn.max(1)
132             know\_acc = (know\_pred == batch.cs\_ids).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().sum().item()
133             know\_chance = batch.ck\_mask.sum(1).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().reciprocal().sum().item()
134             self.metrics[\textcolor{stringliteral}{'know\_chance'}] += know\_chance
135             self.metrics[\textcolor{stringliteral}{'bsz'}] += batch.text\_vec.size(0)
136             self.metrics[\textcolor{stringliteral}{'know\_acc'}] += know\_acc
137             know\_loss = th.nn.functional.cross\_entropy(
138                 ctx\_know\_attn, batch.cs\_ids, reduction=\textcolor{stringliteral}{'mean'}
139             )
140             self.metrics[\textcolor{stringliteral}{'know\_loss'}] += know\_loss.item() * batch.text\_vec.size(0)
141             \textcolor{comment}{# in the original paper the loss was scaled by num\_tokens for both}
142             \textcolor{comment}{# know\_loss and token\_loss}
143             know\_loss /= num\_tokens
144             loss = (
145                 1 - self.knowledge\_alpha
146             ) * token\_loss + self.knowledge\_alpha * know\_loss
147         \textcolor{keywordflow}{if} return\_output:
148             \textcolor{keywordflow}{return} (loss, model\_output)
149         \textcolor{keywordflow}{else}:
150             \textcolor{keywordflow}{return} loss
151 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad5961a34fbea934bf2298c77ac220571}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad5961a34fbea934bf2298c77ac220571}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!report@{report}}
\index{report@{report}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{report()}{report()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+report (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 159 of file agents.\+py.


\begin{DoxyCode}
159     \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}(self):
160         r = super().\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}()
161         bsz = max(self.metrics[\textcolor{stringliteral}{'bsz'}], 1)
162         \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'know\_loss'}, \textcolor{stringliteral}{'know\_acc'}, \textcolor{stringliteral}{'know\_chance'}]:
163             \textcolor{comment}{# round and average across all items since last report}
164             r[k] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(self.metrics[k] / bsz, 4)
165         \textcolor{keywordflow}{return} r
166 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a6c75fa85fe522f4e5e0c35b3db5dfebc}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a6c75fa85fe522f4e5e0c35b3db5dfebc}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!reset\+\_\+metrics@{reset\+\_\+metrics}}
\index{reset\+\_\+metrics@{reset\+\_\+metrics}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{reset\+\_\+metrics()}{reset\_metrics()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+reset\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 152 of file agents.\+py.


\begin{DoxyCode}
152     \textcolor{keyword}{def }reset\_metrics(self):
153         super().reset\_metrics()
154         self.metrics[\textcolor{stringliteral}{'bsz'}] = 0.0
155         self.metrics[\textcolor{stringliteral}{'know\_acc'}] = 0.0
156         self.metrics[\textcolor{stringliteral}{'know\_loss'}] = 0.0
157         self.metrics[\textcolor{stringliteral}{'know\_chance'}] = 0.0
158 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_aedbbe969af864f628e3b918b144eef7a}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_aedbbe969af864f628e3b918b144eef7a}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!knowledge\+\_\+alpha@{knowledge\+\_\+alpha}}
\index{knowledge\+\_\+alpha@{knowledge\+\_\+alpha}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{knowledge\+\_\+alpha}{knowledge\_alpha}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+knowledge\+\_\+alpha}



Definition at line 107 of file agents.\+py.

\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a4896f62ea9365cdc1a1de560be6a53c4}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a4896f62ea9365cdc1a1de560be6a53c4}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!knowledge\+\_\+truncate@{knowledge\+\_\+truncate}}
\index{knowledge\+\_\+truncate@{knowledge\+\_\+truncate}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{knowledge\+\_\+truncate}{knowledge\_truncate}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+knowledge\+\_\+truncate}



Definition at line 103 of file agents.\+py.

\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a83c844ac99f2a0dd37422e3c08477dd4}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a83c844ac99f2a0dd37422e3c08477dd4}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!max\+\_\+knowledge@{max\+\_\+knowledge}}
\index{max\+\_\+knowledge@{max\+\_\+knowledge}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{max\+\_\+knowledge}{max\_knowledge}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+max\+\_\+knowledge}



Definition at line 106 of file agents.\+py.

\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a9d99aa0740cb7d473e15dfd287122e92}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a9d99aa0740cb7d473e15dfd287122e92}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!model@{model}}
\index{model@{model}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+model}



Definition at line 322 of file agents.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/wizard\+\_\+of\+\_\+wikipedia/generator/\hyperlink{projects_2wizard__of__wikipedia_2generator_2agents_8py}{agents.\+py}\end{DoxyCompactItemize}
