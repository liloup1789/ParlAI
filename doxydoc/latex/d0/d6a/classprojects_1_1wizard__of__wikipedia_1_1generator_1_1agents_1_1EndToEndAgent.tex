\hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent}{}\section{projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent Class Reference}
\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent}\index{projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent@{projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent}}


Inheritance diagram for projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{d1/d37/classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{db/de1/classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ae3b4c4f4ef8e39b2a4ceac21bfbcb7d6}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1core_1_1torch__agent_1_1TorchAgent_a785bb920cf8c8afc3e9bf6a8b77e335a}{opt}, shared=None)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a68e719b6f68178e5bc3c26f6677fe152}{compute\+\_\+loss} (self, batch, return\+\_\+output=False)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a6c75fa85fe522f4e5e0c35b3db5dfebc}{reset\+\_\+metrics} (self)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad5961a34fbea934bf2298c77ac220571}{report} (self)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a66886694fb06a243c783d2b7902b46bb}{batchify} (self, obs\+\_\+batch)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad602e5c8fc8c07391faa8730b665eb7c}{add\+\_\+cmdline\+\_\+args} (cls, argparser)
\item 
def \hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a490f03b728556a5c89b86851ff81255d}{build\+\_\+model} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a4896f62ea9365cdc1a1de560be6a53c4}{knowledge\+\_\+truncate}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a83c844ac99f2a0dd37422e3c08477dd4}{max\+\_\+knowledge}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_aedbbe969af864f628e3b918b144eef7a}{knowledge\+\_\+alpha}
\item 
\hyperlink{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a9d99aa0740cb7d473e15dfd287122e92}{model}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}


Definition at line 99 of file agents.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ae3b4c4f4ef8e39b2a4ceac21bfbcb7d6}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ae3b4c4f4ef8e39b2a4ceac21bfbcb7d6}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 100 of file agents.\+py.


\begin{DoxyCode}
100     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
101         super().\_\_init\_\_(opt, shared)
102         self.\_vectorize\_text = lru\_cache(\hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(2 ** 20))(self.\_vectorize\_text)
103 
104         \textcolor{comment}{# knowledge truncate defaults to the same as --truncate}
105         self.knowledge\_truncate = opt.get(\textcolor{stringliteral}{'knowledge\_truncate'})
106         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.knowledge\_truncate:
107             self.knowledge\_truncate = opt[\textcolor{stringliteral}{'truncate'}]
108         self.max\_knowledge = opt.get(\textcolor{stringliteral}{'max\_knowledge'})
109         self.knowledge\_alpha = opt[\textcolor{stringliteral}{'knowledge\_alpha'}]
110 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad602e5c8fc8c07391faa8730b665eb7c}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad602e5c8fc8c07391faa8730b665eb7c}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{cls,  }\item[{}]{argparser }\end{DoxyParamCaption})}



Definition at line 287 of file agents.\+py.


\begin{DoxyCode}
287     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(cls, argparser):
288         super(EndToEndAgent, cls).\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser)
289         group = argparser.add\_argument\_group(\textcolor{stringliteral}{"EndToEnd Agent"})
290         group.add\_argument(
291             \textcolor{stringliteral}{'--knowledge-alpha'},
292             type=float,
293             default=0.95,
294             help=\textcolor{stringliteral}{'Weight on the knowledge-attn loss'},
295         )
296         group.add\_argument(
297             \textcolor{stringliteral}{'--knowledge-truncate'},
298             type=int,
299             default=32,
300             help=\textcolor{stringliteral}{'Knowledge truncation field. Defaults to same as --truncate.'},
301         )
302         group.add\_argument(
303             \textcolor{stringliteral}{'--max-knowledge'},
304             type=int,
305             help=\textcolor{stringliteral}{'Reduce the amount of negative knowledge at train time.'},
306         )
307         argparser.add\_argument(
308             \textcolor{stringliteral}{'--knowledge-alpha'},
309             type=float,
310             default=0.95,
311             help=\textcolor{stringliteral}{'Weight on the knowledge-attn loss'},
312         )
313 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a66886694fb06a243c783d2b7902b46bb}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a66886694fb06a243c783d2b7902b46bb}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!batchify@{batchify}}
\index{batchify@{batchify}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{batchify()}{batchify()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+batchify (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs\+\_\+batch }\end{DoxyParamCaption})}

\begin{DoxyVerb}Wizard custom batchify, which passes along the knowledge/title.

Following the docstring of TorchAgent.batchify, it calls super, then
uses an extended version of the torch_agent.Batch namedtuple.

The purpose of extending the info is to keep track of some custom
metrics.
\end{DoxyVerb}
 

Definition at line 204 of file agents.\+py.


\begin{DoxyCode}
204     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_aca22dd97c5b6dcda2a7479c1cb22ef1e}{batchify}(self, obs\_batch):
205         \textcolor{stringliteral}{"""}
206 \textcolor{stringliteral}{        Wizard custom batchify, which passes along the knowledge/title.}
207 \textcolor{stringliteral}{}
208 \textcolor{stringliteral}{        Following the docstring of TorchAgent.batchify, it calls super, then}
209 \textcolor{stringliteral}{        uses an extended version of the torch\_agent.Batch namedtuple.}
210 \textcolor{stringliteral}{}
211 \textcolor{stringliteral}{        The purpose of extending the info is to keep track of some custom}
212 \textcolor{stringliteral}{        metrics.}
213 \textcolor{stringliteral}{        """}
214         batch = super().\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_aca22dd97c5b6dcda2a7479c1cb22ef1e}{batchify}(obs\_batch)
215         reordered\_observations = [obs\_batch[i] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} batch.valid\_indices]
216         is\_training = \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} reordered\_observations[0]
217 
218         \textcolor{comment}{# first parse and compile all the knowledge together}
219         all\_knowledges = []  \textcolor{comment}{# list-of-lists knowledge items for each observation}
220         knowledge\_counts = []  \textcolor{comment}{# how much knowledge each observation gets}
221         \textcolor{keywordflow}{for} obs \textcolor{keywordflow}{in} reordered\_observations:
222             obs\_know = self.\_parse\_knowledge(obs)
223             \textcolor{comment}{# downsample if desired}
224             \textcolor{keywordflow}{if} (
225                 is\_training
226                 \textcolor{keywordflow}{and} self.max\_knowledge
227                 \textcolor{keywordflow}{and} len(obs\_know) > self.max\_knowledge
228             ):
229                 \textcolor{comment}{# offset by one so that we don't choose 0}
230                 keepers = 1 + np.random.choice(
231                     len(obs\_know) - 1, self.max\_knowledge, \textcolor{keyword}{False}
232                 )
233                 \textcolor{comment}{# correct answer is always the first one}
234                 keepers[0] = 0
235                 obs\_know = [obs\_know[i] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} keepers]
236             all\_knowledges.append(obs\_know)
237             knowledge\_counts.append(len(obs\_know))
238 
239         \textcolor{comment}{# now we want to actually pack this into a tensor, along with the mask}
240         N = len(reordered\_observations)
241         K = max(knowledge\_counts)
242         \textcolor{comment}{# round out the array so everything is equally sized}
243         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(N):
244             all\_knowledges[i] += [\textcolor{stringliteral}{''}] * (K - knowledge\_counts[i])
245         flattened\_knowledge = list(chain(*all\_knowledges))
246 
247         knowledge\_vec = [
248             self.\_vectorize\_text(
249                 \textcolor{comment}{# the beginning of the sentence is more useful}
250                 k,
251                 truncate=self.knowledge\_truncate,
252                 add\_end=\textcolor{keyword}{True},
253                 truncate\_left=\textcolor{keyword}{False},
254             )
255             \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} flattened\_knowledge
256         ]
257         knowledge\_vec, \_ = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v1_adb5a414ae439f14c54e8c760b91cc4c8}{padded\_tensor}(
258             knowledge\_vec, self.NULL\_IDX, self.use\_cuda, left\_padded=\textcolor{keyword}{True}
259         )
260         knowledge\_vec[:, -1] = self.END\_IDX
261         T = knowledge\_vec.size(-1)
262         knowledge\_vec = knowledge\_vec.view(N, K, T)
263 
264         \textcolor{comment}{# knowledge mask is a N x K tensor saying which items we're allowed to}
265         \textcolor{comment}{# attend over}
266         bsz = len(reordered\_observations)
267         ck\_mask = th.zeros(bsz, K, dtype=th.uint8)
268         \textcolor{keywordflow}{for} i, klen \textcolor{keywordflow}{in} enumerate(knowledge\_counts):
269             ck\_mask[i, :klen] = 1
270         ck\_mask = ck\_mask != 0  \textcolor{comment}{# for pytorch 1.0/1.2 uint8/bool compatibility}
271         \textcolor{comment}{# and the correct labels}
272         cs\_ids = th.LongTensor(bsz).zero\_()
273 
274         \textcolor{keywordflow}{if} self.use\_cuda:
275             knowledge\_vec = knowledge\_vec.cuda()
276             ck\_mask = ck\_mask.cuda()
277             cs\_ids = cs\_ids.cuda()
278 
279         batch[\textcolor{stringliteral}{'know\_vec'}] = knowledge\_vec
280         batch[\textcolor{stringliteral}{'ck\_mask'}] = ck\_mask
281         batch[\textcolor{stringliteral}{'cs\_ids'}] = cs\_ids
282         batch[\textcolor{stringliteral}{'use\_cs\_ids'}] = is\_training
283         batch[\textcolor{stringliteral}{'knowledge'}] = np.array(flattened\_knowledge).reshape(N, K)
284         \textcolor{keywordflow}{return} batch
285 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a490f03b728556a5c89b86851ff81255d}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a490f03b728556a5c89b86851ff81255d}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!build\+\_\+model@{build\+\_\+model}}
\index{build\+\_\+model@{build\+\_\+model}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{build\+\_\+model()}{build\_model()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+build\+\_\+model (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 323 of file agents.\+py.


\begin{DoxyCode}
323     \textcolor{keyword}{def }build\_model(self):
324         self.model = EndToEndModel(self.opt, self.dict)
325         \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'embedding\_type'}] != \textcolor{stringliteral}{'random'}:
326             self.\_copy\_embeddings(
327                 self.model.embeddings.weight, self.opt[\textcolor{stringliteral}{'embedding\_type'}]
328             )
329         \textcolor{keywordflow}{if} self.use\_cuda:
330             self.model = self.model.cuda()
331         \textcolor{keywordflow}{return} self.model
332 \end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a68e719b6f68178e5bc3c26f6677fe152}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a68e719b6f68178e5bc3c26f6677fe152}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!compute\+\_\+loss@{compute\+\_\+loss}}
\index{compute\+\_\+loss@{compute\+\_\+loss}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{compute\+\_\+loss()}{compute\_loss()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+compute\+\_\+loss (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batch,  }\item[{}]{return\+\_\+output = {\ttfamily False} }\end{DoxyParamCaption})}



Definition at line 121 of file agents.\+py.


\begin{DoxyCode}
121     \textcolor{keyword}{def }compute\_loss(self, batch, return\_output=False):
122         \textcolor{comment}{# first compute our regular forced decoding loss}
123         token\_loss, model\_output = super().compute\_loss(batch, return\_output=\textcolor{keyword}{True})
124         notnull = batch.label\_vec.ne(self.NULL\_IDX)
125         num\_tokens = notnull.long().sum().item()
126 
127         encoder\_states = model\_output[2]
128         ctx\_know\_attn = encoder\_states[2]
129 
130         \textcolor{keywordflow}{if} self.knowledge\_alpha == 0.0:
131             loss = token\_loss
132         \textcolor{keywordflow}{else}:
133             \_, know\_pred = ctx\_know\_attn.max(1)
134             know\_acc = (know\_pred == batch.cs\_ids).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().sum().item()
135             know\_chance = batch.ck\_mask.sum(1).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().reciprocal().sum().item()
136             self.metrics[\textcolor{stringliteral}{'know\_chance'}] += know\_chance
137             self.metrics[\textcolor{stringliteral}{'bsz'}] += batch.text\_vec.size(0)
138             self.metrics[\textcolor{stringliteral}{'know\_acc'}] += know\_acc
139             know\_loss = th.nn.functional.cross\_entropy(
140                 ctx\_know\_attn, batch.cs\_ids, reduction=\textcolor{stringliteral}{'mean'}
141             )
142             self.metrics[\textcolor{stringliteral}{'know\_loss'}] += know\_loss.item() * batch.text\_vec.size(0)
143             \textcolor{comment}{# in the original paper the loss was scaled by num\_tokens for both}
144             \textcolor{comment}{# know\_loss and token\_loss}
145             know\_loss /= num\_tokens
146             loss = (
147                 1 - self.knowledge\_alpha
148             ) * token\_loss + self.knowledge\_alpha * know\_loss
149         \textcolor{keywordflow}{if} return\_output:
150             \textcolor{keywordflow}{return} (loss, model\_output)
151         \textcolor{keywordflow}{else}:
152             \textcolor{keywordflow}{return} loss
153 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad5961a34fbea934bf2298c77ac220571}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_ad5961a34fbea934bf2298c77ac220571}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!report@{report}}
\index{report@{report}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{report()}{report()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+report (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 161 of file agents.\+py.


\begin{DoxyCode}
161     \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}(self):
162         r = super().\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}()
163         bsz = max(self.metrics[\textcolor{stringliteral}{'bsz'}], 1)
164         \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'know\_loss'}, \textcolor{stringliteral}{'know\_acc'}, \textcolor{stringliteral}{'know\_chance'}]:
165             \textcolor{comment}{# round and average across all items since last report}
166             r[k] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(self.metrics[k] / bsz, 4)
167         \textcolor{keywordflow}{return} r
168 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a6c75fa85fe522f4e5e0c35b3db5dfebc}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a6c75fa85fe522f4e5e0c35b3db5dfebc}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!reset\+\_\+metrics@{reset\+\_\+metrics}}
\index{reset\+\_\+metrics@{reset\+\_\+metrics}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{reset\+\_\+metrics()}{reset\_metrics()}}
{\footnotesize\ttfamily def projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+reset\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 154 of file agents.\+py.


\begin{DoxyCode}
154     \textcolor{keyword}{def }reset\_metrics(self):
155         super().reset\_metrics()
156         self.metrics[\textcolor{stringliteral}{'bsz'}] = 0.0
157         self.metrics[\textcolor{stringliteral}{'know\_acc'}] = 0.0
158         self.metrics[\textcolor{stringliteral}{'know\_loss'}] = 0.0
159         self.metrics[\textcolor{stringliteral}{'know\_chance'}] = 0.0
160 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_aedbbe969af864f628e3b918b144eef7a}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_aedbbe969af864f628e3b918b144eef7a}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!knowledge\+\_\+alpha@{knowledge\+\_\+alpha}}
\index{knowledge\+\_\+alpha@{knowledge\+\_\+alpha}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{knowledge\+\_\+alpha}{knowledge\_alpha}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+knowledge\+\_\+alpha}



Definition at line 109 of file agents.\+py.

\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a4896f62ea9365cdc1a1de560be6a53c4}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a4896f62ea9365cdc1a1de560be6a53c4}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!knowledge\+\_\+truncate@{knowledge\+\_\+truncate}}
\index{knowledge\+\_\+truncate@{knowledge\+\_\+truncate}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{knowledge\+\_\+truncate}{knowledge\_truncate}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+knowledge\+\_\+truncate}



Definition at line 105 of file agents.\+py.

\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a83c844ac99f2a0dd37422e3c08477dd4}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a83c844ac99f2a0dd37422e3c08477dd4}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!max\+\_\+knowledge@{max\+\_\+knowledge}}
\index{max\+\_\+knowledge@{max\+\_\+knowledge}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{max\+\_\+knowledge}{max\_knowledge}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+max\+\_\+knowledge}



Definition at line 108 of file agents.\+py.

\mbox{\Hypertarget{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a9d99aa0740cb7d473e15dfd287122e92}\label{classprojects_1_1wizard__of__wikipedia_1_1generator_1_1agents_1_1EndToEndAgent_a9d99aa0740cb7d473e15dfd287122e92}} 
\index{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}!model@{model}}
\index{model@{model}!projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent@{projects\+::wizard\+\_\+of\+\_\+wikipedia\+::generator\+::agents\+::\+End\+To\+End\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily projects.\+wizard\+\_\+of\+\_\+wikipedia.\+generator.\+agents.\+End\+To\+End\+Agent.\+model}



Definition at line 324 of file agents.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/wizard\+\_\+of\+\_\+wikipedia/generator/\hyperlink{projects_2wizard__of__wikipedia_2generator_2agents_8py}{agents.\+py}\end{DoxyCompactItemize}
