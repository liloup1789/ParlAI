\hypertarget{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered}{}\section{projects.\+self\+\_\+feeding.\+scripts.\+convert\+\_\+sliced\+\_\+to\+\_\+unfiltered Namespace Reference}
\label{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered}\index{projects.\+self\+\_\+feeding.\+scripts.\+convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects.\+self\+\_\+feeding.\+scripts.\+convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a13c1e69c48c191e9cc6f8d257b79152d}{setup\+\_\+args} ()
\item 
def \hyperlink{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a552f368b316e70524ec9118b03841486}{main} (\hyperlink{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a7138270b9589cbf6a9c6f608a6e50c21}{config})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a7138270b9589cbf6a9c6f608a6e50c21}{config}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a552f368b316e70524ec9118b03841486}\label{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a552f368b316e70524ec9118b03841486}} 
\index{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}!main@{main}}
\index{main@{main}!projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily def projects.\+self\+\_\+feeding.\+scripts.\+convert\+\_\+sliced\+\_\+to\+\_\+unfiltered.\+main (\begin{DoxyParamCaption}\item[{}]{config }\end{DoxyParamCaption})}

\begin{DoxyVerb}Creates .unfiltered files from .sliced files.

input: a .sliced file of logs (in ParlaiDialog format) from Mturk task 1, each of
    which starts with an initial prompt or topic request, and ends with a y_exp
output: a .unfiltered file (in self-feeding format) with every utterance output by
    bot used as a label (i.e., act as though the bot was a human and we want to
    train in a normal supervised way).
\end{DoxyVerb}
 

Definition at line 25 of file convert\+\_\+sliced\+\_\+to\+\_\+unfiltered.\+py.


\begin{DoxyCode}
25 \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a552f368b316e70524ec9118b03841486}{main}(config):
26     \textcolor{stringliteral}{"""}
27 \textcolor{stringliteral}{    Creates .unfiltered files from .sliced files.}
28 \textcolor{stringliteral}{}
29 \textcolor{stringliteral}{    input: a .sliced file of logs (in ParlaiDialog format) from Mturk task 1, each of}
30 \textcolor{stringliteral}{        which starts with an initial prompt or topic request, and ends with a y\_exp}
31 \textcolor{stringliteral}{    output: a .unfiltered file (in self-feeding format) with every utterance output by}
32 \textcolor{stringliteral}{        bot used as a label (i.e., act as though the bot was a human and we want to}
33 \textcolor{stringliteral}{        train in a normal supervised way).}
34 \textcolor{stringliteral}{    """}
35     examples = []
36     episodes = [e \textcolor{keywordflow}{for} e \textcolor{keywordflow}{in} \hyperlink{namespaceprojects_1_1self__feeding_1_1utils_a7bfa2fe610a2d0da7968b1a2662e0c23}{extract\_parlai\_episodes}(config[\textcolor{stringliteral}{'infile'}])]
37     \textcolor{keywordflow}{for} episode \textcolor{keywordflow}{in} episodes:
38         history = []
39         num\_parleys = len(episode)
40         \textcolor{keywordflow}{for} i, parley \textcolor{keywordflow}{in} enumerate(episode):
41             \textcolor{keywordflow}{if} i == 0:  \textcolor{comment}{# Don't include the topic request}
42                 history.append(parley.response)
43                 \textcolor{keywordflow}{continue}
44             \textcolor{keywordflow}{elif} i == num\_parleys - 1:
45                 \textcolor{comment}{# ultimate turn was correction request and explanation}
46                 \textcolor{keywordflow}{continue}
47             \textcolor{keywordflow}{else}:
48                 example = Parley(
49                     context=\hyperlink{namespaceprojects_1_1self__feeding_1_1utils_a3f3d055dc6c4058057baae7b240de5ec}{add\_person\_tokens}(history, last\_speaker=1),
50                     response=parley.context,  \textcolor{comment}{# What the bot said}
51                 )
52                 examples.append(example)
53                 history.append(parley.context)
54                 history.append(parley.response)
55 
56     \textcolor{comment}{# Write new episodes to self-feeding format}
57     with open(config[\textcolor{stringliteral}{'outfile'}], \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} outfile:
58         \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} examples:
59             outfile.write(json.dumps(ex.to\_dict()) + \textcolor{stringliteral}{'\(\backslash\)n'})
60 
61     print(
62         f\textcolor{stringliteral}{"Extracted \{len(examples)\} self-feeding episodes out of "}
63         f\textcolor{stringliteral}{"\{len(episodes)\} parlai episodes and wrote them to \{config['outfile']\}."}
64     )
65 
66 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a13c1e69c48c191e9cc6f8d257b79152d}\label{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a13c1e69c48c191e9cc6f8d257b79152d}} 
\index{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}!setup\+\_\+args@{setup\+\_\+args}}
\index{setup\+\_\+args@{setup\+\_\+args}!projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}}
\subsubsection{\texorpdfstring{setup\+\_\+args()}{setup\_args()}}
{\footnotesize\ttfamily def projects.\+self\+\_\+feeding.\+scripts.\+convert\+\_\+sliced\+\_\+to\+\_\+unfiltered.\+setup\+\_\+args (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Definition at line 16 of file convert\+\_\+sliced\+\_\+to\+\_\+unfiltered.\+py.


\begin{DoxyCode}
16 \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a13c1e69c48c191e9cc6f8d257b79152d}{setup\_args}():
17     argparser = ArgumentParser()
18     argparser.add\_argument(\textcolor{stringliteral}{'-if'}, \textcolor{stringliteral}{'--infile'}, type=str)
19     argparser.add\_argument(\textcolor{stringliteral}{'-of'}, \textcolor{stringliteral}{'--outfile'}, type=str)
20     config = vars(argparser.parse\_args())
21 
22     \textcolor{keywordflow}{return} config
23 
24 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a7138270b9589cbf6a9c6f608a6e50c21}\label{namespaceprojects_1_1self__feeding_1_1scripts_1_1convert__sliced__to__unfiltered_a7138270b9589cbf6a9c6f608a6e50c21}} 
\index{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}!config@{config}}
\index{config@{config}!projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered@{projects\+::self\+\_\+feeding\+::scripts\+::convert\+\_\+sliced\+\_\+to\+\_\+unfiltered}}
\subsubsection{\texorpdfstring{config}{config}}
{\footnotesize\ttfamily projects.\+self\+\_\+feeding.\+scripts.\+convert\+\_\+sliced\+\_\+to\+\_\+unfiltered.\+config}



Definition at line 68 of file convert\+\_\+sliced\+\_\+to\+\_\+unfiltered.\+py.

