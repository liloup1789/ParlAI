\hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent}{}\section{projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent Class Reference}
\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent}\index{projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent@{projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent}}


Inheritance diagram for projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{dc/d4e/classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=245pt]{d8/dc2/classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a0ef5e4216cb586b31414df5c0992269d}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a4a66af4ad244944bef1de1010d4f2c1e}{opt}, shared=None)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a3d5bcfdf1b547e56c6e6e1af047fa7c2}{share} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a7e7fa664b89790467ceef3a41cfb623e}{load\+\_\+personalities} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_af78a4624bcebdd216c6cb9325cf59a81}{observe} (self, \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc97f37e227519a48abbfaab4bdd7e92}{observation})
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_abba9eae98eb8f0bac353e2da64b98044}{act} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5953c4f5ae44faf51f47e61194ada84e}{train\+\_\+step} (self, valid\+\_\+obs, image\+\_\+feats, personalities)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a407247b202808f7cc820819e6192c448}{eval\+\_\+step} (self, valid\+\_\+obs, image\+\_\+feats, personalities)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac87e6396d4b4e3d6d8c69202940a2b11}{batch\+\_\+act} (self, observations)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_acd07a9e73c6f58600c0db97331ff26f4}{extract\+\_\+image\+\_\+feats} (self, obs)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aa3ad5410a6cb1ef7f730ba0fda5b673c}{filter\+\_\+valid\+\_\+obs} (self, observations, is\+\_\+training)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a59ccc8175318115d066f550659de70d3}{update\+\_\+metrics} (self, loss, num\+\_\+correct, num\+\_\+samples, med\+\_\+rank=None)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a969be7eaa4f82bb64b449b9750ddb383}{receive\+\_\+metrics} (self, metrics\+\_\+dict)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a8d88f87cd908c48580910e8458c873b3}{reset} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9940b8a9a9a8ceca55058684e81d3898}{reset\+\_\+metrics} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a1bbc4e55caf459f68c67a9baa202605a}{report} (self)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9bacab7aeb7c9f795c72ee7d36867ee4}{save} (self, path=None)
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ae8a9b4cd65c4440314769206a4c821b8}{load} (self, path)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a076b5b97fbc703f87e4bbee6fe0651db}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5ba9d699dea1acba5a64c76c5ab4cb6a}{metrics}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a26a11e8d9e70ef2b85a91d812f3b2f01}{blank\+\_\+image\+\_\+features}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a4a66af4ad244944bef1de1010d4f2c1e}{opt}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a88a06e4070b69d6ecedccff2504f7f6d}{model\+\_\+file}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac4a9872b521b3b4244470d16ec2f1273}{id}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a1d6d44890195ffdce0fd5c98938a4632}{one\+\_\+cand\+\_\+set}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a0349367e2cc13a0765338adbe37f0161}{use\+\_\+cuda}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac7da024c18938460b50014af94898ffd}{fcp}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aad19e258d358b59a1839153fcca6675e}{episode\+\_\+done}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a571e760f13dddbab17534f1252e722c5}{personalities\+\_\+list}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a05d2178cee691cf5f246ca43764704db}{freeze\+\_\+patience}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc7fe3e7c9d6880ba5d44bd1bc08cc1a}{freeze\+\_\+impatience}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9a20b4821c3481f7a08bcc68df5f0fe3}{freeze\+\_\+best\+\_\+metric}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5bdf6e53f546563af9dd552536a5c023}{is\+\_\+frozen}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aef1312ff6ea2ee58c245236114d19ecd}{dict}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a8bdd596d3dabed6072c814db1f705b82}{model}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a08427ced81096471bbe8eaa931c8d029}{fixed\+\_\+cands}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a208f000d4bc99419aa38a1f4c86c12d2}{fixed\+\_\+cands\+\_\+enc}
\item 
\hyperlink{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc97f37e227519a48abbfaab4bdd7e92}{observation}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Model described in (https://arxiv.org/abs/1811.00945).

A model for producing engaging captions about an image. Given an image and
this model will attempt to predict an appropriate
next utterance in the dialog, in the context of a given personality.

See the paper linked above for more information.
\end{DoxyVerb}
 

Definition at line 25 of file transresnet.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a0ef5e4216cb586b31414df5c0992269d}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a0ef5e4216cb586b31414df5c0992269d}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 67 of file transresnet.\+py.


\begin{DoxyCode}
67     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
68         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'numthreads'}, 1) > 1:
69             \textcolor{keywordflow}{raise} RuntimeError(
70                 \textcolor{stringliteral}{'Warning: You cannot use multithreading with '}
71                 \textcolor{stringliteral}{'this agent, as the current metrics do not '}
72                 \textcolor{stringliteral}{'support sharing of lists (for median rank '}
73                 \textcolor{stringliteral}{'calculation). Please set --numthreads to 1'}
74             )
75         self.metrics = \{
76             \textcolor{stringliteral}{'hits@1/100'}: 0.0,
77             \textcolor{stringliteral}{'loss'}: 0.0,
78             \textcolor{stringliteral}{'num\_samples'}: 0,
79             \textcolor{stringliteral}{'med\_rank'}: [],
80         \}
81         self.blank\_image\_features = torch.FloatTensor(
82             opt.get(\textcolor{stringliteral}{'image\_features\_dim'})
83         ).fill\_(0)
84         self.opt = opt
85         self.model\_file = opt[\textcolor{stringliteral}{'model\_file'}]
86         self.id = \textcolor{stringliteral}{'TransresnetAgent'}
87         self.one\_cand\_set = opt.get(\textcolor{stringliteral}{'one\_cand\_set'}, \textcolor{keyword}{False})
88         self.use\_cuda = \textcolor{keywordflow}{not} opt[\textcolor{stringliteral}{'no\_cuda'}] \textcolor{keywordflow}{and} torch.cuda.is\_available()
89         self.fcp = \textcolor{keywordtype}{None}
90         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'fixed\_cands\_path'}) \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
91             self.fcp = opt[\textcolor{stringliteral}{'fixed\_cands\_path'}]
92         self.episode\_done = \textcolor{keyword}{True}
93 
94         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} shared:
95             \textcolor{comment}{# setup dict}
96             self.\_setup\_dict()
97             \textcolor{comment}{# load the list of personalities}
98             self.personalities\_list = self.load\_personalities()
99             \textcolor{comment}{# possibly load the model from a model file}
100             self.\_build\_model()
101             \textcolor{comment}{# load candidates if specified}
102             self.\_setup\_cands()
103             self.freeze\_patience = self.opt[\textcolor{stringliteral}{'freeze\_patience'}]
104             \textcolor{keywordflow}{if} self.freeze\_patience != -1:
105                 \textcolor{comment}{# For fine-tuning}
106                 self.model.freeze\_text\_encoder()
107                 self.freeze\_impatience = 0
108                 self.freeze\_best\_metric = 0
109                 self.is\_frozen = \textcolor{keyword}{True}
110         \textcolor{keywordflow}{else}:
111             self.dict = shared[\textcolor{stringliteral}{'dict'}]
112             self.model = shared[\textcolor{stringliteral}{'model'}]
113             self.personalities\_list = shared[\textcolor{stringliteral}{'personalities\_list'}]
114             self.fixed\_cands = shared[\textcolor{stringliteral}{'fixed\_cands'}]
115             self.fixed\_cands\_enc = shared[\textcolor{stringliteral}{'fixed\_cands\_enc'}]
116 
117         super().\_\_init\_\_(opt, shared)
118 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_abba9eae98eb8f0bac353e2da64b98044}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_abba9eae98eb8f0bac353e2da64b98044}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!act@{act}}
\index{act@{act}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Act.
\end{DoxyVerb}
 

Definition at line 205 of file transresnet.\+py.


\begin{DoxyCode}
205     \textcolor{keyword}{def }act(self):
206         \textcolor{stringliteral}{"""}
207 \textcolor{stringliteral}{        Act.}
208 \textcolor{stringliteral}{        """}
209         \textcolor{keywordflow}{return} self.batch\_act([self.observation])[0]
210 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a076b5b97fbc703f87e4bbee6fe0651db}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a076b5b97fbc703f87e4bbee6fe0651db}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Add command line args.
\end{DoxyVerb}
 

Definition at line 37 of file transresnet.\+py.


\begin{DoxyCode}
37     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
38         \textcolor{stringliteral}{"""}
39 \textcolor{stringliteral}{        Add command line args.}
40 \textcolor{stringliteral}{        """}
41         arg\_group = argparser.add\_argument\_group(\textcolor{stringliteral}{'Transresnet Arguments'})
42         TransresnetModel.add\_cmdline\_args(argparser)
43         argparser.add\_argument(
44             \textcolor{stringliteral}{'--freeze-patience'},
45             type=int,
46             default=-1,
47             help=\textcolor{stringliteral}{'How long to freeze text encoders'},
48         )
49         argparser.add\_argument(
50             \textcolor{stringliteral}{'--one-cand-set'},
51             type=\textcolor{stringliteral}{'bool'},
52             default=\textcolor{keyword}{False},
53             help=\textcolor{stringliteral}{'True if each example has one set of shared '} \textcolor{stringliteral}{'label candidates'},
54         )
55         argparser.add\_argument(
56             \textcolor{stringliteral}{'--fixed-cands-path'},
57             type=str,
58             default=\textcolor{keywordtype}{None},
59             help=\textcolor{stringliteral}{'path to text file with candidates'},
60         )
61         argparser.add\_argument(
62             \textcolor{stringliteral}{'--pretrained'}, type=\textcolor{stringliteral}{'bool'}, default=\textcolor{keyword}{False}, help=\textcolor{stringliteral}{'True if pretrained model'}
63         )
64         DictionaryAgent.add\_cmdline\_args(argparser)
65         \textcolor{keywordflow}{return} arg\_group
66 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac87e6396d4b4e3d6d8c69202940a2b11}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac87e6396d4b4e3d6d8c69202940a2b11}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!batch\+\_\+act@{batch\+\_\+act}}
\index{batch\+\_\+act@{batch\+\_\+act}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+act()}{batch\_act()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+batch\+\_\+act (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}

\begin{DoxyVerb}Act on a batch of observations.

:param observations:
    list of observations

:return:
    A list of acts, one for each observation
\end{DoxyVerb}
 

Definition at line 300 of file transresnet.\+py.


\begin{DoxyCode}
300     \textcolor{keyword}{def }batch\_act(self, observations):
301         \textcolor{stringliteral}{"""}
302 \textcolor{stringliteral}{        Act on a batch of observations.}
303 \textcolor{stringliteral}{}
304 \textcolor{stringliteral}{        :param observations:}
305 \textcolor{stringliteral}{            list of observations}
306 \textcolor{stringliteral}{}
307 \textcolor{stringliteral}{        :return:}
308 \textcolor{stringliteral}{            A list of acts, one for each observation}
309 \textcolor{stringliteral}{        """}
310         is\_training = any([\textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} obs \textcolor{keywordflow}{for} obs \textcolor{keywordflow}{in} observations])
311         valid\_obs, valid\_indexes = self.filter\_valid\_obs(observations, is\_training)
312         image\_feats = self.extract\_image\_feats(valid\_obs)
313         personalities = [v.get(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{''}) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} valid\_obs]
314 
315         chosen\_captions = \textcolor{keywordtype}{None}
316         med\_rank = \textcolor{keywordtype}{None}
317         \textcolor{keywordflow}{if} is\_training:
318             loss, num\_correct, num\_examples = self.train\_step(
319                 valid\_obs, image\_feats, personalities
320             )
321         \textcolor{keywordflow}{else}:
322             loss, num\_correct, num\_examples, med\_rank, chosen\_captions = self.eval\_step(
323                 valid\_obs, image\_feats, personalities
324             )
325 
326         self.update\_metrics(loss, num\_correct, num\_examples, med\_rank)
327         result = [
328             \{\textcolor{stringliteral}{'text'}: \textcolor{stringliteral}{'No Response During Training'}\} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(len(observations))
329         ]
330         \textcolor{keywordflow}{if} chosen\_captions \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
331             \textcolor{keywordflow}{for} i, index\_obs \textcolor{keywordflow}{in} enumerate(valid\_indexes):
332                 result[index\_obs][\textcolor{stringliteral}{'text'}] = chosen\_captions[i][0]
333                 result[index\_obs][\textcolor{stringliteral}{'text\_candidates'}] = chosen\_captions[i]
334         \textcolor{keywordflow}{return} result
335 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a407247b202808f7cc820819e6192c448}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a407247b202808f7cc820819e6192c448}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!eval\+\_\+step@{eval\+\_\+step}}
\index{eval\+\_\+step@{eval\+\_\+step}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{eval\+\_\+step()}{eval\_step()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+eval\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{valid\+\_\+obs,  }\item[{}]{image\+\_\+feats,  }\item[{}]{personalities }\end{DoxyParamCaption})}

\begin{DoxyVerb}Model eval step.

:param valid_obs:
    list of valid observations

:param image_feats:
    list of image features, one per example

:param personalities:
    list of personalities, one per example

:return:
    the total loss, number of correct examples, the total number of
    examples evaluated, the ranked position of each correct caption,
    and the ranked lists of candidates (one per example)
\end{DoxyVerb}
 

Definition at line 234 of file transresnet.\+py.


\begin{DoxyCode}
234     \textcolor{keyword}{def }eval\_step(self, valid\_obs, image\_feats, personalities):
235         \textcolor{stringliteral}{"""}
236 \textcolor{stringliteral}{        Model eval step.}
237 \textcolor{stringliteral}{}
238 \textcolor{stringliteral}{        :param valid\_obs:}
239 \textcolor{stringliteral}{            list of valid observations}
240 \textcolor{stringliteral}{}
241 \textcolor{stringliteral}{        :param image\_feats:}
242 \textcolor{stringliteral}{            list of image features, one per example}
243 \textcolor{stringliteral}{}
244 \textcolor{stringliteral}{        :param personalities:}
245 \textcolor{stringliteral}{            list of personalities, one per example}
246 \textcolor{stringliteral}{}
247 \textcolor{stringliteral}{        :return:}
248 \textcolor{stringliteral}{            the total loss, number of correct examples, the total number of}
249 \textcolor{stringliteral}{            examples evaluated, the ranked position of each correct caption,}
250 \textcolor{stringliteral}{            and the ranked lists of candidates (one per example)}
251 \textcolor{stringliteral}{        """}
252         med\_rank = \textcolor{keywordtype}{None}
253         chosen\_captions = \textcolor{keywordtype}{None}
254         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'label\_candidates'} \textcolor{keywordflow}{in} valid\_obs[0] \textcolor{keywordflow}{or} self.fixed\_cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
255             \textcolor{comment}{# User provides candidates, used as negatives for evaluation}
256             candidates\_encoded = \textcolor{keywordtype}{None}
257             \textcolor{keywordflow}{if} self.fixed\_cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
258                 candidates\_encoded = self.fixed\_cands\_enc
259                 candidates = self.fixed\_cands
260             \textcolor{keywordflow}{else}:
261                 candidates = [v[\textcolor{stringliteral}{'label\_candidates'}] \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} valid\_obs]
262                 \textcolor{keywordflow}{if} self.one\_cand\_set:
263                     candidates\_encoded = self.model(\textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, candidates[0])[
264                         1
265                     ].detach()
266             chosen\_captions = self.model.choose\_best\_caption(
267                 image\_feats,
268                 personalities,
269                 candidates,
270                 candidates\_encoded=candidates\_encoded,
271                 k=-1 \textcolor{keywordflow}{if} self.fixed\_cands \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} 100,
272             )
273             \textcolor{comment}{# calculate median ranks}
274             num\_examples = len(chosen\_captions)
275             loss = -1
276             \textcolor{keywordflow}{if} self.fixed\_cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
277                 num\_correct = 0
278             \textcolor{keywordflow}{else}:
279                 comments = [v[\textcolor{stringliteral}{'eval\_labels'}] \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} valid\_obs]
280                 med\_rank = []
281                 \textcolor{keywordflow}{for} i, c\_list \textcolor{keywordflow}{in} enumerate(chosen\_captions):
282                     lowest\_rank = len(c\_list) + 1
283                     \textcolor{keywordflow}{for} \_, c \textcolor{keywordflow}{in} enumerate(comments[i]):
284                         lowest\_rank = min(lowest\_rank, c\_list.index(c) + 1)
285                     med\_rank.append(lowest\_rank)
286                 num\_correct = sum(
287                     [
288                         1 \textcolor{keywordflow}{if} chosen\_captions[i][0] \textcolor{keywordflow}{in} chosen\_captions[i] \textcolor{keywordflow}{else} 0
289                         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(chosen\_captions))
290                     ]
291                 )
292         \textcolor{keywordflow}{else}:
293             comments = [random.choice(v[\textcolor{stringliteral}{'eval\_labels'}]) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} valid\_obs]
294             loss, num\_correct, num\_examples = self.model.eval\_batch(
295                 image\_feats, personalities, comments
296             )
297 
298         \textcolor{keywordflow}{return} loss, num\_correct, num\_examples, med\_rank, chosen\_captions
299 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_acd07a9e73c6f58600c0db97331ff26f4}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_acd07a9e73c6f58600c0db97331ff26f4}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!extract\+\_\+image\+\_\+feats@{extract\+\_\+image\+\_\+feats}}
\index{extract\+\_\+image\+\_\+feats@{extract\+\_\+image\+\_\+feats}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{extract\+\_\+image\+\_\+feats()}{extract\_image\_feats()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+extract\+\_\+image\+\_\+feats (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs }\end{DoxyParamCaption})}

\begin{DoxyVerb}Extract image features from the observations.

:param obs:
    list of observations

:return:
    list of image features
\end{DoxyVerb}
 

Definition at line 336 of file transresnet.\+py.


\begin{DoxyCode}
336     \textcolor{keyword}{def }extract\_image\_feats(self, obs):
337         \textcolor{stringliteral}{"""}
338 \textcolor{stringliteral}{        Extract image features from the observations.}
339 \textcolor{stringliteral}{}
340 \textcolor{stringliteral}{        :param obs:}
341 \textcolor{stringliteral}{            list of observations}
342 \textcolor{stringliteral}{}
343 \textcolor{stringliteral}{        :return:}
344 \textcolor{stringliteral}{            list of image features}
345 \textcolor{stringliteral}{        """}
346         tmp\_image\_feats = [v.get(\textcolor{stringliteral}{'image'}) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} obs]
347         \textcolor{keywordflow}{for} i, im \textcolor{keywordflow}{in} enumerate(tmp\_image\_feats):
348             \textcolor{keywordflow}{try}:
349                 \textcolor{comment}{# Check if given img features of form [1, <dim>, 1, 1]}
350                 \textcolor{keywordflow}{if} len(im.size()) == 4:
351                     tmp\_image\_feats[i] = im[0, :, 0, 0]
352             \textcolor{keywordflow}{except} TypeError:  \textcolor{comment}{# No Image Feats Given}
353                 tmp\_image\_feats[i] = self.blank\_image\_features
354         image\_feats = []
355         \textcolor{keywordflow}{for} img \textcolor{keywordflow}{in} tmp\_image\_feats:
356             image\_feats.append(img.detach())
357         \textcolor{keywordflow}{return} image\_feats
358 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aa3ad5410a6cb1ef7f730ba0fda5b673c}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aa3ad5410a6cb1ef7f730ba0fda5b673c}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!filter\+\_\+valid\+\_\+obs@{filter\+\_\+valid\+\_\+obs}}
\index{filter\+\_\+valid\+\_\+obs@{filter\+\_\+valid\+\_\+obs}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{filter\+\_\+valid\+\_\+obs()}{filter\_valid\_obs()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+filter\+\_\+valid\+\_\+obs (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations,  }\item[{}]{is\+\_\+training }\end{DoxyParamCaption})}

\begin{DoxyVerb}Filter out invalid observations.
\end{DoxyVerb}
 

Definition at line 359 of file transresnet.\+py.


\begin{DoxyCode}
359     \textcolor{keyword}{def }filter\_valid\_obs(self, observations, is\_training):
360         \textcolor{stringliteral}{"""}
361 \textcolor{stringliteral}{        Filter out invalid observations.}
362 \textcolor{stringliteral}{        """}
363         label\_key = \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{if} is\_training \textcolor{keywordflow}{else} \textcolor{stringliteral}{'eval\_labels'}
364         valid\_obs = []
365         valid\_indexes = []
366         seen\_texts = set()
367         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(observations)):
368             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'image'} \textcolor{keywordflow}{in} observations[i]:
369                 \textcolor{keywordflow}{if} self.fixed\_cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
370                     valid\_obs.append(observations[i])
371                     valid\_indexes.append(i)
372                 \textcolor{keywordflow}{else}:
373                     text = observations[i][label\_key][0]
374                     \textcolor{keywordflow}{if} text \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} seen\_texts:
375                         seen\_texts.add(text)
376                         valid\_obs.append(observations[i])
377                         valid\_indexes.append(i)
378         \textcolor{keywordflow}{return} valid\_obs, valid\_indexes
379 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ae8a9b4cd65c4440314769206a4c821b8}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ae8a9b4cd65c4440314769206a4c821b8}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!load@{load}}
\index{load@{load}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Load a model.

:param path:
    path from which to load model
\end{DoxyVerb}
 

Definition at line 506 of file transresnet.\+py.


\begin{DoxyCode}
506     \textcolor{keyword}{def }load(self, path):
507         \textcolor{stringliteral}{"""}
508 \textcolor{stringliteral}{        Load a model.}
509 \textcolor{stringliteral}{}
510 \textcolor{stringliteral}{        :param path:}
511 \textcolor{stringliteral}{            path from which to load model}
512 \textcolor{stringliteral}{        """}
513         states = torch.load(path, map\_location=\textcolor{keyword}{lambda} cpu, \_: cpu)
514         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'model'} \textcolor{keywordflow}{in} states:
515             self.model.load\_state\_dict(states[\textcolor{stringliteral}{'model'}])
516 \end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a7e7fa664b89790467ceef3a41cfb623e}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a7e7fa664b89790467ceef3a41cfb623e}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!load\+\_\+personalities@{load\+\_\+personalities}}
\index{load\+\_\+personalities@{load\+\_\+personalities}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{load\+\_\+personalities()}{load\_personalities()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+load\+\_\+personalities (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Load and return the list of personalities.
\end{DoxyVerb}
 

Definition at line 180 of file transresnet.\+py.


\begin{DoxyCode}
180     \textcolor{keyword}{def }load\_personalities(self):
181         \textcolor{stringliteral}{"""}
182 \textcolor{stringliteral}{        Load and return the list of personalities.}
183 \textcolor{stringliteral}{        """}
184         personality\_path = os.path.join(
185             self.opt[\textcolor{stringliteral}{'datapath'}], \textcolor{stringliteral}{'personality\_captions/personalities.txt'}
186         )
187         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'yfcc\_path'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.opt:
188             self.opt[\textcolor{stringliteral}{'yfcc\_path'}] = \textcolor{stringliteral}{'temp\_path'}
189         \hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1talkthewalk_1_1download_a8c0fbb9b6dfe127cb8c1bd6e7c4e33fd}{build}(self.opt)
190         del self.opt[\textcolor{stringliteral}{'yfcc\_path'}]
191         perss = []
192         with open(personality\_path) \textcolor{keyword}{as} f:
193             \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} f:
194                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'Trait'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} line:
195                     perss.append(line[0:-1])
196         \textcolor{keywordflow}{return} perss
197 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_af78a4624bcebdd216c6cb9325cf59a81}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_af78a4624bcebdd216c6cb9325cf59a81}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!observe@{observe}}
\index{observe@{observe}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Observe.
\end{DoxyVerb}
 

Definition at line 198 of file transresnet.\+py.


\begin{DoxyCode}
198     \textcolor{keyword}{def }observe(self, observation):
199         \textcolor{stringliteral}{"""}
200 \textcolor{stringliteral}{        Observe.}
201 \textcolor{stringliteral}{        """}
202         self.observation = observation
203         \textcolor{keywordflow}{return} observation
204 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a969be7eaa4f82bb64b449b9750ddb383}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a969be7eaa4f82bb64b449b9750ddb383}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!receive\+\_\+metrics@{receive\+\_\+metrics}}
\index{receive\+\_\+metrics@{receive\+\_\+metrics}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{receive\+\_\+metrics()}{receive\_metrics()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+receive\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{metrics\+\_\+dict }\end{DoxyParamCaption})}

\begin{DoxyVerb}Receive the metrics from validation.

Unfreeze text encoder weights after a certain number of rounds without improvement.

:param metrics_dict:
    the metrics dictionary
\end{DoxyVerb}
 

Definition at line 419 of file transresnet.\+py.


\begin{DoxyCode}
419     \textcolor{keyword}{def }receive\_metrics(self, metrics\_dict):
420         \textcolor{stringliteral}{"""}
421 \textcolor{stringliteral}{        Receive the metrics from validation.}
422 \textcolor{stringliteral}{}
423 \textcolor{stringliteral}{        Unfreeze text encoder weights after a certain number of rounds without improvement.}
424 \textcolor{stringliteral}{}
425 \textcolor{stringliteral}{        :param metrics\_dict:}
426 \textcolor{stringliteral}{            the metrics dictionary}
427 \textcolor{stringliteral}{        """}
428         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'tasks'} \textcolor{keywordflow}{in} metrics\_dict:
429             metrics\_dict = metrics\_dict[\textcolor{stringliteral}{'tasks'}][\textcolor{stringliteral}{'personality\_captions'}]
430         \textcolor{keywordflow}{if} self.freeze\_patience != -1 \textcolor{keywordflow}{and} self.is\_frozen:
431             m = metrics\_dict[\textcolor{stringliteral}{'hits@1/100'}]
432             \textcolor{keywordflow}{if} m > self.freeze\_best\_metric:
433                 self.freeze\_impatience = 0
434                 self.freeze\_best\_metric = m
435                 print(\textcolor{stringliteral}{'performance not good enough to unfreeze the model.'})
436             \textcolor{keywordflow}{else}:
437                 self.freeze\_impatience += 1
438                 print(\textcolor{stringliteral}{'Growing impatience for unfreezing'})
439                 \textcolor{keywordflow}{if} self.freeze\_impatience >= self.freeze\_patience:
440                     self.is\_frozen = \textcolor{keyword}{False}
441                     print(
442                         \textcolor{stringliteral}{'Reached impatience for fine tuning. '}
443                         \textcolor{stringliteral}{'Reloading the best model so far.'}
444                     )
445                     self.\_build\_model(self.model\_file)
446                     \textcolor{keywordflow}{if} self.use\_cuda:
447                         self.model = self.model.cuda()
448                     print(\textcolor{stringliteral}{'Unfreezing.'})
449                     self.model.unfreeze\_text\_encoder()
450                     print(\textcolor{stringliteral}{'Done'})
451 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a1bbc4e55caf459f68c67a9baa202605a}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a1bbc4e55caf459f68c67a9baa202605a}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!report@{report}}
\index{report@{report}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{report()}{report()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+report (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Report the current metrics.

:return:
    a metrics dict
\end{DoxyVerb}
 

Definition at line 469 of file transresnet.\+py.


\begin{DoxyCode}
469     \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}(self):
470         \textcolor{stringliteral}{"""}
471 \textcolor{stringliteral}{        Report the current metrics.}
472 \textcolor{stringliteral}{}
473 \textcolor{stringliteral}{        :return:}
474 \textcolor{stringliteral}{            a metrics dict}
475 \textcolor{stringliteral}{        """}
476         m = \{\}
477         \textcolor{keywordflow}{if} self.metrics[\textcolor{stringliteral}{'num\_samples'}] > 0:
478             m[\textcolor{stringliteral}{'hits@1/100'}] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(
479                 self.metrics[\textcolor{stringliteral}{'hits@1/100'}] / self.metrics[\textcolor{stringliteral}{'num\_samples'}], 4
480             )
481             m[\textcolor{stringliteral}{'loss'}] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(
482                 self.metrics[\textcolor{stringliteral}{'loss'}] / self.metrics[\textcolor{stringliteral}{'num\_samples'}], 4
483             )
484             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'med\_rank'} \textcolor{keywordflow}{in} self.metrics:
485                 m[\textcolor{stringliteral}{'med\_rank'}] = np.median(self.metrics[\textcolor{stringliteral}{'med\_rank'}])
486         \textcolor{keywordflow}{return} m
487 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a8d88f87cd908c48580910e8458c873b3}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a8d88f87cd908c48580910e8458c873b3}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!reset@{reset}}
\index{reset@{reset}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset metrics.
\end{DoxyVerb}
 

Definition at line 452 of file transresnet.\+py.


\begin{DoxyCode}
452     \textcolor{keyword}{def }reset(self):
453         \textcolor{stringliteral}{"""}
454 \textcolor{stringliteral}{        Reset metrics.}
455 \textcolor{stringliteral}{        """}
456         super().reset()
457         self.reset\_metrics()
458 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9940b8a9a9a8ceca55058684e81d3898}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9940b8a9a9a8ceca55058684e81d3898}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!reset\+\_\+metrics@{reset\+\_\+metrics}}
\index{reset\+\_\+metrics@{reset\+\_\+metrics}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{reset\+\_\+metrics()}{reset\_metrics()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+reset\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset the metrics.
\end{DoxyVerb}
 

Definition at line 459 of file transresnet.\+py.


\begin{DoxyCode}
459     \textcolor{keyword}{def }reset\_metrics(self):
460         \textcolor{stringliteral}{"""}
461 \textcolor{stringliteral}{        Reset the metrics.}
462 \textcolor{stringliteral}{        """}
463         self.metrics[\textcolor{stringliteral}{'hits@1/100'}] = 0.0
464         self.metrics[\textcolor{stringliteral}{'loss'}] = 0.0
465         self.metrics[\textcolor{stringliteral}{'num\_samples'}] = 0.0
466         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'med\_rank'} \textcolor{keywordflow}{in} self.metrics:
467             self.metrics[\textcolor{stringliteral}{'med\_rank'}] = []
468 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9bacab7aeb7c9f795c72ee7d36867ee4}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9bacab7aeb7c9f795c72ee7d36867ee4}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!save@{save}}
\index{save@{save}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save the model.

:param path:
    path for saving model
\end{DoxyVerb}
 

Definition at line 488 of file transresnet.\+py.


\begin{DoxyCode}
488     \textcolor{keyword}{def }save(self, path=None):
489         \textcolor{stringliteral}{"""}
490 \textcolor{stringliteral}{        Save the model.}
491 \textcolor{stringliteral}{}
492 \textcolor{stringliteral}{        :param path:}
493 \textcolor{stringliteral}{            path for saving model}
494 \textcolor{stringliteral}{        """}
495         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} path
496         self.dict.save(path + \textcolor{stringliteral}{'.dict'}, sort=\textcolor{keyword}{False})
497         print(\textcolor{stringliteral}{'Saving best model'})
498         states = \{\}
499         states[\textcolor{stringliteral}{'model'}] = self.model.state\_dict()
500         torch.save(states, path)
501 
502         with open(path + \textcolor{stringliteral}{'.opt'}, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} handle:
503             json.dump(self.opt, handle)
504             handle.write(\textcolor{stringliteral}{'\(\backslash\)n'})
505 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a3d5bcfdf1b547e56c6e6e1af047fa7c2}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a3d5bcfdf1b547e56c6e6e1af047fa7c2}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!share@{share}}
\index{share@{share}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Share appropriate attributes.
\end{DoxyVerb}
 

Definition at line 119 of file transresnet.\+py.


\begin{DoxyCode}
119     \textcolor{keyword}{def }share(self):
120         \textcolor{stringliteral}{"""}
121 \textcolor{stringliteral}{        Share appropriate attributes.}
122 \textcolor{stringliteral}{        """}
123         shared = super().share()
124         shared[\textcolor{stringliteral}{'dict'}] = self.dict
125         shared[\textcolor{stringliteral}{'model'}] = self.model
126         shared[\textcolor{stringliteral}{'personalities\_list'}] = self.personalities\_list
127         shared[\textcolor{stringliteral}{'fixed\_cands'}] = self.fixed\_cands
128         shared[\textcolor{stringliteral}{'fixed\_cands\_enc'}] = self.fixed\_cands\_enc
129         \textcolor{keywordflow}{return} shared
130 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5953c4f5ae44faf51f47e61194ada84e}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5953c4f5ae44faf51f47e61194ada84e}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!train\+\_\+step@{train\+\_\+step}}
\index{train\+\_\+step@{train\+\_\+step}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{train\+\_\+step()}{train\_step()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+train\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{valid\+\_\+obs,  }\item[{}]{image\+\_\+feats,  }\item[{}]{personalities }\end{DoxyParamCaption})}

\begin{DoxyVerb}Model train step.

:param valid_obs:
    list of valid observations

:param image_feats:
    list of image features, one per example

:param personalities:
    list of personalities, one per example

:return:
    the total loss, number of correct examples, and total number of
    examples evaluated
\end{DoxyVerb}
 

Definition at line 211 of file transresnet.\+py.


\begin{DoxyCode}
211     \textcolor{keyword}{def }train\_step(self, valid\_obs, image\_feats, personalities):
212         \textcolor{stringliteral}{"""}
213 \textcolor{stringliteral}{        Model train step.}
214 \textcolor{stringliteral}{}
215 \textcolor{stringliteral}{        :param valid\_obs:}
216 \textcolor{stringliteral}{            list of valid observations}
217 \textcolor{stringliteral}{}
218 \textcolor{stringliteral}{        :param image\_feats:}
219 \textcolor{stringliteral}{            list of image features, one per example}
220 \textcolor{stringliteral}{}
221 \textcolor{stringliteral}{        :param personalities:}
222 \textcolor{stringliteral}{            list of personalities, one per example}
223 \textcolor{stringliteral}{}
224 \textcolor{stringliteral}{        :return:}
225 \textcolor{stringliteral}{            the total loss, number of correct examples, and total number of}
226 \textcolor{stringliteral}{            examples evaluated}
227 \textcolor{stringliteral}{        """}
228         comments = [random.choice(v[\textcolor{stringliteral}{'labels'}]) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} valid\_obs]
229         loss, num\_correct, num\_examples = self.model.train\_batch(
230             image\_feats, personalities, comments
231         )
232         \textcolor{keywordflow}{return} loss, num\_correct, num\_examples
233 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a59ccc8175318115d066f550659de70d3}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a59ccc8175318115d066f550659de70d3}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!update\+\_\+metrics@{update\+\_\+metrics}}
\index{update\+\_\+metrics@{update\+\_\+metrics}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{update\+\_\+metrics()}{update\_metrics()}}
{\footnotesize\ttfamily def projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+update\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{loss,  }\item[{}]{num\+\_\+correct,  }\item[{}]{num\+\_\+samples,  }\item[{}]{med\+\_\+rank = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Update Metrics.

:param loss:
    float loss
:param num_correct:
    number of examples for which chosen caption is correct
:param num_samples:
    total number of examples
:param med_rank:
    rank of correct caption for each example
\end{DoxyVerb}
 

Definition at line 380 of file transresnet.\+py.


\begin{DoxyCode}
380     \textcolor{keyword}{def }update\_metrics(self, loss, num\_correct, num\_samples, med\_rank=None):
381         \textcolor{stringliteral}{"""}
382 \textcolor{stringliteral}{        Update Metrics.}
383 \textcolor{stringliteral}{}
384 \textcolor{stringliteral}{        :param loss:}
385 \textcolor{stringliteral}{            float loss}
386 \textcolor{stringliteral}{        :param num\_correct:}
387 \textcolor{stringliteral}{            number of examples for which chosen caption is correct}
388 \textcolor{stringliteral}{        :param num\_samples:}
389 \textcolor{stringliteral}{            total number of examples}
390 \textcolor{stringliteral}{        :param med\_rank:}
391 \textcolor{stringliteral}{            rank of correct caption for each example}
392 \textcolor{stringliteral}{        """}
393         self.metrics[\textcolor{stringliteral}{'hits@1/100'}] += num\_correct
394         self.metrics[\textcolor{stringliteral}{'loss'}] += loss
395         self.metrics[\textcolor{stringliteral}{'num\_samples'}] += num\_samples
396         \textcolor{keywordflow}{if} med\_rank:
397             self.metrics[\textcolor{stringliteral}{'med\_rank'}] += med\_rank
398 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a26a11e8d9e70ef2b85a91d812f3b2f01}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a26a11e8d9e70ef2b85a91d812f3b2f01}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!blank\+\_\+image\+\_\+features@{blank\+\_\+image\+\_\+features}}
\index{blank\+\_\+image\+\_\+features@{blank\+\_\+image\+\_\+features}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{blank\+\_\+image\+\_\+features}{blank\_image\_features}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+blank\+\_\+image\+\_\+features}



Definition at line 81 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aef1312ff6ea2ee58c245236114d19ecd}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aef1312ff6ea2ee58c245236114d19ecd}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!dict@{dict}}
\index{dict@{dict}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+dict}



Definition at line 111 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aad19e258d358b59a1839153fcca6675e}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_aad19e258d358b59a1839153fcca6675e}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!episode\+\_\+done@{episode\+\_\+done}}
\index{episode\+\_\+done@{episode\+\_\+done}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{episode\+\_\+done}{episode\_done}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+episode\+\_\+done}



Definition at line 92 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac7da024c18938460b50014af94898ffd}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac7da024c18938460b50014af94898ffd}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!fcp@{fcp}}
\index{fcp@{fcp}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{fcp}{fcp}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+fcp}



Definition at line 89 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a08427ced81096471bbe8eaa931c8d029}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a08427ced81096471bbe8eaa931c8d029}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!fixed\+\_\+cands@{fixed\+\_\+cands}}
\index{fixed\+\_\+cands@{fixed\+\_\+cands}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{fixed\+\_\+cands}{fixed\_cands}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+fixed\+\_\+cands}



Definition at line 114 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a208f000d4bc99419aa38a1f4c86c12d2}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a208f000d4bc99419aa38a1f4c86c12d2}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!fixed\+\_\+cands\+\_\+enc@{fixed\+\_\+cands\+\_\+enc}}
\index{fixed\+\_\+cands\+\_\+enc@{fixed\+\_\+cands\+\_\+enc}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{fixed\+\_\+cands\+\_\+enc}{fixed\_cands\_enc}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+fixed\+\_\+cands\+\_\+enc}



Definition at line 115 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9a20b4821c3481f7a08bcc68df5f0fe3}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a9a20b4821c3481f7a08bcc68df5f0fe3}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!freeze\+\_\+best\+\_\+metric@{freeze\+\_\+best\+\_\+metric}}
\index{freeze\+\_\+best\+\_\+metric@{freeze\+\_\+best\+\_\+metric}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{freeze\+\_\+best\+\_\+metric}{freeze\_best\_metric}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+freeze\+\_\+best\+\_\+metric}



Definition at line 108 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc7fe3e7c9d6880ba5d44bd1bc08cc1a}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc7fe3e7c9d6880ba5d44bd1bc08cc1a}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!freeze\+\_\+impatience@{freeze\+\_\+impatience}}
\index{freeze\+\_\+impatience@{freeze\+\_\+impatience}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{freeze\+\_\+impatience}{freeze\_impatience}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+freeze\+\_\+impatience}



Definition at line 107 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a05d2178cee691cf5f246ca43764704db}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a05d2178cee691cf5f246ca43764704db}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!freeze\+\_\+patience@{freeze\+\_\+patience}}
\index{freeze\+\_\+patience@{freeze\+\_\+patience}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{freeze\+\_\+patience}{freeze\_patience}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+freeze\+\_\+patience}



Definition at line 103 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac4a9872b521b3b4244470d16ec2f1273}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_ac4a9872b521b3b4244470d16ec2f1273}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!id@{id}}
\index{id@{id}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+id}



Definition at line 86 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5bdf6e53f546563af9dd552536a5c023}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5bdf6e53f546563af9dd552536a5c023}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!is\+\_\+frozen@{is\+\_\+frozen}}
\index{is\+\_\+frozen@{is\+\_\+frozen}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{is\+\_\+frozen}{is\_frozen}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+is\+\_\+frozen}



Definition at line 109 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5ba9d699dea1acba5a64c76c5ab4cb6a}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a5ba9d699dea1acba5a64c76c5ab4cb6a}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!metrics@{metrics}}
\index{metrics@{metrics}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{metrics}{metrics}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+metrics}



Definition at line 75 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a8bdd596d3dabed6072c814db1f705b82}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a8bdd596d3dabed6072c814db1f705b82}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!model@{model}}
\index{model@{model}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+model}



Definition at line 112 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a88a06e4070b69d6ecedccff2504f7f6d}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a88a06e4070b69d6ecedccff2504f7f6d}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!model\+\_\+file@{model\+\_\+file}}
\index{model\+\_\+file@{model\+\_\+file}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{model\+\_\+file}{model\_file}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+model\+\_\+file}



Definition at line 85 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc97f37e227519a48abbfaab4bdd7e92}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_adc97f37e227519a48abbfaab4bdd7e92}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!observation@{observation}}
\index{observation@{observation}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+observation}



Definition at line 202 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a1d6d44890195ffdce0fd5c98938a4632}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a1d6d44890195ffdce0fd5c98938a4632}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!one\+\_\+cand\+\_\+set@{one\+\_\+cand\+\_\+set}}
\index{one\+\_\+cand\+\_\+set@{one\+\_\+cand\+\_\+set}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{one\+\_\+cand\+\_\+set}{one\_cand\_set}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+one\+\_\+cand\+\_\+set}



Definition at line 87 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a4a66af4ad244944bef1de1010d4f2c1e}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a4a66af4ad244944bef1de1010d4f2c1e}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!opt@{opt}}
\index{opt@{opt}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+opt}



Definition at line 84 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a571e760f13dddbab17534f1252e722c5}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a571e760f13dddbab17534f1252e722c5}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!personalities\+\_\+list@{personalities\+\_\+list}}
\index{personalities\+\_\+list@{personalities\+\_\+list}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{personalities\+\_\+list}{personalities\_list}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+personalities\+\_\+list}



Definition at line 98 of file transresnet.\+py.

\mbox{\Hypertarget{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a0349367e2cc13a0765338adbe37f0161}\label{classprojects_1_1personality__captions_1_1transresnet_1_1transresnet_1_1TransresnetAgent_a0349367e2cc13a0765338adbe37f0161}} 
\index{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent@{projects\+::personality\+\_\+captions\+::transresnet\+::transresnet\+::\+Transresnet\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily projects.\+personality\+\_\+captions.\+transresnet.\+transresnet.\+Transresnet\+Agent.\+use\+\_\+cuda}



Definition at line 88 of file transresnet.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/personality\+\_\+captions/transresnet/\hyperlink{projects_2personality__captions_2transresnet_2transresnet_8py}{transresnet.\+py}\end{DoxyCompactItemize}
