\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear}\index{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear@{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{d5/db4/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{da/dc5/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a961944a7bcebe7bee8c32967e505994d}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a79479f805ef73bba4f52a676999e06da}{in\+\_\+features}, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add537bbe47b10f383ff20b4244c2a38a}{out\+\_\+features}, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add46cc133ca8a969cee42cef77c87466}{bias}=True, shared\+\_\+weight=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a1ec65604d05f105801a61de18d16caa1}{reset\+\_\+parameters} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a5114a45ac1b8e2a07c399da5bff760be}{forward} (self, input)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_aad59400f7c8edf9b07305749b928186b}{\+\_\+\+\_\+repr\+\_\+\+\_\+} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a79479f805ef73bba4f52a676999e06da}{in\+\_\+features}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add537bbe47b10f383ff20b4244c2a38a}{out\+\_\+features}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_afa722c4a409a6e2b981874a8a472e892}{shared}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_ab561a82edc15dcd7509618466d2f684f}{weight}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add46cc133ca8a969cee42cef77c87466}{bias}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Custom Linear layer which allows for sharing weights (e.g. with an nn.Embedding
layer).
\end{DoxyVerb}
 

Definition at line 643 of file modules\+\_\+v0.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a961944a7bcebe7bee8c32967e505994d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a961944a7bcebe7bee8c32967e505994d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{in\+\_\+features,  }\item[{}]{out\+\_\+features,  }\item[{}]{bias = {\ttfamily True},  }\item[{}]{shared\+\_\+weight = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 649 of file modules\+\_\+v0.\+py.


\begin{DoxyCode}
649     \textcolor{keyword}{def }\_\_init\_\_(self, in\_features, out\_features, bias=True, shared\_weight=None):
650         super().\_\_init\_\_()
651         self.in\_features = in\_features
652         self.out\_features = out\_features
653         self.shared = shared\_weight \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}
654 
655         \textcolor{comment}{# init weight}
656         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.shared:
657             self.weight = Parameter(torch.Tensor(out\_features, in\_features))
658         \textcolor{keywordflow}{else}:
659             \textcolor{keywordflow}{if} (
660                 shared\_weight.size(0) != out\_features
661                 \textcolor{keywordflow}{or} shared\_weight.size(1) != in\_features
662             ):
663                 \textcolor{keywordflow}{raise} RuntimeError(\textcolor{stringliteral}{'wrong dimensions for shared weights'})
664             self.weight = shared\_weight
665 
666         \textcolor{comment}{# init bias}
667         \textcolor{keywordflow}{if} bias:
668             self.bias = Parameter(torch.Tensor(out\_features))
669         \textcolor{keywordflow}{else}:
670             self.register\_parameter(\textcolor{stringliteral}{'bias'}, \textcolor{keywordtype}{None})
671         self.reset\_parameters()
672 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_aad59400f7c8edf9b07305749b928186b}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_aad59400f7c8edf9b07305749b928186b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!\+\_\+\+\_\+repr\+\_\+\+\_\+@{\+\_\+\+\_\+repr\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+repr\+\_\+\+\_\+@{\+\_\+\+\_\+repr\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+repr\+\_\+\+\_\+()}{\_\_repr\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+\_\+\+\_\+repr\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 689 of file modules\+\_\+v0.\+py.


\begin{DoxyCode}
689     \textcolor{keyword}{def }\_\_repr\_\_(self):
690         \textcolor{keywordflow}{return} (
691             self.\_\_class\_\_.\_\_name\_\_
692             + \textcolor{stringliteral}{' ('}
693             + \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(self.in\_features)
694             + \textcolor{stringliteral}{' -> '}
695             + \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(self.out\_features)
696             + \textcolor{stringliteral}{')'}
697         )
698 
699 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a5114a45ac1b8e2a07c399da5bff760be}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a5114a45ac1b8e2a07c399da5bff760be}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!forward@{forward}}
\index{forward@{forward}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{input }\end{DoxyParamCaption})}



Definition at line 681 of file modules\+\_\+v0.\+py.


\begin{DoxyCode}
681     \textcolor{keyword}{def }forward(self, input):
682         weight = self.weight
683         \textcolor{keywordflow}{if} self.shared:
684             \textcolor{comment}{# detach weight to prevent gradients from changing weight}
685             \textcolor{comment}{# (but need to detach every time so weights are up to date)}
686             weight = weight.detach()
687         \textcolor{keywordflow}{return} F.linear(input, weight, self.bias)
688 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a1ec65604d05f105801a61de18d16caa1}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a1ec65604d05f105801a61de18d16caa1}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!reset\+\_\+parameters@{reset\+\_\+parameters}}
\index{reset\+\_\+parameters@{reset\+\_\+parameters}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{reset\+\_\+parameters()}{reset\_parameters()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+reset\+\_\+parameters (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 673 of file modules\+\_\+v0.\+py.


\begin{DoxyCode}
673     \textcolor{keyword}{def }reset\_parameters(self):
674         stdv = 1.0 / math.sqrt(self.weight.size(1))
675         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.shared:
676             \textcolor{comment}{# weight is shared so don't overwrite it}
677             self.weight.data.uniform\_(-stdv, stdv)
678         \textcolor{keywordflow}{if} self.bias \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
679             self.bias.data.uniform\_(-stdv, stdv)
680 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add46cc133ca8a969cee42cef77c87466}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add46cc133ca8a969cee42cef77c87466}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!bias@{bias}}
\index{bias@{bias}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{bias}{bias}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+bias}



Definition at line 668 of file modules\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a79479f805ef73bba4f52a676999e06da}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_a79479f805ef73bba4f52a676999e06da}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!in\+\_\+features@{in\+\_\+features}}
\index{in\+\_\+features@{in\+\_\+features}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{in\+\_\+features}{in\_features}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+in\+\_\+features}



Definition at line 651 of file modules\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add537bbe47b10f383ff20b4244c2a38a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_add537bbe47b10f383ff20b4244c2a38a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!out\+\_\+features@{out\+\_\+features}}
\index{out\+\_\+features@{out\+\_\+features}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{out\+\_\+features}{out\_features}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+out\+\_\+features}



Definition at line 652 of file modules\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_afa722c4a409a6e2b981874a8a472e892}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_afa722c4a409a6e2b981874a8a472e892}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!shared@{shared}}
\index{shared@{shared}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{shared}{shared}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+shared}



Definition at line 653 of file modules\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_ab561a82edc15dcd7509618466d2f684f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1modules__v0_1_1Linear_ab561a82edc15dcd7509618466d2f684f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}!weight@{weight}}
\index{weight@{weight}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::modules\+\_\+v0\+::\+Linear}}
\subsubsection{\texorpdfstring{weight}{weight}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+modules\+\_\+v0.\+Linear.\+weight}



Definition at line 657 of file modules\+\_\+v0.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/seq2seq/\hyperlink{seq2seq_2modules__v0_8py}{modules\+\_\+v0.\+py}\end{DoxyCompactItemize}
