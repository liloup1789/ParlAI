\hypertarget{namespaceparlai_1_1agents_1_1transformer_1_1modules}{}\section{parlai.\+agents.\+transformer.\+modules Namespace Reference}
\label{namespaceparlai_1_1agents_1_1transformer_1_1modules}\index{parlai.\+agents.\+transformer.\+modules@{parlai.\+agents.\+transformer.\+modules}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1BasicAttention}{Basic\+Attention}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention}{Multi\+Head\+Attention}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerDecoder}{Transformer\+Decoder}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerDecoderLayer}{Transformer\+Decoder\+Layer}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoder}{Transformer\+Encoder}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer}{Transformer\+Encoder\+Layer}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerFFN}{Transformer\+F\+FN}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerGeneratorModel}{Transformer\+Generator\+Model}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerLinearWrapper}{Transformer\+Linear\+Wrapper}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerMemNetModel}{Transformer\+Mem\+Net\+Model}
\item 
class \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerResponseWrapper}{Transformer\+Response\+Wrapper}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_ad93916b8d2188c35733089e1581c44f8}{gelu} (tensor)
\item 
def \hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_ab67607512c597ddd54f2b60a1a1eaf4c}{get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options} (opt)
\item 
def \hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_a0b86437e6e9682fa3100e9cadcaae259}{create\+\_\+position\+\_\+codes} (n\+\_\+pos, dim, out)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_a05d7fdb12d6d53f201ad11c3a487bd18}{L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1agents_1_1transformer_1_1modules_a0b86437e6e9682fa3100e9cadcaae259}\label{namespaceparlai_1_1agents_1_1transformer_1_1modules_a0b86437e6e9682fa3100e9cadcaae259}} 
\index{parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}!create\+\_\+position\+\_\+codes@{create\+\_\+position\+\_\+codes}}
\index{create\+\_\+position\+\_\+codes@{create\+\_\+position\+\_\+codes}!parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}}
\subsubsection{\texorpdfstring{create\+\_\+position\+\_\+codes()}{create\_position\_codes()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+create\+\_\+position\+\_\+codes (\begin{DoxyParamCaption}\item[{}]{n\+\_\+pos,  }\item[{}]{dim,  }\item[{}]{out }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create positional codes and store them in ``out``.
\end{DoxyVerb}
 

Definition at line 286 of file modules.\+py.


\begin{DoxyCode}
286 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_a0b86437e6e9682fa3100e9cadcaae259}{create\_position\_codes}(n\_pos, dim, out):
287     \textcolor{stringliteral}{"""}
288 \textcolor{stringliteral}{    Create positional codes and store them in ``out``.}
289 \textcolor{stringliteral}{    """}
290     position\_enc = np.array(
291         [
292             [pos / np.power(10000, 2 * j / dim) \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(dim // 2)]
293             \textcolor{keywordflow}{for} pos \textcolor{keywordflow}{in} range(n\_pos)
294         ]
295     )
296 
297     out[:, 0::2] = torch.FloatTensor(np.sin(position\_enc)).type\_as(out)
298     out[:, 1::2] = torch.FloatTensor(np.cos(position\_enc)).type\_as(out)
299     out.detach\_()
300     out.requires\_grad = \textcolor{keyword}{False}
301 
302 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1agents_1_1transformer_1_1modules_ad93916b8d2188c35733089e1581c44f8}\label{namespaceparlai_1_1agents_1_1transformer_1_1modules_ad93916b8d2188c35733089e1581c44f8}} 
\index{parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}!gelu@{gelu}}
\index{gelu@{gelu}!parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}}
\subsubsection{\texorpdfstring{gelu()}{gelu()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+gelu (\begin{DoxyParamCaption}\item[{}]{tensor }\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute gelu function.

c.f. https://arxiv.org/abs/1606.08415
\end{DoxyVerb}
 

Definition at line 112 of file modules.\+py.


\begin{DoxyCode}
112 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_ad93916b8d2188c35733089e1581c44f8}{gelu}(tensor):
113     \textcolor{stringliteral}{"""}
114 \textcolor{stringliteral}{    Compute gelu function.}
115 \textcolor{stringliteral}{}
116 \textcolor{stringliteral}{    c.f. https://arxiv.org/abs/1606.08415}
117 \textcolor{stringliteral}{    """}
118     \textcolor{keywordflow}{return} 0.5 * tensor * (1.0 + torch.erf(tensor / math.sqrt(2.0)))
119 
120 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1agents_1_1transformer_1_1modules_ab67607512c597ddd54f2b60a1a1eaf4c}\label{namespaceparlai_1_1agents_1_1transformer_1_1modules_ab67607512c597ddd54f2b60a1a1eaf4c}} 
\index{parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}!get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options@{get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options}}
\index{get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options@{get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options}!parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}}
\subsubsection{\texorpdfstring{get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options()}{get\_n\_positions\_from\_options()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+get\+\_\+n\+\_\+positions\+\_\+from\+\_\+options (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Determine n_positions from options dict.
\end{DoxyVerb}
 

Definition at line 121 of file modules.\+py.


\begin{DoxyCode}
121 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1transformer_1_1modules_ab67607512c597ddd54f2b60a1a1eaf4c}{get\_n\_positions\_from\_options}(opt):
122     \textcolor{stringliteral}{"""}
123 \textcolor{stringliteral}{    Determine n\_positions from options dict.}
124 \textcolor{stringliteral}{    """}
125     \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'n\_positions'}):
126         \textcolor{comment}{# if the number of positions is explicitly provided, use that}
127         n\_positions = opt[\textcolor{stringliteral}{'n\_positions'}]
128     \textcolor{keywordflow}{else}:
129         \textcolor{comment}{# else, use the worst case from truncate}
130         n\_positions = max(
131             opt.get(\textcolor{stringliteral}{'truncate'}) \textcolor{keywordflow}{or} 0,
132             opt.get(\textcolor{stringliteral}{'text\_truncate'}) \textcolor{keywordflow}{or} 0,
133             opt.get(\textcolor{stringliteral}{'label\_truncate'}) \textcolor{keywordflow}{or} 0,
134         )
135         \textcolor{keywordflow}{if} n\_positions == 0:
136             n\_positions = 1024
137     \textcolor{keywordflow}{return} n\_positions
138 
139 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1agents_1_1transformer_1_1modules_a05d7fdb12d6d53f201ad11c3a487bd18}\label{namespaceparlai_1_1agents_1_1transformer_1_1modules_a05d7fdb12d6d53f201ad11c3a487bd18}} 
\index{parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}!L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS@{L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS}}
\index{L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS@{L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS}!parlai\+::agents\+::transformer\+::modules@{parlai\+::agents\+::transformer\+::modules}}
\subsubsection{\texorpdfstring{L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS}{LAYER\_NORM\_EPS}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+L\+A\+Y\+E\+R\+\_\+\+N\+O\+R\+M\+\_\+\+E\+PS}



Definition at line 37 of file modules.\+py.

