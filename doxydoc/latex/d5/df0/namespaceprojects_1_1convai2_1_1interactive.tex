\hypertarget{namespaceprojects_1_1convai2_1_1interactive}{}\section{projects.\+convai2.\+interactive Namespace Reference}
\label{namespaceprojects_1_1convai2_1_1interactive}\index{projects.\+convai2.\+interactive@{projects.\+convai2.\+interactive}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceprojects_1_1convai2_1_1interactive_ac1ba8d400d87a3bb10e40d5ab1bcfd86}{setup\+\_\+args} (\hyperlink{namespaceprojects_1_1convai2_1_1interactive_a357f3f81f9f343acbab6c962cb12495c}{parser}=None)
\item 
def \hyperlink{namespaceprojects_1_1convai2_1_1interactive_a81cb75ad91b081600739897e216e9302}{interactive} (opt, \hyperlink{namespaceprojects_1_1convai2_1_1interactive_a8683646bcf8a96c4e87b52d6a79f4a3a}{print\+\_\+parser}=None)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceprojects_1_1convai2_1_1interactive_a357f3f81f9f343acbab6c962cb12495c}{parser}
\item 
\hyperlink{namespaceprojects_1_1convai2_1_1interactive_a35edcce7766cfab1e9829722cdd82270}{print\+\_\+args}
\item 
\hyperlink{namespaceprojects_1_1convai2_1_1interactive_a8683646bcf8a96c4e87b52d6a79f4a3a}{print\+\_\+parser}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceprojects_1_1convai2_1_1interactive_a81cb75ad91b081600739897e216e9302}\label{namespaceprojects_1_1convai2_1_1interactive_a81cb75ad91b081600739897e216e9302}} 
\index{projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}!interactive@{interactive}}
\index{interactive@{interactive}!projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}}
\subsubsection{\texorpdfstring{interactive()}{interactive()}}
{\footnotesize\ttfamily def projects.\+convai2.\+interactive.\+interactive (\begin{DoxyParamCaption}\item[{}]{opt,  }\item[{}]{print\+\_\+parser = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 50 of file interactive.\+py.


\begin{DoxyCode}
50 \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1self__feeding_1_1interactive_aaebd4c577ab0371c73e8442be469ebab}{interactive}(opt, print\_parser=None):
51     \textcolor{keywordflow}{if} print\_parser \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
52         \textcolor{keywordflow}{if} print\_parser \textcolor{keywordflow}{is} \textcolor{keyword}{True} \textcolor{keywordflow}{and} isinstance(opt, ParlaiParser):
53             print\_parser = opt
54         \textcolor{keywordflow}{elif} print\_parser \textcolor{keywordflow}{is} \textcolor{keyword}{False}:
55             print\_parser = \textcolor{keywordtype}{None}
56     \textcolor{keywordflow}{if} isinstance(opt, ParlaiParser):
57         print(\textcolor{stringliteral}{'[ Deprecated Warning: interactive should be passed opt not Parser ]'})
58         opt = opt.parse\_args()
59     opt[\textcolor{stringliteral}{'task'}] = \textcolor{stringliteral}{'parlai.agents.local\_human.local\_human:LocalHumanAgent'}
60     \textcolor{comment}{# Create model and assign it to the specified task}
61     agent = \hyperlink{namespaceparlai_1_1core_1_1agents_ad0d54074d4bcc148bb415ab5515a53b5}{create\_agent}(opt, requireModelExists=\textcolor{keyword}{True})
62     world = \hyperlink{namespaceparlai_1_1core_1_1worlds_a11923c10b545c7ecc1b08fe2242d9c2c}{create\_task}(opt, agent)
63     \textcolor{keywordflow}{if} print\_parser:
64         \textcolor{comment}{# Show arguments after loading model}
65         print\_parser.opt = agent.opt
66         print\_parser.print\_args()
67 
68     \textcolor{comment}{# Create ConvAI2 data so we can assign personas.}
69     convai2\_opt = opt.copy()
70     convai2\_opt[\textcolor{stringliteral}{'task'}] = \textcolor{stringliteral}{'convai2:both'}
71     convai2\_agent = RepeatLabelAgent(convai2\_opt)
72     convai2\_world = \hyperlink{namespaceparlai_1_1core_1_1worlds_a11923c10b545c7ecc1b08fe2242d9c2c}{create\_task}(convai2\_opt, convai2\_agent)
73 
74     \textcolor{keyword}{def }get\_new\_personas():
75         \textcolor{comment}{# Find a new episode}
76         \textcolor{keywordflow}{while} \textcolor{keyword}{True}:
77             convai2\_world.parley()
78             msg = convai2\_world.get\_acts()[0]
79             \textcolor{keywordflow}{if} msg[\textcolor{stringliteral}{'episode\_done'}]:
80                 convai2\_world.parley()
81                 msg = convai2\_world.get\_acts()[0]
82                 \textcolor{keywordflow}{break}
83         txt = msg.get(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{''}).split(\textcolor{stringliteral}{'\(\backslash\)n'})
84         bot\_persona = \textcolor{stringliteral}{""}
85         \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} txt:
86             \textcolor{keywordflow}{if} t.startswith(\textcolor{stringliteral}{"partner's persona:"}):
87                 print(t.replace(\textcolor{stringliteral}{"partner's "}, \textcolor{stringliteral}{'your '}))
88             \textcolor{keywordflow}{if} t.startswith(\textcolor{stringliteral}{'your persona:'}):
89                 bot\_persona += t + \textcolor{stringliteral}{'\(\backslash\)n'}
90         print(\textcolor{stringliteral}{"Enter [DONE] if you want a new partner at any time."})
91         \textcolor{keywordflow}{return} bot\_persona
92 
93     \textcolor{comment}{# Now run interactive mode, chatting with personas!}
94     cnt = 0
95     \textcolor{keywordflow}{while} \textcolor{keyword}{True}:
96         \textcolor{keywordflow}{if} cnt == 0:
97             bot\_persona = get\_new\_personas()
98         \textcolor{comment}{# Run the parts of world.parley() in turn,}
99         \textcolor{comment}{# but insert persona into user message.}
100         acts = world.acts
101         agents = world.agents
102         acts[0] = agents[0].act()
103         \textcolor{comment}{# add the persona on to the first message}
104         \textcolor{keywordflow}{if} cnt == 0:
105             acts[0][\textcolor{stringliteral}{'text'}] = bot\_persona + acts[0].get(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{'hi'})
106         agents[1].observe(acts[0])
107         acts[1] = agents[1].act()
108         agents[0].observe(acts[1])
109         world.update\_counters()
110         cnt = cnt + 1
111 
112         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'display\_examples'}):
113             print(\textcolor{stringliteral}{"---"})
114             print(world.display())
115         \textcolor{keywordflow}{if} world.episode\_done():
116             print(\textcolor{stringliteral}{"CHAT DONE "})
117             print(\textcolor{stringliteral}{"In case you were curious you were talking to this bot:"})
118             print(bot\_persona.split(\textcolor{stringliteral}{'\(\backslash\)n'}))
119             print(\textcolor{stringliteral}{"\(\backslash\)n... preparing new chat... \(\backslash\)n"})
120             cnt = 0
121 
122 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceprojects_1_1convai2_1_1interactive_ac1ba8d400d87a3bb10e40d5ab1bcfd86}\label{namespaceprojects_1_1convai2_1_1interactive_ac1ba8d400d87a3bb10e40d5ab1bcfd86}} 
\index{projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}!setup\+\_\+args@{setup\+\_\+args}}
\index{setup\+\_\+args@{setup\+\_\+args}!projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}}
\subsubsection{\texorpdfstring{setup\+\_\+args()}{setup\_args()}}
{\footnotesize\ttfamily def projects.\+convai2.\+interactive.\+setup\+\_\+args (\begin{DoxyParamCaption}\item[{}]{parser = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 28 of file interactive.\+py.


\begin{DoxyCode}
28 \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1self__feeding_1_1interactive_a2ad3b874d9caef6e76ea41e029b933f0}{setup\_args}(parser=None):
29     \textcolor{keywordflow}{if} parser \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
30         parser = ParlaiParser(\textcolor{keyword}{True}, \textcolor{keyword}{True}, \textcolor{stringliteral}{'Interactive chat with a model'})
31     parser.add\_argument(\textcolor{stringliteral}{'-d'}, \textcolor{stringliteral}{'--display-examples'}, type=\textcolor{stringliteral}{'bool'}, default=\textcolor{keyword}{False})
32     parser.add\_argument(
33         \textcolor{stringliteral}{'--display-prettify'},
34         type=\textcolor{stringliteral}{'bool'},
35         default=\textcolor{keyword}{False},
36         help=\textcolor{stringliteral}{'Set to use a prettytable when displaying '}
37         \textcolor{stringliteral}{'examples with text candidates'},
38     )
39     parser.add\_argument(
40         \textcolor{stringliteral}{'--display-ignore-fields'},
41         type=str,
42         default=\textcolor{stringliteral}{'label\_candidates,text\_candidates'},
43         help=\textcolor{stringliteral}{'Do not display these fields'},
44     )
45     parser.set\_defaults(model\_file=\textcolor{stringliteral}{'models:convai2/kvmemnn/model'})
46     LocalHumanAgent.add\_cmdline\_args(parser)
47     \textcolor{keywordflow}{return} parser
48 
49 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceprojects_1_1convai2_1_1interactive_a357f3f81f9f343acbab6c962cb12495c}\label{namespaceprojects_1_1convai2_1_1interactive_a357f3f81f9f343acbab6c962cb12495c}} 
\index{projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}!parser@{parser}}
\index{parser@{parser}!projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}}
\subsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily projects.\+convai2.\+interactive.\+parser}



Definition at line 125 of file interactive.\+py.

\mbox{\Hypertarget{namespaceprojects_1_1convai2_1_1interactive_a35edcce7766cfab1e9829722cdd82270}\label{namespaceprojects_1_1convai2_1_1interactive_a35edcce7766cfab1e9829722cdd82270}} 
\index{projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}!print\+\_\+args@{print\+\_\+args}}
\index{print\+\_\+args@{print\+\_\+args}!projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}}
\subsubsection{\texorpdfstring{print\+\_\+args}{print\_args}}
{\footnotesize\ttfamily projects.\+convai2.\+interactive.\+print\+\_\+args}



Definition at line 126 of file interactive.\+py.

\mbox{\Hypertarget{namespaceprojects_1_1convai2_1_1interactive_a8683646bcf8a96c4e87b52d6a79f4a3a}\label{namespaceprojects_1_1convai2_1_1interactive_a8683646bcf8a96c4e87b52d6a79f4a3a}} 
\index{projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}!print\+\_\+parser@{print\+\_\+parser}}
\index{print\+\_\+parser@{print\+\_\+parser}!projects\+::convai2\+::interactive@{projects\+::convai2\+::interactive}}
\subsubsection{\texorpdfstring{print\+\_\+parser}{print\_parser}}
{\footnotesize\ttfamily projects.\+convai2.\+interactive.\+print\+\_\+parser}



Definition at line 126 of file interactive.\+py.

