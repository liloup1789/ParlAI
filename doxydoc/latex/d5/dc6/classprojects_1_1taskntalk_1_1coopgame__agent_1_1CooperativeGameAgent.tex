\hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent}{}\section{projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent Class Reference}
\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent}\index{projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent@{projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent}}


Inheritance diagram for projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d6/db7/classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=233pt]{da/d0c/classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aee05007c3aa3127ebc9c6deff777c884}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1core_1_1agents_1_1Agent_ab3b45d2754244608c75d4068b90cd051}{opt}, shared=None)
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afe7b621baea1c0bbc86fb5c815428c63}{modules} (self)
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_adbd6d539317548bc9fe5e4ceccbe89e0}{setup\+\_\+optimizer} (self)
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ad61f88467c3cef93c85292b733a5ec91}{tokenize} (self, text)
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afa4b457e8d225f99cc97d30753dd1ff0}{detokenize} (self, vec)
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a6c3dbce5e745edf451daff9474b6a52f}{observe} (self, \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a935d5ccb012f0acfccddc34ba1c414ad}{observation})
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a6c41bb531d4581a70347b311922ab885}{act} (self)
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aa5fe586f3c20c7db8eea6ffae87b0a34}{reset} (self, retain\+\_\+actions=False)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aa7758c445e0e2213116e667184a6b31b}{dictionary\+\_\+class} ()
\item 
def \hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_af06b68508ab556b36c19c9378ce1f63e}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ab1d8f1563dd1c2fc4f2716f4b193a68e}{id}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afc43683bdc26833326ee8b1249f1009a}{actions}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a1c7bbe7c817146f3f4d9cbe68a52692b}{listen\+\_\+net}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a09ffa1bb1ab48ffc8310e683918c930f}{state\+\_\+net}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aea61853aed7368fea4e2826dd1d551b4}{speak\+\_\+net}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a20be5fabcb0e4716fdc6fb9242f317ef}{optimizer}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ac7e33d98b63ce28369f88a59b631726a}{dict\+\_\+agent}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a070a6528c2814e0df9e714bdc178c736}{use\+\_\+cuda}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a935d5ccb012f0acfccddc34ba1c414ad}{observation}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a821bc77afbc968ce32f4ced5271ffb65}{c\+\_\+state}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a7ce6d36ddb01828b6caef828b71e7380}{h\+\_\+state}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a20a6c84adea72558d4586ccd2f71eff9}{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Base class for both, the questioner and answerer.

It can be extended to create custom players of games, other than questioner and
answerer. It has separate modules to listen (observe), speak (act) and update its
internal state. Each module is a collection of one or more pytorch modules, and can
be extended and replaced in the agent as per task requirements.
\end{DoxyVerb}
 

Definition at line 17 of file coopgame\+\_\+agent.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aee05007c3aa3127ebc9c6deff777c884}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aee05007c3aa3127ebc9c6deff777c884}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 79 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
79     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
80         super().\_\_init\_\_(opt, shared)
81         self.id = \textcolor{stringliteral}{'CooperativeGameAgent'}
82         self.actions = []
83 
84         \textcolor{comment}{# initialize short (h) and long (c) term states}
85         self.reset()
86 
87         \textcolor{comment}{# basic modules for listening, state update and speaking}
88         \textcolor{comment}{# questioner will have `PredictNet`, answerer will have `ImgNet`}
89         self.listen\_net = ListenNet(opt[\textcolor{stringliteral}{'in\_vocab\_size'}], opt[\textcolor{stringliteral}{'embed\_size'}])
90         self.state\_net = StateNet(opt[\textcolor{stringliteral}{'embed\_size'}], opt[\textcolor{stringliteral}{'state\_size'}])
91         self.speak\_net = SpeakNet(opt[\textcolor{stringliteral}{'state\_size'}], opt[\textcolor{stringliteral}{'out\_vocab\_size'}])
92 
93         \textcolor{comment}{# setup optimizer according to command-line arguments}
94         self.optimizer = self.setup\_optimizer()
95         \textcolor{comment}{# setup dictionary agent}
96         self.dict\_agent = CooperativeGameAgent.dictionary\_class()()
97 
98         \textcolor{comment}{# transfer agent to GPU if applicable}
99         self.use\_cuda = \textcolor{keywordflow}{not} opt.get(\textcolor{stringliteral}{'no\_cuda'}) \textcolor{keywordflow}{and} torch.cuda.is\_available()
100         \textcolor{keywordflow}{if} self.use\_cuda:
101             print(\textcolor{stringliteral}{'[ Using CUDA for %s ]'} % self.id)
102             torch.cuda.set\_device(opt[\textcolor{stringliteral}{'gpuid'}])
103             \textcolor{keywordflow}{for} module \textcolor{keywordflow}{in} self.modules:
104                 module = module.cuda()
105 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a6c41bb531d4581a70347b311922ab885}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a6c41bb531d4581a70347b311922ab885}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!act@{act}}
\index{act@{act}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Based on current state, utter a reply (string) for next round.
\end{DoxyVerb}
 

Definition at line 187 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
187     \textcolor{keyword}{def }act(self):
188         \textcolor{stringliteral}{"""}
189 \textcolor{stringliteral}{        Based on current state, utter a reply (string) for next round.}
190 \textcolor{stringliteral}{        """}
191         out\_distr = self.speak\_net(self.h\_state)
192         \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'datatype'}] == \textcolor{stringliteral}{'train'}:
193             action = out\_distr.multinomial()
194         \textcolor{keywordflow}{else}:
195             \_, action = out\_distr.max(1)
196             action = action.unsqueeze(1)
197         self.actions.append(action)
198         action\_text = self.detokenize(action.squeeze(1))
199         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'text'}: action\_text, \textcolor{stringliteral}{'id'}: self.id\}
200 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_af06b68508ab556b36c19c9378ce1f63e}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_af06b68508ab556b36c19c9378ce1f63e}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Add command-line arguments specifically for this agent.
\end{DoxyVerb}
 

Definition at line 48 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
48     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
49         \textcolor{stringliteral}{"""}
50 \textcolor{stringliteral}{        Add command-line arguments specifically for this agent.}
51 \textcolor{stringliteral}{        """}
52         group = argparser.add\_argument\_group(\textcolor{stringliteral}{'Cooperative Game Agent Arguments'})
53         group.add\_argument(
54             \textcolor{stringliteral}{'--optimizer'},
55             default=\textcolor{stringliteral}{'adam'},
56             choices=CooperativeGameAgent.OPTIM\_OPTS.keys(),
57             help=\textcolor{stringliteral}{'Choose between pytorch optimizers. Any member of '}
58             \textcolor{stringliteral}{'torch.optim is valid and will be used with '}
59             \textcolor{stringliteral}{'default params except learning rate (as specified '}
60             \textcolor{stringliteral}{'by -lr).'},
61         )
62         group.add\_argument(
63             \textcolor{stringliteral}{'--learning-rate'}, default=1e-2, type=float, help=\textcolor{stringliteral}{'Initial learning rate'}
64         )
65         group.add\_argument(
66             \textcolor{stringliteral}{'--no-cuda'},
67             action=\textcolor{stringliteral}{'store\_true'},
68             default=\textcolor{keyword}{False},
69             help=\textcolor{stringliteral}{'disable GPUs even if available'},
70         )
71         group.add\_argument(
72             \textcolor{stringliteral}{'--gpuid'},
73             type=int,
74             default=-1,
75             help=\textcolor{stringliteral}{'which GPU device to use (defaults to cpu)'},
76         )
77         DictionaryAgent.add\_cmdline\_args(argparser)
78 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afa4b457e8d225f99cc97d30753dd1ff0}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afa4b457e8d225f99cc97d30753dd1ff0}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!detokenize@{detokenize}}
\index{detokenize@{detokenize}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{detokenize()}{detokenize()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+detokenize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{vec }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert a ``torch.autograd.Variable`` of tokens into a string.
\end{DoxyVerb}
 

Definition at line 142 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
142     \textcolor{keyword}{def }detokenize(self, vec):
143         \textcolor{stringliteral}{"""}
144 \textcolor{stringliteral}{        Convert a ``torch.autograd.Variable`` of tokens into a string.}
145 \textcolor{stringliteral}{        """}
146         text\_tokens = vec
147         \textcolor{keywordflow}{if} isinstance(text\_tokens, Variable):
148             text\_tokens = list(text\_tokens.data)
149         \textcolor{keywordflow}{return} self.dict.vec2txt(text\_tokens)
150 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aa7758c445e0e2213116e667184a6b31b}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aa7758c445e0e2213116e667184a6b31b}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!dictionary\+\_\+class@{dictionary\+\_\+class}}
\index{dictionary\+\_\+class@{dictionary\+\_\+class}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{dictionary\+\_\+class()}{dictionary\_class()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+dictionary\+\_\+class (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}If different strategy for tokenization and de-tokenization of actions is
required, override this method to return custom subclass.
\end{DoxyVerb}
 

Definition at line 40 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
40     \textcolor{keyword}{def }dictionary\_class():
41         \textcolor{stringliteral}{"""}
42 \textcolor{stringliteral}{        If different strategy for tokenization and de-tokenization of actions is}
43 \textcolor{stringliteral}{        required, override this method to return custom subclass.}
44 \textcolor{stringliteral}{        """}
45         \textcolor{keywordflow}{return} DictionaryAgent
46 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afe7b621baea1c0bbc86fb5c815428c63}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afe7b621baea1c0bbc86fb5c815428c63}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!modules@{modules}}
\index{modules@{modules}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{modules()}{modules()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+modules (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Property to return a list of pytorch modules.

Override this method while subclassing, if extra modules are added (for example,
image feature extractor in answerer).
\end{DoxyVerb}
 

Definition at line 107 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
107     \textcolor{keyword}{def }modules(self):
108         \textcolor{stringliteral}{"""}
109 \textcolor{stringliteral}{        Property to return a list of pytorch modules.}
110 \textcolor{stringliteral}{}
111 \textcolor{stringliteral}{        Override this method while subclassing, if extra modules are added (for example,}
112 \textcolor{stringliteral}{        image feature extractor in answerer).}
113 \textcolor{stringliteral}{        """}
114         \textcolor{keywordflow}{return} [self.listen\_net, self.state\_net, self.speak\_net]
115 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a6c3dbce5e745edf451daff9474b6a52f}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a6c3dbce5e745edf451daff9474b6a52f}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!observe@{observe}}
\index{observe@{observe}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Update state, given a previous reply by other agent.

In case of questioner, it can be goal description at start of episode.
\end{DoxyVerb}
 

Definition at line 151 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
151     \textcolor{keyword}{def }observe(self, observation):
152         \textcolor{stringliteral}{"""}
153 \textcolor{stringliteral}{        Update state, given a previous reply by other agent.}
154 \textcolor{stringliteral}{}
155 \textcolor{stringliteral}{        In case of questioner, it can be goal description at start of episode.}
156 \textcolor{stringliteral}{        """}
157         self.observation = observation
158 
159         \textcolor{comment}{# if episode not done, tokenize, embed and update state}
160         \textcolor{comment}{# at the end of dialog episode, perform backward pass and step}
161         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} observation.get(\textcolor{stringliteral}{'episode\_done'}, \textcolor{keyword}{False}):
162             text\_tokens = self.tokenize(observation[\textcolor{stringliteral}{'text'}])
163             token\_embeds = self.listen\_net(text\_tokens)
164             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'image'} \textcolor{keywordflow}{in} observation:
165                 token\_embeds = torch.cat((token\_embeds, observation[\textcolor{stringliteral}{'image'}]), 1)
166                 token\_embeds = token\_embeds.squeeze(1)
167             self.h\_state, self.c\_state = self.state\_net(
168                 token\_embeds, (self.h\_state, self.c\_state)
169             )
170         \textcolor{keywordflow}{else}:
171             \textcolor{keywordflow}{if} observation.get(\textcolor{stringliteral}{'reward'}, \textcolor{keywordtype}{None}):
172                 \textcolor{keywordflow}{for} action \textcolor{keywordflow}{in} self.actions:
173                     action.reinforce(observation[\textcolor{stringliteral}{'reward'}])
174                 autograd\_backward(
175                     self.actions, [\textcolor{keywordtype}{None} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} self.actions], retain\_graph=\textcolor{keyword}{True}
176                 )
177                 \textcolor{comment}{# clamp all gradients between (-5, 5)}
178                 \textcolor{keywordflow}{for} module \textcolor{keywordflow}{in} self.modules:
179                     \textcolor{keywordflow}{for} parameter \textcolor{keywordflow}{in} module.parameters():
180                         parameter.grad.data.clamp\_(min=-5, max=5)
181                 self.optimizer.step()
182             \textcolor{keywordflow}{else}:
183                 \textcolor{comment}{# start of dialog episode}
184                 self.optimizer.zero\_grad()
185                 self.reset()
186 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aa5fe586f3c20c7db8eea6ffae87b0a34}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aa5fe586f3c20c7db8eea6ffae87b0a34}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!reset@{reset}}
\index{reset@{reset}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{retain\+\_\+actions = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset internal state (and actions, if specified).
\end{DoxyVerb}
 

Definition at line 201 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
201     \textcolor{keyword}{def }reset(self, retain\_actions=False):
202         \textcolor{stringliteral}{"""}
203 \textcolor{stringliteral}{        Reset internal state (and actions, if specified).}
204 \textcolor{stringliteral}{        """}
205         \textcolor{comment}{# TODO(kd): share state across other instances during batch training}
206         self.h\_state = Variable(torch.zeros(1, self.opt[\textcolor{stringliteral}{'hidden\_size'}]))
207         self.c\_state = Variable(torch.zeros(1, self.opt[\textcolor{stringliteral}{'hidden\_size'}]))
208         \textcolor{keywordflow}{if} self.use\_cuda:
209             self.h\_state, self.c\_state = self.h\_state.cuda(), self.c\_state.cuda()
210 
211         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} retain\_actions:
212             self.actions = []
213 
214 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_adbd6d539317548bc9fe5e4ceccbe89e0}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_adbd6d539317548bc9fe5e4ceccbe89e0}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!setup\+\_\+optimizer@{setup\+\_\+optimizer}}
\index{setup\+\_\+optimizer@{setup\+\_\+optimizer}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{setup\+\_\+optimizer()}{setup\_optimizer()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+setup\+\_\+optimizer (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return a ``torch.nn.optim.optimizer`` according to command-line argument
``--optimizer``.

Override this method to setup optimizer with non-default parameters or use
custom optimizer not available as choice.
\end{DoxyVerb}
 

Definition at line 116 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
116     \textcolor{keyword}{def }setup\_optimizer(self):
117         \textcolor{stringliteral}{"""}
118 \textcolor{stringliteral}{        Return a ``torch.nn.optim.optimizer`` according to command-line argument}
119 \textcolor{stringliteral}{        ``--optimizer``.}
120 \textcolor{stringliteral}{}
121 \textcolor{stringliteral}{        Override this method to setup optimizer with non-default parameters or use}
122 \textcolor{stringliteral}{        custom optimizer not available as choice.}
123 \textcolor{stringliteral}{        """}
124         optim\_class = CooperativeGameAgent.OPTIM\_OPTS[self.opt[\textcolor{stringliteral}{'optimizer'}]]
125         kwargs = \{\textcolor{stringliteral}{'lr'}: self.opt[\textcolor{stringliteral}{'learning\_rate'}]\}
126         \textcolor{keywordflow}{if} self.opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'sgd'}:
127             kwargs[\textcolor{stringliteral}{'momentum'}] = 0.95
128             kwargs[\textcolor{stringliteral}{'nesterov'}] = \textcolor{keyword}{True}
129         \textcolor{keywordflow}{return} optim\_class([module.parameters() \textcolor{keywordflow}{for} module \textcolor{keywordflow}{in} self.modules], **kwargs)
130 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ad61f88467c3cef93c85292b733a5ec91}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ad61f88467c3cef93c85292b733a5ec91}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!tokenize@{tokenize}}
\index{tokenize@{tokenize}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{tokenize()}{tokenize()}}
{\footnotesize\ttfamily def projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+tokenize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert text observaton (string) to a ``torch.autograd.Variable`` of tokens
using ``DictionaryAgent``.
\end{DoxyVerb}
 

Definition at line 131 of file coopgame\+\_\+agent.\+py.


\begin{DoxyCode}
131     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_a1fdb457e98eb4e4c26047e229686a616}{tokenize}(self, text):
132         \textcolor{stringliteral}{"""}
133 \textcolor{stringliteral}{        Convert text observaton (string) to a ``torch.autograd.Variable`` of tokens}
134 \textcolor{stringliteral}{        using ``DictionaryAgent``.}
135 \textcolor{stringliteral}{        """}
136         text\_tokens = self.dict.txt2vec(text)
137         token\_vars = Variable(torch.Tensor(text\_tokens))
138         \textcolor{keywordflow}{if} self.use\_cuda:
139             token\_vars = token\_vars.cuda()
140         \textcolor{keywordflow}{return} token\_vars
141 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afc43683bdc26833326ee8b1249f1009a}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_afc43683bdc26833326ee8b1249f1009a}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!actions@{actions}}
\index{actions@{actions}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{actions}{actions}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+actions}



Definition at line 82 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a821bc77afbc968ce32f4ced5271ffb65}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a821bc77afbc968ce32f4ced5271ffb65}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!c\+\_\+state@{c\+\_\+state}}
\index{c\+\_\+state@{c\+\_\+state}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{c\+\_\+state}{c\_state}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+c\+\_\+state}



Definition at line 167 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ac7e33d98b63ce28369f88a59b631726a}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ac7e33d98b63ce28369f88a59b631726a}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!dict\+\_\+agent@{dict\+\_\+agent}}
\index{dict\+\_\+agent@{dict\+\_\+agent}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{dict\+\_\+agent}{dict\_agent}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+dict\+\_\+agent}



Definition at line 96 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a7ce6d36ddb01828b6caef828b71e7380}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a7ce6d36ddb01828b6caef828b71e7380}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!h\+\_\+state@{h\+\_\+state}}
\index{h\+\_\+state@{h\+\_\+state}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{h\+\_\+state}{h\_state}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+h\+\_\+state}



Definition at line 206 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ab1d8f1563dd1c2fc4f2716f4b193a68e}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_ab1d8f1563dd1c2fc4f2716f4b193a68e}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!id@{id}}
\index{id@{id}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+id}



Definition at line 81 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a1c7bbe7c817146f3f4d9cbe68a52692b}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a1c7bbe7c817146f3f4d9cbe68a52692b}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!listen\+\_\+net@{listen\+\_\+net}}
\index{listen\+\_\+net@{listen\+\_\+net}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{listen\+\_\+net}{listen\_net}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+listen\+\_\+net}



Definition at line 89 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a935d5ccb012f0acfccddc34ba1c414ad}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a935d5ccb012f0acfccddc34ba1c414ad}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!observation@{observation}}
\index{observation@{observation}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+observation}



Definition at line 157 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a20a6c84adea72558d4586ccd2f71eff9}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a20a6c84adea72558d4586ccd2f71eff9}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!O\+P\+T\+I\+M\+\_\+\+O\+P\+TS@{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}}
\index{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS@{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}{OPTIM\_OPTS}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+O\+P\+T\+I\+M\+\_\+\+O\+P\+TS\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 27 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a20be5fabcb0e4716fdc6fb9242f317ef}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a20be5fabcb0e4716fdc6fb9242f317ef}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+optimizer}



Definition at line 94 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aea61853aed7368fea4e2826dd1d551b4}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_aea61853aed7368fea4e2826dd1d551b4}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!speak\+\_\+net@{speak\+\_\+net}}
\index{speak\+\_\+net@{speak\+\_\+net}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{speak\+\_\+net}{speak\_net}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+speak\+\_\+net}



Definition at line 91 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a09ffa1bb1ab48ffc8310e683918c930f}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a09ffa1bb1ab48ffc8310e683918c930f}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!state\+\_\+net@{state\+\_\+net}}
\index{state\+\_\+net@{state\+\_\+net}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{state\+\_\+net}{state\_net}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+state\+\_\+net}



Definition at line 90 of file coopgame\+\_\+agent.\+py.

\mbox{\Hypertarget{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a070a6528c2814e0df9e714bdc178c736}\label{classprojects_1_1taskntalk_1_1coopgame__agent_1_1CooperativeGameAgent_a070a6528c2814e0df9e714bdc178c736}} 
\index{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent@{projects\+::taskntalk\+::coopgame\+\_\+agent\+::\+Cooperative\+Game\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily projects.\+taskntalk.\+coopgame\+\_\+agent.\+Cooperative\+Game\+Agent.\+use\+\_\+cuda}



Definition at line 99 of file coopgame\+\_\+agent.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/taskntalk/\hyperlink{coopgame__agent_8py}{coopgame\+\_\+agent.\+py}\end{DoxyCompactItemize}
