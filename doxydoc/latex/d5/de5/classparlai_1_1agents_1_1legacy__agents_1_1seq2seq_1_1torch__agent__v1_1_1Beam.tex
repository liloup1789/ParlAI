\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam}\index{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam@{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{d3/d15/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=196pt]{d0/d74/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_af0f9f1c8fc21c9a00932129c2239b6a9}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3e3407eeb8dd25ede9950524146f9403}{beam\+\_\+size}, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a9c3bd0baa9376a027dabbbe43c6aac5e}{min\+\_\+length}=3, padding\+\_\+token=0, bos\+\_\+token=1, eos\+\_\+token=2, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a65b34839f24c68fa76df61cff22e177e}{min\+\_\+n\+\_\+best}=3, cuda=\textquotesingle{}cpu\textquotesingle{}, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aa2ba93350ee7aa9ab2ae5ba01c1c0c1e}{block\+\_\+ngram}=0)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a4f7299716e2ca82b0f8759ea11fec60a}{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab714337648fc40cffa481985b382fcc4}{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a6c6cf89b73830b99bba0420c720c50d8}{advance} (self, softmax\+\_\+probs)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a8b62a64897663062c4e3cf9cf85fce50}{done} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_abd7ea96a6f890297fc526e31e143a018}{get\+\_\+top\+\_\+hyp} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a5ae82a3d567dd8f282678d0ee40aa41e}{get\+\_\+hyp\+\_\+from\+\_\+finished} (self, hypothesis\+\_\+tail)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a94a3638f18c959a5a9223061ea9af77e}{get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail} (self, ts, hypid)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3dbc095780f560a02bfafc0e0f646ebc}{get\+\_\+rescored\+\_\+finished} (self, n\+\_\+best=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a6d43c0169b15e4d6a754a91a25137709}{check\+\_\+finished} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_af4d7c9fd1fd93f59148fe7ab90c58da9}{get\+\_\+beam\+\_\+dot} (self, dictionary=None, n\+\_\+best=None)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afb6aafacc0ad6d28539fe1406468ae66}{find\+\_\+ngrams} (input\+\_\+list, n)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afb4e5fd2e6a13e7b64fa00d2336e5e14}{get\+\_\+pretty\+\_\+hypothesis} (list\+\_\+of\+\_\+hypotails)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3e3407eeb8dd25ede9950524146f9403}{beam\+\_\+size}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a9c3bd0baa9376a027dabbbe43c6aac5e}{min\+\_\+length}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a53606067a92569a4fa3603f07f067a5c}{eos}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a09f679ae508459a7c45863856ec7d413}{bos}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aadd5d9795e5d7ac5c5339d6136eb7ba4}{pad}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afda1961fd241c49dadf623abb81b688d}{device}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ad7e21da35d537a09f23973b415e62660}{scores}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a2be10cea5a3cbf664ec9a9a9d283e7a9}{all\+\_\+scores}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a673dd5c13cababb5d04b5af72a740222}{bookkeep}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a13bd578395eeca81c0d1712e220c4b37}{outputs}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a5e2cb2f6be6aa0d1a6ff971d271356b1}{finished}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aebe8a3e030fba84dd31dc9d68731038e}{Hypothesis\+Tail}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab9e04c7385dd553a6a8a8c76650d60b7}{eos\+\_\+top}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab1d9fb1a27a4a96ea9293720eb812487}{eos\+\_\+top\+\_\+ts}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a44a03facdc6259db57720fcae9f9a6ed}{n\+\_\+best\+\_\+counter}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a65b34839f24c68fa76df61cff22e177e}{min\+\_\+n\+\_\+best}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aa2ba93350ee7aa9ab2ae5ba01c1c0c1e}{block\+\_\+ngram}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a35c45bf55c21713f720fffdaafc68081}{partial\+\_\+hyps}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Generic beam class.

It keeps information about beam_size hypothesis.
\end{DoxyVerb}
 

Definition at line 1074 of file torch\+\_\+agent\+\_\+v1.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_af0f9f1c8fc21c9a00932129c2239b6a9}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_af0f9f1c8fc21c9a00932129c2239b6a9}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{beam\+\_\+size,  }\item[{}]{min\+\_\+length = {\ttfamily 3},  }\item[{}]{padding\+\_\+token = {\ttfamily 0},  }\item[{}]{bos\+\_\+token = {\ttfamily 1},  }\item[{}]{eos\+\_\+token = {\ttfamily 2},  }\item[{}]{min\+\_\+n\+\_\+best = {\ttfamily 3},  }\item[{}]{cuda = {\ttfamily \textquotesingle{}cpu\textquotesingle{}},  }\item[{}]{block\+\_\+ngram = {\ttfamily 0} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Instantiate Beam object.

:param beam_size: number of hypothesis in the beam
:param min_length: minimum length of the predicted sequence
:param padding_token: Set to 0 as usual in ParlAI
:param bos_token: Set to 1 as usual in ParlAI
:param eos_token: Set to 2 as usual in ParlAI
:param min_n_best: Beam will not be done unless this amount of finished
           hypothesis (with EOS) is done
:param cuda: What device to use for computations
\end{DoxyVerb}
 

Definition at line 1091 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1091     ):
1092         \textcolor{stringliteral}{"""}
1093 \textcolor{stringliteral}{        Instantiate Beam object.}
1094 \textcolor{stringliteral}{}
1095 \textcolor{stringliteral}{        :param beam\_size: number of hypothesis in the beam}
1096 \textcolor{stringliteral}{        :param min\_length: minimum length of the predicted sequence}
1097 \textcolor{stringliteral}{        :param padding\_token: Set to 0 as usual in ParlAI}
1098 \textcolor{stringliteral}{        :param bos\_token: Set to 1 as usual in ParlAI}
1099 \textcolor{stringliteral}{        :param eos\_token: Set to 2 as usual in ParlAI}
1100 \textcolor{stringliteral}{        :param min\_n\_best: Beam will not be done unless this amount of finished}
1101 \textcolor{stringliteral}{                           hypothesis (with EOS) is done}
1102 \textcolor{stringliteral}{        :param cuda: What device to use for computations}
1103 \textcolor{stringliteral}{        """}
1104         self.beam\_size = beam\_size
1105         self.min\_length = min\_length
1106         self.eos = eos\_token
1107         self.bos = bos\_token
1108         self.pad = padding\_token
1109         self.device = cuda
1110         \textcolor{comment}{# recent score for each hypo in the beam}
1111         self.scores = torch.Tensor(self.beam\_size).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().zero\_().to(self.device)
1112         \textcolor{comment}{# self.scores values per each time step}
1113         self.all\_scores = [torch.Tensor([0.0] * beam\_size).to(self.device)]
1114         \textcolor{comment}{# backtracking id to hypothesis at previous time step}
1115         self.bookkeep = []
1116         \textcolor{comment}{# output tokens at each time step}
1117         self.outputs = [
1118             torch.Tensor(self.beam\_size).long().fill\_(self.bos).to(self.device)
1119         ]
1120         \textcolor{comment}{# keeps tuples (score, time\_step, hyp\_id)}
1121         self.finished = []
1122         self.HypothesisTail = namedtuple(
1123             \textcolor{stringliteral}{'HypothesisTail'}, [\textcolor{stringliteral}{'timestep'}, \textcolor{stringliteral}{'hypid'}, \textcolor{stringliteral}{'score'}, \textcolor{stringliteral}{'tokenid'}]
1124         )
1125         self.eos\_top = \textcolor{keyword}{False}
1126         self.eos\_top\_ts = \textcolor{keywordtype}{None}
1127         self.n\_best\_counter = 0
1128         self.min\_n\_best = min\_n\_best
1129         self.block\_ngram = block\_ngram
1130         self.partial\_hyps = [[self.bos] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(beam\_size)]
1131 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a6c6cf89b73830b99bba0420c720c50d8}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a6c6cf89b73830b99bba0420c720c50d8}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!advance@{advance}}
\index{advance@{advance}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{advance()}{advance()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+advance (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{softmax\+\_\+probs }\end{DoxyParamCaption})}

\begin{DoxyVerb}Advance the beam one step.
\end{DoxyVerb}
 

Definition at line 1151 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1151     \textcolor{keyword}{def }advance(self, softmax\_probs):
1152         \textcolor{stringliteral}{"""}
1153 \textcolor{stringliteral}{        Advance the beam one step.}
1154 \textcolor{stringliteral}{        """}
1155         voc\_size = softmax\_probs.size(-1)
1156         current\_length = len(self.all\_scores) - 1
1157         \textcolor{keywordflow}{if} current\_length < self.min\_length:
1158             \textcolor{comment}{# penalize all eos probs to make it decode longer}
1159             \textcolor{keywordflow}{for} hyp\_id \textcolor{keywordflow}{in} range(softmax\_probs.size(0)):
1160                 softmax\_probs[hyp\_id][self.eos] = -NEAR\_INF
1161         \textcolor{keywordflow}{if} len(self.bookkeep) == 0:
1162             \textcolor{comment}{# the first step we take only the first hypo into account since all}
1163             \textcolor{comment}{# hypos are the same initially}
1164             beam\_scores = softmax\_probs[0]
1165         \textcolor{keywordflow}{else}:
1166             \textcolor{comment}{# we need to sum up hypo scores and curr softmax scores before topk}
1167             \textcolor{comment}{# [beam\_size, voc\_size]}
1168             beam\_scores = softmax\_probs + self.scores.unsqueeze(1).expand\_as(
1169                 softmax\_probs
1170             )
1171             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(self.outputs[-1].size(0)):
1172                 \textcolor{keywordflow}{if} self.block\_ngram > 0:
1173                     current\_hypo = self.partial\_hyps[i][1:]
1174                     current\_ngrams = []
1175                     \textcolor{keywordflow}{for} ng \textcolor{keywordflow}{in} range(self.block\_ngram):
1176                         ngrams = Beam.find\_ngrams(current\_hypo, ng)
1177                         \textcolor{keywordflow}{if} len(ngrams) > 0:
1178                             current\_ngrams.extend(ngrams)
1179                     counted\_ngrams = Counter(current\_ngrams)
1180                     \textcolor{keywordflow}{if} any(v > 1 \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} counted\_ngrams.items()):
1181                         \textcolor{comment}{# block this hypothesis hard}
1182                         beam\_scores[i] = -NEAR\_INF
1183 
1184                 \textcolor{comment}{#  if previous output hypo token had eos}
1185                 \textcolor{comment}{# we penalize those word probs to never be chosen}
1186                 \textcolor{keywordflow}{if} self.outputs[-1][i] == self.eos:
1187                     \textcolor{comment}{# beam\_scores[i] is voc\_size array for i-th hypo}
1188                     beam\_scores[i] = -NEAR\_INF
1189 
1190         flatten\_beam\_scores = beam\_scores.view(-1)  \textcolor{comment}{# [beam\_size * voc\_size]}
1191         with torch.no\_grad():
1192             best\_scores, best\_idxs = torch.topk(
1193                 flatten\_beam\_scores, self.beam\_size, dim=-1
1194             )
1195 
1196         self.scores = best\_scores
1197         self.all\_scores.append(self.scores)
1198         \textcolor{comment}{# get the backtracking hypothesis id as a multiple of full voc\_sizes}
1199         hyp\_ids = best\_idxs / voc\_size
1200         \textcolor{comment}{# get the actual word id from residual of the same division}
1201         tok\_ids = best\_idxs % voc\_size
1202 
1203         self.outputs.append(tok\_ids)
1204         self.bookkeep.append(hyp\_ids)
1205         self.partial\_hyps = [
1206             self.partial\_hyps[hyp\_ids[i]] + [tok\_ids[i].item()]
1207             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(self.beam\_size)
1208         ]
1209 
1210         \textcolor{comment}{#  check new hypos for eos label, if we have some, add to finished}
1211         \textcolor{keywordflow}{for} hypid \textcolor{keywordflow}{in} range(self.beam\_size):
1212             \textcolor{keywordflow}{if} self.outputs[-1][hypid] == self.eos:
1213                 \textcolor{comment}{#  this is finished hypo, adding to finished}
1214                 eostail = self.HypothesisTail(
1215                     timestep=len(self.outputs) - 1,
1216                     hypid=hypid,
1217                     score=self.scores[hypid],
1218                     tokenid=self.eos,
1219                 )
1220                 self.finished.append(eostail)
1221                 self.n\_best\_counter += 1
1222 
1223         \textcolor{keywordflow}{if} self.outputs[-1][0] == self.eos:
1224             self.eos\_top = \textcolor{keyword}{True}
1225             \textcolor{keywordflow}{if} self.eos\_top\_ts \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
1226                 self.eos\_top\_ts = len(self.outputs) - 1
1227 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a6d43c0169b15e4d6a754a91a25137709}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a6d43c0169b15e4d6a754a91a25137709}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!check\+\_\+finished@{check\+\_\+finished}}
\index{check\+\_\+finished@{check\+\_\+finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{check\+\_\+finished()}{check\_finished()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+check\+\_\+finished (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Check if self.finished is empty and add hyptail in that case.

This will be suboptimal hypothesis since the model did not get any EOS

:returns: None
\end{DoxyVerb}
 

Definition at line 1334 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1334     \textcolor{keyword}{def }check\_finished(self):
1335         \textcolor{stringliteral}{"""}
1336 \textcolor{stringliteral}{        Check if self.finished is empty and add hyptail in that case.}
1337 \textcolor{stringliteral}{}
1338 \textcolor{stringliteral}{        This will be suboptimal hypothesis since the model did not get any EOS}
1339 \textcolor{stringliteral}{}
1340 \textcolor{stringliteral}{        :returns: None}
1341 \textcolor{stringliteral}{        """}
1342         \textcolor{keywordflow}{if} len(self.finished) == 0:
1343             \textcolor{comment}{# we change output because we want outputs to have eos}
1344             \textcolor{comment}{# to pass assert in L102, it is ok since empty self.finished}
1345             \textcolor{comment}{# means junk prediction anyway}
1346             self.outputs[-1][0] = self.eos
1347             hyptail = self.HypothesisTail(
1348                 timestep=len(self.outputs) - 1,
1349                 hypid=0,
1350                 score=self.all\_scores[-1][0],
1351                 tokenid=self.outputs[-1][0],
1352             )
1353 
1354             self.finished.append(hyptail)
1355 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a8b62a64897663062c4e3cf9cf85fce50}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a8b62a64897663062c4e3cf9cf85fce50}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!done@{done}}
\index{done@{done}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{done()}{done()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+done (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return whether beam search is complete.
\end{DoxyVerb}
 

Definition at line 1228 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1228     \textcolor{keyword}{def }done(self):
1229         \textcolor{stringliteral}{"""}
1230 \textcolor{stringliteral}{        Return whether beam search is complete.}
1231 \textcolor{stringliteral}{        """}
1232         \textcolor{keywordflow}{return} self.eos\_top \textcolor{keywordflow}{and} self.n\_best\_counter >= self.min\_n\_best
1233 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afb6aafacc0ad6d28539fe1406468ae66}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afb6aafacc0ad6d28539fe1406468ae66}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!find\+\_\+ngrams@{find\+\_\+ngrams}}
\index{find\+\_\+ngrams@{find\+\_\+ngrams}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{find\+\_\+ngrams()}{find\_ngrams()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+find\+\_\+ngrams (\begin{DoxyParamCaption}\item[{}]{input\+\_\+list,  }\item[{}]{n }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Get list of ngrams with context length n-1.
\end{DoxyVerb}
 

Definition at line 1133 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1133     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1dict__v0_aa7398720bbf0f8e82c5b1495313f4f8b}{find\_ngrams}(input\_list, n):
1134         \textcolor{stringliteral}{"""}
1135 \textcolor{stringliteral}{        Get list of ngrams with context length n-1.}
1136 \textcolor{stringliteral}{        """}
1137         \textcolor{keywordflow}{return} list(zip(*[input\_list[i:] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(n)]))
1138 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab714337648fc40cffa481985b382fcc4}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab714337648fc40cffa481985b382fcc4}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step}}
\index{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step()}{get\_backtrack\_from\_current\_step()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+backtrack\+\_\+from\+\_\+current\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get the backtrack at the current step.
\end{DoxyVerb}
 

Definition at line 1145 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1145     \textcolor{keyword}{def }get\_backtrack\_from\_current\_step(self):
1146         \textcolor{stringliteral}{"""}
1147 \textcolor{stringliteral}{        Get the backtrack at the current step.}
1148 \textcolor{stringliteral}{        """}
1149         \textcolor{keywordflow}{return} self.bookkeep[-1]
1150 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_af4d7c9fd1fd93f59148fe7ab90c58da9}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_af4d7c9fd1fd93f59148fe7ab90c58da9}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+beam\+\_\+dot@{get\+\_\+beam\+\_\+dot}}
\index{get\+\_\+beam\+\_\+dot@{get\+\_\+beam\+\_\+dot}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+beam\+\_\+dot()}{get\_beam\_dot()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+beam\+\_\+dot (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{dictionary = {\ttfamily None},  }\item[{}]{n\+\_\+best = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Create pydot graph representation of the beam.

:param outputs: self.outputs from the beam
:param dictionary: tok 2 word dict to save words in the tree nodes
:returns: pydot graph
\end{DoxyVerb}
 

Definition at line 1356 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1356     \textcolor{keyword}{def }get\_beam\_dot(self, dictionary=None, n\_best=None):
1357         \textcolor{stringliteral}{"""}
1358 \textcolor{stringliteral}{        Create pydot graph representation of the beam.}
1359 \textcolor{stringliteral}{}
1360 \textcolor{stringliteral}{        :param outputs: self.outputs from the beam}
1361 \textcolor{stringliteral}{        :param dictionary: tok 2 word dict to save words in the tree nodes}
1362 \textcolor{stringliteral}{        :returns: pydot graph}
1363 \textcolor{stringliteral}{        """}
1364         \textcolor{keywordflow}{try}:
1365             \textcolor{keyword}{import} pydot
1366         \textcolor{keywordflow}{except} ImportError:
1367             print(\textcolor{stringliteral}{"Please install pydot package to dump beam visualization"})
1368 
1369         graph = pydot.Dot(graph\_type=\textcolor{stringliteral}{'digraph'})
1370         outputs = [i.tolist() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.outputs]
1371         bookkeep = [i.tolist() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.bookkeep]
1372         all\_scores = [i.tolist() \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} self.all\_scores]
1373         \textcolor{keywordflow}{if} n\_best \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
1374             n\_best = \hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(self.beam\_size / 2)
1375 
1376         \textcolor{comment}{# get top nbest hyp}
1377         top\_hyp\_idx\_n\_best = []
1378         n\_best\_colors = [\textcolor{stringliteral}{'aquamarine'}, \textcolor{stringliteral}{'chocolate1'}, \textcolor{stringliteral}{'deepskyblue'}, \textcolor{stringliteral}{'green2'}, \textcolor{stringliteral}{'tan'}]
1379         sorted\_finished = self.get\_rescored\_finished(n\_best=n\_best)
1380         \textcolor{keywordflow}{for} hyptail \textcolor{keywordflow}{in} sorted\_finished:
1381             \textcolor{comment}{# do not include EOS since it has rescored score not from original}
1382             \textcolor{comment}{# self.all\_scores, we color EOS with black}
1383             top\_hyp\_idx\_n\_best.append(self.get\_hyp\_from\_finished(hyptail))
1384 
1385         \textcolor{comment}{# create nodes}
1386         \textcolor{keywordflow}{for} tstep, lis \textcolor{keywordflow}{in} enumerate(outputs):
1387             \textcolor{keywordflow}{for} hypid, token \textcolor{keywordflow}{in} enumerate(lis):
1388                 \textcolor{keywordflow}{if} tstep == 0:
1389                     hypid = 0  \textcolor{comment}{# collapse all \_\_NULL\_\_ nodes}
1390                 node\_tail = self.HypothesisTail(
1391                     timestep=tstep,
1392                     hypid=hypid,
1393                     score=all\_scores[tstep][hypid],
1394                     tokenid=token,
1395                 )
1396                 color = \textcolor{stringliteral}{'white'}
1397                 rank = \textcolor{keywordtype}{None}
1398                 \textcolor{keywordflow}{for} i, hypseq \textcolor{keywordflow}{in} enumerate(top\_hyp\_idx\_n\_best):
1399                     \textcolor{keywordflow}{if} node\_tail \textcolor{keywordflow}{in} hypseq:
1400                         \textcolor{keywordflow}{if} n\_best <= 5:  \textcolor{comment}{# color nodes only if <=5}
1401                             color = n\_best\_colors[i]
1402                         rank = i
1403                         \textcolor{keywordflow}{break}
1404                 label = (
1405                     \textcolor{stringliteral}{"<\{\}"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
1406                         dictionary.vec2txt([token]) \textcolor{keywordflow}{if} dictionary \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} token
1407                     )
1408                     + \textcolor{stringliteral}{" : "}
1409                     + \textcolor{stringliteral}{"\{:.\{prec\}f\}>"}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(all\_scores[tstep][hypid], prec=3)
1410                 )
1411 
1412                 graph.add\_node(
1413                     pydot.Node(
1414                         node\_tail.\_\_repr\_\_(),
1415                         label=label,
1416                         fillcolor=color,
1417                         style=\textcolor{stringliteral}{'filled'},
1418                         xlabel=\textcolor{stringliteral}{'\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(rank) \textcolor{keywordflow}{if} rank \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} \textcolor{stringliteral}{''},
1419                     )
1420                 )
1421 
1422         \textcolor{comment}{# create edges}
1423         \textcolor{keywordflow}{for} revtstep, lis \textcolor{keywordflow}{in} reversed(list(enumerate(bookkeep))):
1424             \textcolor{keywordflow}{for} i, prev\_id \textcolor{keywordflow}{in} enumerate(lis):
1425                 from\_node = graph.get\_node(
1426                     \textcolor{stringliteral}{'"\{\}"'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
1427                         self.HypothesisTail(
1428                             timestep=revtstep,
1429                             hypid=prev\_id,
1430                             score=all\_scores[revtstep][prev\_id],
1431                             tokenid=outputs[revtstep][prev\_id],
1432                         ).\_\_repr\_\_()
1433                     )
1434                 )[0]
1435                 to\_node = graph.get\_node(
1436                     \textcolor{stringliteral}{'"\{\}"'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
1437                         self.HypothesisTail(
1438                             timestep=revtstep + 1,
1439                             hypid=i,
1440                             score=all\_scores[revtstep + 1][i],
1441                             tokenid=outputs[revtstep + 1][i],
1442                         ).\_\_repr\_\_()
1443                     )
1444                 )[0]
1445                 newedge = pydot.Edge(from\_node.get\_name(), to\_node.get\_name())
1446                 graph.add\_edge(newedge)
1447 
1448         \textcolor{keywordflow}{return} graph
1449 \end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a5ae82a3d567dd8f282678d0ee40aa41e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a5ae82a3d567dd8f282678d0ee40aa41e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+hyp\+\_\+from\+\_\+finished@{get\+\_\+hyp\+\_\+from\+\_\+finished}}
\index{get\+\_\+hyp\+\_\+from\+\_\+finished@{get\+\_\+hyp\+\_\+from\+\_\+finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+hyp\+\_\+from\+\_\+finished()}{get\_hyp\_from\_finished()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+hyp\+\_\+from\+\_\+finished (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{hypothesis\+\_\+tail }\end{DoxyParamCaption})}

\begin{DoxyVerb}Extract hypothesis ending with EOS at timestep with hyp_id.

:param timestep: timestep with range up to len(self.outputs)-1
:param hyp_id: id with range up to beam_size-1
:return: hypothesis sequence
\end{DoxyVerb}
 

Definition at line 1246 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1246     \textcolor{keyword}{def }get\_hyp\_from\_finished(self, hypothesis\_tail):
1247         \textcolor{stringliteral}{"""}
1248 \textcolor{stringliteral}{        Extract hypothesis ending with EOS at timestep with hyp\_id.}
1249 \textcolor{stringliteral}{}
1250 \textcolor{stringliteral}{        :param timestep: timestep with range up to len(self.outputs)-1}
1251 \textcolor{stringliteral}{        :param hyp\_id: id with range up to beam\_size-1}
1252 \textcolor{stringliteral}{        :return: hypothesis sequence}
1253 \textcolor{stringliteral}{        """}
1254         \textcolor{keyword}{assert} self.outputs[hypothesis\_tail.timestep][hypothesis\_tail.hypid] == self.eos
1255         \textcolor{keyword}{assert} hypothesis\_tail.tokenid == self.eos
1256         hyp\_idx = []
1257         endback = hypothesis\_tail.hypid
1258         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(hypothesis\_tail.timestep, -1, -1):
1259             hyp\_idx.append(
1260                 self.HypothesisTail(
1261                     timestep=i,
1262                     hypid=endback,
1263                     score=self.all\_scores[i][endback],
1264                     tokenid=self.outputs[i][endback],
1265                 )
1266             )
1267             endback = self.bookkeep[i - 1][endback]
1268 
1269         \textcolor{keywordflow}{return} hyp\_idx
1270 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a4f7299716e2ca82b0f8759ea11fec60a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a4f7299716e2ca82b0f8759ea11fec60a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+output\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step}}
\index{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step@{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+output\+\_\+from\+\_\+current\+\_\+step()}{get\_output\_from\_current\_step()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+output\+\_\+from\+\_\+current\+\_\+step (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get the outputput at the current step.
\end{DoxyVerb}
 

Definition at line 1139 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1139     \textcolor{keyword}{def }get\_output\_from\_current\_step(self):
1140         \textcolor{stringliteral}{"""}
1141 \textcolor{stringliteral}{        Get the outputput at the current step.}
1142 \textcolor{stringliteral}{        """}
1143         \textcolor{keywordflow}{return} self.outputs[-1]
1144 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a94a3638f18c959a5a9223061ea9af77e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a94a3638f18c959a5a9223061ea9af77e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail@{get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail}}
\index{get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail@{get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail()}{get\_partial\_hyp\_from\_tail()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+partial\+\_\+hyp\+\_\+from\+\_\+tail (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{ts,  }\item[{}]{hypid }\end{DoxyParamCaption})}



Definition at line 1284 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1284     \textcolor{keyword}{def }get\_partial\_hyp\_from\_tail(self, ts, hypid):
1285         hypothesis\_tail = self.HypothesisTail(
1286             timestep=ts,
1287             hypid=torch.Tensor([hypid]).long(),
1288             score=self.all\_scores[ts][hypid],
1289             tokenid=self.outputs[ts][hypid],
1290         )
1291         hyp\_idx = []
1292         endback = hypothesis\_tail.hypid
1293         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(hypothesis\_tail.timestep, -1, -1):
1294             hyp\_idx.append(
1295                 self.HypothesisTail(
1296                     timestep=i,
1297                     hypid=endback,
1298                     score=self.all\_scores[i][endback],
1299                     tokenid=self.outputs[i][endback],
1300                 )
1301             )
1302             endback = self.bookkeep[i - 1][endback]
1303 
1304         \textcolor{keywordflow}{return} hyp\_idx
1305 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afb4e5fd2e6a13e7b64fa00d2336e5e14}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afb4e5fd2e6a13e7b64fa00d2336e5e14}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+pretty\+\_\+hypothesis@{get\+\_\+pretty\+\_\+hypothesis}}
\index{get\+\_\+pretty\+\_\+hypothesis@{get\+\_\+pretty\+\_\+hypothesis}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+pretty\+\_\+hypothesis()}{get\_pretty\_hypothesis()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+pretty\+\_\+hypothesis (\begin{DoxyParamCaption}\item[{}]{list\+\_\+of\+\_\+hypotails }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Return prettier version of the hypotheses.
\end{DoxyVerb}
 

Definition at line 1272 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1272     \textcolor{keyword}{def }get\_pretty\_hypothesis(list\_of\_hypotails):
1273         \textcolor{stringliteral}{"""}
1274 \textcolor{stringliteral}{        Return prettier version of the hypotheses.}
1275 \textcolor{stringliteral}{        """}
1276         hypothesis = []
1277         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} list\_of\_hypotails:
1278             hypothesis.append(i.tokenid)
1279 
1280         hypothesis = torch.stack(list(reversed(hypothesis)))
1281 
1282         \textcolor{keywordflow}{return} hypothesis
1283 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3dbc095780f560a02bfafc0e0f646ebc}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3dbc095780f560a02bfafc0e0f646ebc}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+rescored\+\_\+finished@{get\+\_\+rescored\+\_\+finished}}
\index{get\+\_\+rescored\+\_\+finished@{get\+\_\+rescored\+\_\+finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+rescored\+\_\+finished()}{get\_rescored\_finished()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+rescored\+\_\+finished (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{n\+\_\+best = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return finished hypotheses in rescored order.

:param n_best: how many n best hypothesis to return
:return: list with hypothesis
\end{DoxyVerb}
 

Definition at line 1306 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1306     \textcolor{keyword}{def }get\_rescored\_finished(self, n\_best=None):
1307         \textcolor{stringliteral}{"""}
1308 \textcolor{stringliteral}{        Return finished hypotheses in rescored order.}
1309 \textcolor{stringliteral}{}
1310 \textcolor{stringliteral}{        :param n\_best: how many n best hypothesis to return}
1311 \textcolor{stringliteral}{        :return: list with hypothesis}
1312 \textcolor{stringliteral}{        """}
1313         rescored\_finished = []
1314         \textcolor{keywordflow}{for} finished\_item \textcolor{keywordflow}{in} self.finished:
1315             current\_length = finished\_item.timestep + 1
1316             \textcolor{comment}{# these weights are from Google NMT paper}
1317             length\_penalty = math.pow((1 + current\_length) / 6, 0.65)
1318             rescored\_finished.append(
1319                 self.HypothesisTail(
1320                     timestep=finished\_item.timestep,
1321                     hypid=finished\_item.hypid,
1322                     score=finished\_item.score / length\_penalty,
1323                     tokenid=finished\_item.tokenid,
1324                 )
1325             )
1326 
1327         srted = sorted(rescored\_finished, key=attrgetter(\textcolor{stringliteral}{'score'}), reverse=\textcolor{keyword}{True})
1328 
1329         \textcolor{keywordflow}{if} n\_best \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
1330             srted = srted[:n\_best]
1331 
1332         \textcolor{keywordflow}{return} srted
1333 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_abd7ea96a6f890297fc526e31e143a018}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_abd7ea96a6f890297fc526e31e143a018}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!get\+\_\+top\+\_\+hyp@{get\+\_\+top\+\_\+hyp}}
\index{get\+\_\+top\+\_\+hyp@{get\+\_\+top\+\_\+hyp}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{get\+\_\+top\+\_\+hyp()}{get\_top\_hyp()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+get\+\_\+top\+\_\+hyp (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get single best hypothesis.

:return: hypothesis sequence and the final score
\end{DoxyVerb}
 

Definition at line 1234 of file torch\+\_\+agent\+\_\+v1.\+py.


\begin{DoxyCode}
1234     \textcolor{keyword}{def }get\_top\_hyp(self):
1235         \textcolor{stringliteral}{"""}
1236 \textcolor{stringliteral}{        Get single best hypothesis.}
1237 \textcolor{stringliteral}{}
1238 \textcolor{stringliteral}{        :return: hypothesis sequence and the final score}
1239 \textcolor{stringliteral}{        """}
1240         top\_hypothesis\_tail = self.get\_rescored\_finished(n\_best=1)[0]
1241         \textcolor{keywordflow}{return} (
1242             self.get\_hyp\_from\_finished(top\_hypothesis\_tail),
1243             top\_hypothesis\_tail.score,
1244         )
1245 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a2be10cea5a3cbf664ec9a9a9d283e7a9}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a2be10cea5a3cbf664ec9a9a9d283e7a9}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!all\+\_\+scores@{all\+\_\+scores}}
\index{all\+\_\+scores@{all\+\_\+scores}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{all\+\_\+scores}{all\_scores}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+all\+\_\+scores}



Definition at line 1113 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3e3407eeb8dd25ede9950524146f9403}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a3e3407eeb8dd25ede9950524146f9403}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!beam\+\_\+size@{beam\+\_\+size}}
\index{beam\+\_\+size@{beam\+\_\+size}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{beam\+\_\+size}{beam\_size}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+beam\+\_\+size}



Definition at line 1104 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aa2ba93350ee7aa9ab2ae5ba01c1c0c1e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aa2ba93350ee7aa9ab2ae5ba01c1c0c1e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!block\+\_\+ngram@{block\+\_\+ngram}}
\index{block\+\_\+ngram@{block\+\_\+ngram}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{block\+\_\+ngram}{block\_ngram}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+block\+\_\+ngram}



Definition at line 1129 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a673dd5c13cababb5d04b5af72a740222}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a673dd5c13cababb5d04b5af72a740222}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!bookkeep@{bookkeep}}
\index{bookkeep@{bookkeep}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{bookkeep}{bookkeep}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+bookkeep}



Definition at line 1115 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a09f679ae508459a7c45863856ec7d413}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a09f679ae508459a7c45863856ec7d413}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!bos@{bos}}
\index{bos@{bos}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{bos}{bos}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+bos}



Definition at line 1107 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afda1961fd241c49dadf623abb81b688d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_afda1961fd241c49dadf623abb81b688d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!device@{device}}
\index{device@{device}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{device}{device}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+device}



Definition at line 1109 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a53606067a92569a4fa3603f07f067a5c}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a53606067a92569a4fa3603f07f067a5c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!eos@{eos}}
\index{eos@{eos}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{eos}{eos}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+eos}



Definition at line 1106 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab9e04c7385dd553a6a8a8c76650d60b7}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab9e04c7385dd553a6a8a8c76650d60b7}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!eos\+\_\+top@{eos\+\_\+top}}
\index{eos\+\_\+top@{eos\+\_\+top}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{eos\+\_\+top}{eos\_top}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+eos\+\_\+top}



Definition at line 1125 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab1d9fb1a27a4a96ea9293720eb812487}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ab1d9fb1a27a4a96ea9293720eb812487}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!eos\+\_\+top\+\_\+ts@{eos\+\_\+top\+\_\+ts}}
\index{eos\+\_\+top\+\_\+ts@{eos\+\_\+top\+\_\+ts}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{eos\+\_\+top\+\_\+ts}{eos\_top\_ts}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+eos\+\_\+top\+\_\+ts}



Definition at line 1126 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a5e2cb2f6be6aa0d1a6ff971d271356b1}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a5e2cb2f6be6aa0d1a6ff971d271356b1}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!finished@{finished}}
\index{finished@{finished}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{finished}{finished}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+finished}



Definition at line 1121 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aebe8a3e030fba84dd31dc9d68731038e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aebe8a3e030fba84dd31dc9d68731038e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!Hypothesis\+Tail@{Hypothesis\+Tail}}
\index{Hypothesis\+Tail@{Hypothesis\+Tail}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{Hypothesis\+Tail}{HypothesisTail}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+Hypothesis\+Tail}



Definition at line 1122 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a9c3bd0baa9376a027dabbbe43c6aac5e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a9c3bd0baa9376a027dabbbe43c6aac5e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!min\+\_\+length@{min\+\_\+length}}
\index{min\+\_\+length@{min\+\_\+length}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{min\+\_\+length}{min\_length}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+min\+\_\+length}



Definition at line 1105 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a65b34839f24c68fa76df61cff22e177e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a65b34839f24c68fa76df61cff22e177e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!min\+\_\+n\+\_\+best@{min\+\_\+n\+\_\+best}}
\index{min\+\_\+n\+\_\+best@{min\+\_\+n\+\_\+best}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{min\+\_\+n\+\_\+best}{min\_n\_best}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+min\+\_\+n\+\_\+best}



Definition at line 1128 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a44a03facdc6259db57720fcae9f9a6ed}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a44a03facdc6259db57720fcae9f9a6ed}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!n\+\_\+best\+\_\+counter@{n\+\_\+best\+\_\+counter}}
\index{n\+\_\+best\+\_\+counter@{n\+\_\+best\+\_\+counter}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{n\+\_\+best\+\_\+counter}{n\_best\_counter}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+n\+\_\+best\+\_\+counter}



Definition at line 1127 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a13bd578395eeca81c0d1712e220c4b37}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a13bd578395eeca81c0d1712e220c4b37}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!outputs@{outputs}}
\index{outputs@{outputs}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{outputs}{outputs}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+outputs}



Definition at line 1117 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aadd5d9795e5d7ac5c5339d6136eb7ba4}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_aadd5d9795e5d7ac5c5339d6136eb7ba4}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!pad@{pad}}
\index{pad@{pad}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{pad}{pad}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+pad}



Definition at line 1108 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a35c45bf55c21713f720fffdaafc68081}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_a35c45bf55c21713f720fffdaafc68081}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!partial\+\_\+hyps@{partial\+\_\+hyps}}
\index{partial\+\_\+hyps@{partial\+\_\+hyps}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{partial\+\_\+hyps}{partial\_hyps}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+partial\+\_\+hyps}



Definition at line 1130 of file torch\+\_\+agent\+\_\+v1.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ad7e21da35d537a09f23973b415e62660}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1torch__agent__v1_1_1Beam_ad7e21da35d537a09f23973b415e62660}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}!scores@{scores}}
\index{scores@{scores}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::torch\+\_\+agent\+\_\+v1\+::\+Beam}}
\subsubsection{\texorpdfstring{scores}{scores}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+torch\+\_\+agent\+\_\+v1.\+Beam.\+scores}



Definition at line 1111 of file torch\+\_\+agent\+\_\+v1.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/seq2seq/\hyperlink{torch__agent__v1_8py}{torch\+\_\+agent\+\_\+v1.\+py}\end{DoxyCompactItemize}
