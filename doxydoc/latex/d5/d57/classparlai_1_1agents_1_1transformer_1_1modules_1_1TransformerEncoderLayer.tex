\hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer}{}\section{parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer Class Reference}
\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer}\index{parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer@{parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer}}


Inheritance diagram for parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{d6/d58/classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{d1/d6c/classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a68caa3f119bfb946e34b7cf3c8bd9e48}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, n\+\_\+heads, embedding\+\_\+size, ffn\+\_\+size, attention\+\_\+dropout=0.\+0, relu\+\_\+dropout=0.\+0, \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a3bcd00a8073a48b6a1626fccb87be143}{dropout}=0.\+0, \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2986c3841832cc56d76908347f22a0a3}{activation}=\textquotesingle{}relu\textquotesingle{}, \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a33ff5864b155499ecf8d31383b33e8d8}{variant}=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_aba0474eb3a08b6c482648adc0804776e}{forward} (self, tensor, mask)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_ae0f31a52dac8d678fdf6ba573201e7d7}{dim}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_abcdb8b9abb049afacdd132d2a811faff}{ffn\+\_\+dim}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2986c3841832cc56d76908347f22a0a3}{activation}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a33ff5864b155499ecf8d31383b33e8d8}{variant}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_ad8b0a3b903ca2595e72dd54f82f4dd9f}{attention}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a74730602aaea5afd4564d0f35c84af15}{norm1}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2f40ac67a332293a3f51eb11647e2ec1}{ffn}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_acc0beb3a5c95f3ab45b13dff322e4225}{norm2}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a3bcd00a8073a48b6a1626fccb87be143}{dropout}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Implements a single Transformer encoder layer.
\end{DoxyVerb}
 

Definition at line 544 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a68caa3f119bfb946e34b7cf3c8bd9e48}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a68caa3f119bfb946e34b7cf3c8bd9e48}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{n\+\_\+heads,  }\item[{}]{embedding\+\_\+size,  }\item[{}]{ffn\+\_\+size,  }\item[{}]{attention\+\_\+dropout = {\ttfamily 0.0},  }\item[{}]{relu\+\_\+dropout = {\ttfamily 0.0},  }\item[{}]{dropout = {\ttfamily 0.0},  }\item[{}]{activation = {\ttfamily \textquotesingle{}relu\textquotesingle{}},  }\item[{}]{variant = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 559 of file modules.\+py.


\begin{DoxyCode}
559     ):
560         super().\_\_init\_\_()
561         self.dim = embedding\_size
562         self.ffn\_dim = ffn\_size
563         self.activation = activation
564         self.variant = variant
565         self.attention = MultiHeadAttention(
566             n\_heads, embedding\_size, dropout=attention\_dropout  \textcolor{comment}{# --attention-dropout}
567         )
568         self.norm1 = LayerNorm(embedding\_size, eps=LAYER\_NORM\_EPS)
569         self.ffn = TransformerFFN(
570             embedding\_size,
571             ffn\_size,
572             relu\_dropout=relu\_dropout,
573             activation=self.activation,
574         )
575         self.norm2 = LayerNorm(embedding\_size, eps=LAYER\_NORM\_EPS)
576         self.dropout = nn.Dropout(p=dropout)
577 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_aba0474eb3a08b6c482648adc0804776e}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_aba0474eb3a08b6c482648adc0804776e}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!forward@{forward}}
\index{forward@{forward}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{tensor,  }\item[{}]{mask }\end{DoxyParamCaption})}

\begin{DoxyVerb}Forward pass.
\end{DoxyVerb}
 

Definition at line 578 of file modules.\+py.


\begin{DoxyCode}
578     \textcolor{keyword}{def }forward(self, tensor, mask):
579         \textcolor{stringliteral}{"""}
580 \textcolor{stringliteral}{        Forward pass.}
581 \textcolor{stringliteral}{        """}
582         tensor = tensor + self.dropout(self.attention(tensor, mask=mask))
583         tensor = \_normalize(tensor, self.norm1)
584         tensor = tensor + self.dropout(self.ffn(tensor))
585         tensor = \_normalize(tensor, self.norm2)
586         tensor *= mask.unsqueeze(-1).type\_as(tensor)
587         \textcolor{keywordflow}{return} tensor
588 
589 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2986c3841832cc56d76908347f22a0a3}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2986c3841832cc56d76908347f22a0a3}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!activation@{activation}}
\index{activation@{activation}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{activation}{activation}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+activation}



Definition at line 563 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_ad8b0a3b903ca2595e72dd54f82f4dd9f}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_ad8b0a3b903ca2595e72dd54f82f4dd9f}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!attention@{attention}}
\index{attention@{attention}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{attention}{attention}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+attention}



Definition at line 565 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_ae0f31a52dac8d678fdf6ba573201e7d7}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_ae0f31a52dac8d678fdf6ba573201e7d7}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!dim@{dim}}
\index{dim@{dim}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{dim}{dim}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+dim}



Definition at line 561 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a3bcd00a8073a48b6a1626fccb87be143}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a3bcd00a8073a48b6a1626fccb87be143}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!dropout@{dropout}}
\index{dropout@{dropout}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{dropout}{dropout}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+dropout}



Definition at line 576 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2f40ac67a332293a3f51eb11647e2ec1}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a2f40ac67a332293a3f51eb11647e2ec1}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!ffn@{ffn}}
\index{ffn@{ffn}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{ffn}{ffn}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+ffn}



Definition at line 569 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_abcdb8b9abb049afacdd132d2a811faff}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_abcdb8b9abb049afacdd132d2a811faff}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!ffn\+\_\+dim@{ffn\+\_\+dim}}
\index{ffn\+\_\+dim@{ffn\+\_\+dim}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{ffn\+\_\+dim}{ffn\_dim}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+ffn\+\_\+dim}



Definition at line 562 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a74730602aaea5afd4564d0f35c84af15}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a74730602aaea5afd4564d0f35c84af15}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!norm1@{norm1}}
\index{norm1@{norm1}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{norm1}{norm1}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+norm1}



Definition at line 568 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_acc0beb3a5c95f3ab45b13dff322e4225}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_acc0beb3a5c95f3ab45b13dff322e4225}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!norm2@{norm2}}
\index{norm2@{norm2}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{norm2}{norm2}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+norm2}



Definition at line 575 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a33ff5864b155499ecf8d31383b33e8d8}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1TransformerEncoderLayer_a33ff5864b155499ecf8d31383b33e8d8}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}!variant@{variant}}
\index{variant@{variant}!parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer@{parlai\+::agents\+::transformer\+::modules\+::\+Transformer\+Encoder\+Layer}}
\subsubsection{\texorpdfstring{variant}{variant}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Transformer\+Encoder\+Layer.\+variant}



Definition at line 564 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/transformer/\hyperlink{parlai_2agents_2transformer_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
