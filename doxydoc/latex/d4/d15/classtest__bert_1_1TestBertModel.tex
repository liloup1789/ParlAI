\hypertarget{classtest__bert_1_1TestBertModel}{}\section{test\+\_\+bert.\+Test\+Bert\+Model Class Reference}
\label{classtest__bert_1_1TestBertModel}\index{test\+\_\+bert.\+Test\+Bert\+Model@{test\+\_\+bert.\+Test\+Bert\+Model}}


Inheritance diagram for test\+\_\+bert.\+Test\+Bert\+Model\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=202pt]{d0/dcd/classtest__bert_1_1TestBertModel__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for test\+\_\+bert.\+Test\+Bert\+Model\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=202pt]{d8/d7a/classtest__bert_1_1TestBertModel__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classtest__bert_1_1TestBertModel_a58a6c62d3ef3009a203c407feea4852b}{test\+\_\+biencoder} (self)
\item 
def \hyperlink{classtest__bert_1_1TestBertModel_a1576f491a7c638f37d3e5e3317478931}{test\+\_\+crossencoder} (self)
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classtest__bert_1_1TestBertModel_af62ecae2b9496780476aae9732a03d26}{ntries}
\item 
\hyperlink{classtest__bert_1_1TestBertModel_af6b428797cdbe20ca87f4b1379235347}{log\+\_\+retry}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Test of Bert biencoder and crossencoder.

Checks that Both Biencoder and CrossEncoder of Bert can be trained for about 100
samples on convai2
\end{DoxyVerb}
 

Definition at line 12 of file test\+\_\+bert.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classtest__bert_1_1TestBertModel_a58a6c62d3ef3009a203c407feea4852b}\label{classtest__bert_1_1TestBertModel_a58a6c62d3ef3009a203c407feea4852b}} 
\index{test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}!test\+\_\+biencoder@{test\+\_\+biencoder}}
\index{test\+\_\+biencoder@{test\+\_\+biencoder}!test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}}
\subsubsection{\texorpdfstring{test\+\_\+biencoder()}{test\_biencoder()}}
{\footnotesize\ttfamily def test\+\_\+bert.\+Test\+Bert\+Model.\+test\+\_\+biencoder (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 21 of file test\+\_\+bert.\+py.


\begin{DoxyCode}
21     \textcolor{keyword}{def }test\_biencoder(self):
22         stdout, valid, test = testing\_utils.train\_model(
23             dict(
24                 task=\textcolor{stringliteral}{'convai2'},
25                 model=\textcolor{stringliteral}{'bert\_ranker/bi\_encoder\_ranker'},
26                 num\_epochs=0.1,
27                 batchsize=8,
28                 learningrate=3e-4,
29                 text\_truncate=32,
30                 validation\_max\_exs=20,
31                 short\_final\_eval=\textcolor{keyword}{True},
32             )
33         )
34         \textcolor{comment}{# can't conclude much from the biencoder after that little iterations.}
35         \textcolor{comment}{# this test will just make sure it hasn't crashed and the accuracy isn't}
36         \textcolor{comment}{# too high}
37         self.assertLessEqual(
38             test[\textcolor{stringliteral}{'accuracy'}],
39             0.5,
40             \textcolor{stringliteral}{'test accuracy = \{\}\(\backslash\)nLOG:\(\backslash\)n\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(test[\textcolor{stringliteral}{'accuracy'}], stdout),
41         )
42 
\end{DoxyCode}
\mbox{\Hypertarget{classtest__bert_1_1TestBertModel_a1576f491a7c638f37d3e5e3317478931}\label{classtest__bert_1_1TestBertModel_a1576f491a7c638f37d3e5e3317478931}} 
\index{test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}!test\+\_\+crossencoder@{test\+\_\+crossencoder}}
\index{test\+\_\+crossencoder@{test\+\_\+crossencoder}!test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}}
\subsubsection{\texorpdfstring{test\+\_\+crossencoder()}{test\_crossencoder()}}
{\footnotesize\ttfamily def test\+\_\+bert.\+Test\+Bert\+Model.\+test\+\_\+crossencoder (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 44 of file test\+\_\+bert.\+py.


\begin{DoxyCode}
44     \textcolor{keyword}{def }test\_crossencoder(self):
45         stdout, valid, test = testing\_utils.train\_model(
46             dict(
47                 task=\textcolor{stringliteral}{'convai2'},
48                 model=\textcolor{stringliteral}{'bert\_ranker/cross\_encoder\_ranker'},
49                 num\_epochs=0.002,
50                 batchsize=1,
51                 candidates=\textcolor{stringliteral}{"inline"},
52                 type\_optimization=\textcolor{stringliteral}{"all\_encoder\_layers"},
53                 warmup\_updates=100,
54                 text\_truncate=32,
55                 label\_truncate=32,
56                 validation\_max\_exs=20,
57                 short\_final\_eval=\textcolor{keyword}{True},
58             )
59         )
60         \textcolor{comment}{# The cross encoder reaches an interesting state MUCH faster}
61         \textcolor{comment}{# accuracy should be present and somewhere between 0.2 and 0.8}
62         \textcolor{comment}{# (large interval so that it doesn't flake.)}
63         self.assertGreaterEqual(
64             test[\textcolor{stringliteral}{'accuracy'}],
65             0.03,
66             \textcolor{stringliteral}{'test accuracy = \{\}\(\backslash\)nLOG:\(\backslash\)n\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(test[\textcolor{stringliteral}{'accuracy'}], stdout),
67         )
68         self.assertLessEqual(
69             test[\textcolor{stringliteral}{'accuracy'}],
70             0.8,
71             \textcolor{stringliteral}{'test accuracy = \{\}\(\backslash\)nLOG:\(\backslash\)n\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(test[\textcolor{stringliteral}{'accuracy'}], stdout),
72         )
73 
74 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classtest__bert_1_1TestBertModel_af6b428797cdbe20ca87f4b1379235347}\label{classtest__bert_1_1TestBertModel_af6b428797cdbe20ca87f4b1379235347}} 
\index{test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}!log\+\_\+retry@{log\+\_\+retry}}
\index{log\+\_\+retry@{log\+\_\+retry}!test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}}
\subsubsection{\texorpdfstring{log\+\_\+retry}{log\_retry}}
{\footnotesize\ttfamily test\+\_\+bert.\+Test\+Bert\+Model.\+log\+\_\+retry\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 20 of file test\+\_\+bert.\+py.

\mbox{\Hypertarget{classtest__bert_1_1TestBertModel_af62ecae2b9496780476aae9732a03d26}\label{classtest__bert_1_1TestBertModel_af62ecae2b9496780476aae9732a03d26}} 
\index{test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}!ntries@{ntries}}
\index{ntries@{ntries}!test\+\_\+bert\+::\+Test\+Bert\+Model@{test\+\_\+bert\+::\+Test\+Bert\+Model}}
\subsubsection{\texorpdfstring{ntries}{ntries}}
{\footnotesize\ttfamily test\+\_\+bert.\+Test\+Bert\+Model.\+ntries\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 20 of file test\+\_\+bert.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
tests/nightly/gpu/\hyperlink{test__bert_8py}{test\+\_\+bert.\+py}\end{DoxyCompactItemize}
