\hypertarget{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent}{}\section{projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent Class Reference}
\label{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent}\index{projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent@{projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent}}


Inheritance diagram for projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{d7/d08/classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{d4/d94/classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_afe1b45c585513c89e5b20888a32f54fd}{build} (self)
\item 
def \hyperlink{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_aa7bf3db7ca3b36cb8b67b2341a3ce676}{get\+\_\+data} (self, observations, datatype=\textquotesingle{}train\textquotesingle{}, assert\+\_\+=True)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_a698d961e03b940ec4ff537c209a9da02}{A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 413 of file agents.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_afe1b45c585513c89e5b20888a32f54fd}\label{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_afe1b45c585513c89e5b20888a32f54fd}} 
\index{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent@{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent}!build@{build}}
\index{build@{build}!projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent@{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent}}
\subsubsection{\texorpdfstring{build()}{build()}}
{\footnotesize\ttfamily def projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent.\+build (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 414 of file agents.\+py.


\begin{DoxyCode}
414     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1talkthewalk_1_1download_a8c0fbb9b6dfe127cb8c1bd6e7c4e33fd}{build}(self):
415         self.ACTION\_TYPES = [
416             \textcolor{stringliteral}{'go'},
417             \textcolor{stringliteral}{'get'},
418             \textcolor{stringliteral}{'drop'},
419             \textcolor{stringliteral}{'eat'},
420             \textcolor{stringliteral}{'drink'},
421             \textcolor{stringliteral}{'wear'},
422             \textcolor{stringliteral}{'wield'},
423             \textcolor{stringliteral}{'remove'},
424             \textcolor{stringliteral}{'unwield'},
425             \textcolor{stringliteral}{'give'},
426             \textcolor{stringliteral}{'take'},
427             \textcolor{stringliteral}{'put'},
428             \textcolor{stringliteral}{'hit'},
429             \textcolor{stringliteral}{'stop'},
430         ]
431         super().\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1talkthewalk_1_1download_a8c0fbb9b6dfe127cb8c1bd6e7c4e33fd}{build}()
432         self.build\_action\_id()
433 
\end{DoxyCode}
\mbox{\Hypertarget{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_aa7bf3db7ca3b36cb8b67b2341a3ce676}\label{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_aa7bf3db7ca3b36cb8b67b2341a3ce676}} 
\index{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent@{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent}!get\+\_\+data@{get\+\_\+data}}
\index{get\+\_\+data@{get\+\_\+data}!projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent@{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent}}
\subsubsection{\texorpdfstring{get\+\_\+data()}{get\_data()}}
{\footnotesize\ttfamily def projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent.\+get\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations,  }\item[{}]{datatype = {\ttfamily \textquotesingle{}train\textquotesingle{}},  }\item[{}]{assert\+\_\+ = {\ttfamily True} }\end{DoxyParamCaption})}



Definition at line 434 of file agents.\+py.


\begin{DoxyCode}
434     \textcolor{keyword}{def }get\_data(self, observations, datatype='train', assert\_=True):
435         opt = self.opt
436         batch\_size = len(observations)
437         seq\_in, seq\_out = 0, 0
438         tokens\_list, inst\_list, symb\_points\_list = [], [], []
439         \textcolor{keywordflow}{for} observation \textcolor{keywordflow}{in} observations:
440             graph, text, actions = (
441                 observation[\textcolor{stringliteral}{'graph'}],
442                 observation[\textcolor{stringliteral}{'text'}],
443                 observation[\textcolor{stringliteral}{'actions'}],
444             )
445             tokens\_list.append(self.\_tokenize(text))
446             seq\_in = max(seq\_in, len(tokens\_list[-1]))
447 
448             graph = observation[\textcolor{stringliteral}{'graph'}]
449             inst, symb\_points = graph.parse(actions)
450             seq\_out = max(seq\_out, len(symb\_points) - 1 + 1)  \textcolor{comment}{# +1 for stop}
451             inst\_list.append(inst)
452             symb\_points\_list.append(symb\_points)
453 
454         \textcolor{keywordflow}{if} datatype == \textcolor{stringliteral}{'valid'}:
455             seq\_out = opt[\textcolor{stringliteral}{'max\_seq\_out'}]
456 
457         seq\_in = min(seq\_in, opt[\textcolor{stringliteral}{'max\_seq\_in'}])
458         y\_dim = self.y\_dim
459         x = np.zeros((batch\_size, seq\_in), dtype=np.int64)
460         y = np.zeros((batch\_size, seq\_out, y\_dim), dtype=np.float32)
461 
462         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(batch\_size):
463             \textcolor{keywordflow}{for} j, token \textcolor{keywordflow}{in} enumerate(tokens\_list[i]):
464                 \textcolor{keywordflow}{if} j >= seq\_in:
465                     \textcolor{keywordflow}{break}
466                 x[i, j] = self.\_get\_word\_index(token)
467 
468             inst = inst\_list[i]
469             g = observations[i][\textcolor{stringliteral}{'graph'}].copy()
470             len\_plus\_one = len(symb\_points\_list[i])
471 
472             action\_tuples = []
473             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(len\_plus\_one - 1):
474                 k, l = symb\_points\_list[i][j], symb\_points\_list[i][j + 1]
475                 action\_tuples.append(\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_a11c98f469df4fb4ecb640c91544dfe26}{parse\_action\_tuple}(inst[k:l]))
476 
477             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(len\_plus\_one):
478                 \textcolor{keywordflow}{if} j < len\_plus\_one - 1:
479                     cur\_tuple = action\_tuples[j]
480 
481                     y[i, j, self.get\_action\_id(cur\_tuple)] = 1.0
482 
483                 \textcolor{keywordflow}{else}:
484                     stop\_tuple = (\textcolor{stringliteral}{'stop'},)
485                     y[i, j, self.get\_action\_id(stop\_tuple)] = 1.0
486 
487                 \textcolor{keywordflow}{if} j < len\_plus\_one - 1:
488                     k, l = symb\_points\_list[i][j], symb\_points\_list[i][j + 1]
489                     parse\_success = g.parse\_exec(\textcolor{stringliteral}{' '}.join(inst[k:l]))
490                     \textcolor{keywordflow}{if} assert\_:
491                         \textcolor{keyword}{assert} parse\_success, \textcolor{stringliteral}{' '}.join(inst[k:l])
492         \textcolor{keywordflow}{return} x, y
493 
494 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_a698d961e03b940ec4ff537c209a9da02}\label{classprojects_1_1mastering__the__dungeon_1_1agents_1_1graph__world2_1_1agents_1_1Seq2SeqDataAgent_a698d961e03b940ec4ff537c209a9da02}} 
\index{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent@{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent}!A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES@{A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES}}
\index{A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES@{A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES}!projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent@{projects\+::mastering\+\_\+the\+\_\+dungeon\+::agents\+::graph\+\_\+world2\+::agents\+::\+Seq2\+Seq\+Data\+Agent}}
\subsubsection{\texorpdfstring{A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES}{ACTION\_TYPES}}
{\footnotesize\ttfamily projects.\+mastering\+\_\+the\+\_\+dungeon.\+agents.\+graph\+\_\+world2.\+agents.\+Seq2\+Seq\+Data\+Agent.\+A\+C\+T\+I\+O\+N\+\_\+\+T\+Y\+P\+ES}



Definition at line 415 of file agents.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
projects/mastering\+\_\+the\+\_\+dungeon/agents/graph\+\_\+world2/\hyperlink{projects_2mastering__the__dungeon_2agents_2graph__world2_2agents_8py}{agents.\+py}\end{DoxyCompactItemize}
