\hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent}{}\section{parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent Class Reference}
\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent}\index{parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent@{parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent}}


Inheritance diagram for parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{da/d5a/classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{dd/dd3/classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae2277cc7020d5aeae4b53e195842c379}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af8d8114af65bf817afe01545033d51e6}{opt}, shared=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_acd53015e95f8aead134d65e2cc8cf180}{override\+\_\+opt} (self, new\+\_\+opt)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ad67bbe760648032c08da9400bb2e3da1}{parse} (self, text)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ad7b6363acdfb3d009cd9a3bcc6206faf}{zero\+\_\+grad} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af474c46339e2e0c881f8b8b81f5f9b7f}{update\+\_\+params} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4ccc140cc9d528c4135ec65f2bb4325}{reset} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a62896fd9aa38b55c6ea1b8a8770e3261}{reset\+\_\+metrics} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_acc05a1253c9fc32f8d1f9817b9ca559e}{report} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a9d871fa6c5da46d2fd5564b814001a97}{share} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a78df1c525c94c4cc68e05cd44ee374fd}{observe} (self, \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aee73b46f6a1dd58cf369bf39b6c66903}{observation})
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa54ff09a8edc6ae51ac8be33aeb4acc8}{repackage\+\_\+hidden} (self, h)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aeb1136a4ae2a2a1e8c0d5a7b75d9898f}{get\+\_\+target\+\_\+loss} (self, data, \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa7c4053a69871ded8ac7f6afc31b9af3}{hidden}, targets)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa3de87163cd61e4195afc0ccf801699b}{get\+\_\+predictions} (self, data)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a1ff4e6849d50eb9d58a2f97a91d715ce}{predict} (self, data, \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa7c4053a69871ded8ac7f6afc31b9af3}{hidden}, targets=None, \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4a04c916f52bdd6d5163d36d49aa378}{is\+\_\+training}=True, y\+\_\+lens=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aeddf3a4b207e0668644ce6dfd93f39ef}{vectorize} (self, observations, seq\+\_\+len, \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4a04c916f52bdd6d5163d36d49aa378}{is\+\_\+training})
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a91a1386cee7fa786aa817a58646cda5e}{batch\+\_\+act} (self, observations)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0f8d50e5423b4f34ab5d078d6185e4b2}{act} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_adc621ff0e625e2f00225d78408e9bafc}{save} (self, path=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab7b37ff49b1ce04ef7ce0e598cf736e3}{shutdown} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a058d0497a88662c2d523b3b5a836a0bb}{receive\+\_\+metrics} (self, metrics\+\_\+dict)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a8f879ddce0947b8b56f980f7f4fea07b}{load\+\_\+opt} (self, path)
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a3b1a39e1467680e19dccfcfb8dae4273}{load} (self, path)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a80bdd18c28f4a2ab19c463dd123165e7}{dictionary\+\_\+class} ()
\item 
def \hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a935ed616ff38d97e918adb2345386631}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a6ff4db5833be08d7275233eabd88caa2}{metrics}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0a38913deb7063ce611e0b4494114a9e}{states}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a5a81987ecc0033c7c62c309598426090}{use\+\_\+cuda}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0a1ef8c00baeab09cd811906ee778d06}{batchsize}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a4d8f28572b3ff9530e7ced7f4bc1d279}{use\+\_\+person\+\_\+tokens}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a2f3a4f5a61bdc2d2292dfeac93ff3e06}{sampling\+\_\+mode}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af8d8114af65bf817afe01545033d51e6}{opt}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_abbb9c4e9bd984179a01f4bb0fa77a005}{dict}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a100d32913ae7e28f898064761cf09ca2}{model}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_adb13050a971d2dd7399cd6c0f5271647}{N\+U\+L\+L\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_affe3b740c3cdbac4f3883ff527091f47}{E\+N\+D\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ac3a3800bb1e2b9a8e7599346f16d17f6}{id}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab16ff562fa5f17f1544c4e78c4dbe2dd}{next\+\_\+observe}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab9e45cf73e4e7d933c92826a3a0c2d68}{next\+\_\+batch}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4a04c916f52bdd6d5163d36d49aa378}{is\+\_\+training}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0cedb5672a7f4f6533490fbf550cb853}{clip}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a5a7f43878aa096fd1f091dd403dfe30c}{criterion}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa7c4053a69871ded8ac7f6afc31b9af3}{hidden}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab0db3334e63765ac0e7fd991db214f72}{ends}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a8be32c6f1a5b35f4c508c9dc1ca911b8}{lr}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a222e071975fc874e82e6480c030bbb9d}{optimizer}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a981e3901460fa1eda1d8564a1792eef3}{best\+\_\+val\+\_\+loss}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ac57a5e5b664eca0b561973b98a6f5ab5}{lr\+\_\+factor}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a89bb8ba94b9f71ea1571b2b9b38f180a}{lr\+\_\+patience}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a045ef7c347b9295879ff3aaec1a8d9a0}{lr\+\_\+min}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a4695c070d27825b7ee206eac0fb4b576}{scheduler}
\item 
\hyperlink{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aee73b46f6a1dd58cf369bf39b6c66903}{observation}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Agent which trains an RNN on a language modeling task.

It is adapted from the language model featured in Pytorch's examples repo
here: <https://github.com/pytorch/examples/tree/master/word_language_model>.
\end{DoxyVerb}
 

Definition at line 23 of file language\+\_\+model.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae2277cc7020d5aeae4b53e195842c379}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae2277cc7020d5aeae4b53e195842c379}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Set up model if shared params not set, otherwise no work to do.
\end{DoxyVerb}
 

Definition at line 159 of file language\+\_\+model.\+py.


\begin{DoxyCode}
159     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
160         \textcolor{stringliteral}{"""}
161 \textcolor{stringliteral}{        Set up model if shared params not set, otherwise no work to do.}
162 \textcolor{stringliteral}{        """}
163         super().\_\_init\_\_(opt, shared)
164         opt = self.opt  \textcolor{comment}{# there is a deepcopy in the init}
165         self.metrics = \{\textcolor{stringliteral}{'loss'}: 0, \textcolor{stringliteral}{'num\_tokens'}: 0, \textcolor{stringliteral}{'lmloss'}: 0, \textcolor{stringliteral}{'lm\_num\_tokens'}: 0\}
166         self.states = \{\}
167         \textcolor{comment}{# check for cuda}
168         self.use\_cuda = \textcolor{keywordflow}{not} opt.get(\textcolor{stringliteral}{'no\_cuda'}) \textcolor{keywordflow}{and} torch.cuda.is\_available()
169         self.batchsize = opt.get(\textcolor{stringliteral}{'batchsize'}, 1)
170         self.use\_person\_tokens = opt.get(\textcolor{stringliteral}{'person\_tokens'}, \textcolor{keyword}{True})
171         self.sampling\_mode = opt.get(\textcolor{stringliteral}{'sampling\_mode'}, \textcolor{keyword}{False})
172 
173         \textcolor{keywordflow}{if} shared:
174             \textcolor{comment}{# set up shared properties}
175             self.opt = shared[\textcolor{stringliteral}{'opt'}]
176             opt = self.opt
177             self.dict = shared[\textcolor{stringliteral}{'dict'}]
178 
179             self.model = shared[\textcolor{stringliteral}{'model'}]
180             self.metrics = shared[\textcolor{stringliteral}{'metrics'}]
181 
182             \textcolor{comment}{# get NULL token and END token}
183             self.NULL\_IDX = self.dict[self.dict.null\_token]
184             self.END\_IDX = self.dict[self.dict.end\_token]
185 
186             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'states'} \textcolor{keywordflow}{in} shared:
187                 self.states = shared[\textcolor{stringliteral}{'states'}]
188 
189             \textcolor{keywordflow}{if} self.use\_person\_tokens:
190                 \textcolor{comment}{# add person1 and person2 tokens}
191                 self.dict.add\_to\_dict(self.dict.\hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_a1fdb457e98eb4e4c26047e229686a616}{tokenize}(\textcolor{stringliteral}{"PERSON1"}))
192                 self.dict.add\_to\_dict(self.dict.\hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_a1fdb457e98eb4e4c26047e229686a616}{tokenize}(\textcolor{stringliteral}{"PERSON2"}))
193 
194         \textcolor{keywordflow}{else}:
195             \textcolor{comment}{# this is not a shared instance of this class, so do full init}
196             \textcolor{keywordflow}{if} self.use\_cuda:
197                 print(\textcolor{stringliteral}{'[ Using CUDA ]'})
198                 torch.cuda.set\_device(opt[\textcolor{stringliteral}{'gpu'}])
199 
200             init\_model = \textcolor{keywordtype}{None}
201             \textcolor{comment}{# check first for 'init\_model' for loading model from file}
202             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'init\_model'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'init\_model'}]):
203                 init\_model = opt[\textcolor{stringliteral}{'init\_model'}]
204             \textcolor{comment}{# next check for 'model\_file', this would override init\_model}
205             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'model\_file'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'model\_file'}]):
206                 init\_model = opt[\textcolor{stringliteral}{'model\_file'}]
207 
208             \textcolor{comment}{# for backwards compatibility: will only be called for older models}
209             \textcolor{comment}{# for which .opt file does not exist}
210             \textcolor{keywordflow}{if} init\_model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} os.path.isfile(init\_model + \textcolor{stringliteral}{'.opt'}):
211                 new\_opt = self.load\_opt(init\_model)
212                 \textcolor{comment}{# load model parameters if available}
213                 print(\textcolor{stringliteral}{'[ Setting opt from \{\} ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(init\_model))
214                 \textcolor{comment}{# since .opt file does not exist, save one for future use}
215                 print(\textcolor{stringliteral}{"Saving opt file at:"}, init\_model + \textcolor{stringliteral}{".opt"})
216                 with open(init\_model + \textcolor{stringliteral}{'.opt'}, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} handle:
217                     json.dump(new\_opt, handle)
218                 opt = self.override\_opt(new\_opt)
219 
220             \textcolor{keywordflow}{if} (init\_model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} os.path.isfile(init\_model + \textcolor{stringliteral}{'.dict'})) \textcolor{keywordflow}{or} opt[
221                 \textcolor{stringliteral}{'dict\_file'}
222             ] \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
223                 opt[\textcolor{stringliteral}{'dict\_file'}] = init\_model + \textcolor{stringliteral}{'.dict'}
224 
225             \textcolor{comment}{# load dictionary and basic tokens & vectors}
226             self.dict = DictionaryAgent(opt)
227             self.id = \textcolor{stringliteral}{'LanguageModel'}
228 
229             \textcolor{comment}{# get NULL token and END token}
230             self.NULL\_IDX = self.dict[self.dict.null\_token]
231             self.END\_IDX = self.dict[self.dict.end\_token]
232 
233             \textcolor{keywordflow}{if} self.use\_person\_tokens:
234                 \textcolor{comment}{# add person1 and person2 tokens}
235                 self.dict.add\_to\_dict(self.dict.\hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_a1fdb457e98eb4e4c26047e229686a616}{tokenize}(\textcolor{stringliteral}{"PERSON1"}))
236                 self.dict.add\_to\_dict(self.dict.\hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_a1fdb457e98eb4e4c26047e229686a616}{tokenize}(\textcolor{stringliteral}{"PERSON2"}))
237 
238             \textcolor{comment}{# set model}
239             self.model = RNNModel(opt, len(self.dict))
240 
241             \textcolor{keywordflow}{if} init\_model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
242                 self.load(init\_model)
243 
244             \textcolor{keywordflow}{if} self.use\_cuda:
245                 self.model.cuda()
246 
247         self.next\_observe = []
248         self.next\_batch = []
249 
250         self.is\_training = \textcolor{keyword}{True}
251 
252         self.clip = opt.get(\textcolor{stringliteral}{'gradient\_clip'}, 0.25)
253         \textcolor{comment}{# set up criteria}
254         self.criterion = nn.CrossEntropyLoss(
255             ignore\_index=self.NULL\_IDX, size\_average=\textcolor{keyword}{False}
256         )
257         \textcolor{keywordflow}{if} self.use\_cuda:
258             \textcolor{comment}{# push to cuda}
259             self.criterion.cuda()
260         \textcolor{comment}{# init hidden state}
261         self.hidden = self.model.init\_hidden(self.batchsize)
262         \textcolor{comment}{# init tensor of end tokens}
263         self.ends = torch.LongTensor([self.END\_IDX \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(self.batchsize)])
264         \textcolor{keywordflow}{if} self.use\_cuda:
265             self.ends = self.ends.cuda()
266         \textcolor{comment}{# set up model and learning rate scheduler parameters}
267         self.lr = opt[\textcolor{stringliteral}{'learningrate'}]
268         self.optimizer = torch.optim.SGD(self.model.parameters(), lr=self.lr)
269         self.best\_val\_loss = self.states.get(\textcolor{stringliteral}{'best\_val\_loss'}, \textcolor{keywordtype}{None})
270         self.lr\_factor = opt[\textcolor{stringliteral}{'lr\_factor'}]
271         \textcolor{keywordflow}{if} self.lr\_factor < 1.0:
272             self.lr\_patience = opt[\textcolor{stringliteral}{'lr\_patience'}]
273             self.lr\_min = opt[\textcolor{stringliteral}{'lr\_minimum'}]
274             self.scheduler = torch.optim.lr\_scheduler.ReduceLROnPlateau(
275                 self.optimizer,
276                 factor=self.lr\_factor,
277                 verbose=\textcolor{keyword}{True},
278                 patience=self.lr\_patience,
279                 min\_lr=self.lr\_min,
280             )
281             \textcolor{comment}{# initial step for scheduler if self.best\_val\_loss is initialized}
282             \textcolor{keywordflow}{if} self.best\_val\_loss \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
283                 self.scheduler.step(self.best\_val\_loss)
284         \textcolor{keywordflow}{else}:
285             self.scheduler = \textcolor{keywordtype}{None}
286 
287         self.reset()
288 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0f8d50e5423b4f34ab5d078d6185e4b2}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0f8d50e5423b4f34ab5d078d6185e4b2}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!act@{act}}
\index{act@{act}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 696 of file language\+\_\+model.\+py.


\begin{DoxyCode}
696     \textcolor{keyword}{def }act(self):
697         \textcolor{comment}{# call batch\_act with this batch of one}
698         \textcolor{keywordflow}{return} self.batch\_act([self.observation])[0]
699 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a935ed616ff38d97e918adb2345386631}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a935ed616ff38d97e918adb2345386631}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Add command-line arguments specifically for this agent.
\end{DoxyVerb}
 

Definition at line 36 of file language\+\_\+model.\+py.


\begin{DoxyCode}
36     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
37         \textcolor{stringliteral}{"""}
38 \textcolor{stringliteral}{        Add command-line arguments specifically for this agent.}
39 \textcolor{stringliteral}{        """}
40         agent = argparser.add\_argument\_group(\textcolor{stringliteral}{'Language Model Arguments'})
41         agent.add\_argument(
42             \textcolor{stringliteral}{'--init-model'},
43             type=str,
44             default=\textcolor{keywordtype}{None},
45             help=\textcolor{stringliteral}{'load dict/features/weights/opts from this file'},
46         )
47         agent.add\_argument(
48             \textcolor{stringliteral}{'-hs'},
49             \textcolor{stringliteral}{'--hiddensize'},
50             type=int,
51             default=200,
52             help=\textcolor{stringliteral}{'size of the hidden layers'},
53         )
54         agent.add\_argument(
55             \textcolor{stringliteral}{'-esz'},
56             \textcolor{stringliteral}{'--embeddingsize'},
57             type=int,
58             default=200,
59             help=\textcolor{stringliteral}{'size of the token embeddings'},
60         )
61         agent.add\_argument(
62             \textcolor{stringliteral}{'-nl'}, \textcolor{stringliteral}{'--numlayers'}, type=int, default=2, help=\textcolor{stringliteral}{'number of hidden layers'}
63         )
64         agent.add\_argument(
65             \textcolor{stringliteral}{'-dr'}, \textcolor{stringliteral}{'--dropout'}, type=float, default=0.2, help=\textcolor{stringliteral}{'dropout rate'}
66         )
67         agent.add\_argument(
68             \textcolor{stringliteral}{'-clip'},
69             \textcolor{stringliteral}{'--gradient-clip'},
70             type=float,
71             default=0.25,
72             help=\textcolor{stringliteral}{'gradient clipping'},
73         )
74         agent.add\_argument(
75             \textcolor{stringliteral}{'--no-cuda'},
76             action=\textcolor{stringliteral}{'store\_true'},
77             default=\textcolor{keyword}{False},
78             help=\textcolor{stringliteral}{'disable GPUs even if available'},
79         )
80         agent.add\_argument(
81             \textcolor{stringliteral}{'-rnn'},
82             \textcolor{stringliteral}{'--rnn-class'},
83             default=\textcolor{stringliteral}{'LSTM'},
84             help=\textcolor{stringliteral}{'type of recurrent net (RNN\_TANH, RNN\_RELU, LSTM, GRU)'},
85         )
86         agent.add\_argument(
87             \textcolor{stringliteral}{'-sl'}, \textcolor{stringliteral}{'--seq-len'}, type=int, default=35, help=\textcolor{stringliteral}{'sequence length'}
88         )
89         agent.add\_argument(
90             \textcolor{stringliteral}{'-tied'},
91             \textcolor{stringliteral}{'--emb-tied'},
92             action=\textcolor{stringliteral}{'store\_true'},
93             help=\textcolor{stringliteral}{'tie the word embedding and softmax weights'},
94         )
95         agent.add\_argument(
96             \textcolor{stringliteral}{'-seed'}, \textcolor{stringliteral}{'--random-seed'}, type=int, default=1111, help=\textcolor{stringliteral}{'random seed'}
97         )
98         agent.add\_argument(
99             \textcolor{stringliteral}{'--gpu'}, type=int, default=-1, help=\textcolor{stringliteral}{'which GPU device to use'}
100         )
101         agent.add\_argument(
102             \textcolor{stringliteral}{'-tr'}, \textcolor{stringliteral}{'--truncate-pred'}, type=int, default=50, help=\textcolor{stringliteral}{'truncate predictions'}
103         )
104         agent.add\_argument(
105             \textcolor{stringliteral}{'-rf'},
106             \textcolor{stringliteral}{'--report-freq'},
107             type=float,
108             default=0.1,
109             help=\textcolor{stringliteral}{'report frequency of prediction during eval'},
110         )
111         agent.add\_argument(
112             \textcolor{stringliteral}{'-pt'},
113             \textcolor{stringliteral}{'--person-tokens'},
114             type=\textcolor{stringliteral}{'bool'},
115             default=\textcolor{keyword}{True},
116             help=\textcolor{stringliteral}{'append person1 and person2 tokens to text'},
117         )
118         \textcolor{comment}{# learning rate parameters}
119         agent.add\_argument(
120             \textcolor{stringliteral}{'-lr'},
121             \textcolor{stringliteral}{'--learningrate'},
122             type=float,
123             default=20,
124             help=\textcolor{stringliteral}{'initial learning rate'},
125         )
126         agent.add\_argument(
127             \textcolor{stringliteral}{'-lrf'},
128             \textcolor{stringliteral}{'--lr-factor'},
129             type=float,
130             default=1.0,
131             help=\textcolor{stringliteral}{'mutliply learning rate by this factor when the \(\backslash\)}
132 \textcolor{stringliteral}{                           validation loss does not decrease'},
133         )
134         agent.add\_argument(
135             \textcolor{stringliteral}{'-lrp'},
136             \textcolor{stringliteral}{'--lr-patience'},
137             type=int,
138             default=10,
139             help=\textcolor{stringliteral}{'wait before decreasing learning rate'},
140         )
141         agent.add\_argument(
142             \textcolor{stringliteral}{'-lrm'},
143             \textcolor{stringliteral}{'--lr-minimum'},
144             type=float,
145             default=0.1,
146             help=\textcolor{stringliteral}{'minimum learning rate'},
147         )
148         agent.add\_argument(
149             \textcolor{stringliteral}{'-sm'},
150             \textcolor{stringliteral}{'--sampling-mode'},
151             type=\textcolor{stringliteral}{'bool'},
152             default=\textcolor{keyword}{False},
153             help=\textcolor{stringliteral}{'sample when generating tokens instead of taking \(\backslash\)}
154 \textcolor{stringliteral}{                           the max and do not produce UNK token (when bs=1)'},
155         )
156         LanguageModelAgent.dictionary\_class().\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser)
157         \textcolor{keywordflow}{return} agent
158 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a91a1386cee7fa786aa817a58646cda5e}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a91a1386cee7fa786aa817a58646cda5e}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!batch\+\_\+act@{batch\+\_\+act}}
\index{batch\+\_\+act@{batch\+\_\+act}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+act()}{batch\_act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+batch\+\_\+act (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}



Definition at line 637 of file language\+\_\+model.\+py.


\begin{DoxyCode}
637     \textcolor{keyword}{def }batch\_act(self, observations):
638         batch\_reply = [\{\textcolor{stringliteral}{'id'}: self.getID()\} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(len(observations))]
639         \textcolor{keywordflow}{if} any([\textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} obs \textcolor{keywordflow}{for} obs \textcolor{keywordflow}{in} observations]):
640             \textcolor{comment}{# if we are starting a new training epoch, reinitialize hidden}
641             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.is\_training:
642                 self.hidden = self.model.init\_hidden(self.batchsize)
643             self.is\_training = \textcolor{keyword}{True}
644             data\_list, targets\_list, \_c, \_v, y\_lens = self.vectorize(
645                 observations, self.opt[\textcolor{stringliteral}{'seq\_len'}], self.is\_training
646             )
647         \textcolor{keywordflow}{else}:
648             \textcolor{comment}{# if we just finished training, reinitialize hidden}
649             \textcolor{keywordflow}{if} self.is\_training:
650                 self.hidden = self.model.init\_hidden(self.batchsize)
651                 self.is\_training = \textcolor{keyword}{False}
652             data\_list, targets\_list, labels, valid\_inds, y\_lens = self.vectorize(
653                 observations, self.opt[\textcolor{stringliteral}{'seq\_len'}], self.is\_training
654             )
655 
656         \textcolor{keywordflow}{if} data\_list \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
657             \textcolor{comment}{# not enough data to batch act yet, return empty responses}
658             \textcolor{keywordflow}{return} batch\_reply
659 
660         batch\_reply = []
661         \textcolor{comment}{# during evaluation, len(data\_list) is always 1}
662         \textcolor{comment}{# during training, len(dat\_list) >= 0: vectorize returns a list}
663         \textcolor{comment}{#     containing all batches available at the time it is called}
664         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(data\_list)):
665             temp\_dicts = [\{\textcolor{stringliteral}{'id'}: self.getID()\} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(len(observations))]
666             \textcolor{comment}{# ignore case when we do not return any valid indices}
667             \textcolor{keywordflow}{if} data\_list[i] \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
668                 output, hidden, predictions = self.predict(
669                     data\_list[i], self.hidden, targets\_list[i], self.is\_training, y\_lens
670                 )
671                 self.hidden = self.repackage\_hidden(hidden)
672 
673                 \textcolor{keywordflow}{if} predictions \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
674                     \textcolor{comment}{# map predictions back to the right order}
675                     PaddingUtils.map\_predictions(
676                         predictions.cpu(),
677                         valid\_inds,
678                         temp\_dicts,
679                         observations,
680                         self.dict,
681                         self.END\_IDX,
682                         report\_freq=self.opt[\textcolor{stringliteral}{'report\_freq'}],
683                     )
684 
685             batch\_reply += temp\_dicts
686 
687         \textcolor{comment}{# for prediction metrics computations, we get rid of PERSON1 and PERSON2 tokens}
688         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} self.is\_training:
689             \textcolor{keywordflow}{for} reply \textcolor{keywordflow}{in} batch\_reply:
690                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} reply:
691                     reply[\textcolor{stringliteral}{'text'}] = reply[\textcolor{stringliteral}{'text'}].replace(\textcolor{stringliteral}{'PERSON1 '}, \textcolor{stringliteral}{''})
692                     reply[\textcolor{stringliteral}{'text'}] = reply[\textcolor{stringliteral}{'text'}].replace(\textcolor{stringliteral}{'PERSON2 '}, \textcolor{stringliteral}{''})
693 
694         \textcolor{keywordflow}{return} batch\_reply
695 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a80bdd18c28f4a2ab19c463dd123165e7}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a80bdd18c28f4a2ab19c463dd123165e7}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!dictionary\+\_\+class@{dictionary\+\_\+class}}
\index{dictionary\+\_\+class@{dictionary\+\_\+class}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{dictionary\+\_\+class()}{dictionary\_class()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+dictionary\+\_\+class (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 32 of file language\+\_\+model.\+py.


\begin{DoxyCode}
32     \textcolor{keyword}{def }dictionary\_class():
33         \textcolor{keywordflow}{return} DictionaryAgent
34 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa3de87163cd61e4195afc0ccf801699b}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa3de87163cd61e4195afc0ccf801699b}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!get\+\_\+predictions@{get\+\_\+predictions}}
\index{get\+\_\+predictions@{get\+\_\+predictions}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{get\+\_\+predictions()}{get\_predictions()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+get\+\_\+predictions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{data }\end{DoxyParamCaption})}

\begin{DoxyVerb}Generates predictions word by word until we either reach the end token or some
max length (opt['truncate_pred']).
\end{DoxyVerb}
 

Definition at line 491 of file language\+\_\+model.\+py.


\begin{DoxyCode}
491     \textcolor{keyword}{def }get\_predictions(self, data):
492         \textcolor{stringliteral}{"""}
493 \textcolor{stringliteral}{        Generates predictions word by word until we either reach the end token or some}
494 \textcolor{stringliteral}{        max length (opt['truncate\_pred']).}
495 \textcolor{stringliteral}{        """}
496         token\_list = []
497         bsz = data.size(0)
498         done = [\textcolor{keyword}{False} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(bsz)]
499         total\_done = 0
500         hidden = self.model.init\_hidden(bsz)
501 
502         i = 0
503         word\_idx = \textcolor{keywordtype}{None}
504         \textcolor{keywordflow}{while} total\_done < bsz \textcolor{keywordflow}{and} i <= self.opt[\textcolor{stringliteral}{'truncate\_pred'}]:
505             \textcolor{keywordflow}{if} i == 0:
506                 \textcolor{comment}{# feed in input without end tokens}
507                 output, hidden = self.model(data.transpose(0, 1), hidden)
508                 hidden = self.repackage\_hidden(hidden)
509                 \textcolor{comment}{# feed in end tokens}
510                 output, hidden = self.model(
511                     Variable(self.ends[:bsz].view(1, bsz)), hidden
512                 )
513             \textcolor{keywordflow}{else}:
514                 output, hidden = self.model(
515                     Variable(word\_idx.view(1, bsz)), hidden, no\_pack=\textcolor{keyword}{True}
516                 )
517             hidden = self.repackage\_hidden(hidden)
518             word\_weights = output.squeeze().data.exp()
519             \textcolor{keywordflow}{if} bsz > 1:
520                 \_, word\_idx = torch.max(word\_weights, 1)
521             \textcolor{keywordflow}{else}:
522                 \textcolor{keywordflow}{if} self.sampling\_mode:
523                     unk\_idx = self.dict[self.dict.unk\_token]
524                     \textcolor{comment}{# make word\_weights have smaller norm so that calculated}
525                     \textcolor{comment}{# norm does not blow up}
526                     word\_weights = word\_weights.div(1e10)
527                     \textcolor{comment}{# make word\_weights have L2 norm 1}
528                     ww\_norm = torch.norm(word\_weights, p=2)
529                     word\_weights = word\_weights.div(ww\_norm)
530                     \textcolor{comment}{# square distribution}
531                     word\_weights = torch.mul(word\_weights, word\_weights)
532                     \textcolor{comment}{# sample distribution}
533                     word\_idx = torch.multinomial(word\_weights, 1)
534                     \textcolor{comment}{# do not produce UNK token}
535                     \textcolor{keywordflow}{while} word\_idx == unk\_idx:
536                         word\_idx = torch.multinomial(word\_weights, 1)
537                 \textcolor{keywordflow}{else}:
538                     \_, word\_idx = torch.max(word\_weights, 0)
539             \textcolor{comment}{# mark end indices for items in batch}
540             word\_idx = word\_idx.view(-1)
541             \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} range(word\_idx.size(0)):
542                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} done[k]:
543                     \textcolor{keywordflow}{if} \hyperlink{namespacelanguage__model_1_1eval__ppl_a7d12ee00479673c5c8d1f6d01faa272a}{int}(word\_idx[k]) == self.END\_IDX:
544                         done[k] = \textcolor{keyword}{True}
545                         total\_done += 1
546             token\_list.append(word\_idx.view(bsz, 1))
547             i += 1
548 
549         \textcolor{keywordflow}{return} torch.cat(token\_list, 1)
550 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aeb1136a4ae2a2a1e8c0d5a7b75d9898f}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aeb1136a4ae2a2a1e8c0d5a7b75d9898f}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!get\+\_\+target\+\_\+loss@{get\+\_\+target\+\_\+loss}}
\index{get\+\_\+target\+\_\+loss@{get\+\_\+target\+\_\+loss}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{get\+\_\+target\+\_\+loss()}{get\_target\_loss()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+get\+\_\+target\+\_\+loss (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{data,  }\item[{}]{hidden,  }\item[{}]{targets }\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculates the loss with respect to the targets, token by token, where each
output token is conditioned on either the input or the previous target token.
\end{DoxyVerb}
 

Definition at line 460 of file language\+\_\+model.\+py.


\begin{DoxyCode}
460     \textcolor{keyword}{def }get\_target\_loss(self, data, hidden, targets):
461         \textcolor{stringliteral}{"""}
462 \textcolor{stringliteral}{        Calculates the loss with respect to the targets, token by token, where each}
463 \textcolor{stringliteral}{        output token is conditioned on either the input or the previous target token.}
464 \textcolor{stringliteral}{        """}
465         loss = 0.0
466         bsz = data.size(0)
467 
468         \textcolor{comment}{# during interactive mode, when no targets exist, we return 0}
469         \textcolor{keywordflow}{if} targets \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
470             \textcolor{keywordflow}{return} loss
471 
472         \textcolor{comment}{# feed in inputs without end token}
473         output, hidden = self.model(data.transpose(0, 1), hidden)
474         self.hidden = self.repackage\_hidden(hidden)
475         \textcolor{comment}{# feed in end tokens}
476         output, hidden = self.model(Variable(self.ends[:bsz].view(1, bsz)), self.hidden)
477         self.hidden = self.repackage\_hidden(hidden)
478         output\_flat = output.view(-1, len(self.dict))
479         loss += self.criterion(output\_flat, targets.select(1, 0).view(-1)).data
480 
481         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, targets.size(1)):
482             output, hidden = self.model(
483                 targets.select(1, i - 1).view(1, bsz), self.hidden, no\_pack=\textcolor{keyword}{True}
484             )
485             self.hidden = self.repackage\_hidden(hidden)
486             output\_flat = output.view(-1, len(self.dict))
487             loss += self.criterion(output\_flat, targets.select(1, i).view(-1)).data
488 
489         \textcolor{keywordflow}{return} loss
490 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a3b1a39e1467680e19dccfcfb8dae4273}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a3b1a39e1467680e19dccfcfb8dae4273}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!load@{load}}
\index{load@{load}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Load model states.
\end{DoxyVerb}
 

Definition at line 738 of file language\+\_\+model.\+py.


\begin{DoxyCode}
738     \textcolor{keyword}{def }load(self, path):
739         \textcolor{stringliteral}{"""}
740 \textcolor{stringliteral}{        Load model states.}
741 \textcolor{stringliteral}{        """}
742         \textcolor{keywordflow}{if} os.path.isfile(path):
743             \textcolor{comment}{# load model parameters if available}
744             print(\textcolor{stringliteral}{'[ Loading existing model params from \{\} ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(path))
745             self.states = torch.load(path, map\_location=\textcolor{keyword}{lambda} cpu, \_: cpu)
746             self.model.load\_state\_dict(self.states[\textcolor{stringliteral}{'model'}])
747 \end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a8f879ddce0947b8b56f980f7f4fea07b}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a8f879ddce0947b8b56f980f7f4fea07b}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!load\+\_\+opt@{load\+\_\+opt}}
\index{load\+\_\+opt@{load\+\_\+opt}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{load\+\_\+opt()}{load\_opt()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+load\+\_\+opt (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return opt, states.
\end{DoxyVerb}
 

Definition at line 731 of file language\+\_\+model.\+py.


\begin{DoxyCode}
731     \textcolor{keyword}{def }load\_opt(self, path):
732         \textcolor{stringliteral}{"""}
733 \textcolor{stringliteral}{        Return opt, states.}
734 \textcolor{stringliteral}{        """}
735         states = torch.load(path, map\_location=\textcolor{keyword}{lambda} cpu, \_: cpu)
736         \textcolor{keywordflow}{return} states[\textcolor{stringliteral}{'opt'}]
737 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a78df1c525c94c4cc68e05cd44ee374fd}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a78df1c525c94c4cc68e05cd44ee374fd}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!observe@{observe}}
\index{observe@{observe}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save observation for act.

If multiple observations are from the same episode, concatenate them.
\end{DoxyVerb}
 

Definition at line 390 of file language\+\_\+model.\+py.


\begin{DoxyCode}
390     \textcolor{keyword}{def }observe(self, observation):
391         \textcolor{stringliteral}{"""}
392 \textcolor{stringliteral}{        Save observation for act.}
393 \textcolor{stringliteral}{}
394 \textcolor{stringliteral}{        If multiple observations are from the same episode, concatenate them.}
395 \textcolor{stringliteral}{        """}
396         \textcolor{comment}{# shallow copy observation (deep copy can be expensive)}
397         obs = Message(observation.copy())  \textcolor{comment}{# TODO: all teachers should return}
398         \textcolor{comment}{# messages, so this should be eventually unecessary}
399         seq\_len = self.opt[\textcolor{stringliteral}{'seq\_len'}]
400         is\_training = \textcolor{keyword}{True}
401         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} obs:
402             is\_training = \textcolor{keyword}{False}
403 
404         \textcolor{keywordflow}{if} is\_training:
405             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} obs:
406                 \textcolor{keywordflow}{if} self.use\_person\_tokens:
407                     obs.force\_set(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{'PERSON1 '} + obs[\textcolor{stringliteral}{'text'}])
408                 vec = self.parse(obs[\textcolor{stringliteral}{'text'}])
409                 vec.append(self.END\_IDX)
410                 self.next\_observe += vec
411             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} obs:
412                 \textcolor{keywordflow}{if} self.use\_person\_tokens:
413                     labels = [
414                         \textcolor{stringliteral}{'PERSON2 '} + label \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} obs[\textcolor{stringliteral}{'labels'}] \textcolor{keywordflow}{if} label != \textcolor{stringliteral}{''}
415                     ]
416                     obs.force\_set(\textcolor{stringliteral}{'labels'}, tuple(labels))
417                 vec = self.parse(obs[\textcolor{stringliteral}{'labels'}][0])
418                 vec.append(self.END\_IDX)
419                 self.next\_observe += vec
420             \textcolor{keywordflow}{if} len(self.next\_observe) < (seq\_len + 1):
421                 \textcolor{comment}{# not enough to return to make a batch}
422                 \textcolor{comment}{# we handle this case in vectorize}
423                 \textcolor{comment}{# labels indicates that we are training}
424                 self.observation = \{\textcolor{stringliteral}{'labels'}: \textcolor{stringliteral}{''}\}
425                 \textcolor{keywordflow}{return} self.observation
426             \textcolor{keywordflow}{else}:
427                 vecs\_to\_return = []
428                 total = len(self.next\_observe) // (seq\_len + 1)
429                 \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(total):
430                     observe = self.next\_observe[: (seq\_len + 1)]
431                     self.next\_observe = self.next\_observe[(seq\_len + 1) :]
432                     vecs\_to\_return.append(observe)
433                 dict\_to\_return = \{\textcolor{stringliteral}{'text'}: \textcolor{stringliteral}{''}, \textcolor{stringliteral}{'labels'}: \textcolor{stringliteral}{''}, \textcolor{stringliteral}{'text2vec'}: vecs\_to\_return\}
434                 self.observation = Message(dict\_to\_return)
435                 \textcolor{keywordflow}{return} dict\_to\_return
436         \textcolor{keywordflow}{else}:
437             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} obs:
438                 \textcolor{keywordflow}{if} self.use\_person\_tokens:
439                     obs.force\_set(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{'PERSON1 '} + obs[\textcolor{stringliteral}{'text'}])
440             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'eval\_labels'} \textcolor{keywordflow}{in} obs:
441                 \textcolor{keywordflow}{if} self.use\_person\_tokens:
442                     eval\_labels = [
443                         \textcolor{stringliteral}{'PERSON2 '} + label
444                         \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} obs[\textcolor{stringliteral}{'eval\_labels'}]
445                         \textcolor{keywordflow}{if} label != \textcolor{stringliteral}{''}
446                     ]
447                     obs.force\_set(\textcolor{stringliteral}{'eval\_labels'}, tuple(eval\_labels))
448             self.observation = obs
449             \textcolor{keywordflow}{return} obs
450 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_acd53015e95f8aead134d65e2cc8cf180}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_acd53015e95f8aead134d65e2cc8cf180}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!override\+\_\+opt@{override\+\_\+opt}}
\index{override\+\_\+opt@{override\+\_\+opt}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{override\+\_\+opt()}{override\_opt()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+override\+\_\+opt (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{new\+\_\+opt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Set overridable opts from loaded opt file.

Print out each added key and each overriden key. Only override args specific to
the model.
\end{DoxyVerb}
 

Definition at line 289 of file language\+\_\+model.\+py.


\begin{DoxyCode}
289     \textcolor{keyword}{def }override\_opt(self, new\_opt):
290         \textcolor{stringliteral}{"""}
291 \textcolor{stringliteral}{        Set overridable opts from loaded opt file.}
292 \textcolor{stringliteral}{}
293 \textcolor{stringliteral}{        Print out each added key and each overriden key. Only override args specific to}
294 \textcolor{stringliteral}{        the model.}
295 \textcolor{stringliteral}{        """}
296         model\_args = \{
297             \textcolor{stringliteral}{'hiddensize'},
298             \textcolor{stringliteral}{'embeddingsize'},
299             \textcolor{stringliteral}{'numlayers'},
300             \textcolor{stringliteral}{'dropout'},
301             \textcolor{stringliteral}{'seq\_len'},
302             \textcolor{stringliteral}{'emb\_tied'},
303             \textcolor{stringliteral}{'truncate\_pred'},
304             \textcolor{stringliteral}{'report\_freq'},
305             \textcolor{stringliteral}{'person\_tokens'},
306             \textcolor{stringliteral}{'learningrate'},
307         \}
308         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} new\_opt.items():
309             \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} model\_args:
310                 \textcolor{comment}{# skip non-model args}
311                 \textcolor{keywordflow}{continue}
312             \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.opt:
313                 print(\textcolor{stringliteral}{'Adding new option [ \{k\}: \{v\} ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(k=k, v=v))
314             \textcolor{keywordflow}{elif} self.opt[k] != v:
315                 print(
316                     \textcolor{stringliteral}{'Overriding option [ \{k\}: \{old\} => \{v\}]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
317                         k=k, old=self.opt[k], v=v
318                     )
319                 )
320             self.opt[k] = v
321         \textcolor{keywordflow}{return} self.opt
322 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ad67bbe760648032c08da9400bb2e3da1}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ad67bbe760648032c08da9400bb2e3da1}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!parse@{parse}}
\index{parse@{parse}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{parse()}{parse()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+parse (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert string to token indices.
\end{DoxyVerb}
 

Definition at line 323 of file language\+\_\+model.\+py.


\begin{DoxyCode}
323     \textcolor{keyword}{def }parse(self, text):
324         \textcolor{stringliteral}{"""}
325 \textcolor{stringliteral}{        Convert string to token indices.}
326 \textcolor{stringliteral}{        """}
327         \textcolor{keywordflow}{return} self.dict.txt2vec(text)
328 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a1ff4e6849d50eb9d58a2f97a91d715ce}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a1ff4e6849d50eb9d58a2f97a91d715ce}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!predict@{predict}}
\index{predict@{predict}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{predict()}{predict()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+predict (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{data,  }\item[{}]{hidden,  }\item[{}]{targets = {\ttfamily None},  }\item[{}]{is\+\_\+training = {\ttfamily True},  }\item[{}]{y\+\_\+lens = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Produce a prediction from our model.
\end{DoxyVerb}
 

Definition at line 551 of file language\+\_\+model.\+py.


\begin{DoxyCode}
551     \textcolor{keyword}{def }predict(self, data, hidden, targets=None, is\_training=True, y\_lens=None):
552         \textcolor{stringliteral}{"""}
553 \textcolor{stringliteral}{        Produce a prediction from our model.}
554 \textcolor{stringliteral}{        """}
555         output = \textcolor{keywordtype}{None}
556         predictions = \textcolor{keywordtype}{None}
557         \textcolor{keywordflow}{if} is\_training:
558             self.model.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}()
559             self.zero\_grad()
560             output, hidden = self.model(data, hidden)
561             loss = self.criterion(output.view(-1, len(self.dict)), targets.view(-1))
562             \textcolor{comment}{# save loss to metrics}
563             target\_tokens = targets.ne(self.NULL\_IDX).\hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}().sum().item()
564             self.metrics[\textcolor{stringliteral}{'lmloss'}] += loss.double().item()
565             self.metrics[\textcolor{stringliteral}{'lm\_num\_tokens'}] += target\_tokens
566             \textcolor{comment}{# average loss per token}
567             loss /= target\_tokens
568             loss.backward(retain\_graph=\textcolor{keyword}{True})
569             self.update\_params()
570         \textcolor{keywordflow}{else}:
571             self.model.eval()
572             predictions = self.get\_predictions(data)
573             bsz = data.size(0)
574             \textcolor{keywordflow}{if} bsz != self.batchsize:
575                 self.hidden = self.model.init\_hidden(bsz)
576             \textcolor{keywordflow}{if} targets \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
577                 loss = self.get\_target\_loss(data, self.hidden, targets)
578                 self.metrics[\textcolor{stringliteral}{'loss'}] += loss
579                 self.metrics[\textcolor{stringliteral}{'num\_tokens'}] += sum(y\_lens)
580 
581         \textcolor{keywordflow}{return} output, hidden, predictions
582 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a058d0497a88662c2d523b3b5a836a0bb}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a058d0497a88662c2d523b3b5a836a0bb}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!receive\+\_\+metrics@{receive\+\_\+metrics}}
\index{receive\+\_\+metrics@{receive\+\_\+metrics}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{receive\+\_\+metrics()}{receive\_metrics()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+receive\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{metrics\+\_\+dict }\end{DoxyParamCaption})}



Definition at line 727 of file language\+\_\+model.\+py.


\begin{DoxyCode}
727     \textcolor{keyword}{def }receive\_metrics(self, metrics\_dict):
728         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'loss'} \textcolor{keywordflow}{in} metrics\_dict \textcolor{keywordflow}{and} self.scheduler \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
729             self.scheduler.step(metrics\_dict[\textcolor{stringliteral}{'loss'}])
730 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa54ff09a8edc6ae51ac8be33aeb4acc8}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa54ff09a8edc6ae51ac8be33aeb4acc8}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!repackage\+\_\+hidden@{repackage\+\_\+hidden}}
\index{repackage\+\_\+hidden@{repackage\+\_\+hidden}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{repackage\+\_\+hidden()}{repackage\_hidden()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+repackage\+\_\+hidden (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{h }\end{DoxyParamCaption})}

\begin{DoxyVerb}Wraps hidden states in new Variables, to detach them from their history.
\end{DoxyVerb}
 

Definition at line 451 of file language\+\_\+model.\+py.


\begin{DoxyCode}
451     \textcolor{keyword}{def }repackage\_hidden(self, h):
452         \textcolor{stringliteral}{"""}
453 \textcolor{stringliteral}{        Wraps hidden states in new Variables, to detach them from their history.}
454 \textcolor{stringliteral}{        """}
455         \textcolor{keywordflow}{if} isinstance(h, Variable):
456             \textcolor{keywordflow}{return} Variable(h.data)
457         \textcolor{keywordflow}{else}:
458             \textcolor{keywordflow}{return} tuple(self.repackage\_hidden(v) \textcolor{keywordflow}{for} v \textcolor{keywordflow}{in} h)
459 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_acc05a1253c9fc32f8d1f9817b9ca559e}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_acc05a1253c9fc32f8d1f9817b9ca559e}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!report@{report}}
\index{report@{report}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{report()}{report()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+report (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 356 of file language\+\_\+model.\+py.


\begin{DoxyCode}
356     \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}(self):
357         m = \{\}
358         \textcolor{keywordflow}{if} self.metrics[\textcolor{stringliteral}{'num\_tokens'}] > 0:
359             m[\textcolor{stringliteral}{'loss'}] = self.metrics[\textcolor{stringliteral}{'loss'}] / self.metrics[\textcolor{stringliteral}{'num\_tokens'}]
360             m[\textcolor{stringliteral}{'ppl'}] = math.exp(m[\textcolor{stringliteral}{'loss'}])
361         \textcolor{keywordflow}{if} self.metrics[\textcolor{stringliteral}{'lm\_num\_tokens'}] > 0:
362             m[\textcolor{stringliteral}{'lmloss'}] = self.metrics[\textcolor{stringliteral}{'lmloss'}] / self.metrics[\textcolor{stringliteral}{'lm\_num\_tokens'}]
363             m[\textcolor{stringliteral}{'lmppl'}] = math.exp(m[\textcolor{stringliteral}{'lmloss'}])
364         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} m.items():
365             \textcolor{comment}{# clean up: rounds to sigfigs and converts tensors to floats}
366             m[k] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(v, 4)
367         \textcolor{keywordflow}{return} m
368 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4ccc140cc9d528c4135ec65f2bb4325}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4ccc140cc9d528c4135ec65f2bb4325}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!reset@{reset}}
\index{reset@{reset}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset observation and episode_done.
\end{DoxyVerb}
 

Definition at line 342 of file language\+\_\+model.\+py.


\begin{DoxyCode}
342     \textcolor{keyword}{def }reset(self):
343         \textcolor{stringliteral}{"""}
344 \textcolor{stringliteral}{        Reset observation and episode\_done.}
345 \textcolor{stringliteral}{        """}
346         self.observation = \textcolor{keywordtype}{None}
347         self.reset\_metrics()
348 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a62896fd9aa38b55c6ea1b8a8770e3261}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a62896fd9aa38b55c6ea1b8a8770e3261}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!reset\+\_\+metrics@{reset\+\_\+metrics}}
\index{reset\+\_\+metrics@{reset\+\_\+metrics}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{reset\+\_\+metrics()}{reset\_metrics()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+reset\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 349 of file language\+\_\+model.\+py.


\begin{DoxyCode}
349     \textcolor{keyword}{def }reset\_metrics(self):
350         self.metrics.clear()
351         self.metrics[\textcolor{stringliteral}{'loss'}] = 0
352         self.metrics[\textcolor{stringliteral}{'lmloss'}] = 0
353         self.metrics[\textcolor{stringliteral}{'num\_tokens'}] = 0
354         self.metrics[\textcolor{stringliteral}{'lm\_num\_tokens'}] = 0
355 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_adc621ff0e625e2f00225d78408e9bafc}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_adc621ff0e625e2f00225d78408e9bafc}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!save@{save}}
\index{save@{save}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save model parameters if model_file is set.
\end{DoxyVerb}
 

Definition at line 700 of file language\+\_\+model.\+py.


\begin{DoxyCode}
700     \textcolor{keyword}{def }save(self, path=None):
701         \textcolor{stringliteral}{"""}
702 \textcolor{stringliteral}{        Save model parameters if model\_file is set.}
703 \textcolor{stringliteral}{        """}
704         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} path
705 
706         \textcolor{keywordflow}{if} path \textcolor{keywordflow}{and} hasattr(self, \textcolor{stringliteral}{'model'}):
707             model = \{\}
708             model[\textcolor{stringliteral}{'model'}] = self.model.state\_dict()
709             model[\textcolor{stringliteral}{'opt'}] = self.opt
710             model[\textcolor{stringliteral}{'best\_val\_loss'}] = self.best\_val\_loss
711 
712             with open(path, \textcolor{stringliteral}{'wb'}) \textcolor{keyword}{as} write:
713                 torch.save(model, write)
714             \textcolor{comment}{# save opt file}
715             with open(path + \textcolor{stringliteral}{'.opt'}, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} handle:
716                 json.dump(self.opt, handle)
717 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a9d871fa6c5da46d2fd5564b814001a97}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a9d871fa6c5da46d2fd5564b814001a97}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!share@{share}}
\index{share@{share}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Share internal states between parent and child instances.
\end{DoxyVerb}
 

Definition at line 369 of file language\+\_\+model.\+py.


\begin{DoxyCode}
369     \textcolor{keyword}{def }share(self):
370         \textcolor{stringliteral}{"""}
371 \textcolor{stringliteral}{        Share internal states between parent and child instances.}
372 \textcolor{stringliteral}{        """}
373         shared = super().share()
374         shared[\textcolor{stringliteral}{'opt'}] = self.opt
375         shared[\textcolor{stringliteral}{'dict'}] = self.dict
376         shared[\textcolor{stringliteral}{'NULL\_IDX'}] = self.NULL\_IDX
377         shared[\textcolor{stringliteral}{'END\_IDX'}] = self.END\_IDX
378         shared[\textcolor{stringliteral}{'model'}] = self.model
379         \textcolor{keywordflow}{if} self.opt.get(\textcolor{stringliteral}{'numthreads'}, 1) > 1:
380             \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(self.metrics) == dict:
381                 \textcolor{comment}{# move metrics and model to shared memory}
382                 self.metrics = SharedTable(self.metrics)
383                 self.model.share\_memory()
384             shared[\textcolor{stringliteral}{'states'}] = \{  \textcolor{comment}{# only need to pass optimizer states}
385                 \textcolor{stringliteral}{'optimizer'}: self.optimizer.state\_dict()
386             \}
387         shared[\textcolor{stringliteral}{'metrics'}] = self.metrics
388         \textcolor{keywordflow}{return} shared
389 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab7b37ff49b1ce04ef7ce0e598cf736e3}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab7b37ff49b1ce04ef7ce0e598cf736e3}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{shutdown()}{shutdown()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+shutdown (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save the state of the model when shutdown.
\end{DoxyVerb}
 

Definition at line 718 of file language\+\_\+model.\+py.


\begin{DoxyCode}
718     \textcolor{keyword}{def }shutdown(self):
719         \textcolor{stringliteral}{"""}
720 \textcolor{stringliteral}{        Save the state of the model when shutdown.}
721 \textcolor{stringliteral}{        """}
722         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None})
723         \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
724             self.save(path + \textcolor{stringliteral}{'.shutdown\_state'})
725         super().shutdown()
726 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af474c46339e2e0c881f8b8b81f5f9b7f}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af474c46339e2e0c881f8b8b81f5f9b7f}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!update\+\_\+params@{update\+\_\+params}}
\index{update\+\_\+params@{update\+\_\+params}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{update\+\_\+params()}{update\_params()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+update\+\_\+params (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Do one optimization step.
\end{DoxyVerb}
 

Definition at line 335 of file language\+\_\+model.\+py.


\begin{DoxyCode}
335     \textcolor{keyword}{def }update\_params(self):
336         \textcolor{stringliteral}{"""}
337 \textcolor{stringliteral}{        Do one optimization step.}
338 \textcolor{stringliteral}{        """}
339         torch.nn.utils.clip\_grad\_norm\_(self.model.parameters(), self.clip)
340         self.optimizer.step()
341 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aeddf3a4b207e0668644ce6dfd93f39ef}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aeddf3a4b207e0668644ce6dfd93f39ef}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!vectorize@{vectorize}}
\index{vectorize@{vectorize}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{vectorize()}{vectorize()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+vectorize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations,  }\item[{}]{seq\+\_\+len,  }\item[{}]{is\+\_\+training }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert a list of observations into input & target tensors.
\end{DoxyVerb}
 

Definition at line 583 of file language\+\_\+model.\+py.


\begin{DoxyCode}
583     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_a5c76cc39e3014c7bcf9199d566dbdc0f}{vectorize}(self, observations, seq\_len, is\_training):
584         \textcolor{stringliteral}{"""}
585 \textcolor{stringliteral}{        Convert a list of observations into input & target tensors.}
586 \textcolor{stringliteral}{        """}
587         labels = \textcolor{keywordtype}{None}
588         valid\_inds = \textcolor{keywordtype}{None}
589         y\_lens = \textcolor{keywordtype}{None}
590         \textcolor{keywordflow}{if} is\_training:
591             \textcolor{keywordflow}{for} obs \textcolor{keywordflow}{in} observations:
592                 \textcolor{keywordflow}{if} obs:
593                     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text2vec'} \textcolor{keywordflow}{in} obs:
594                         self.next\_batch += obs[\textcolor{stringliteral}{'text2vec'}]
595             \textcolor{keywordflow}{if} len(self.next\_batch) <= self.batchsize:
596                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}
597             \textcolor{keywordflow}{else}:
598                 data\_list = []
599                 targets\_list = []
600                 \textcolor{comment}{# total is the number of batches}
601                 total = len(self.next\_batch) // self.batchsize
602                 \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(total):
603                     batch = self.next\_batch[: self.batchsize]
604                     self.next\_batch = self.next\_batch[self.batchsize :]
605 
606                     source = torch.LongTensor(batch).t().contiguous()
607                     data = Variable(source[:seq\_len])
608                     targets = Variable(source[1:])
609 
610                     \textcolor{keywordflow}{if} self.use\_cuda:
611                         data = data.cuda()
612                         targets = targets.cuda()
613 
614                     data\_list.append(data)
615                     targets\_list.append(targets)
616         \textcolor{keywordflow}{else}:
617             \textcolor{comment}{# here we get valid examples and pad them with zeros}
618             xs, ys, labels, valid\_inds, \_, y\_lens = PaddingUtils.pad\_text(
619                 observations, self.dict, end\_idx=self.END\_IDX, null\_idx=self.NULL\_IDX
620             )
621 
622             \textcolor{keywordflow}{if} self.use\_cuda:
623                 \textcolor{keywordflow}{if} xs \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
624                     xs = Variable(torch.LongTensor(xs)).cuda()
625                 \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
626                     ys = Variable(torch.LongTensor(ys)).cuda()
627             \textcolor{keywordflow}{else}:
628                 \textcolor{keywordflow}{if} xs \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
629                     xs = Variable(torch.LongTensor(xs))
630                 \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
631                     ys = Variable(torch.LongTensor(ys))
632             data\_list = [xs]
633             targets\_list = [ys]
634 
635         \textcolor{keywordflow}{return} data\_list, targets\_list, labels, valid\_inds, y\_lens
636 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ad7b6363acdfb3d009cd9a3bcc6206faf}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ad7b6363acdfb3d009cd9a3bcc6206faf}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!zero\+\_\+grad@{zero\+\_\+grad}}
\index{zero\+\_\+grad@{zero\+\_\+grad}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{zero\+\_\+grad()}{zero\_grad()}}
{\footnotesize\ttfamily def parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+zero\+\_\+grad (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Zero out optimizer.
\end{DoxyVerb}
 

Definition at line 329 of file language\+\_\+model.\+py.


\begin{DoxyCode}
329     \textcolor{keyword}{def }zero\_grad(self):
330         \textcolor{stringliteral}{"""}
331 \textcolor{stringliteral}{        Zero out optimizer.}
332 \textcolor{stringliteral}{        """}
333         self.optimizer.zero\_grad()
334 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0a1ef8c00baeab09cd811906ee778d06}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0a1ef8c00baeab09cd811906ee778d06}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!batchsize@{batchsize}}
\index{batchsize@{batchsize}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{batchsize}{batchsize}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+batchsize}



Definition at line 169 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a981e3901460fa1eda1d8564a1792eef3}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a981e3901460fa1eda1d8564a1792eef3}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!best\+\_\+val\+\_\+loss@{best\+\_\+val\+\_\+loss}}
\index{best\+\_\+val\+\_\+loss@{best\+\_\+val\+\_\+loss}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{best\+\_\+val\+\_\+loss}{best\_val\_loss}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+best\+\_\+val\+\_\+loss}



Definition at line 269 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0cedb5672a7f4f6533490fbf550cb853}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0cedb5672a7f4f6533490fbf550cb853}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!clip@{clip}}
\index{clip@{clip}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{clip}{clip}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+clip}



Definition at line 252 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a5a7f43878aa096fd1f091dd403dfe30c}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a5a7f43878aa096fd1f091dd403dfe30c}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!criterion@{criterion}}
\index{criterion@{criterion}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{criterion}{criterion}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+criterion}



Definition at line 254 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_abbb9c4e9bd984179a01f4bb0fa77a005}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_abbb9c4e9bd984179a01f4bb0fa77a005}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!dict@{dict}}
\index{dict@{dict}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+dict}



Definition at line 177 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_affe3b740c3cdbac4f3883ff527091f47}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_affe3b740c3cdbac4f3883ff527091f47}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!E\+N\+D\+\_\+\+I\+DX@{E\+N\+D\+\_\+\+I\+DX}}
\index{E\+N\+D\+\_\+\+I\+DX@{E\+N\+D\+\_\+\+I\+DX}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{E\+N\+D\+\_\+\+I\+DX}{END\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+E\+N\+D\+\_\+\+I\+DX}



Definition at line 184 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab0db3334e63765ac0e7fd991db214f72}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab0db3334e63765ac0e7fd991db214f72}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!ends@{ends}}
\index{ends@{ends}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{ends}{ends}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+ends}



Definition at line 263 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa7c4053a69871ded8ac7f6afc31b9af3}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aa7c4053a69871ded8ac7f6afc31b9af3}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!hidden@{hidden}}
\index{hidden@{hidden}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{hidden}{hidden}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+hidden}



Definition at line 261 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ac3a3800bb1e2b9a8e7599346f16d17f6}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ac3a3800bb1e2b9a8e7599346f16d17f6}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!id@{id}}
\index{id@{id}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+id}



Definition at line 227 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4a04c916f52bdd6d5163d36d49aa378}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ae4a04c916f52bdd6d5163d36d49aa378}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!is\+\_\+training@{is\+\_\+training}}
\index{is\+\_\+training@{is\+\_\+training}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{is\+\_\+training}{is\_training}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+is\+\_\+training}



Definition at line 250 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a8be32c6f1a5b35f4c508c9dc1ca911b8}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a8be32c6f1a5b35f4c508c9dc1ca911b8}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!lr@{lr}}
\index{lr@{lr}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{lr}{lr}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+lr}



Definition at line 267 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ac57a5e5b664eca0b561973b98a6f5ab5}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ac57a5e5b664eca0b561973b98a6f5ab5}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!lr\+\_\+factor@{lr\+\_\+factor}}
\index{lr\+\_\+factor@{lr\+\_\+factor}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{lr\+\_\+factor}{lr\_factor}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+lr\+\_\+factor}



Definition at line 270 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a045ef7c347b9295879ff3aaec1a8d9a0}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a045ef7c347b9295879ff3aaec1a8d9a0}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!lr\+\_\+min@{lr\+\_\+min}}
\index{lr\+\_\+min@{lr\+\_\+min}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{lr\+\_\+min}{lr\_min}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+lr\+\_\+min}



Definition at line 273 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a89bb8ba94b9f71ea1571b2b9b38f180a}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a89bb8ba94b9f71ea1571b2b9b38f180a}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!lr\+\_\+patience@{lr\+\_\+patience}}
\index{lr\+\_\+patience@{lr\+\_\+patience}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{lr\+\_\+patience}{lr\_patience}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+lr\+\_\+patience}



Definition at line 272 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a6ff4db5833be08d7275233eabd88caa2}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a6ff4db5833be08d7275233eabd88caa2}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!metrics@{metrics}}
\index{metrics@{metrics}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{metrics}{metrics}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+metrics}



Definition at line 165 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a100d32913ae7e28f898064761cf09ca2}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a100d32913ae7e28f898064761cf09ca2}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!model@{model}}
\index{model@{model}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+model}



Definition at line 179 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab9e45cf73e4e7d933c92826a3a0c2d68}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab9e45cf73e4e7d933c92826a3a0c2d68}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!next\+\_\+batch@{next\+\_\+batch}}
\index{next\+\_\+batch@{next\+\_\+batch}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{next\+\_\+batch}{next\_batch}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+next\+\_\+batch}



Definition at line 248 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab16ff562fa5f17f1544c4e78c4dbe2dd}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_ab16ff562fa5f17f1544c4e78c4dbe2dd}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!next\+\_\+observe@{next\+\_\+observe}}
\index{next\+\_\+observe@{next\+\_\+observe}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{next\+\_\+observe}{next\_observe}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+next\+\_\+observe}



Definition at line 247 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_adb13050a971d2dd7399cd6c0f5271647}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_adb13050a971d2dd7399cd6c0f5271647}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}}
\index{N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{N\+U\+L\+L\+\_\+\+I\+DX}{NULL\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+N\+U\+L\+L\+\_\+\+I\+DX}



Definition at line 183 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aee73b46f6a1dd58cf369bf39b6c66903}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_aee73b46f6a1dd58cf369bf39b6c66903}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!observation@{observation}}
\index{observation@{observation}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+observation}



Definition at line 346 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af8d8114af65bf817afe01545033d51e6}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_af8d8114af65bf817afe01545033d51e6}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!opt@{opt}}
\index{opt@{opt}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+opt}



Definition at line 175 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a222e071975fc874e82e6480c030bbb9d}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a222e071975fc874e82e6480c030bbb9d}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+optimizer}



Definition at line 268 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a2f3a4f5a61bdc2d2292dfeac93ff3e06}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a2f3a4f5a61bdc2d2292dfeac93ff3e06}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!sampling\+\_\+mode@{sampling\+\_\+mode}}
\index{sampling\+\_\+mode@{sampling\+\_\+mode}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{sampling\+\_\+mode}{sampling\_mode}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+sampling\+\_\+mode}



Definition at line 171 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a4695c070d27825b7ee206eac0fb4b576}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a4695c070d27825b7ee206eac0fb4b576}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!scheduler@{scheduler}}
\index{scheduler@{scheduler}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{scheduler}{scheduler}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+scheduler}



Definition at line 274 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0a38913deb7063ce611e0b4494114a9e}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a0a38913deb7063ce611e0b4494114a9e}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!states@{states}}
\index{states@{states}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{states}{states}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+states}



Definition at line 166 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a5a81987ecc0033c7c62c309598426090}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a5a81987ecc0033c7c62c309598426090}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+use\+\_\+cuda}



Definition at line 168 of file language\+\_\+model.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a4d8f28572b3ff9530e7ced7f4bc1d279}\label{classparlai_1_1agents_1_1language__model_1_1language__model_1_1LanguageModelAgent_a4d8f28572b3ff9530e7ced7f4bc1d279}} 
\index{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}!use\+\_\+person\+\_\+tokens@{use\+\_\+person\+\_\+tokens}}
\index{use\+\_\+person\+\_\+tokens@{use\+\_\+person\+\_\+tokens}!parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent@{parlai\+::agents\+::language\+\_\+model\+::language\+\_\+model\+::\+Language\+Model\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+person\+\_\+tokens}{use\_person\_tokens}}
{\footnotesize\ttfamily parlai.\+agents.\+language\+\_\+model.\+language\+\_\+model.\+Language\+Model\+Agent.\+use\+\_\+person\+\_\+tokens}



Definition at line 170 of file language\+\_\+model.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/language\+\_\+model/\hyperlink{language__model_8py}{language\+\_\+model.\+py}\end{DoxyCompactItemize}
