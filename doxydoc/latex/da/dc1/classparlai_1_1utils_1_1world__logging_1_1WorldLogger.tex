\hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger}{}\section{parlai.\+utils.\+world\+\_\+logging.\+World\+Logger Class Reference}
\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger}\index{parlai.\+utils.\+world\+\_\+logging.\+World\+Logger@{parlai.\+utils.\+world\+\_\+logging.\+World\+Logger}}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aecf78591417c85526b5f3efb75bbdca1}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aaf2ae02c76953a68916b5136c1d2cc31}{opt})
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_ae53d57ea1f9df92d06b7d63bd8235bd5}{reset} (self)
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a1f3d6928454f5d230891388bb661681a}{reset\+\_\+world} (self, idx=0)
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a98460ce773e615dabd51e1f3ffb45db3}{log} (self, world)
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aef9b66c44083ace9c8c35a0b41828c34}{convert\+\_\+to\+\_\+labeled\+\_\+data} (self, episode)
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a9a5210ac32adcaec88d4b33265cbba92}{write\+\_\+parlai\+\_\+format} (self, outfile)
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a89f41f54a257d6f2c5fbae6a710d8b44}{write\+\_\+jsonl\+\_\+format} (self, outfile)
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a313438d1ccd5eef2b291dd0ee6dea59f}{write} (self, outfile, file\+\_\+format=\textquotesingle{}jsonl\textquotesingle{})
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a5e5cf4e2cabbf48f39e5e09b7578283a}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aaf2ae02c76953a68916b5136c1d2cc31}{opt}
\item 
\hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_afbcb1888545753a6bc9e272ab63e8218}{keep\+\_\+fields}
\item 
\hyperlink{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aa183aa6d24db81a89a4b21f54d374ef2}{keep\+\_\+all}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Logs actions/observations in a world and saves in a JSONL format.
\end{DoxyVerb}
 

Definition at line 21 of file world\+\_\+logging.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aecf78591417c85526b5f3efb75bbdca1}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aecf78591417c85526b5f3efb75bbdca1}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 36 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
36     \textcolor{keyword}{def }\_\_init\_\_(self, opt):
37         self.opt = copy.deepcopy(opt)
38         self.\_set\_keep\_fields(opt)
39 
40         self.\_current\_episodes = \{\}
41         self.\_logs = []
42 
43         self.reset()
44 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a5e5cf4e2cabbf48f39e5e09b7578283a}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a5e5cf4e2cabbf48f39e5e09b7578283a}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 27 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
27     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
28         agent = argparser.add\_argument\_group(\textcolor{stringliteral}{'World Logging'})
29         agent.add\_argument(
30             \textcolor{stringliteral}{'--log-keep-fields'},
31             type=str,
32             default=KEEP\_ALL,
33             help=\textcolor{stringliteral}{'Fields to keep when logging. Should be a comma separated list'},
34         )
35 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aef9b66c44083ace9c8c35a0b41828c34}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aef9b66c44083ace9c8c35a0b41828c34}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!convert\+\_\+to\+\_\+labeled\+\_\+data@{convert\+\_\+to\+\_\+labeled\+\_\+data}}
\index{convert\+\_\+to\+\_\+labeled\+\_\+data@{convert\+\_\+to\+\_\+labeled\+\_\+data}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{convert\+\_\+to\+\_\+labeled\+\_\+data()}{convert\_to\_labeled\_data()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+convert\+\_\+to\+\_\+labeled\+\_\+data (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{episode }\end{DoxyParamCaption})}



Definition at line 109 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
109     \textcolor{keyword}{def }convert\_to\_labeled\_data(self, episode):
110         out = []
111         text\_lst = []
112         \textcolor{keywordflow}{for} parley \textcolor{keywordflow}{in} episode:
113             first\_act, second\_act = parley
114             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} first\_act:
115                 text\_lst.append(first\_act[\textcolor{stringliteral}{'text'}])
116             \textcolor{keywordflow}{if} second\_act.get(\textcolor{stringliteral}{'id'}) != \textcolor{stringliteral}{'context'}:
117                 label = second\_act.get(\textcolor{stringliteral}{'text'})
118                 out.append(
119                     \{
120                         \textcolor{stringliteral}{'id'}: first\_act.get(\textcolor{stringliteral}{'id'}, \textcolor{stringliteral}{''}),
121                         \textcolor{stringliteral}{'text'}: \textcolor{stringliteral}{'\(\backslash\)n'}.join(text\_lst),
122                         \textcolor{stringliteral}{'labels'}: [label],
123                         \textcolor{stringliteral}{'episode\_done'}: \textcolor{keyword}{False},
124                     \}
125                 )
126                 text\_lst = []
127         \textcolor{keywordflow}{if} len(out) > 0:
128             out[-1][\textcolor{stringliteral}{'episode\_done'}] = \textcolor{keyword}{True}
129         \textcolor{keywordflow}{return} out
130 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a98460ce773e615dabd51e1f3ffb45db3}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a98460ce773e615dabd51e1f3ffb45db3}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!log@{log}}
\index{log@{log}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{log()}{log()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+log (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{world }\end{DoxyParamCaption})}

\begin{DoxyVerb}Log acts from a world.
\end{DoxyVerb}
 

Definition at line 93 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
93     \textcolor{keyword}{def }log(self, world):
94         \textcolor{stringliteral}{"""}
95 \textcolor{stringliteral}{        Log acts from a world.}
96 \textcolor{stringliteral}{        """}
97         \textcolor{comment}{# log batch world}
98         \textcolor{keywordflow}{if} self.\_is\_batch\_world(world):
99             self.\_log\_batch(world)
100             \textcolor{keywordflow}{return}
101 
102         \textcolor{comment}{# log single world}
103         acts = world.get\_acts()
104         self.\_add\_msgs(acts)
105         \textcolor{keywordflow}{if} world.episode\_done():
106             \textcolor{comment}{# add episode to logs and clear examples}
107             self.reset\_world()
108 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_ae53d57ea1f9df92d06b7d63bd8235bd5}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_ae53d57ea1f9df92d06b7d63bd8235bd5}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!reset@{reset}}
\index{reset@{reset}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 49 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
49     \textcolor{keyword}{def }reset(self):
50         \textcolor{keywordflow}{for} \_, ep \textcolor{keywordflow}{in} self.\_current\_episodes.items():
51             self.\_add\_episode(ep)
52 
53         self.\_current\_episodes = \{\}
54 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a1f3d6928454f5d230891388bb661681a}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a1f3d6928454f5d230891388bb661681a}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!reset\+\_\+world@{reset\+\_\+world}}
\index{reset\+\_\+world@{reset\+\_\+world}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{reset\+\_\+world()}{reset\_world()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+reset\+\_\+world (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{idx = {\ttfamily 0} }\end{DoxyParamCaption})}



Definition at line 55 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
55     \textcolor{keyword}{def }reset\_world(self, idx=0):
56         self.\_add\_episode(self.\_current\_episodes[idx])
57         self.\_current\_episodes[idx] = []
58 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a313438d1ccd5eef2b291dd0ee6dea59f}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a313438d1ccd5eef2b291dd0ee6dea59f}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!write@{write}}
\index{write@{write}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{write()}{write()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+write (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{outfile,  }\item[{}]{file\+\_\+format = {\ttfamily \textquotesingle{}jsonl\textquotesingle{}} }\end{DoxyParamCaption})}



Definition at line 149 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
149     \textcolor{keyword}{def }write(self, outfile, file\_format='jsonl'):
150         \textcolor{keywordflow}{if} file\_format == \textcolor{stringliteral}{'jsonl'}:
151             self.write\_json\_format(outfile)
152         \textcolor{keywordflow}{else}:
153             self.write\_parlai\_format(outfile)
154 \end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a89f41f54a257d6f2c5fbae6a710d8b44}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a89f41f54a257d6f2c5fbae6a710d8b44}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!write\+\_\+jsonl\+\_\+format@{write\+\_\+jsonl\+\_\+format}}
\index{write\+\_\+jsonl\+\_\+format@{write\+\_\+jsonl\+\_\+format}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{write\+\_\+jsonl\+\_\+format()}{write\_jsonl\_format()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+write\+\_\+jsonl\+\_\+format (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{outfile }\end{DoxyParamCaption})}



Definition at line 141 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
141     \textcolor{keyword}{def }write\_jsonl\_format(self, outfile):
142         print(\textcolor{stringliteral}{'[ Saving log to \{\} in jsonl format ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(outfile))
143         with open(outfile, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} of:
144             \textcolor{keywordflow}{for} episode \textcolor{keywordflow}{in} tqdm(self.\_logs):
145                 dialog = \{\textcolor{stringliteral}{'dialog'}: episode\}
146                 json\_episode = json.dumps(dialog, indent=4)
147                 of.write(json\_episode + \textcolor{stringliteral}{'\(\backslash\)n'})
148 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a9a5210ac32adcaec88d4b33265cbba92}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_a9a5210ac32adcaec88d4b33265cbba92}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!write\+\_\+parlai\+\_\+format@{write\+\_\+parlai\+\_\+format}}
\index{write\+\_\+parlai\+\_\+format@{write\+\_\+parlai\+\_\+format}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{write\+\_\+parlai\+\_\+format()}{write\_parlai\_format()}}
{\footnotesize\ttfamily def parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+write\+\_\+parlai\+\_\+format (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{outfile }\end{DoxyParamCaption})}



Definition at line 131 of file world\+\_\+logging.\+py.


\begin{DoxyCode}
131     \textcolor{keyword}{def }write\_parlai\_format(self, outfile):
132         print(\textcolor{stringliteral}{'[ Saving log to \{\} in ParlAI format ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(outfile))
133         with open(outfile, \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} fw:
134             \textcolor{keywordflow}{for} episode \textcolor{keywordflow}{in} tqdm(self.\_logs):
135                 ep = self.convert\_to\_labeled\_data(episode)
136                 \textcolor{keywordflow}{for} act \textcolor{keywordflow}{in} ep:
137                     txt = \hyperlink{namespaceparlai_1_1utils_1_1misc_ae5db473b41d3b49814e2566e866282b6}{msg\_to\_str}(act)
138                     fw.write(txt + \textcolor{stringliteral}{'\(\backslash\)n'})
139                 fw.write(\textcolor{stringliteral}{'\(\backslash\)n'})
140 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aa183aa6d24db81a89a4b21f54d374ef2}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aa183aa6d24db81a89a4b21f54d374ef2}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!keep\+\_\+all@{keep\+\_\+all}}
\index{keep\+\_\+all@{keep\+\_\+all}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{keep\+\_\+all}{keep\_all}}
{\footnotesize\ttfamily parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+keep\+\_\+all}



Definition at line 47 of file world\+\_\+logging.\+py.

\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_afbcb1888545753a6bc9e272ab63e8218}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_afbcb1888545753a6bc9e272ab63e8218}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!keep\+\_\+fields@{keep\+\_\+fields}}
\index{keep\+\_\+fields@{keep\+\_\+fields}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{keep\+\_\+fields}{keep\_fields}}
{\footnotesize\ttfamily parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+keep\+\_\+fields}



Definition at line 46 of file world\+\_\+logging.\+py.

\mbox{\Hypertarget{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aaf2ae02c76953a68916b5136c1d2cc31}\label{classparlai_1_1utils_1_1world__logging_1_1WorldLogger_aaf2ae02c76953a68916b5136c1d2cc31}} 
\index{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}!opt@{opt}}
\index{opt@{opt}!parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger@{parlai\+::utils\+::world\+\_\+logging\+::\+World\+Logger}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+utils.\+world\+\_\+logging.\+World\+Logger.\+opt}



Definition at line 37 of file world\+\_\+logging.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/utils/\hyperlink{world__logging_8py}{world\+\_\+logging.\+py}\end{DoxyCompactItemize}
