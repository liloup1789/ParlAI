\hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler}{}\section{parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler Class Reference}
\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler}\index{parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler@{parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler}}


Inheritance diagram for parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{d5/dfa/classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{dd/d34/classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a68a930a675ce483852fc323e0f302381}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, args, kwargs)
\item 
def \hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a3b5c9e9fc500c312e1895c6220d52ca7}{open} (self)
\item 
def \hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_ac86fc08a0abf8acabaab0949d579ffb1}{on\+\_\+close} (self)
\item 
def \hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a6e45176bf280b1c9b90b93f933af5e00}{on\+\_\+message} (self, message\+\_\+text)
\item 
def \hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a3f2a94972e7e7564c361b4045983ab35}{check\+\_\+origin} (self, origin)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_ae97ee5ffb1b97863c68c32bbe89cde5e}{message\+\_\+callback}
\item 
\hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a5e574f1ab05ba9d4749f4d4c2fe6e6d2}{sid}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
dictionary \hyperlink{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a9a7875987a4e46a7526c8c230c52c00f}{subs} = \{\}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 17 of file sockets.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a68a930a675ce483852fc323e0f302381}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a68a930a675ce483852fc323e0f302381}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{args,  }\item[{}]{kwargs }\end{DoxyParamCaption})}



Definition at line 20 of file sockets.\+py.


\begin{DoxyCode}
20     \textcolor{keyword}{def }\_\_init\_\_(self, *args, **kwargs):
21         \textcolor{keyword}{def }\_default\_callback(message, socketID):
22             logging.warn(f\textcolor{stringliteral}{"No callback defined for new WebSocket messages."})
23 
24         self.message\_callback = kwargs.pop(\textcolor{stringliteral}{'message\_callback'}, \_default\_callback)
25         self.sid = \hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_a474be2aef9361e19eacf308fbce1e802}{get\_rand\_id}()
26         super().\_\_init\_\_(*args, **kwargs)
27 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a3f2a94972e7e7564c361b4045983ab35}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a3f2a94972e7e7564c361b4045983ab35}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!check\+\_\+origin@{check\+\_\+origin}}
\index{check\+\_\+origin@{check\+\_\+origin}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{check\+\_\+origin()}{check\_origin()}}
{\footnotesize\ttfamily def parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+check\+\_\+origin (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{origin }\end{DoxyParamCaption})}



Definition at line 65 of file sockets.\+py.


\begin{DoxyCode}
65     \textcolor{keyword}{def }check\_origin(self, origin):
66         \textcolor{keywordflow}{return} \textcolor{keyword}{True}
67 \end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_ac86fc08a0abf8acabaab0949d579ffb1}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_ac86fc08a0abf8acabaab0949d579ffb1}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!on\+\_\+close@{on\+\_\+close}}
\index{on\+\_\+close@{on\+\_\+close}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{on\+\_\+close()}{on\_close()}}
{\footnotesize\ttfamily def parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+on\+\_\+close (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Runs when a socket is closed.
\end{DoxyVerb}
 

Definition at line 38 of file sockets.\+py.


\begin{DoxyCode}
38     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1terminal__chat_1_1client_a02c04f40cfa11defbf5c83bbe46aba00}{on\_close}(self):
39         \textcolor{stringliteral}{"""}
40 \textcolor{stringliteral}{        Runs when a socket is closed.}
41 \textcolor{stringliteral}{        """}
42         del self.subs[self.sid]
43 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a6e45176bf280b1c9b90b93f933af5e00}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a6e45176bf280b1c9b90b93f933af5e00}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!on\+\_\+message@{on\+\_\+message}}
\index{on\+\_\+message@{on\+\_\+message}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{on\+\_\+message()}{on\_message()}}
{\footnotesize\ttfamily def parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+on\+\_\+message (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{message\+\_\+text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Callback that runs when a new message is received from a client See the
chat_service README for the resultant message structure.

Args:
    message_text: A stringified JSON object with a text or attachment key.
`text` should contain a string message and `attachment` is a dict.
See `WebsocketAgent.put_data` for more information about the
attachment dict structure.
\end{DoxyVerb}
 

Definition at line 44 of file sockets.\+py.


\begin{DoxyCode}
44     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1terminal__chat_1_1client_a0ef2bb2bd3b966dcdd8402a92b999708}{on\_message}(self, message\_text):
45         \textcolor{stringliteral}{"""}
46 \textcolor{stringliteral}{        Callback that runs when a new message is received from a client See the}
47 \textcolor{stringliteral}{        chat\_service README for the resultant message structure.}
48 \textcolor{stringliteral}{}
49 \textcolor{stringliteral}{        Args:}
50 \textcolor{stringliteral}{            message\_text: A stringified JSON object with a text or attachment key.}
51 \textcolor{stringliteral}{                `text` should contain a string message and `attachment` is a dict.}
52 \textcolor{stringliteral}{                See `WebsocketAgent.put\_data` for more information about the}
53 \textcolor{stringliteral}{                attachment dict structure.}
54 \textcolor{stringliteral}{        """}
55         logging.info(\textcolor{stringliteral}{'websocket message from client: \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(message\_text))
56         message = json.loads(message\_text)
57         message = \{
58             \textcolor{stringliteral}{'text'}: message.get(\textcolor{stringliteral}{'text'}, \textcolor{stringliteral}{''}),
59             \textcolor{stringliteral}{'payload'}: message.get(\textcolor{stringliteral}{'payload'}),
60             \textcolor{stringliteral}{'sender'}: \{\textcolor{stringliteral}{'id'}: self.sid\},
61             \textcolor{stringliteral}{'recipient'}: \{\textcolor{stringliteral}{'id'}: 0\},
62         \}
63         self.message\_callback(message)
64 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a3b5c9e9fc500c312e1895c6220d52ca7}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a3b5c9e9fc500c312e1895c6220d52ca7}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!open@{open}}
\index{open@{open}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{open()}{open()}}
{\footnotesize\ttfamily def parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+open (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Opens a websocket and assigns a random UUID that is stored in the class-level
`subs` variable.
\end{DoxyVerb}
 

Definition at line 28 of file sockets.\+py.


\begin{DoxyCode}
28     \textcolor{keyword}{def }open(self):
29         \textcolor{stringliteral}{"""}
30 \textcolor{stringliteral}{        Opens a websocket and assigns a random UUID that is stored in the class-level}
31 \textcolor{stringliteral}{        `subs` variable.}
32 \textcolor{stringliteral}{        """}
33         \textcolor{keywordflow}{if} self.sid \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.subs.values():
34             self.subs[self.sid] = self
35             logging.info(f\textcolor{stringliteral}{"Opened new socket from ip: \{self.request.remote\_ip\}"})
36             logging.info(f\textcolor{stringliteral}{"Current subscribers: \{self.subs\}"})
37 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_ae97ee5ffb1b97863c68c32bbe89cde5e}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_ae97ee5ffb1b97863c68c32bbe89cde5e}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!message\+\_\+callback@{message\+\_\+callback}}
\index{message\+\_\+callback@{message\+\_\+callback}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{message\+\_\+callback}{message\_callback}}
{\footnotesize\ttfamily parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+message\+\_\+callback}



Definition at line 24 of file sockets.\+py.

\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a5e574f1ab05ba9d4749f4d4c2fe6e6d2}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a5e574f1ab05ba9d4749f4d4c2fe6e6d2}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!sid@{sid}}
\index{sid@{sid}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{sid}{sid}}
{\footnotesize\ttfamily parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+sid}



Definition at line 25 of file sockets.\+py.

\mbox{\Hypertarget{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a9a7875987a4e46a7526c8c230c52c00f}\label{classparlai_1_1chat__service_1_1services_1_1websocket_1_1sockets_1_1MessageSocketHandler_a9a7875987a4e46a7526c8c230c52c00f}} 
\index{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}!subs@{subs}}
\index{subs@{subs}!parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler@{parlai\+::chat\+\_\+service\+::services\+::websocket\+::sockets\+::\+Message\+Socket\+Handler}}
\subsubsection{\texorpdfstring{subs}{subs}}
{\footnotesize\ttfamily dictionary parlai.\+chat\+\_\+service.\+services.\+websocket.\+sockets.\+Message\+Socket\+Handler.\+subs = \{\}\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 18 of file sockets.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/chat\+\_\+service/services/websocket/\hyperlink{sockets_8py}{sockets.\+py}\end{DoxyCompactItemize}
