\hypertarget{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build}{}\section{parlai.\+tasks.\+cornell\+\_\+movie.\+build Namespace Reference}
\label{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build}\index{parlai.\+tasks.\+cornell\+\_\+movie.\+build@{parlai.\+tasks.\+cornell\+\_\+movie.\+build}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_ad02efe0879bce0da293ba177112e1af3}{create\+\_\+fb\+\_\+format} (lines\+\_\+file, convo\+\_\+file, outpath)
\item 
def \hyperlink{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_aced5c0daa1d9fa613eb87535e22f1b47}{build} (opt)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_ac28041130f45c27ff10168f8046b65e9}{R\+E\+S\+O\+U\+R\+C\+ES}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_aced5c0daa1d9fa613eb87535e22f1b47}\label{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_aced5c0daa1d9fa613eb87535e22f1b47}} 
\index{parlai\+::tasks\+::cornell\+\_\+movie\+::build@{parlai\+::tasks\+::cornell\+\_\+movie\+::build}!build@{build}}
\index{build@{build}!parlai\+::tasks\+::cornell\+\_\+movie\+::build@{parlai\+::tasks\+::cornell\+\_\+movie\+::build}}
\subsubsection{\texorpdfstring{build()}{build()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+cornell\+\_\+movie.\+build.\+build (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 61 of file build.\+py.


\begin{DoxyCode}
61 \textcolor{keyword}{def }\hyperlink{namespacedialog__babi__feedback_1_1build_a7a9d289f7493a5ded13c4b7f071b6184}{build}(opt):
62     dpath = os.path.join(opt[\textcolor{stringliteral}{'datapath'}], \textcolor{stringliteral}{'CornellMovie'})
63     version = \textcolor{keywordtype}{None}
64 
65     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} build\_data.built(dpath, version\_string=version):
66         print(\textcolor{stringliteral}{'[building data: '} + dpath + \textcolor{stringliteral}{']'})
67         \textcolor{keywordflow}{if} build\_data.built(dpath):
68             \textcolor{comment}{# An older version exists, so remove these outdated files.}
69             build\_data.remove\_dir(dpath)
70         build\_data.make\_dir(dpath)
71 
72         \textcolor{comment}{# Download the data.}
73         \textcolor{keywordflow}{for} downloadable\_file \textcolor{keywordflow}{in} RESOURCES:
74             downloadable\_file.download\_file(dpath)
75 
76         dpext = os.path.join(dpath, \textcolor{stringliteral}{'cornell movie-dialogs corpus'})
77         \hyperlink{namespaceparlai_1_1tasks_1_1wikiqa_1_1build_a554828702769592403db58c955d1dfe3}{create\_fb\_format}(
78             os.path.join(dpext, \textcolor{stringliteral}{'movie\_lines.txt'}),
79             os.path.join(dpext, \textcolor{stringliteral}{'movie\_conversations.txt'}),
80             dpath,
81         )
82 
83         \textcolor{comment}{# Mark the data as built.}
84         build\_data.mark\_done(dpath, version\_string=version)
85 \end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_ad02efe0879bce0da293ba177112e1af3}\label{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_ad02efe0879bce0da293ba177112e1af3}} 
\index{parlai\+::tasks\+::cornell\+\_\+movie\+::build@{parlai\+::tasks\+::cornell\+\_\+movie\+::build}!create\+\_\+fb\+\_\+format@{create\+\_\+fb\+\_\+format}}
\index{create\+\_\+fb\+\_\+format@{create\+\_\+fb\+\_\+format}!parlai\+::tasks\+::cornell\+\_\+movie\+::build@{parlai\+::tasks\+::cornell\+\_\+movie\+::build}}
\subsubsection{\texorpdfstring{create\+\_\+fb\+\_\+format()}{create\_fb\_format()}}
{\footnotesize\ttfamily def parlai.\+tasks.\+cornell\+\_\+movie.\+build.\+create\+\_\+fb\+\_\+format (\begin{DoxyParamCaption}\item[{}]{lines\+\_\+file,  }\item[{}]{convo\+\_\+file,  }\item[{}]{outpath }\end{DoxyParamCaption})}



Definition at line 22 of file build.\+py.


\begin{DoxyCode}
22 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1tasks_1_1wikiqa_1_1build_a554828702769592403db58c955d1dfe3}{create\_fb\_format}(lines\_file, convo\_file, outpath):
23     print(\textcolor{stringliteral}{'[building fbformat]'})
24     with open(os.path.join(outpath, \textcolor{stringliteral}{'train.txt'}), \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} ftrain, open(
25         os.path.join(outpath, \textcolor{stringliteral}{'valid.txt'}), \textcolor{stringliteral}{'w'}
26     ) \textcolor{keyword}{as} fvalid, open(os.path.join(outpath, \textcolor{stringliteral}{'test.txt'}), \textcolor{stringliteral}{'w'}) \textcolor{keyword}{as} ftest:
27         lines = \{\}
28 
29         codecs.register\_error(\textcolor{stringliteral}{'strict'}, codecs.ignore\_errors)
30         with codecs.open(lines\_file, \textcolor{stringliteral}{'r') as f:}
31 \textcolor{stringliteral}{            }\textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} f:
32                 l = line.split(\textcolor{stringliteral}{' +++$+++ '})
33                 lines[l[0]] = \textcolor{stringliteral}{' '}.join(l[4:]).strip(\textcolor{stringliteral}{'\(\backslash\)n'}).replace(\textcolor{stringliteral}{'\(\backslash\)t'}, \textcolor{stringliteral}{' '})
34 
35         cnt = 0
36         with codecs.open(convo\_file, \textcolor{stringliteral}{'r') as f:}
37 \textcolor{stringliteral}{            }\textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} f:
38                 l = line.split(\textcolor{stringliteral}{' '})
39                 convo = \textcolor{stringliteral}{' '}.join(l[6:]).strip(\textcolor{stringliteral}{'\(\backslash\)n'}).strip(\textcolor{stringliteral}{'['}).strip(\textcolor{stringliteral}{']'})
40                 c = convo.replace(\textcolor{stringliteral}{"'"}, \textcolor{stringliteral}{''}).replace(\textcolor{stringliteral}{' '}, \textcolor{stringliteral}{''}).split(\textcolor{stringliteral}{','})
41 
42                 \textcolor{comment}{# forward conversation}
43                 s = \textcolor{stringliteral}{''}
44                 index = 0
45                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0, len(c), 2):
46                     index += 1
47                     s += \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(index) + \textcolor{stringliteral}{' '} + lines[c[i]]
48                     \textcolor{keywordflow}{if} len(c) > i + 1:
49                         s += \textcolor{stringliteral}{'\(\backslash\)t'} + lines[c[i + 1]]
50                     s += \textcolor{stringliteral}{'\(\backslash\)n'}
51 
52                 cnt = cnt + 1
53                 handle = ftrain
54                 \textcolor{keywordflow}{if} (cnt % 10) == 0:
55                     handle = ftest
56                 \textcolor{keywordflow}{if} (cnt % 10) == 1:
57                     handle = fvalid
58                 handle.write(s + \textcolor{stringliteral}{'\(\backslash\)n'})
59 
60 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_ac28041130f45c27ff10168f8046b65e9}\label{namespaceparlai_1_1tasks_1_1cornell__movie_1_1build_ac28041130f45c27ff10168f8046b65e9}} 
\index{parlai\+::tasks\+::cornell\+\_\+movie\+::build@{parlai\+::tasks\+::cornell\+\_\+movie\+::build}!R\+E\+S\+O\+U\+R\+C\+ES@{R\+E\+S\+O\+U\+R\+C\+ES}}
\index{R\+E\+S\+O\+U\+R\+C\+ES@{R\+E\+S\+O\+U\+R\+C\+ES}!parlai\+::tasks\+::cornell\+\_\+movie\+::build@{parlai\+::tasks\+::cornell\+\_\+movie\+::build}}
\subsubsection{\texorpdfstring{R\+E\+S\+O\+U\+R\+C\+ES}{RESOURCES}}
{\footnotesize\ttfamily parlai.\+tasks.\+cornell\+\_\+movie.\+build.\+R\+E\+S\+O\+U\+R\+C\+ES}



Definition at line 13 of file build.\+py.

