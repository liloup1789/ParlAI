\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent}\index{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent@{parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=226pt]{d3/d2f/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=211pt]{dc/d5a/classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a88801410eefdb0b71bb674a0768e87b9}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8e4926c0c0da6bd7d530c44aa5416731}{opt}, shared=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad40d38a1cc2cafe32c43477740b4a164}{override\+\_\+opt} (self, new\+\_\+opt)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a073830870e283f88ee45a95c0ae8ad2f}{parse} (self, text)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8f6de929b475d3915c159c48165b4575}{v2t} (self, vec)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a0be9f1e378a403284d8afac5648fbf4d}{zero\+\_\+grad} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a3933d4fdc5e603b1a168d92e7da77151}{update\+\_\+params} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a56d246fd8b6bcf41726181c17cdc2762}{reset} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae76435bf7acee9501188de47c0ba6991}{reset\+\_\+metrics} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a83a444ecb418dfb4381147f23653dd7b}{report} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac050147b69c47182730e92866f64156a}{share} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8419a9652b14a16cedff86206a7bb613}{observe} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4473b0e478d7928c2b59ab653c8334fb}{observation})
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_aadec879f7d8daa6451076e4fb358715b}{predict} (self, xs, ys=None, cands=None, valid\+\_\+cands=None, is\+\_\+training=False)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a83e2433e00bff6162ebad3b818771b59}{vectorize} (self, observations)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a9326d8ed88999a992b8ec73313c70a36}{init\+\_\+cuda\+\_\+buffer} (self, batchsize)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4ae534e440fd57603bc9b6e7c08b1c57}{batch\+\_\+act} (self, observations)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae66e8065addb136eb82828ccbe56c5ca}{act} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a31c017cd07b01834a5d467fadfddd7cd}{save} (self, path=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a86c41e705170f0b2e56a5bbc378aead9}{shutdown} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a2aabe1e56b7b94f46875ae7f704f681f}{load} (self, path)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a584d45d729817694d615d2d545532af2}{receive\+\_\+metrics} (self, metrics\+\_\+dict)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a05552a2714cd8d15d754a62258727c98}{dictionary\+\_\+class} ()
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac00637641bf7d8f23614c53ec8a1c610}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a7943d21acc4e6986e15678e7da1d2f27}{truncate}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac50fcecc3b2ec89ece9bf75df8e21c6d}{metrics}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a11398edabc596559f45324d2d603b1e3}{history}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a3f13aca25d825730f0dacbf50f48d7c6}{report\+\_\+freq}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a227faa3994686ab266237ce9e11a2dc7}{use\+\_\+person\+\_\+tokens}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a2f31501d3923b8fb080d147d23ab727b}{batch\+\_\+idx}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a07995ff61edb2c4699aa766122878e94}{rank}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a215857d3ce2c7522c43728ab2879ce89}{beam\+\_\+size}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac0b7a3b712fe92dbabee7f31972b8a47}{topk}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ab81d3b0bd5474debb2f983d1b6220d5e}{use\+\_\+cuda}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8e4926c0c0da6bd7d530c44aa5416731}{opt}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad5ff9534948d32ca9b387fe1189174e6}{dict}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a044b5f18e6d9f0207b947769f06bcc6b}{S\+T\+A\+R\+T\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a46ebee256e0812f6cab77a71c02578e0}{E\+N\+D\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8589f9403a5d358b1c58b467fc556680}{N\+U\+L\+L\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad5d4bdcd877577596273c4af1eb4c70d}{answers}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae6ef958bb58cc1597b23b0a6c6c49b3f}{model}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a616955265cd96254aae5b5958ac18159}{id}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a203f77c92dd9f343cd7c5580756d5e5a}{model\+\_\+class}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad336994a64a83591ba1388aef3f1d5de}{criterion}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4896d5dc3fd7a0f876a654f0bc942b6a}{clip}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac6a5cc3b1faaae160f5c10318a7afcfd}{optimizer}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac8229fafe6c4b7d7ebedbd0f00b55eb0}{scheduler}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4473b0e478d7928c2b59ab653c8334fb}{observation}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a31e1353ee2c64ac03af2bc7854597f35}{buffer\+\_\+initialized}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a82630ee9be1d6e9828ffdd24049a8de3}{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Agent which takes an input sequence and produces an output sequence.

This model supports encoding the input and decoding the output via one of
several flavors of RNN. It then uses a linear layer (whose weights can
be shared with the embedding layer) to convert RNN output states into
output tokens. This model currently uses greedy decoding, selecting the
highest probability token at each time step.

For more information, see the following papers:
- Neural Machine Translation by Jointly Learning to Align and Translate
  `(Bahdanau et al. 2014) <arxiv.org/abs/1409.0473>`_
- Sequence to Sequence Learning with Neural Networks
  `(Sutskever et al. 2014) <arxiv.org/abs/1409.3215>`_
- Effective Approaches to Attention-based Neural Machine Translation
  `(Luong et al. 2015) <arxiv.org/abs/1508.04025>`_
\end{DoxyVerb}
 

Definition at line 95 of file seq2seq\+\_\+v0.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a88801410eefdb0b71bb674a0768e87b9}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a88801410eefdb0b71bb674a0768e87b9}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Set up model.
\end{DoxyVerb}
 

Definition at line 357 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
357     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
358         \textcolor{stringliteral}{"""}
359 \textcolor{stringliteral}{        Set up model.}
360 \textcolor{stringliteral}{        """}
361         super().\_\_init\_\_(opt, shared)
362         opt = self.opt  \textcolor{comment}{# there is a deepcopy in the init}
363 
364         \textcolor{comment}{# all instances may need some params}
365         self.truncate = opt[\textcolor{stringliteral}{'truncate'}] \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'truncate'}] > 0 \textcolor{keywordflow}{else} \textcolor{keywordtype}{None}
366         self.metrics = \{
367             \textcolor{stringliteral}{'loss'}: 0.0,
368             \textcolor{stringliteral}{'num\_tokens'}: 0,
369             \textcolor{stringliteral}{'correct\_tokens'}: 0,
370             \textcolor{stringliteral}{'total\_skipped\_batches'}: 0,
371         \}
372         self.history = \{\}
373         self.report\_freq = opt.get(\textcolor{stringliteral}{'report\_freq'}, 0.001)
374         self.use\_person\_tokens = opt.get(\textcolor{stringliteral}{'person\_tokens'}, \textcolor{keyword}{False})
375         self.batch\_idx = shared \textcolor{keywordflow}{and} shared.get(\textcolor{stringliteral}{'batchindex'}) \textcolor{keywordflow}{or} 0
376         self.rank = opt[\textcolor{stringliteral}{'rank\_candidates'}]
377         self.beam\_size = opt.get(\textcolor{stringliteral}{'beam\_size'}, 1)
378         self.topk = opt.get(\textcolor{stringliteral}{'topk'}, 1)
379         states = \{\}
380 
381         \textcolor{comment}{# check for cuda}
382         self.use\_cuda = \textcolor{keywordflow}{not} opt.get(\textcolor{stringliteral}{'no\_cuda'}) \textcolor{keywordflow}{and} torch.cuda.is\_available()
383         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'numthreads'}, 1) > 1:
384             torch.set\_num\_threads(1)
385 
386         \textcolor{keywordflow}{if} shared:
387             \textcolor{comment}{# set up shared properties}
388             self.opt = shared[\textcolor{stringliteral}{'opt'}]
389             opt = self.opt
390             self.dict = shared[\textcolor{stringliteral}{'dict'}]
391             self.START\_IDX = shared[\textcolor{stringliteral}{'START\_IDX'}]
392             self.END\_IDX = shared[\textcolor{stringliteral}{'END\_IDX'}]
393             self.NULL\_IDX = shared[\textcolor{stringliteral}{'NULL\_IDX'}]
394             \textcolor{comment}{# answers contains a batch\_size list of the last answer produced}
395             self.answers = shared[\textcolor{stringliteral}{'answers'}]
396             self.model = shared[\textcolor{stringliteral}{'model'}]
397             self.metrics = shared[\textcolor{stringliteral}{'metrics'}]
398             states = shared.get(\textcolor{stringliteral}{'states'}, \{\})
399 
400         \textcolor{keywordflow}{else}:
401             \textcolor{comment}{# this is not a shared instance of this class, so do full init}
402             \textcolor{comment}{# answers contains a batch\_size list of the last answer produced}
403             self.answers = [\textcolor{keywordtype}{None}] * opt[\textcolor{stringliteral}{'batchsize'}]
404 
405             \textcolor{keywordflow}{if} self.use\_cuda:
406                 print(\textcolor{stringliteral}{'[ Using CUDA ]'})
407                 torch.cuda.set\_device(opt[\textcolor{stringliteral}{'gpu'}])
408 
409             init\_model = \textcolor{keywordtype}{None}
410             \textcolor{comment}{# check first for 'init\_model' for loading model from file}
411             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'init\_model'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'init\_model'}]):
412                 init\_model = opt[\textcolor{stringliteral}{'init\_model'}]
413             \textcolor{comment}{# next check for 'model\_file', this would override init\_model}
414             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'model\_file'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'model\_file'}]):
415                 init\_model = opt[\textcolor{stringliteral}{'model\_file'}]
416 
417             \textcolor{keywordflow}{if} init\_model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
418                 \textcolor{comment}{# load model parameters if available}
419                 print(\textcolor{stringliteral}{'[ Loading existing model params from \{\} ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(init\_model))
420                 states = self.load(init\_model)
421 
422                 \textcolor{keywordflow}{if} os.path.isfile(init\_model + \textcolor{stringliteral}{'.dict'}) \textcolor{keywordflow}{or} opt[\textcolor{stringliteral}{'dict\_file'}] \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
423                     opt[\textcolor{stringliteral}{'dict\_file'}] = init\_model + \textcolor{stringliteral}{'.dict'}
424 
425             \textcolor{comment}{# load dictionary and basic tokens & vectors}
426             self.dict = DictionaryAgent(opt)
427             self.id = \textcolor{stringliteral}{'Seq2Seq'}
428             \textcolor{comment}{# we use START markers to start our output}
429             self.START\_IDX = self.dict[self.dict.start\_token]
430             \textcolor{comment}{# we use END markers to end our output}
431             self.END\_IDX = self.dict[self.dict.end\_token]
432             \textcolor{comment}{# get index of null token from dictionary (probably 0)}
433             self.NULL\_IDX = self.dict[self.dict.null\_token]
434 
435             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} hasattr(self, \textcolor{stringliteral}{'model\_class'}):
436                 \textcolor{comment}{# this allows child classes to override this but inherit init}
437                 self.model\_class = Seq2seq
438             self.model = self.model\_class(
439                 opt,
440                 len(self.dict),
441                 padding\_idx=self.NULL\_IDX,
442                 start\_idx=self.START\_IDX,
443                 end\_idx=self.END\_IDX,
444                 longest\_label=states.get(\textcolor{stringliteral}{'longest\_label'}, 1),
445             )
446 
447             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'dict\_tokenizer'}) == \textcolor{stringliteral}{'bpe'} \textcolor{keywordflow}{and} opt[\textcolor{stringliteral}{'embedding\_type'}] != \textcolor{stringliteral}{'random'}:
448                 print(\textcolor{stringliteral}{'skipping preinitialization of embeddings for bpe'})
449             \textcolor{keywordflow}{elif} \textcolor{keywordflow}{not} states \textcolor{keywordflow}{and} opt[\textcolor{stringliteral}{'embedding\_type'}] != \textcolor{stringliteral}{'random'}:
450                 \textcolor{comment}{# set up preinitialized embeddings}
451                 \textcolor{keywordflow}{try}:
452                     \textcolor{keyword}{import} torchtext.vocab \textcolor{keyword}{as} vocab
453                 \textcolor{keywordflow}{except} ImportError \textcolor{keyword}{as} ex:
454                     print(\textcolor{stringliteral}{'Please install torch text with `pip install torchtext`'})
455                     \textcolor{keywordflow}{raise} ex
456                 pretrained\_dim = 300
457                 \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'embedding\_type'}].startswith(\textcolor{stringliteral}{'glove'}):
458                     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'twitter'} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'embedding\_type'}]:
459                         init = \textcolor{stringliteral}{'glove-twitter'}
460                         name = \textcolor{stringliteral}{'twitter.27B'}
461                         pretrained\_dim = 200
462                     \textcolor{keywordflow}{else}:
463                         init = \textcolor{stringliteral}{'glove'}
464                         name = \textcolor{stringliteral}{'840B'}
465                     embs = vocab.GloVe(
466                         name=name,
467                         dim=pretrained\_dim,
468                         cache=\hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_a5fbd3301b67f00d6d146fb01c7cd7626}{modelzoo\_path}(
469                             self.opt.get(\textcolor{stringliteral}{'datapath'}), \textcolor{stringliteral}{'models:glove\_vectors'}
470                         ),
471                     )
472                 \textcolor{keywordflow}{elif} opt[\textcolor{stringliteral}{'embedding\_type'}].startswith(\textcolor{stringliteral}{'fasttext'}):
473                     init = \textcolor{stringliteral}{'fasttext'}
474                     embs = vocab.FastText(
475                         language=\textcolor{stringliteral}{'en'},
476                         cache=\hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_a5fbd3301b67f00d6d146fb01c7cd7626}{modelzoo\_path}(
477                             self.opt.get(\textcolor{stringliteral}{'datapath'}), \textcolor{stringliteral}{'models:fasttext\_vectors'}
478                         ),
479                     )
480                 \textcolor{keywordflow}{else}:
481                     \textcolor{keywordflow}{raise} RuntimeError(\textcolor{stringliteral}{'embedding type not implemented'})
482 
483                 \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'embeddingsize'}] != pretrained\_dim:
484                     rp = torch.Tensor(pretrained\_dim, opt[\textcolor{stringliteral}{'embeddingsize'}]).normal\_()
485                 \textcolor{keywordflow}{else}:
486                     rp = \textcolor{keywordtype}{None}
487                 cnt = 0
488                 \textcolor{keywordflow}{for} w, i \textcolor{keywordflow}{in} self.dict.tok2ind.items():
489                     \textcolor{keywordflow}{if} w \textcolor{keywordflow}{in} embs.stoi:
490                         vec = embs.vectors[embs.stoi[w]]
491                         \textcolor{keywordflow}{if} rp \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
492                             vec = torch.mm(vec.unsqueeze(0), rp)
493                         self.model.decoder.lt.weight.data[i] = vec
494                         cnt += 1
495                         \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'lookuptable'}] \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'unique'}, \textcolor{stringliteral}{'dec\_out'}]:
496                             \textcolor{comment}{# also set encoder lt, since it's not shared}
497                             self.model.encoder.lt.weight.data[i] = vec
498                 print(
499                     \textcolor{stringliteral}{'Seq2seq: initialized embeddings for \{\} tokens from \{\}.'}
500                     \textcolor{stringliteral}{''}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(cnt, init)
501                 )
502 
503             \textcolor{keywordflow}{if} states:
504                 \textcolor{comment}{# set loaded states if applicable}
505                 self.model.load\_state\_dict(states[\textcolor{stringliteral}{'model'}])
506 
507             \textcolor{keywordflow}{if} self.use\_cuda:
508                 self.model.cuda()
509 
510         \textcolor{comment}{# set up criteria}
511         \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'numsoftmax'}, 1) > 1:
512             self.criterion = nn.NLLLoss(ignore\_index=self.NULL\_IDX, size\_average=\textcolor{keyword}{False})
513         \textcolor{keywordflow}{else}:
514             self.criterion = nn.CrossEntropyLoss(
515                 ignore\_index=self.NULL\_IDX, size\_average=\textcolor{keyword}{False}
516             )
517 
518         \textcolor{keywordflow}{if} self.use\_cuda:
519             self.criterion.cuda()
520 
521         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'train'} \textcolor{keywordflow}{in} opt.get(\textcolor{stringliteral}{'datatype'}, \textcolor{stringliteral}{''}):
522             \textcolor{comment}{# we only set up optimizers when training}
523             \textcolor{comment}{# we only set this up for the original instance or hogwild ones}
524             self.clip = opt.get(\textcolor{stringliteral}{'gradient\_clip'}, -1)
525 
526             \textcolor{comment}{# set up optimizer}
527             lr = opt[\textcolor{stringliteral}{'learningrate'}]
528             optim\_class = Seq2seqAgent.OPTIM\_OPTS[opt[\textcolor{stringliteral}{'optimizer'}]]
529             kwargs = \{\textcolor{stringliteral}{'lr'}: lr\}
530             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'momentum'}) > 0 \textcolor{keywordflow}{and} opt[\textcolor{stringliteral}{'optimizer'}] \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'sgd'}, \textcolor{stringliteral}{'rmsprop'}]:
531                 kwargs[\textcolor{stringliteral}{'momentum'}] = opt[\textcolor{stringliteral}{'momentum'}]
532                 \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'sgd'}:
533                     kwargs[\textcolor{stringliteral}{'nesterov'}] = \textcolor{keyword}{True}
534             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'adam'}:
535                 \textcolor{comment}{# https://openreview.net/forum?id=ryQu7f-RZ}
536                 kwargs[\textcolor{stringliteral}{'amsgrad'}] = \textcolor{keyword}{True}
537 
538             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'embedding\_type'}].endswith(\textcolor{stringliteral}{'fixed'}):
539                 print(\textcolor{stringliteral}{'Seq2seq: fixing embedding weights.'})
540                 self.model.decoder.lt.weight.requires\_grad = \textcolor{keyword}{False}
541                 self.model.encoder.lt.weight.requires\_grad = \textcolor{keyword}{False}
542                 \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'lookuptable'}] \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'dec\_out'}, \textcolor{stringliteral}{'all'}]:
543                     self.model.decoder.e2s.weight.requires\_grad = \textcolor{keyword}{False}
544             self.optimizer = optim\_class(
545                 [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} self.model.parameters() \textcolor{keywordflow}{if} p.requires\_grad], **kwargs
546             )
547             \textcolor{keywordflow}{if} states.get(\textcolor{stringliteral}{'optimizer'}):
548                 \textcolor{keywordflow}{if} states[\textcolor{stringliteral}{'optimizer\_type'}] != opt[\textcolor{stringliteral}{'optimizer'}]:
549                     print(
550                         \textcolor{stringliteral}{'WARNING: not loading optim state since optim class '} \textcolor{stringliteral}{'changed.'}
551                     )
552                 \textcolor{keywordflow}{else}:
553                     \textcolor{keywordflow}{try}:
554                         self.optimizer.load\_state\_dict(states[\textcolor{stringliteral}{'optimizer'}])
555                     \textcolor{keywordflow}{except} ValueError:
556                         print(
557                             \textcolor{stringliteral}{'WARNING: not loading optim state since model '}
558                             \textcolor{stringliteral}{'params changed.'}
559                         )
560                     \textcolor{keywordflow}{if} self.use\_cuda:
561                         \textcolor{keywordflow}{for} state \textcolor{keywordflow}{in} self.optimizer.state.values():
562                             \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} state.items():
563                                 \textcolor{keywordflow}{if} isinstance(v, torch.Tensor):
564                                     state[k] = v.cuda()
565             self.scheduler = optim.lr\_scheduler.ReduceLROnPlateau(
566                 self.optimizer, \textcolor{stringliteral}{'min'}, factor=0.5, patience=3, verbose=\textcolor{keyword}{True}
567             )
568 
569         self.reset()
570 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae66e8065addb136eb82828ccbe56c5ca}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae66e8065addb136eb82828ccbe56c5ca}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!act@{act}}
\index{act@{act}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 925 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
925     \textcolor{keyword}{def }act(self):
926         \textcolor{comment}{# call batch\_act with this batch of one}
927         \textcolor{keywordflow}{return} self.batch\_act([self.observation])[0]
928 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac00637641bf7d8f23614c53ec8a1c610}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac00637641bf7d8f23614c53ec8a1c610}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

\begin{DoxyVerb}Add command-line arguments specifically for this agent.
\end{DoxyVerb}
 

Definition at line 131 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
131     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
132         \textcolor{stringliteral}{"""}
133 \textcolor{stringliteral}{        Add command-line arguments specifically for this agent.}
134 \textcolor{stringliteral}{        """}
135         agent = argparser.add\_argument\_group(\textcolor{stringliteral}{'Seq2Seq Arguments'})
136         agent.add\_argument(
137             \textcolor{stringliteral}{'--init-model'},
138             type=str,
139             default=\textcolor{keywordtype}{None},
140             help=\textcolor{stringliteral}{'load dict/features/weights/opts from this file'},
141         )
142         agent.add\_argument(
143             \textcolor{stringliteral}{'-hs'},
144             \textcolor{stringliteral}{'--hiddensize'},
145             type=int,
146             default=128,
147             help=\textcolor{stringliteral}{'size of the hidden layers'},
148         )
149         agent.add\_argument(
150             \textcolor{stringliteral}{'-esz'},
151             \textcolor{stringliteral}{'--embeddingsize'},
152             type=int,
153             default=128,
154             help=\textcolor{stringliteral}{'size of the token embeddings'},
155         )
156         agent.add\_argument(
157             \textcolor{stringliteral}{'-nl'}, \textcolor{stringliteral}{'--numlayers'}, type=int, default=2, help=\textcolor{stringliteral}{'number of hidden layers'}
158         )
159         agent.add\_argument(
160             \textcolor{stringliteral}{'-lr'}, \textcolor{stringliteral}{'--learningrate'}, type=float, default=1, help=\textcolor{stringliteral}{'learning rate'}
161         )
162         agent.add\_argument(
163             \textcolor{stringliteral}{'-dr'}, \textcolor{stringliteral}{'--dropout'}, type=float, default=0.1, help=\textcolor{stringliteral}{'dropout rate'}
164         )
165         agent.add\_argument(
166             \textcolor{stringliteral}{'-clip'},
167             \textcolor{stringliteral}{'--gradient-clip'},
168             type=float,
169             default=0.1,
170             help=\textcolor{stringliteral}{'gradient clipping using l2 norm'},
171         )
172         agent.add\_argument(
173             \textcolor{stringliteral}{'-bi'},
174             \textcolor{stringliteral}{'--bidirectional'},
175             type=\textcolor{stringliteral}{'bool'},
176             default=\textcolor{keyword}{False},
177             help=\textcolor{stringliteral}{'whether to encode the context with a '} \textcolor{stringliteral}{'bidirectional rnn'},
178         )
179         agent.add\_argument(
180             \textcolor{stringliteral}{'-att'},
181             \textcolor{stringliteral}{'--attention'},
182             default=\textcolor{stringliteral}{'none'},
183             choices=[\textcolor{stringliteral}{'none'}, \textcolor{stringliteral}{'concat'}, \textcolor{stringliteral}{'general'}, \textcolor{stringliteral}{'dot'}, \textcolor{stringliteral}{'local'}],
184             help=\textcolor{stringliteral}{'Choices: none, concat, general, local. '}
185             \textcolor{stringliteral}{'If set local, also set attention-length. '}
186             \textcolor{stringliteral}{'(see arxiv.org/abs/1508.04025)'},
187         )
188         agent.add\_argument(
189             \textcolor{stringliteral}{'-attl'},
190             \textcolor{stringliteral}{'--attention-length'},
191             default=48,
192             type=int,
193             help=\textcolor{stringliteral}{'Length of local attention.'},
194         )
195         agent.add\_argument(
196             \textcolor{stringliteral}{'--attention-time'},
197             default=\textcolor{stringliteral}{'post'},
198             choices=[\textcolor{stringliteral}{'pre'}, \textcolor{stringliteral}{'post'}],
199             help=\textcolor{stringliteral}{'Whether to apply attention before or after '} \textcolor{stringliteral}{'decoding.'},
200         )
201         agent.add\_argument(
202             \textcolor{stringliteral}{'--no-cuda'},
203             action=\textcolor{stringliteral}{'store\_true'},
204             default=\textcolor{keyword}{False},
205             help=\textcolor{stringliteral}{'disable GPUs even if available'},
206         )
207         agent.add\_argument(
208             \textcolor{stringliteral}{'-gpu'}, \textcolor{stringliteral}{'--gpu'}, type=int, default=-1, help=\textcolor{stringliteral}{'which GPU device to use'}
209         )
210         \textcolor{comment}{# ranking arguments}
211         agent.add\_argument(
212             \textcolor{stringliteral}{'-rc'},
213             \textcolor{stringliteral}{'--rank-candidates'},
214             type=\textcolor{stringliteral}{'bool'},
215             default=\textcolor{keyword}{False},
216             help=\textcolor{stringliteral}{'rank candidates if available. this is done by'}
217             \textcolor{stringliteral}{' computing the prob score per token for each '}
218             \textcolor{stringliteral}{'candidate and selecting the highest scoring.'},
219         )
220         agent.add\_argument(
221             \textcolor{stringliteral}{'-tr'},
222             \textcolor{stringliteral}{'--truncate'},
223             type=int,
224             default=-1,
225             help=\textcolor{stringliteral}{'truncate input & output lengths to speed up '}
226             \textcolor{stringliteral}{'training (may reduce accuracy). This fixes all '}
227             \textcolor{stringliteral}{'input and output to have a maximum length. This '}
228             \textcolor{stringliteral}{'reduces the total amount '}
229             \textcolor{stringliteral}{'of padding in the batches.'},
230         )
231         agent.add\_argument(
232             \textcolor{stringliteral}{'-rnn'},
233             \textcolor{stringliteral}{'--rnn-class'},
234             default=\textcolor{stringliteral}{'lstm'},
235             choices=Seq2seq.RNN\_OPTS.keys(),
236             help=\textcolor{stringliteral}{'Choose between different types of RNNs.'},
237         )
238         agent.add\_argument(
239             \textcolor{stringliteral}{'-dec'},
240             \textcolor{stringliteral}{'--decoder'},
241             default=\textcolor{stringliteral}{'same'},
242             choices=[\textcolor{stringliteral}{'same'}, \textcolor{stringliteral}{'shared'}],
243             help=\textcolor{stringliteral}{'Choose between different decoder modules. '}
244             \textcolor{stringliteral}{'Default "same" uses same class as encoder, '}
245             \textcolor{stringliteral}{'while "shared" also uses the same weights. '}
246             \textcolor{stringliteral}{'Note that shared disabled some encoder '}
247             \textcolor{stringliteral}{'options--in particular, bidirectionality.'},
248         )
249         agent.add\_argument(
250             \textcolor{stringliteral}{'-lt'},
251             \textcolor{stringliteral}{'--lookuptable'},
252             default=\textcolor{stringliteral}{'unique'},
253             choices=[\textcolor{stringliteral}{'unique'}, \textcolor{stringliteral}{'enc\_dec'}, \textcolor{stringliteral}{'dec\_out'}, \textcolor{stringliteral}{'all'}],
254             help=\textcolor{stringliteral}{'The encoder, decoder, and output modules can '}
255             \textcolor{stringliteral}{'share weights, or not. '}
256             \textcolor{stringliteral}{'Unique has independent embeddings for each. '}
257             \textcolor{stringliteral}{'Enc\_dec shares the embedding for the encoder '}
258             \textcolor{stringliteral}{'and decoder. '}
259             \textcolor{stringliteral}{'Dec\_out shares decoder embedding and output '}
260             \textcolor{stringliteral}{'weights. '}
261             \textcolor{stringliteral}{'All shares all three weights.'},
262         )
263         agent.add\_argument(
264             \textcolor{stringliteral}{'-opt'},
265             \textcolor{stringliteral}{'--optimizer'},
266             default=\textcolor{stringliteral}{'sgd'},
267             choices=Seq2seqAgent.OPTIM\_OPTS.keys(),
268             help=\textcolor{stringliteral}{'Choose between pytorch optimizers. '}
269             \textcolor{stringliteral}{'Any member of torch.optim is valid and will '}
270             \textcolor{stringliteral}{'be used with default params except learning '}
271             \textcolor{stringliteral}{'rate (as specified by -lr).'},
272         )
273         agent.add\_argument(
274             \textcolor{stringliteral}{'-mom'},
275             \textcolor{stringliteral}{'--momentum'},
276             default=-1,
277             type=float,
278             help=\textcolor{stringliteral}{'if applicable, momentum value for optimizer. '}
279             \textcolor{stringliteral}{'if > 0, sgd uses nesterov momentum.'},
280         )
281         agent.add\_argument(
282             \textcolor{stringliteral}{'-emb'},
283             \textcolor{stringliteral}{'--embedding-type'},
284             default=\textcolor{stringliteral}{'random'},
285             choices=[
286                 \textcolor{stringliteral}{'random'},
287                 \textcolor{stringliteral}{'glove'},
288                 \textcolor{stringliteral}{'glove-fixed'},
289                 \textcolor{stringliteral}{'fasttext'},
290                 \textcolor{stringliteral}{'fasttext-fixed'},
291                 \textcolor{stringliteral}{'glove-twitter'},
292             ],
293             help=\textcolor{stringliteral}{'Choose between different strategies '}
294             \textcolor{stringliteral}{'for word embeddings. Default is random, '}
295             \textcolor{stringliteral}{'but can also preinitialize from Glove or '}
296             \textcolor{stringliteral}{'Fasttext.'}
297             \textcolor{stringliteral}{'Preinitialized embeddings can also be fixed '}
298             \textcolor{stringliteral}{'so they are not updated during training.'},
299         )
300         agent.add\_argument(
301             \textcolor{stringliteral}{'-soft'},
302             \textcolor{stringliteral}{'--numsoftmax'},
303             default=1,
304             type=int,
305             help=\textcolor{stringliteral}{'default 1, if greater then uses mixture of '}
306             \textcolor{stringliteral}{'softmax (see arxiv.org/abs/1711.03953).'},
307         )
308         agent.add\_argument(
309             \textcolor{stringliteral}{'-rf'},
310             \textcolor{stringliteral}{'--report-freq'},
311             type=float,
312             default=0.001,
313             help=\textcolor{stringliteral}{'Report frequency of prediction during eval.'},
314         )
315         agent.add\_argument(
316             \textcolor{stringliteral}{'-histr'},
317             \textcolor{stringliteral}{'--history-replies'},
318             default=\textcolor{stringliteral}{'label\_else\_model'},
319             type=str,
320             choices=[\textcolor{stringliteral}{'none'}, \textcolor{stringliteral}{'model'}, \textcolor{stringliteral}{'label'}, \textcolor{stringliteral}{'label\_else\_model'}],
321             help=\textcolor{stringliteral}{'Keep replies in the history, or not.'},
322         )
323         agent.add\_argument(
324             \textcolor{stringliteral}{'-pt'},
325             \textcolor{stringliteral}{'--person-tokens'},
326             type=\textcolor{stringliteral}{'bool'},
327             default=\textcolor{keyword}{False},
328             help=\textcolor{stringliteral}{'use special tokens before each speaker'},
329         )
330         agent.add\_argument(
331             \textcolor{stringliteral}{'--beam-size'},
332             type=int,
333             default=1,
334             help=\textcolor{stringliteral}{'Beam size, if 1 then greedy search'},
335         )
336         agent.add\_argument(
337             \textcolor{stringliteral}{'--beam-log-freq'},
338             type=float,
339             default=0.0,
340             help=\textcolor{stringliteral}{'The portion of beams to dump from minibatch into model\_name.beam\_dump folder'},
341         )
342         agent.add\_argument(
343             \textcolor{stringliteral}{'--topk'},
344             type=int,
345             default=1,
346             help=\textcolor{stringliteral}{'Top k sampling from renormalized softmax in test/valid time, default 1 means simple
       greedy max output'},
347         )
348         agent.add\_argument(
349             \textcolor{stringliteral}{'--softmax-layer-bias'},
350             type=\textcolor{stringliteral}{'bool'},
351             default=\textcolor{keyword}{False},
352             help=\textcolor{stringliteral}{'Put True if you want to include the bias in decoder.e2s layer'},
353         )
354         Seq2seqAgent.dictionary\_class().\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser)
355         \textcolor{keywordflow}{return} agent
356 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4ae534e440fd57603bc9b6e7c08b1c57}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4ae534e440fd57603bc9b6e7c08b1c57}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!batch\+\_\+act@{batch\+\_\+act}}
\index{batch\+\_\+act@{batch\+\_\+act}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+act()}{batch\_act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+batch\+\_\+act (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}



Definition at line 872 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
872     \textcolor{keyword}{def }batch\_act(self, observations):
873         batchsize = len(observations)
874         self.init\_cuda\_buffer(batchsize)
875         \textcolor{comment}{# initialize a table of replies with this agent's id}
876         batch\_reply = [\{\textcolor{stringliteral}{'id'}: self.getID()\} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
877 
878         \textcolor{comment}{# convert the observations into batches of inputs and targets}
879         \textcolor{comment}{# valid\_inds tells us the indices of all valid examples}
880         \textcolor{comment}{# e.g. for input [\{\}, \{'text': 'hello'\}, \{\}, \{\}], valid\_inds is [1]}
881         \textcolor{comment}{# since the other three elements had no 'text' field}
882         xs, ys, labels, valid\_inds, cands, valid\_cands, is\_training = self.vectorize(
883             observations
884         )
885 
886         \textcolor{keywordflow}{if} xs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
887             \textcolor{comment}{# no valid examples, just return empty responses}
888             \textcolor{keywordflow}{return} batch\_reply
889 
890         \textcolor{comment}{# produce predictions, train on targets if availables}
891         cand\_inds = [i[0] \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} valid\_cands] \textcolor{keywordflow}{if} valid\_cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} \textcolor{keywordtype}{None}
892         predictions, cand\_preds = self.predict(xs, ys, cands, cand\_inds, is\_training)
893 
894         \textcolor{keywordflow}{if} is\_training:
895             report\_freq = 0
896         \textcolor{keywordflow}{else}:
897             report\_freq = self.report\_freq
898         \textcolor{keywordflow}{if} predictions \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
899             PaddingUtils.map\_predictions(
900                 predictions,
901                 valid\_inds,
902                 batch\_reply,
903                 observations,
904                 self.dict,
905                 self.END\_IDX,
906                 report\_freq=report\_freq,
907                 labels=labels,
908                 answers=self.answers,
909                 ys=ys.data \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} \textcolor{keywordtype}{None},
910             )
911 
912         \textcolor{keywordflow}{if} cand\_preds \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
913             \textcolor{keywordflow}{if} valid\_cands \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
914                 valid\_cands = [(\textcolor{keywordtype}{None}, i, labels) \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} valid\_inds]
915             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(valid\_cands)):
916                 order = cand\_preds[i]
917                 \_, batch\_idx, curr\_cands = valid\_cands[i]
918                 curr = batch\_reply[batch\_idx]
919                 curr[\textcolor{stringliteral}{'text\_candidates'}] = [
920                     curr\_cands[idx] \textcolor{keywordflow}{for} idx \textcolor{keywordflow}{in} order \textcolor{keywordflow}{if} idx < len(curr\_cands)
921                 ]
922 
923         \textcolor{keywordflow}{return} batch\_reply
924 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a05552a2714cd8d15d754a62258727c98}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a05552a2714cd8d15d754a62258727c98}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!dictionary\+\_\+class@{dictionary\+\_\+class}}
\index{dictionary\+\_\+class@{dictionary\+\_\+class}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{dictionary\+\_\+class()}{dictionary\_class()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+dictionary\+\_\+class (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 127 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
127     \textcolor{keyword}{def }dictionary\_class():
128         \textcolor{keywordflow}{return} DictionaryAgent
129 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a9326d8ed88999a992b8ec73313c70a36}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a9326d8ed88999a992b8ec73313c70a36}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!init\+\_\+cuda\+\_\+buffer@{init\+\_\+cuda\+\_\+buffer}}
\index{init\+\_\+cuda\+\_\+buffer@{init\+\_\+cuda\+\_\+buffer}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{init\+\_\+cuda\+\_\+buffer()}{init\_cuda\_buffer()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+init\+\_\+cuda\+\_\+buffer (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{batchsize }\end{DoxyParamCaption})}



Definition at line 851 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
851     \textcolor{keyword}{def }init\_cuda\_buffer(self, batchsize):
852         \textcolor{keywordflow}{if} self.use\_cuda \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} hasattr(self, \textcolor{stringliteral}{'buffer\_initialized'}):
853             \textcolor{keywordflow}{try}:
854                 print(\textcolor{stringliteral}{'preinitializing pytorch cuda buffer'})
855                 bsz = self.opt.get(\textcolor{stringliteral}{'batchsize'}, batchsize)
856                 maxlen = self.truncate \textcolor{keywordflow}{or} 180
857                 dummy = torch.ones(bsz, maxlen).long().cuda()
858                 sc = self.model(dummy, dummy)[1]
859                 loss = self.criterion(sc.view(-1, sc.size(-1)), dummy.view(-1))
860                 loss.backward()
861                 self.buffer\_initialized = \textcolor{keyword}{True}
862             \textcolor{keywordflow}{except} RuntimeError \textcolor{keyword}{as} e:
863                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'out of memory'} \textcolor{keywordflow}{in} \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(e):
864                     m = (
865                         \textcolor{stringliteral}{'CUDA OOM: Lower batch size (-bs) from \{\} or lower max'}
866                         \textcolor{stringliteral}{' sequence length (-tr) from \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(bsz, maxlen)
867                     )
868                     \textcolor{keywordflow}{raise} RuntimeError(m)
869                 \textcolor{keywordflow}{else}:
870                     \textcolor{keywordflow}{raise} e
871 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a2aabe1e56b7b94f46875ae7f704f681f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a2aabe1e56b7b94f46875ae7f704f681f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!load@{load}}
\index{load@{load}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return opt and model states.
\end{DoxyVerb}
 

Definition at line 958 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
958     \textcolor{keyword}{def }load(self, path):
959         \textcolor{stringliteral}{"""}
960 \textcolor{stringliteral}{        Return opt and model states.}
961 \textcolor{stringliteral}{        """}
962         states = torch.load(path, map\_location=\textcolor{keyword}{lambda} cpu, \_: cpu)
963         \textcolor{keywordflow}{return} states
964 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8419a9652b14a16cedff86206a7bb613}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8419a9652b14a16cedff86206a7bb613}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!observe@{observe}}
\index{observe@{observe}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save observation for act.

If multiple observations are from the same episode, concatenate them.
\end{DoxyVerb}
 

Definition at line 709 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
709     \textcolor{keyword}{def }observe(self, observation):
710         \textcolor{stringliteral}{"""}
711 \textcolor{stringliteral}{        Save observation for act.}
712 \textcolor{stringliteral}{}
713 \textcolor{stringliteral}{        If multiple observations are from the same episode, concatenate them.}
714 \textcolor{stringliteral}{        """}
715         \textcolor{comment}{# shallow copy observation (deep copy can be expensive)}
716         obs = observation.copy()
717 
718         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} obs.get(\textcolor{stringliteral}{'preprocessed'}, \textcolor{keyword}{False}) \textcolor{keywordflow}{or} \textcolor{stringliteral}{'text2vec'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} obs:
719             obs[\textcolor{stringliteral}{'text2vec'}] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_ac7cb3ffae208474d6e67f37ecfe07f64}{maintain\_dialog\_history}(
720                 self.history,
721                 obs,
722                 reply=self.answers[self.batch\_idx],
723                 historyLength=self.truncate,
724                 useReplies=self.opt.get(\textcolor{stringliteral}{'history\_replies'}),
725                 dict=self.dict,
726                 useStartEndIndices=self.use\_person\_tokens,
727             )
728         \textcolor{keywordflow}{else}:
729             obs[\textcolor{stringliteral}{'text2vec'}] = deque(obs[\textcolor{stringliteral}{'text2vec'}], maxlen=self.truncate)
730         self.observation = obs
731         self.answers[self.batch\_idx] = \textcolor{keywordtype}{None}
732         \textcolor{keywordflow}{return} obs
733 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad40d38a1cc2cafe32c43477740b4a164}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad40d38a1cc2cafe32c43477740b4a164}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!override\+\_\+opt@{override\+\_\+opt}}
\index{override\+\_\+opt@{override\+\_\+opt}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{override\+\_\+opt()}{override\_opt()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+override\+\_\+opt (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{new\+\_\+opt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Set overridable opts from loaded opt file.

Print out each added key and each overriden key. Only override args specific to
the model.
\end{DoxyVerb}
 

Definition at line 571 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
571     \textcolor{keyword}{def }override\_opt(self, new\_opt):
572         \textcolor{stringliteral}{"""}
573 \textcolor{stringliteral}{        Set overridable opts from loaded opt file.}
574 \textcolor{stringliteral}{}
575 \textcolor{stringliteral}{        Print out each added key and each overriden key. Only override args specific to}
576 \textcolor{stringliteral}{        the model.}
577 \textcolor{stringliteral}{        """}
578         model\_args = \{
579             \textcolor{stringliteral}{'hiddensize'},
580             \textcolor{stringliteral}{'embeddingsize'},
581             \textcolor{stringliteral}{'numlayers'},
582             \textcolor{stringliteral}{'optimizer'},
583             \textcolor{stringliteral}{'encoder'},
584             \textcolor{stringliteral}{'decoder'},
585             \textcolor{stringliteral}{'lookuptable'},
586             \textcolor{stringliteral}{'attention'},
587             \textcolor{stringliteral}{'attention\_length'},
588             \textcolor{stringliteral}{'rnn\_class'},
589         \}
590         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} new\_opt.items():
591             \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} model\_args:
592                 \textcolor{comment}{# skip non-model args}
593                 \textcolor{keywordflow}{continue}
594             \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.opt:
595                 print(\textcolor{stringliteral}{'[ Adding new option: | \{k\}: \{v\} | ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(k=k, v=v))
596             \textcolor{keywordflow}{elif} self.opt[k] != v:
597                 print(
598                     \textcolor{stringliteral}{'[ Overriding option: | \{k\}: \{old\} => \{v\} | ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
599                         k=k, old=self.opt[k], v=v
600                     )
601                 )
602             self.opt[k] = v
603         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'dict\_file'} \textcolor{keywordflow}{in} new\_opt \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} self.opt.get(\textcolor{stringliteral}{'dict\_file'}):
604             print(
605                 \textcolor{stringliteral}{'[ No dictionary path detected, trying to load previous '}
606                 \textcolor{stringliteral}{'path \{\} ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(new\_opt[\textcolor{stringliteral}{'dict\_file'}])
607             )
608             self.opt[\textcolor{stringliteral}{'dict\_file'}] = new\_opt[\textcolor{stringliteral}{'dict\_file'}]
609         \textcolor{keywordflow}{return} self.opt
610 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a073830870e283f88ee45a95c0ae8ad2f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a073830870e283f88ee45a95c0ae8ad2f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!parse@{parse}}
\index{parse@{parse}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{parse()}{parse()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+parse (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{text }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert string to token indices.
\end{DoxyVerb}
 

Definition at line 611 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
611     \textcolor{keyword}{def }parse(self, text):
612         \textcolor{stringliteral}{"""}
613 \textcolor{stringliteral}{        Convert string to token indices.}
614 \textcolor{stringliteral}{        """}
615         \textcolor{keywordflow}{return} self.dict.txt2vec(text)
616 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_aadec879f7d8daa6451076e4fb358715b}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_aadec879f7d8daa6451076e4fb358715b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!predict@{predict}}
\index{predict@{predict}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{predict()}{predict()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+predict (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{xs,  }\item[{}]{ys = {\ttfamily None},  }\item[{}]{cands = {\ttfamily None},  }\item[{}]{valid\+\_\+cands = {\ttfamily None},  }\item[{}]{is\+\_\+training = {\ttfamily False} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Produce a prediction from our model.

Update the model using the targets if available, otherwise rank candidates as
well if they are available and param is set.
\end{DoxyVerb}
 

Definition at line 734 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
734     \textcolor{keyword}{def }predict(self, xs, ys=None, cands=None, valid\_cands=None, is\_training=False):
735         \textcolor{stringliteral}{"""}
736 \textcolor{stringliteral}{        Produce a prediction from our model.}
737 \textcolor{stringliteral}{}
738 \textcolor{stringliteral}{        Update the model using the targets if available, otherwise rank candidates as}
739 \textcolor{stringliteral}{        well if they are available and param is set.}
740 \textcolor{stringliteral}{        """}
741         predictions, cand\_preds = \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}
742         \textcolor{keywordflow}{if} is\_training:
743             self.model.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}()
744             self.zero\_grad()
745             out = \textcolor{keywordtype}{None}
746             \textcolor{keywordflow}{try}:
747                 out = self.model(xs, ys, rank\_during\_training=cands \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None})
748                 \textcolor{comment}{# generated response}
749                 \_preds, scores, cand\_preds = out[0], out[1], out[2]
750 
751                 score\_view = scores.view(-1, scores.size(-1))
752                 loss = self.criterion(score\_view, ys.view(-1))
753                 \textcolor{comment}{# save loss to metrics}
754                 y\_ne = ys.ne(self.NULL\_IDX)
755                 target\_tokens = y\_ne.long().sum().item()
756                 correct = ((ys == \_preds) * y\_ne).sum().item()
757                 self.metrics[\textcolor{stringliteral}{'correct\_tokens'}] += correct
758                 self.metrics[\textcolor{stringliteral}{'loss'}] += loss.item()
759                 self.metrics[\textcolor{stringliteral}{'num\_tokens'}] += target\_tokens
760                 loss /= target\_tokens  \textcolor{comment}{# average loss per token}
761                 loss.backward()
762             \textcolor{keywordflow}{except} RuntimeError \textcolor{keyword}{as} e:
763                 \textcolor{comment}{# catch out of memory exceptions during fwd/bck (skip batch)}
764                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'out of memory'} \textcolor{keywordflow}{in} \hyperlink{namespacegenerate__task__READMEs_a5b88452ffb87b78c8c85ececebafc09f}{str}(e):
765                     print(
766                         \textcolor{stringliteral}{'| WARNING: ran out of memory, skipping batch. '}
767                         \textcolor{stringliteral}{'if this happens frequently, decrease batchsize or '}
768                         \textcolor{stringliteral}{'truncate the inputs to the model.'}
769                     )
770                     self.metrics[\textcolor{stringliteral}{'total\_skipped\_batches'}] += 1
771                     \textcolor{keywordflow}{return} predictions, cand\_preds
772                 \textcolor{keywordflow}{else}:
773                     \textcolor{keywordflow}{raise} e
774             self.update\_params()
775         \textcolor{keywordflow}{else}:
776             self.model.eval()
777             out = self.model(
778                 xs,
779                 ys=\textcolor{keywordtype}{None},
780                 cands=cands,
781                 valid\_cands=valid\_cands,
782                 beam\_size=self.beam\_size,
783                 topk=self.topk,
784             )
785             predictions, cand\_preds = out[0], out[2]
786 
787             \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
788                 \textcolor{comment}{# calculate loss on targets}
789                 out = self.model(xs, ys)
790                 scores = out[1]
791                 score\_view = scores.view(-1, scores.size(-1))
792                 loss = self.criterion(score\_view, ys.view(-1))
793                 \textcolor{comment}{# save loss to metrics}
794                 target\_tokens = ys.ne(self.NULL\_IDX).long().sum().item()
795                 self.metrics[\textcolor{stringliteral}{'loss'}] += loss.item()
796                 self.metrics[\textcolor{stringliteral}{'num\_tokens'}] += target\_tokens
797 
798         \textcolor{keywordflow}{return} predictions, cand\_preds
799 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a584d45d729817694d615d2d545532af2}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a584d45d729817694d615d2d545532af2}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!receive\+\_\+metrics@{receive\+\_\+metrics}}
\index{receive\+\_\+metrics@{receive\+\_\+metrics}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{receive\+\_\+metrics()}{receive\_metrics()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+receive\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{metrics\+\_\+dict }\end{DoxyParamCaption})}

\begin{DoxyVerb}Use the metrics to decide when to adjust LR schedule.
\end{DoxyVerb}
 

Definition at line 965 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
965     \textcolor{keyword}{def }receive\_metrics(self, metrics\_dict):
966         \textcolor{stringliteral}{"""}
967 \textcolor{stringliteral}{        Use the metrics to decide when to adjust LR schedule.}
968 \textcolor{stringliteral}{        """}
969         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'loss'} \textcolor{keywordflow}{in} metrics\_dict:
970             self.scheduler.step(metrics\_dict[\textcolor{stringliteral}{'loss'}])
971 
972 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a83a444ecb418dfb4381147f23653dd7b}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a83a444ecb418dfb4381147f23653dd7b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!report@{report}}
\index{report@{report}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{report()}{report()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+report (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Report loss and perplexity from model's perspective.

Note that this includes predicting __END__ and __UNK__ tokens and may differ
from a truly independent measurement.
\end{DoxyVerb}
 

Definition at line 661 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
661     \textcolor{keyword}{def }\hyperlink{namespaceprojects_1_1convai2_1_1eval__f1_a01a47b9c08dad189837a51f085defc45}{report}(self):
662         \textcolor{stringliteral}{"""}
663 \textcolor{stringliteral}{        Report loss and perplexity from model's perspective.}
664 \textcolor{stringliteral}{}
665 \textcolor{stringliteral}{        Note that this includes predicting \_\_END\_\_ and \_\_UNK\_\_ tokens and may differ}
666 \textcolor{stringliteral}{        from a truly independent measurement.}
667 \textcolor{stringliteral}{        """}
668         m = \{\}
669         num\_tok = self.metrics[\textcolor{stringliteral}{'num\_tokens'}]
670         \textcolor{keywordflow}{if} num\_tok > 0:
671             \textcolor{keywordflow}{if} self.metrics[\textcolor{stringliteral}{'correct\_tokens'}] > 0:
672                 m[\textcolor{stringliteral}{'token\_acc'}] = self.metrics[\textcolor{stringliteral}{'correct\_tokens'}] / num\_tok
673             m[\textcolor{stringliteral}{'loss'}] = self.metrics[\textcolor{stringliteral}{'loss'}] / num\_tok
674             \textcolor{keywordflow}{try}:
675                 m[\textcolor{stringliteral}{'ppl'}] = math.exp(m[\textcolor{stringliteral}{'loss'}])
676             \textcolor{keywordflow}{except} OverflowError:
677                 m[\textcolor{stringliteral}{'ppl'}] = \hyperlink{namespaceprojects_1_1controllable__dialogue_1_1make__control__dataset_aa2b7207688c641dbc094ab44eca27113}{float}(\textcolor{stringliteral}{'inf'})
678         \textcolor{keywordflow}{if} self.metrics[\textcolor{stringliteral}{'total\_skipped\_batches'}] > 0:
679             m[\textcolor{stringliteral}{'total\_skipped\_batches'}] = self.metrics[\textcolor{stringliteral}{'total\_skipped\_batches'}]
680         \textcolor{keywordflow}{for} k, v \textcolor{keywordflow}{in} m.items():
681             \textcolor{comment}{# clean up: rounds to sigfigs and converts tensors to floats}
682             m[k] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_af377ec61bfc0423461e7b409ffc883b9}{round\_sigfigs}(v, 4)
683         \textcolor{keywordflow}{return} m
684 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a56d246fd8b6bcf41726181c17cdc2762}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a56d246fd8b6bcf41726181c17cdc2762}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!reset@{reset}}
\index{reset@{reset}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset observation and episode_done.
\end{DoxyVerb}
 

Definition at line 643 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
643     \textcolor{keyword}{def }reset(self):
644         \textcolor{stringliteral}{"""}
645 \textcolor{stringliteral}{        Reset observation and episode\_done.}
646 \textcolor{stringliteral}{        """}
647         self.observation = \textcolor{keywordtype}{None}
648         self.history.clear()
649         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(self.answers)):
650             self.answers[i] = \textcolor{keywordtype}{None}
651         self.reset\_metrics()
652 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae76435bf7acee9501188de47c0ba6991}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae76435bf7acee9501188de47c0ba6991}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!reset\+\_\+metrics@{reset\+\_\+metrics}}
\index{reset\+\_\+metrics@{reset\+\_\+metrics}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{reset\+\_\+metrics()}{reset\_metrics()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+reset\+\_\+metrics (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Reset metrics for reporting loss and perplexity.
\end{DoxyVerb}
 

Definition at line 653 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
653     \textcolor{keyword}{def }reset\_metrics(self):
654         \textcolor{stringliteral}{"""}
655 \textcolor{stringliteral}{        Reset metrics for reporting loss and perplexity.}
656 \textcolor{stringliteral}{        """}
657         self.metrics[\textcolor{stringliteral}{'loss'}] = 0.0
658         self.metrics[\textcolor{stringliteral}{'num\_tokens'}] = 0
659         self.metrics[\textcolor{stringliteral}{'correct\_tokens'}] = 0
660 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a31c017cd07b01834a5d467fadfddd7cd}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a31c017cd07b01834a5d467fadfddd7cd}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!save@{save}}
\index{save@{save}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save model parameters if model_file is set.
\end{DoxyVerb}
 

Definition at line 929 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
929     \textcolor{keyword}{def }save(self, path=None):
930         \textcolor{stringliteral}{"""}
931 \textcolor{stringliteral}{        Save model parameters if model\_file is set.}
932 \textcolor{stringliteral}{        """}
933         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} path
934 
935         \textcolor{keywordflow}{if} path \textcolor{keywordflow}{and} hasattr(self, \textcolor{stringliteral}{'model'}):
936             model = \{\}
937             model[\textcolor{stringliteral}{'model'}] = self.model.state\_dict()
938             model[\textcolor{stringliteral}{'longest\_label'}] = self.model.longest\_label
939             model[\textcolor{stringliteral}{'optimizer'}] = self.optimizer.state\_dict()
940             model[\textcolor{stringliteral}{'optimizer\_type'}] = self.opt[\textcolor{stringliteral}{'optimizer'}]
941 
942             with open(path, \textcolor{stringliteral}{'wb'}) \textcolor{keyword}{as} write:
943                 torch.save(model, write)
944 
945             \textcolor{comment}{# save opt file}
946             with open(path + \textcolor{stringliteral}{".opt"}, \textcolor{stringliteral}{'wb'}) \textcolor{keyword}{as} handle:
947                 pickle.dump(self.opt, handle, protocol=pickle.HIGHEST\_PROTOCOL)
948 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac050147b69c47182730e92866f64156a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac050147b69c47182730e92866f64156a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!share@{share}}
\index{share@{share}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Share internal states between parent and child instances.
\end{DoxyVerb}
 

Definition at line 685 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
685     \textcolor{keyword}{def }share(self):
686         \textcolor{stringliteral}{"""}
687 \textcolor{stringliteral}{        Share internal states between parent and child instances.}
688 \textcolor{stringliteral}{        """}
689         shared = super().share()
690         shared[\textcolor{stringliteral}{'opt'}] = self.opt
691         shared[\textcolor{stringliteral}{'answers'}] = self.answers
692         shared[\textcolor{stringliteral}{'dict'}] = self.dict
693         shared[\textcolor{stringliteral}{'START\_IDX'}] = self.START\_IDX
694         shared[\textcolor{stringliteral}{'END\_IDX'}] = self.END\_IDX
695         shared[\textcolor{stringliteral}{'NULL\_IDX'}] = self.NULL\_IDX
696         shared[\textcolor{stringliteral}{'model'}] = self.model
697         \textcolor{keywordflow}{if} self.opt.get(\textcolor{stringliteral}{'numthreads'}, 1) > 1:
698             \textcolor{comment}{# we're doing hogwild so share the model too}
699             \textcolor{keywordflow}{if} \hyperlink{namespaceparlai_1_1agents_1_1tfidf__retriever_1_1build__tfidf_ad5dfae268e23f506da084a9efb72f619}{type}(self.metrics) == dict:
700                 \textcolor{comment}{# move metrics and model to shared memory}
701                 self.metrics = SharedTable(self.metrics)
702                 self.model.share\_memory()
703             shared[\textcolor{stringliteral}{'states'}] = \{  \textcolor{comment}{# don't share optimizer states}
704                 \textcolor{stringliteral}{'optimizer\_type'}: self.opt[\textcolor{stringliteral}{'optimizer'}]
705             \}
706         shared[\textcolor{stringliteral}{'metrics'}] = self.metrics  \textcolor{comment}{# do after numthreads check}
707         \textcolor{keywordflow}{return} shared
708 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a86c41e705170f0b2e56a5bbc378aead9}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a86c41e705170f0b2e56a5bbc378aead9}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{shutdown()}{shutdown()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+shutdown (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save the state of the model when shutdown.
\end{DoxyVerb}
 

Definition at line 949 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
949     \textcolor{keyword}{def }shutdown(self):
950         \textcolor{stringliteral}{"""}
951 \textcolor{stringliteral}{        Save the state of the model when shutdown.}
952 \textcolor{stringliteral}{        """}
953         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None})
954         \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} hasattr(self, \textcolor{stringliteral}{'optimizer'}):
955             self.save(path + \textcolor{stringliteral}{'.shutdown\_state'})
956         super().shutdown()
957 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a3933d4fdc5e603b1a168d92e7da77151}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a3933d4fdc5e603b1a168d92e7da77151}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!update\+\_\+params@{update\+\_\+params}}
\index{update\+\_\+params@{update\+\_\+params}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{update\+\_\+params()}{update\_params()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+update\+\_\+params (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Do one optimization step.
\end{DoxyVerb}
 

Definition at line 635 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
635     \textcolor{keyword}{def }update\_params(self):
636         \textcolor{stringliteral}{"""}
637 \textcolor{stringliteral}{        Do one optimization step.}
638 \textcolor{stringliteral}{        """}
639         \textcolor{keywordflow}{if} self.clip > 0:
640             torch.nn.utils.clip\_grad\_norm\_(self.model.parameters(), self.clip)
641         self.optimizer.step()
642 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8f6de929b475d3915c159c48165b4575}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8f6de929b475d3915c159c48165b4575}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!v2t@{v2t}}
\index{v2t@{v2t}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{v2t()}{v2t()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+v2t (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{vec }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert token indices to string of tokens.
\end{DoxyVerb}
 

Definition at line 617 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
617     \textcolor{keyword}{def }v2t(self, vec):
618         \textcolor{stringliteral}{"""}
619 \textcolor{stringliteral}{        Convert token indices to string of tokens.}
620 \textcolor{stringliteral}{        """}
621         new\_vec = []
622         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} vec:
623             \textcolor{keywordflow}{if} i == self.END\_IDX:
624                 \textcolor{keywordflow}{break}
625             \textcolor{keywordflow}{elif} i != self.START\_IDX:
626                 new\_vec.append(i)
627         \textcolor{keywordflow}{return} self.dict.vec2txt(new\_vec)
628 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a83e2433e00bff6162ebad3b818771b59}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a83e2433e00bff6162ebad3b818771b59}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!vectorize@{vectorize}}
\index{vectorize@{vectorize}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{vectorize()}{vectorize()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+vectorize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}

\begin{DoxyVerb}Convert a list of observations into input & target tensors.
\end{DoxyVerb}
 

Definition at line 800 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
800     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_a5c76cc39e3014c7bcf9199d566dbdc0f}{vectorize}(self, observations):
801         \textcolor{stringliteral}{"""}
802 \textcolor{stringliteral}{        Convert a list of observations into input & target tensors.}
803 \textcolor{stringliteral}{        """}
804         is\_training = any([\textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} obs \textcolor{keywordflow}{for} obs \textcolor{keywordflow}{in} observations])
805         xs, ys, labels, valid\_inds, \_, \_ = PaddingUtils.pad\_text(
806             observations,
807             self.dict,
808             end\_idx=self.END\_IDX,
809             null\_idx=self.NULL\_IDX,
810             dq=\textcolor{keyword}{True},
811             eval\_labels=\textcolor{keyword}{True},
812             truncate=self.truncate,
813         )
814 
815         \textcolor{keywordflow}{if} xs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
816             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}
817         xs = torch.LongTensor(xs)
818         \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
819             ys = torch.LongTensor(ys)
820         \textcolor{keywordflow}{if} self.use\_cuda:
821             \textcolor{comment}{# copy to gpu}
822             xs = xs.cuda()
823             \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
824                 ys = ys.cuda()
825 
826         cands = \textcolor{keywordtype}{None}
827         valid\_cands = \textcolor{keywordtype}{None}
828         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} is\_training \textcolor{keywordflow}{and} self.rank:
829             \textcolor{comment}{# set up candidates}
830             cands = []
831             valid\_cands = []
832             \textcolor{keywordflow}{for} i, v \textcolor{keywordflow}{in} enumerate(valid\_inds):
833                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'label\_candidates'} \textcolor{keywordflow}{in} observations[v]:
834                     curr\_lcs = list(observations[v][\textcolor{stringliteral}{'label\_candidates'}])
835                     curr\_cands = [\{\textcolor{stringliteral}{'text'}: c\} \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} curr\_lcs]
836                     cs, \_, \_, valid\_c\_inds, *\_ = PaddingUtils.pad\_text(
837                         curr\_cands,
838                         self.dict,
839                         null\_idx=self.NULL\_IDX,
840                         dq=\textcolor{keyword}{True},
841                         truncate=self.truncate,
842                     )
843                     valid\_cands.append((i, v, [curr\_lcs[j] \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} valid\_c\_inds]))
844                     cs = torch.LongTensor(cs)
845                     \textcolor{keywordflow}{if} self.use\_cuda:
846                         cs = cs.cuda()
847                     cands.append(cs)
848 
849         \textcolor{keywordflow}{return} xs, ys, labels, valid\_inds, cands, valid\_cands, is\_training
850 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a0be9f1e378a403284d8afac5648fbf4d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a0be9f1e378a403284d8afac5648fbf4d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!zero\+\_\+grad@{zero\+\_\+grad}}
\index{zero\+\_\+grad@{zero\+\_\+grad}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{zero\+\_\+grad()}{zero\_grad()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+zero\+\_\+grad (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}

\begin{DoxyVerb}Zero out optimizer.
\end{DoxyVerb}
 

Definition at line 629 of file seq2seq\+\_\+v0.\+py.


\begin{DoxyCode}
629     \textcolor{keyword}{def }zero\_grad(self):
630         \textcolor{stringliteral}{"""}
631 \textcolor{stringliteral}{        Zero out optimizer.}
632 \textcolor{stringliteral}{        """}
633         self.optimizer.zero\_grad()
634 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad5d4bdcd877577596273c4af1eb4c70d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad5d4bdcd877577596273c4af1eb4c70d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!answers@{answers}}
\index{answers@{answers}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{answers}{answers}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+answers}



Definition at line 395 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a2f31501d3923b8fb080d147d23ab727b}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a2f31501d3923b8fb080d147d23ab727b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!batch\+\_\+idx@{batch\+\_\+idx}}
\index{batch\+\_\+idx@{batch\+\_\+idx}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+idx}{batch\_idx}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+batch\+\_\+idx}



Definition at line 375 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a215857d3ce2c7522c43728ab2879ce89}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a215857d3ce2c7522c43728ab2879ce89}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!beam\+\_\+size@{beam\+\_\+size}}
\index{beam\+\_\+size@{beam\+\_\+size}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{beam\+\_\+size}{beam\_size}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+beam\+\_\+size}



Definition at line 377 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a31e1353ee2c64ac03af2bc7854597f35}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a31e1353ee2c64ac03af2bc7854597f35}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!buffer\+\_\+initialized@{buffer\+\_\+initialized}}
\index{buffer\+\_\+initialized@{buffer\+\_\+initialized}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{buffer\+\_\+initialized}{buffer\_initialized}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+buffer\+\_\+initialized}



Definition at line 861 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4896d5dc3fd7a0f876a654f0bc942b6a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4896d5dc3fd7a0f876a654f0bc942b6a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!clip@{clip}}
\index{clip@{clip}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{clip}{clip}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+clip}



Definition at line 524 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad336994a64a83591ba1388aef3f1d5de}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad336994a64a83591ba1388aef3f1d5de}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!criterion@{criterion}}
\index{criterion@{criterion}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{criterion}{criterion}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+criterion}



Definition at line 512 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad5ff9534948d32ca9b387fe1189174e6}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ad5ff9534948d32ca9b387fe1189174e6}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!dict@{dict}}
\index{dict@{dict}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+dict}



Definition at line 390 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a46ebee256e0812f6cab77a71c02578e0}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a46ebee256e0812f6cab77a71c02578e0}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!E\+N\+D\+\_\+\+I\+DX@{E\+N\+D\+\_\+\+I\+DX}}
\index{E\+N\+D\+\_\+\+I\+DX@{E\+N\+D\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{E\+N\+D\+\_\+\+I\+DX}{END\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+E\+N\+D\+\_\+\+I\+DX}



Definition at line 392 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a11398edabc596559f45324d2d603b1e3}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a11398edabc596559f45324d2d603b1e3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!history@{history}}
\index{history@{history}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{history}{history}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+history}



Definition at line 372 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a616955265cd96254aae5b5958ac18159}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a616955265cd96254aae5b5958ac18159}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!id@{id}}
\index{id@{id}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+id}



Definition at line 427 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac50fcecc3b2ec89ece9bf75df8e21c6d}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac50fcecc3b2ec89ece9bf75df8e21c6d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!metrics@{metrics}}
\index{metrics@{metrics}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{metrics}{metrics}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+metrics}



Definition at line 366 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae6ef958bb58cc1597b23b0a6c6c49b3f}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ae6ef958bb58cc1597b23b0a6c6c49b3f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!model@{model}}
\index{model@{model}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+model}



Definition at line 396 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a203f77c92dd9f343cd7c5580756d5e5a}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a203f77c92dd9f343cd7c5580756d5e5a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!model\+\_\+class@{model\+\_\+class}}
\index{model\+\_\+class@{model\+\_\+class}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{model\+\_\+class}{model\_class}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+model\+\_\+class}



Definition at line 437 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8589f9403a5d358b1c58b467fc556680}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8589f9403a5d358b1c58b467fc556680}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}}
\index{N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{N\+U\+L\+L\+\_\+\+I\+DX}{NULL\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+N\+U\+L\+L\+\_\+\+I\+DX}



Definition at line 393 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4473b0e478d7928c2b59ab653c8334fb}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a4473b0e478d7928c2b59ab653c8334fb}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!observation@{observation}}
\index{observation@{observation}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+observation}



Definition at line 647 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8e4926c0c0da6bd7d530c44aa5416731}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a8e4926c0c0da6bd7d530c44aa5416731}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!opt@{opt}}
\index{opt@{opt}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+opt}



Definition at line 388 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a82630ee9be1d6e9828ffdd24049a8de3}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a82630ee9be1d6e9828ffdd24049a8de3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!O\+P\+T\+I\+M\+\_\+\+O\+P\+TS@{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}}
\index{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS@{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{O\+P\+T\+I\+M\+\_\+\+O\+P\+TS}{OPTIM\_OPTS}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+O\+P\+T\+I\+M\+\_\+\+O\+P\+TS\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 114 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac6a5cc3b1faaae160f5c10318a7afcfd}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac6a5cc3b1faaae160f5c10318a7afcfd}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!optimizer@{optimizer}}
\index{optimizer@{optimizer}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{optimizer}{optimizer}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+optimizer}



Definition at line 544 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a07995ff61edb2c4699aa766122878e94}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a07995ff61edb2c4699aa766122878e94}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!rank@{rank}}
\index{rank@{rank}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{rank}{rank}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+rank}



Definition at line 376 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a3f13aca25d825730f0dacbf50f48d7c6}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a3f13aca25d825730f0dacbf50f48d7c6}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!report\+\_\+freq@{report\+\_\+freq}}
\index{report\+\_\+freq@{report\+\_\+freq}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{report\+\_\+freq}{report\_freq}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+report\+\_\+freq}



Definition at line 373 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac8229fafe6c4b7d7ebedbd0f00b55eb0}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac8229fafe6c4b7d7ebedbd0f00b55eb0}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!scheduler@{scheduler}}
\index{scheduler@{scheduler}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{scheduler}{scheduler}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+scheduler}



Definition at line 565 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a044b5f18e6d9f0207b947769f06bcc6b}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a044b5f18e6d9f0207b947769f06bcc6b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!S\+T\+A\+R\+T\+\_\+\+I\+DX@{S\+T\+A\+R\+T\+\_\+\+I\+DX}}
\index{S\+T\+A\+R\+T\+\_\+\+I\+DX@{S\+T\+A\+R\+T\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{S\+T\+A\+R\+T\+\_\+\+I\+DX}{START\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+S\+T\+A\+R\+T\+\_\+\+I\+DX}



Definition at line 391 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac0b7a3b712fe92dbabee7f31972b8a47}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ac0b7a3b712fe92dbabee7f31972b8a47}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!topk@{topk}}
\index{topk@{topk}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{topk}{topk}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+topk}



Definition at line 378 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a7943d21acc4e6986e15678e7da1d2f27}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a7943d21acc4e6986e15678e7da1d2f27}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!truncate@{truncate}}
\index{truncate@{truncate}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{truncate}{truncate}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+truncate}



Definition at line 365 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ab81d3b0bd5474debb2f983d1b6220d5e}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_ab81d3b0bd5474debb2f983d1b6220d5e}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+use\+\_\+cuda}



Definition at line 382 of file seq2seq\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a227faa3994686ab266237ce9e11a2dc7}\label{classparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1seq2seq__v0_1_1Seq2seqAgent_a227faa3994686ab266237ce9e11a2dc7}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}!use\+\_\+person\+\_\+tokens@{use\+\_\+person\+\_\+tokens}}
\index{use\+\_\+person\+\_\+tokens@{use\+\_\+person\+\_\+tokens}!parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::seq2seq\+::seq2seq\+\_\+v0\+::\+Seq2seq\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+person\+\_\+tokens}{use\_person\_tokens}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+seq2seq.\+seq2seq\+\_\+v0.\+Seq2seq\+Agent.\+use\+\_\+person\+\_\+tokens}



Definition at line 374 of file seq2seq\+\_\+v0.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/seq2seq/\hyperlink{seq2seq__v0_8py}{seq2seq\+\_\+v0.\+py}\end{DoxyCompactItemize}
