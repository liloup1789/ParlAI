\hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas}{}\section{parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas Namespace Reference}
\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas}\index{parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas@{parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_ad456be8590e65dece8a4b1e57aacef65}{extract\+\_\+and\+\_\+save} (\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a4956ea1d7db767343948d06c207e3f14}{opt})
\item 
def \hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a3fadfe6571f33f89367defbb1d3907e0}{main} (\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a4956ea1d7db767343948d06c207e3f14}{opt})
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_aaa127ce985dc18ee3a5524edb87abc56}{parser}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_aca44d9fb7857f6ef1e2a6eea9913b88c}{default}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a9f4e1c30b2d1611ab4158001925e5cf7}{type}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a2def58d59437334ec072a3d644c0a577}{choices}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a0bb02874abe7194828166a1bd1b4a342}{help}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a09f827e9b1fb80665edee523230502f3}{False}
\item 
\hyperlink{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a4956ea1d7db767343948d06c207e3f14}{opt}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_ad456be8590e65dece8a4b1e57aacef65}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_ad456be8590e65dece8a4b1e57aacef65}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!extract\+\_\+and\+\_\+save@{extract\+\_\+and\+\_\+save}}
\index{extract\+\_\+and\+\_\+save@{extract\+\_\+and\+\_\+save}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{extract\+\_\+and\+\_\+save()}{extract\_and\_save()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+extract\+\_\+and\+\_\+save (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 13 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.


\begin{DoxyCode}
13 \textcolor{keyword}{def }\hyperlink{namespacepersonachat__eval_1_1extract__and__save__personas_a7bae99c34a0b3f49cbce1328146926fd}{extract\_and\_save}(opt):
14     agent = RepeatLabelAgent(opt)
15     world = \hyperlink{namespaceparlai_1_1core_1_1worlds_a79969c7ba76d4b3c500f5bb776444dc6}{create\_task}(opt, agent)
16     teacher = world.agents[0]
17 
18     personas\_path = opt.get(\textcolor{stringliteral}{'personas\_path'})
19     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(personas\_path):
20         os.makedirs(personas\_path)
21 
22     new\_episode = \textcolor{keyword}{True}
23     personas = []
24     \textcolor{keywordflow}{while} \textcolor{keywordflow}{not} teacher.epoch\_done():
25         act = teacher.act()
26         \textcolor{keywordflow}{if} new\_episode:
27             persona\_text = act[\textcolor{stringliteral}{'text'}].split(\textcolor{stringliteral}{'\(\backslash\)n'})[:-1]
28             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'persona\_type'}) == \textcolor{stringliteral}{'both'}:
29                 persona\_1 = [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} persona\_text \textcolor{keywordflow}{if} \textcolor{stringliteral}{'your persona:'} \textcolor{keywordflow}{in} p]
30                 persona\_2 = [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} persona\_text \textcolor{keywordflow}{if} \textcolor{stringliteral}{'partner\(\backslash\)'s persona:'} \textcolor{keywordflow}{in} p]
31                 persona\_1 = [p[p.find(\textcolor{stringliteral}{':'}) + 1 :] \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} persona\_1]
32                 persona\_2 = [p[p.find(\textcolor{stringliteral}{':'}) + 1 :] \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} persona\_2]
33                 personas += [persona\_1, persona\_2]
34             \textcolor{keywordflow}{else}:
35                 persona = [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} persona\_text \textcolor{keywordflow}{if} \textcolor{stringliteral}{'persona:'} \textcolor{keywordflow}{in} p]
36                 persona = [p[p.find(\textcolor{stringliteral}{':'}) + 1 :] \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} persona]
37                 personas.append(persona)
38             new\_episode = act.get(\textcolor{stringliteral}{'episode\_done'})
39         \textcolor{keywordflow}{else}:
40             new\_episode = act.get(\textcolor{stringliteral}{'episode\_done'})
41 
42     \textcolor{keywordflow}{for} idx, persona \textcolor{keywordflow}{in} enumerate(personas):
43         with open(\textcolor{stringliteral}{'\{\}/\{\}.pkl'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(personas\_path, idx), \textcolor{stringliteral}{'wb'}) \textcolor{keyword}{as} f:
44             pickle.dump(persona, f)
45     print(\textcolor{stringliteral}{'---Finished extracting and saving personas, to \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(personas\_path))
46 
47 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a3fadfe6571f33f89367defbb1d3907e0}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a3fadfe6571f33f89367defbb1d3907e0}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!main@{main}}
\index{main@{main}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+main (\begin{DoxyParamCaption}\item[{}]{opt }\end{DoxyParamCaption})}



Definition at line 48 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.


\begin{DoxyCode}
48 \textcolor{keyword}{def }\hyperlink{namespacepersonachat__eval_1_1extract__and__save__personas_aa39f496bc78dfa28c1fbc2c4129a915c}{main}(opt):
49     print(\textcolor{stringliteral}{'---Extracting and saving personas---'})
50     teacher\_name = \textcolor{stringliteral}{'personachat:\{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(opt.get(\textcolor{stringliteral}{'persona\_type'}))
51     teacher\_name += \textcolor{stringliteral}{'Revised'} \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'revised'}) \textcolor{keywordflow}{else} \textcolor{stringliteral}{'Original'}
52     opt[\textcolor{stringliteral}{'task'}] = teacher\_name
53     \textcolor{keyword}{assert} \textcolor{stringliteral}{'personas\_path'} \textcolor{keywordflow}{in} opt, \textcolor{stringliteral}{'Must specify personas path'}
54     opt[\textcolor{stringliteral}{'datatype'}] = \textcolor{stringliteral}{'train:ordered:stream'}
55     opt[\textcolor{stringliteral}{'numthreads'}] = 1
56     opt[\textcolor{stringliteral}{'batchsize'}] = 1
57     \hyperlink{namespacepersonachat__eval_1_1extract__and__save__personas_a7bae99c34a0b3f49cbce1328146926fd}{extract\_and\_save}(opt)
58 
59 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a2def58d59437334ec072a3d644c0a577}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a2def58d59437334ec072a3d644c0a577}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!choices@{choices}}
\index{choices@{choices}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{choices}{choices}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+choices}



Definition at line 66 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_aca44d9fb7857f6ef1e2a6eea9913b88c}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_aca44d9fb7857f6ef1e2a6eea9913b88c}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!default@{default}}
\index{default@{default}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{default}{default}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+default}



Definition at line 64 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a09f827e9b1fb80665edee523230502f3}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a09f827e9b1fb80665edee523230502f3}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!False@{False}}
\index{False@{False}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{False}{False}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+False}



Definition at line 70 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a0bb02874abe7194828166a1bd1b4a342}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a0bb02874abe7194828166a1bd1b4a342}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!help@{help}}
\index{help@{help}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{help}{help}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+help}



Definition at line 67 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a4956ea1d7db767343948d06c207e3f14}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a4956ea1d7db767343948d06c207e3f14}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!opt@{opt}}
\index{opt@{opt}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+opt}



Definition at line 72 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_aaa127ce985dc18ee3a5524edb87abc56}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_aaa127ce985dc18ee3a5524edb87abc56}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!parser@{parser}}
\index{parser@{parser}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+parser}



Definition at line 61 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a9f4e1c30b2d1611ab4158001925e5cf7}\label{namespaceparlai_1_1mturk_1_1tasks_1_1personachat_1_1personachat__chat_1_1extract__and__save__personas_a9f4e1c30b2d1611ab4158001925e5cf7}} 
\index{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}!type@{type}}
\index{type@{type}!parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas@{parlai\+::mturk\+::tasks\+::personachat\+::personachat\+\_\+chat\+::extract\+\_\+and\+\_\+save\+\_\+personas}}
\subsubsection{\texorpdfstring{type}{type}}
{\footnotesize\ttfamily parlai.\+mturk.\+tasks.\+personachat.\+personachat\+\_\+chat.\+extract\+\_\+and\+\_\+save\+\_\+personas.\+type}



Definition at line 65 of file extract\+\_\+and\+\_\+save\+\_\+personas.\+py.

