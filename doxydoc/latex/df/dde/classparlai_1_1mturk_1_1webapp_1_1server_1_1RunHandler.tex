\hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler}{}\section{parlai.\+mturk.\+webapp.\+server.\+Run\+Handler Class Reference}
\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler}\index{parlai.\+mturk.\+webapp.\+server.\+Run\+Handler@{parlai.\+mturk.\+webapp.\+server.\+Run\+Handler}}


Inheritance diagram for parlai.\+mturk.\+webapp.\+server.\+Run\+Handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{db/d08/classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+mturk.\+webapp.\+server.\+Run\+Handler\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=229pt]{dc/d3c/classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_abec3206f51ca4edd33ce201ef4131581}{initialize} (self, app)
\item 
def \hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_acf94dbda8676931e2ac205e2c8420b39}{get} (self, task\+\_\+target)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a8c691d0a32bac2c64f4cdf8861cfa3fa}{state}
\item 
\hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a3888f3782c09030eb6eed0bb3734b4c6}{subs}
\item 
\hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_af824a31f541d4421205f883d32ea87fe}{sources}
\item 
\hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a18313aaf7e807891e1d21b0930639ca9}{port}
\item 
\hyperlink{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a55ebe293c2c36001b28f879a256fb03d}{data\+\_\+handler}
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 296 of file server.\+py.



\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_acf94dbda8676931e2ac205e2c8420b39}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_acf94dbda8676931e2ac205e2c8420b39}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!get@{get}}
\index{get@{get}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{get()}{get()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+get (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{task\+\_\+target }\end{DoxyParamCaption})}



Definition at line 304 of file server.\+py.


\begin{DoxyCode}
304     \textcolor{keyword}{def }get(self, task\_target):
305         hits = self.data\_handler.get\_hits\_for\_run(task\_target)
306         processed\_hits = []
307         \textcolor{keywordflow}{for} res \textcolor{keywordflow}{in} hits:
308             processed\_hits.append(\hyperlink{namespaceparlai_1_1mturk_1_1webapp_1_1server_a92be47964fa33a4b6a14d4069d091c7d}{row\_to\_dict}(res))
309         assignments = self.data\_handler.get\_assignments\_for\_run(task\_target)
310         pairings = self.data\_handler.get\_pairings\_for\_run(task\_target)
311         processed\_assignments = \hyperlink{namespaceparlai_1_1mturk_1_1webapp_1_1server_abe6ddbf97d0e5c26315fa927ed076489}{merge\_assignments\_with\_pairings}(
312             assignments, pairings, \textcolor{stringliteral}{'task \{\}'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(task\_target)
313         )
314 
315         workers = set()
316         \textcolor{comment}{# get feedback data and put into assignments if present}
317         \textcolor{keywordflow}{for} assignment \textcolor{keywordflow}{in} processed\_assignments:
318             assignment[\textcolor{stringliteral}{'received\_feedback'}] = \textcolor{keywordtype}{None}
319             run\_id = assignment[\textcolor{stringliteral}{'run\_id'}]
320             conversation\_id = assignment[\textcolor{stringliteral}{'conversation\_id'}]
321             worker\_id = assignment[\textcolor{stringliteral}{'worker\_id'}]
322             workers.add(worker\_id)
323             \textcolor{keywordflow}{if} conversation\_id \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
324                 task\_data = MTurkDataHandler.get\_conversation\_data(
325                     run\_id, conversation\_id, worker\_id, self.state[\textcolor{stringliteral}{'is\_sandbox'}]
326                 )
327                 \textcolor{keywordflow}{if} task\_data[\textcolor{stringliteral}{'data'}] \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
328                     assignment[\textcolor{stringliteral}{'received\_feedback'}] = task\_data[\textcolor{stringliteral}{'data'}].get(
329                         \textcolor{stringliteral}{'received\_feedback'}
330                     )
331 
332         worker\_data = \{\}
333         \textcolor{keywordflow}{for} worker \textcolor{keywordflow}{in} workers:
334             worker\_data[worker] = \hyperlink{namespaceparlai_1_1mturk_1_1webapp_1_1server_a92be47964fa33a4b6a14d4069d091c7d}{row\_to\_dict}(self.data\_handler.get\_worker\_data(worker))
335 
336         run\_details = \hyperlink{namespaceparlai_1_1mturk_1_1webapp_1_1server_a92be47964fa33a4b6a14d4069d091c7d}{row\_to\_dict}(self.data\_handler.get\_run\_data(task\_target))
337         \textcolor{comment}{# TODO implement run status determination}
338         run\_details[\textcolor{stringliteral}{'run\_status'}] = \textcolor{stringliteral}{'unimplemented'}
339         data = \{
340             \textcolor{stringliteral}{'run\_details'}: run\_details,
341             \textcolor{stringliteral}{'worker\_details'}: worker\_data,
342             \textcolor{stringliteral}{'assignments'}: processed\_assignments,
343             \textcolor{stringliteral}{'hits'}: processed\_hits,
344         \}
345 
346         self.write(json.dumps(data))
347 
348 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_abec3206f51ca4edd33ce201ef4131581}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_abec3206f51ca4edd33ce201ef4131581}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!initialize@{initialize}}
\index{initialize@{initialize}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{initialize()}{initialize()}}
{\footnotesize\ttfamily def parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+initialize (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{app }\end{DoxyParamCaption})}



Definition at line 297 of file server.\+py.


\begin{DoxyCode}
297     \textcolor{keyword}{def }initialize(self, app):
298         self.state = app.state
299         self.subs = app.subs
300         self.sources = app.sources
301         self.port = app.port
302         self.data\_handler = app.data\_handler
303 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a55ebe293c2c36001b28f879a256fb03d}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a55ebe293c2c36001b28f879a256fb03d}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!data\+\_\+handler@{data\+\_\+handler}}
\index{data\+\_\+handler@{data\+\_\+handler}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{data\+\_\+handler}{data\_handler}}
{\footnotesize\ttfamily parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+data\+\_\+handler}



Definition at line 302 of file server.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a18313aaf7e807891e1d21b0930639ca9}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a18313aaf7e807891e1d21b0930639ca9}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!port@{port}}
\index{port@{port}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{port}{port}}
{\footnotesize\ttfamily parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+port}



Definition at line 301 of file server.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_af824a31f541d4421205f883d32ea87fe}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_af824a31f541d4421205f883d32ea87fe}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!sources@{sources}}
\index{sources@{sources}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{sources}{sources}}
{\footnotesize\ttfamily parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+sources}



Definition at line 300 of file server.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a8c691d0a32bac2c64f4cdf8861cfa3fa}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a8c691d0a32bac2c64f4cdf8861cfa3fa}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!state@{state}}
\index{state@{state}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{state}{state}}
{\footnotesize\ttfamily parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+state}



Definition at line 298 of file server.\+py.

\mbox{\Hypertarget{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a3888f3782c09030eb6eed0bb3734b4c6}\label{classparlai_1_1mturk_1_1webapp_1_1server_1_1RunHandler_a3888f3782c09030eb6eed0bb3734b4c6}} 
\index{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}!subs@{subs}}
\index{subs@{subs}!parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler@{parlai\+::mturk\+::webapp\+::server\+::\+Run\+Handler}}
\subsubsection{\texorpdfstring{subs}{subs}}
{\footnotesize\ttfamily parlai.\+mturk.\+webapp.\+server.\+Run\+Handler.\+subs}



Definition at line 299 of file server.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/mturk/webapp/\hyperlink{server_8py}{server.\+py}\end{DoxyCompactItemize}
