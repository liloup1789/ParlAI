\hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent}{}\section{parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent Class Reference}
\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent}\index{parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent@{parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent}}


Inheritance diagram for parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{d3/d02/classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=253pt]{dd/d7f/classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ac63a554810de551cf9c90d85fefa50d1}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae9e5ceae9adbc5b2e18dfc37da457e3a}{opt}, shared=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a64ae5911364ed06f2a72afe9859e6cdd}{share} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a0f8358dd299ba6719f7354771938fd7b}{observe} (self, \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afa839a741742c292916a7fce23c71a31}{observation})
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad365b2e33983158fbf7581d361a74246}{reset} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a4e850d51ca01adc45754cc509c8b096a}{predict} (self, xs, cands, ys=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a29485cab795b6c8abe0a61d9c6bb87fd}{score} (self, cands, output\+\_\+embeddings)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_aeca21a7823ef27e0f56ac7e420e2beca}{ranked\+\_\+predictions} (self, cands, scores)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae18c65a307c2a3c164beb6cf0bb5b62b}{decode} (self, output\+\_\+embeddings, ys=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a15b8b76a2d2ae5e0a4de2978e5ac0ac5}{generated\+\_\+predictions} (self, output\+\_\+lines)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a5e9b6393cb251b6030bb9a0db51b8026}{parse} (self, memory)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afaa379fa31bcc83bd467d15e2976d0a3}{batchify} (self, obs)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad73ed6e730b608491c2d8ef3ad25e32a}{batch\+\_\+act} (self, observations)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a7079216ce7367ba0ca3ac205daa516c4}{act} (self)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a20509f6931e68ff52e965d3e214c7b0a}{save} (self, path=None)
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a43e08459f9552c66ef389b8727b8eff3}{load} (self, path)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a3ca2bd7b5cbce5ebac978deeb2ce9e10}{add\+\_\+cmdline\+\_\+args} (argparser)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a478c07f1b6366123c71344ad1a4bb9c6}{use\+\_\+cuda}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a920f998926ca4466a6bd382ef7034499}{id}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae7f61afed6d1d95a36c490fb191e99aa}{dict}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afe8168370453275f9d89b10a0212029d}{answers}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a6ab848128ba532c6c72bea26f8256e4c}{model}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a0de6d8c7652909439a38f21616a7561c}{decoder}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae9e5ceae9adbc5b2e18dfc37da457e3a}{opt}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ab21b657cb95a7129d4e0586e537c84c2}{mem\+\_\+size}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a75eb3fc9ff074bd4b56b0a8897d37efc}{longest\+\_\+label}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a459e4d3cc000e2f2458153af7ec83bef}{N\+U\+LL}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a9934e51e2bbc8a76b8b6dd8325d809cb}{N\+U\+L\+L\+\_\+\+I\+DX}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ab4d3e5b627338f308b853d9a61aec2f0}{E\+ND}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a27d4c7bb83f643782984d9ff3306bf41}{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad47aab7437ba9ae08a1cd0637de02f27}{S\+T\+A\+RT}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a7a1ae5fdf464724f1c696ea71f4e2593}{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a438cc6b1bc8e6443220b6d25a332f627}{rank\+\_\+loss}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a1679d276474a4ab8baa4d368fdee8c8b}{gen\+\_\+loss}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a442f9e9a53de9c0e91953371e11a2b5d}{optimizers}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a86ebdb3ff6941cfb15945a9f3f198f83}{history}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a760f59a2f18c3132341cfc6737365c1f}{batch\+\_\+idx}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a19eee67f8834043130a277fa35bbffc5}{episode\+\_\+done}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_affeb8168155ac425e348c0ce599f1764}{last\+\_\+cands\+\_\+list}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afa839a741742c292916a7fce23c71a31}{observation}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a5d56f023807667a1e589833d3d5220df}{labels}
\item 
\hyperlink{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a2f76bf7b117ffc19e89b2b6168026063}{last\+\_\+cands}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Memory Network agent.
\end{DoxyVerb}
 

Definition at line 21 of file memnn\+\_\+v0.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ac63a554810de551cf9c90d85fefa50d1}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ac63a554810de551cf9c90d85fefa50d1}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{opt,  }\item[{}]{shared = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 97 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
97     \textcolor{keyword}{def }\_\_init\_\_(self, opt, shared=None):
98         self.use\_cuda = \textcolor{keywordflow}{not} opt[\textcolor{stringliteral}{'no\_cuda'}] \textcolor{keywordflow}{and} torch.cuda.is\_available()
99         \textcolor{keywordflow}{if} self.use\_cuda:
100             torch.cuda.device(opt[\textcolor{stringliteral}{'gpu'}])
101 
102         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} shared:
103             self.id = \textcolor{stringliteral}{'MemNN'}
104             self.dict = DictionaryAgent(opt)
105             self.answers = [\textcolor{keywordtype}{None}] * opt[\textcolor{stringliteral}{'batchsize'}]
106             self.model = MemNN(opt, len(self.dict), use\_cuda=self.use\_cuda)
107 
108             self.decoder = \textcolor{keywordtype}{None}
109             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'output'}] == \textcolor{stringliteral}{'generate'} \textcolor{keywordflow}{or} opt[\textcolor{stringliteral}{'output'}] == \textcolor{stringliteral}{'g'}:
110                 self.decoder = Decoder(
111                     opt[\textcolor{stringliteral}{'embedding\_size'}],
112                     opt[\textcolor{stringliteral}{'embedding\_size'}],
113                     opt[\textcolor{stringliteral}{'rnn\_layers'}],
114                     opt,
115                     self.dict,
116                 )
117             \textcolor{keywordflow}{elif} opt[\textcolor{stringliteral}{'output'}] != \textcolor{stringliteral}{'rank'} \textcolor{keywordflow}{and} opt[\textcolor{stringliteral}{'output'}] != \textcolor{stringliteral}{'r':}
118 \textcolor{stringliteral}{                }\textcolor{keywordflow}{raise} NotImplementedError(\textcolor{stringliteral}{'Output type not supported.'})
119 
120             \textcolor{keywordflow}{if} self.use\_cuda \textcolor{keywordflow}{and} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
121                 \textcolor{comment}{# don't call cuda on self.model, it is split cuda and cpu}
122                 self.decoder.cuda()
123             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'numthreads'}] > 1:
124                 self.model.share\_memory()
125                 \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
126                     self.decoder.share\_memory()
127         \textcolor{keywordflow}{else}:
128             self.dict = shared[\textcolor{stringliteral}{'dict'}]
129             self.model = shared[\textcolor{stringliteral}{'model'}]
130             self.decoder = shared[\textcolor{stringliteral}{'decoder'}]
131             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'threadindex'} \textcolor{keywordflow}{in} shared:
132                 torch.set\_num\_threads(1)
133                 self.answers = [\textcolor{keywordtype}{None}] * opt[\textcolor{stringliteral}{'batchsize'}]
134             \textcolor{keywordflow}{else}:
135                 self.answers = shared[\textcolor{stringliteral}{'answers'}]
136 
137         self.opt = opt
138         self.mem\_size = opt[\textcolor{stringliteral}{'mem\_size'}]
139 
140         self.longest\_label = 1
141         self.NULL = self.dict.null\_token
142         self.NULL\_IDX = self.dict[self.NULL]
143         self.END = self.dict.end\_token
144         self.END\_TENSOR = torch.LongTensor([self.dict[self.END]])
145         self.START = self.dict.start\_token
146         self.START\_TENSOR = torch.LongTensor([self.dict[self.START]])
147 
148         self.rank\_loss = CrossEntropyLoss()
149         self.gen\_loss = CrossEntropyLoss(ignore\_index=self.NULL\_IDX)
150         \textcolor{keywordflow}{if} self.use\_cuda:
151             self.rank\_loss.cuda()
152             self.gen\_loss.cuda()
153 
154         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'train'} \textcolor{keywordflow}{in} self.opt.get(\textcolor{stringliteral}{'datatype'}, \textcolor{stringliteral}{''}):
155             optim\_params = [p \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} self.model.parameters() \textcolor{keywordflow}{if} p.requires\_grad]
156             lr = opt[\textcolor{stringliteral}{'learning\_rate'}]
157             \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'sgd'}:
158                 self.optimizers = \{\textcolor{stringliteral}{'memnn'}: optim.SGD(optim\_params, lr=lr)\}
159                 \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
160                     self.optimizers[\textcolor{stringliteral}{'decoder'}] = optim.SGD(
161                         self.decoder.parameters(), lr=lr
162                     )
163             \textcolor{keywordflow}{elif} opt[\textcolor{stringliteral}{'optimizer'}] == \textcolor{stringliteral}{'adam'}:
164                 self.optimizers = \{\textcolor{stringliteral}{'memnn'}: optim.Adam(optim\_params, lr=lr)\}
165                 \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
166                     self.optimizers[\textcolor{stringliteral}{'decoder'}] = optim.Adam(
167                         self.decoder.parameters(), lr=lr
168                     )
169             \textcolor{keywordflow}{else}:
170                 \textcolor{keywordflow}{raise} NotImplementedError(\textcolor{stringliteral}{'Optimizer not supported.'})
171 
172         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} shared:
173             \textcolor{comment}{# load model}
174             \textcolor{comment}{# check first for 'init\_model' for loading model from file}
175             \textcolor{keywordflow}{if} opt.get(\textcolor{stringliteral}{'init\_model'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'init\_model'}]):
176                 init\_model = opt[\textcolor{stringliteral}{'init\_model'}]
177             \textcolor{comment}{# next check for 'model\_file'}
178             \textcolor{keywordflow}{elif} opt.get(\textcolor{stringliteral}{'model\_file'}) \textcolor{keywordflow}{and} os.path.isfile(opt[\textcolor{stringliteral}{'model\_file'}]):
179                 init\_model = opt[\textcolor{stringliteral}{'model\_file'}]
180             \textcolor{keywordflow}{else}:
181                 init\_model = \textcolor{keywordtype}{None}
182             \textcolor{keywordflow}{if} init\_model \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
183                 print(\textcolor{stringliteral}{'Loading existing model parameters from '} + init\_model)
184                 self.load(init\_model)
185 
186         self.history = \{\}
187         self.batch\_idx = shared \textcolor{keywordflow}{and} shared.get(\textcolor{stringliteral}{'batchindex'}) \textcolor{keywordflow}{or} 0
188         self.episode\_done = \textcolor{keyword}{True}
189         self.last\_cands, self.last\_cands\_list = \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None}
190         super().\_\_init\_\_(opt, shared)
191 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a7079216ce7367ba0ca3ac205daa516c4}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a7079216ce7367ba0ca3ac205daa516c4}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!act@{act}}
\index{act@{act}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{act()}{act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+act (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 439 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
439     \textcolor{keyword}{def }act(self):
440         \textcolor{keywordflow}{return} self.batch\_act([self.observation])[0]
441 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a3ca2bd7b5cbce5ebac978deeb2ce9e10}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a3ca2bd7b5cbce5ebac978deeb2ce9e10}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}}
\index{add\+\_\+cmdline\+\_\+args@{add\+\_\+cmdline\+\_\+args}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{add\+\_\+cmdline\+\_\+args()}{add\_cmdline\_args()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+add\+\_\+cmdline\+\_\+args (\begin{DoxyParamCaption}\item[{}]{argparser }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 27 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
27     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1config_a62fdd5554f1da6be0cba185271058320}{add\_cmdline\_args}(argparser):
28         arg\_group = argparser.add\_argument\_group(\textcolor{stringliteral}{'MemNN Arguments'})
29         arg\_group.add\_argument(
30             \textcolor{stringliteral}{'--init-model'},
31             type=str,
32             default=\textcolor{keywordtype}{None},
33             help=\textcolor{stringliteral}{'load dict/features/weights/opts from this file'},
34         )
35         arg\_group.add\_argument(
36             \textcolor{stringliteral}{'-lr'}, \textcolor{stringliteral}{'--learning-rate'}, type=float, default=0.01, help=\textcolor{stringliteral}{'learning rate'}
37         )
38         arg\_group.add\_argument(
39             \textcolor{stringliteral}{'--embedding-size'}, type=int, default=128, help=\textcolor{stringliteral}{'size of token embeddings'}
40         )
41         arg\_group.add\_argument(
42             \textcolor{stringliteral}{'--hops'}, type=int, default=3, help=\textcolor{stringliteral}{'number of memory hops'}
43         )
44         arg\_group.add\_argument(
45             \textcolor{stringliteral}{'--mem-size'}, type=int, default=100, help=\textcolor{stringliteral}{'size of memory'}
46         )
47         arg\_group.add\_argument(
48             \textcolor{stringliteral}{'--time-features'},
49             type=\textcolor{stringliteral}{'bool'},
50             default=\textcolor{keyword}{True},
51             help=\textcolor{stringliteral}{'use time features for memory embeddings'},
52         )
53         arg\_group.add\_argument(
54             \textcolor{stringliteral}{'--position-encoding'},
55             type=\textcolor{stringliteral}{'bool'},
56             default=\textcolor{keyword}{False},
57             help=\textcolor{stringliteral}{'use position encoding instead of bag of words embedding'},
58         )
59         arg\_group.add\_argument(
60             \textcolor{stringliteral}{'--output'}, type=str, default=\textcolor{stringliteral}{'rank'}, help=\textcolor{stringliteral}{'type of output (rank|generate)'}
61         )
62         arg\_group.add\_argument(
63             \textcolor{stringliteral}{'--rnn-layers'},
64             type=int,
65             default=2,
66             help=\textcolor{stringliteral}{'number of hidden layers in RNN decoder for generative output'},
67         )
68         arg\_group.add\_argument(
69             \textcolor{stringliteral}{'--dropout'},
70             type=float,
71             default=0.1,
72             help=\textcolor{stringliteral}{'dropout probability for RNN decoder training'},
73         )
74         arg\_group.add\_argument(
75             \textcolor{stringliteral}{'--optimizer'}, default=\textcolor{stringliteral}{'adam'}, help=\textcolor{stringliteral}{'optimizer type (sgd|adam)'}
76         )
77         arg\_group.add\_argument(
78             \textcolor{stringliteral}{'--no-cuda'},
79             action=\textcolor{stringliteral}{'store\_true'},
80             default=\textcolor{keyword}{False},
81             help=\textcolor{stringliteral}{'disable GPUs even if available'},
82         )
83         arg\_group.add\_argument(
84             \textcolor{stringliteral}{'--gpu'}, type=int, default=-1, help=\textcolor{stringliteral}{'which GPU device to use'}
85         )
86         arg\_group.add\_argument(
87             \textcolor{stringliteral}{'-histr'},
88             \textcolor{stringliteral}{'--history-replies'},
89             default=\textcolor{stringliteral}{'label\_else\_model'},
90             type=str,
91             choices=[\textcolor{stringliteral}{'none'}, \textcolor{stringliteral}{'model'}, \textcolor{stringliteral}{'label'}, \textcolor{stringliteral}{'label\_else\_model'}],
92             help=\textcolor{stringliteral}{'Keep replies in the history, or not.'},
93         )
94         DictionaryAgent.add\_cmdline\_args(argparser)
95         \textcolor{keywordflow}{return} arg\_group
96 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad73ed6e730b608491c2d8ef3ad25e32a}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad73ed6e730b608491c2d8ef3ad25e32a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!batch\+\_\+act@{batch\+\_\+act}}
\index{batch\+\_\+act@{batch\+\_\+act}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+act()}{batch\_act()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+batch\+\_\+act (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observations }\end{DoxyParamCaption})}



Definition at line 421 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
421     \textcolor{keyword}{def }batch\_act(self, observations):
422         batchsize = len(observations)
423         batch\_reply = [\{\textcolor{stringliteral}{'id'}: self.getID()\} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
424 
425         xs, ys, cands, valid\_inds = self.batchify(observations)
426 
427         \textcolor{keywordflow}{if} xs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{or} len(xs[1]) == 0:
428             \textcolor{keywordflow}{return} batch\_reply
429 
430         \textcolor{comment}{# Either train or predict}
431         predictions = self.predict(xs, cands, ys)
432 
433         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(valid\_inds)):
434             self.answers[valid\_inds[i]] = predictions[i][0]
435             batch\_reply[valid\_inds[i]][\textcolor{stringliteral}{'text'}] = predictions[i][0]
436             batch\_reply[valid\_inds[i]][\textcolor{stringliteral}{'text\_candidates'}] = predictions[i]
437         \textcolor{keywordflow}{return} batch\_reply
438 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afaa379fa31bcc83bd467d15e2976d0a3}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afaa379fa31bcc83bd467d15e2976d0a3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!batchify@{batchify}}
\index{batchify@{batchify}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{batchify()}{batchify()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+batchify (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{obs }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns:
    xs = [memories, queries, memory_lengths, query_lengths]
    ys = [labels, label_lengths] (if available, else None)
    cands = list of candidates for each example in batch
    valid_inds = list of indices for examples with valid observations
\end{DoxyVerb}
 

Definition at line 365 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
365     \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1drqa_1_1utils_aca22dd97c5b6dcda2a7479c1cb22ef1e}{batchify}(self, obs):
366         \textcolor{stringliteral}{"""Returns:}
367 \textcolor{stringliteral}{            xs = [memories, queries, memory\_lengths, query\_lengths]}
368 \textcolor{stringliteral}{            ys = [labels, label\_lengths] (if available, else None)}
369 \textcolor{stringliteral}{            cands = list of candidates for each example in batch}
370 \textcolor{stringliteral}{            valid\_inds = list of indices for examples with valid observations}
371 \textcolor{stringliteral}{        """}
372         exs = [ex \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} obs \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} ex \textcolor{keywordflow}{and} len(ex[\textcolor{stringliteral}{'text'}]) > 0]
373         valid\_inds = [
374             i \textcolor{keywordflow}{for} i, ex \textcolor{keywordflow}{in} enumerate(obs) \textcolor{keywordflow}{if} \textcolor{stringliteral}{'text'} \textcolor{keywordflow}{in} ex \textcolor{keywordflow}{and} len(ex[\textcolor{stringliteral}{'text'}]) > 0
375         ]
376         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} exs:
377             \textcolor{keywordflow}{return} [\textcolor{keywordtype}{None}] * 4
378 
379         parsed = [self.parse(ex[\textcolor{stringliteral}{'text'}]) \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs]
380         queries = torch.cat([x[0] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed])
381         memories = torch.cat([x[1] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed])
382         query\_lengths = torch.cat([x[2] \textcolor{keywordflow}{for} x \textcolor{keywordflow}{in} parsed])
383         memory\_lengths = torch.LongTensor(len(exs), self.mem\_size).zero\_()
384         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(exs)):
385             \textcolor{keywordflow}{if} len(parsed[i][3]) > 0:
386                 memory\_lengths[i, -len(parsed[i][3]) :] = parsed[i][3]
387         xs = [memories, queries, memory\_lengths, query\_lengths]
388 
389         ys = \textcolor{keywordtype}{None}
390         self.labels = [random.choice(ex[\textcolor{stringliteral}{'labels'}]) \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs \textcolor{keywordflow}{if} \textcolor{stringliteral}{'labels'} \textcolor{keywordflow}{in} ex]
391         \textcolor{keywordflow}{if} len(self.labels) == len(exs):
392             parsed = [self.dict.txt2vec(l) \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} self.labels]
393             parsed = [torch.LongTensor(p) \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} parsed]
394             label\_lengths = torch.LongTensor([len(p) \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} parsed]).unsqueeze(1)
395             self.longest\_label = max(self.longest\_label, label\_lengths.max())
396             padded = [
397                 torch.cat(
398                     (
399                         p,
400                         torch.LongTensor(self.longest\_label - len(p)).fill\_(
401                             self.END\_TENSOR[0]
402                         ),
403                     )
404                 )
405                 \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} parsed
406             ]
407             labels = torch.stack(padded)
408             ys = [labels, label\_lengths]
409 
410         cands = [ex[\textcolor{stringliteral}{'label\_candidates'}] \textcolor{keywordflow}{for} ex \textcolor{keywordflow}{in} exs \textcolor{keywordflow}{if} \textcolor{stringliteral}{'label\_candidates'} \textcolor{keywordflow}{in} ex]
411         \textcolor{comment}{# Use words in dict as candidates if no candidates are provided}
412         \textcolor{keywordflow}{if} len(cands) < len(exs):
413             cands = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_ab07fdb540c02e8e2a1cc7e8cf662a8b8}{build\_cands}(exs, self.dict)
414         \textcolor{comment}{# Avoid rebuilding candidate list every batch if its the same}
415         \textcolor{keywordflow}{if} self.last\_cands != cands:
416             self.last\_cands = cands
417             self.last\_cands\_list = [list(c) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cands]
418         cands = self.last\_cands\_list
419         \textcolor{keywordflow}{return} xs, ys, cands, valid\_inds
420 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae18c65a307c2a3c164beb6cf0bb5b62b}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae18c65a307c2a3c164beb6cf0bb5b62b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!decode@{decode}}
\index{decode@{decode}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{decode()}{decode()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+decode (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{output\+\_\+embeddings,  }\item[{}]{ys = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 298 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
298     \textcolor{keyword}{def }decode(self, output\_embeddings, ys=None):
299         batchsize = output\_embeddings.size(0)
300         hn = output\_embeddings.unsqueeze(0).expand(
301             self.opt[\textcolor{stringliteral}{'rnn\_layers'}], batchsize, output\_embeddings.size(1)
302         )
303         x = self.model.answer\_embedder(torch.LongTensor([1]), self.START\_TENSOR)
304         xes = x.unsqueeze(1).expand(x.size(0), batchsize, x.size(1))
305 
306         loss = 0
307         output\_lines = [[] \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
308         done = [\textcolor{keyword}{False} \textcolor{keywordflow}{for} \_ \textcolor{keywordflow}{in} range(batchsize)]
309         total\_done = 0
310         idx = 0
311         \textcolor{keywordflow}{while} (total\_done < batchsize) \textcolor{keywordflow}{and} idx < self.longest\_label:
312             \textcolor{comment}{# keep producing tokens until we hit END or max length for each ex}
313             \textcolor{keywordflow}{if} self.use\_cuda:
314                 xes = xes.cuda()
315                 hn = hn.contiguous()
316             preds, scores = self.decoder(xes, hn)
317             \textcolor{keywordflow}{if} ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
318                 y = ys[0][:, idx]
319                 temp\_y = y.cuda() \textcolor{keywordflow}{if} self.use\_cuda \textcolor{keywordflow}{else} y
320                 loss += self.gen\_loss(scores, temp\_y)
321             \textcolor{keywordflow}{else}:
322                 y = preds
323             \textcolor{comment}{# use the true token as the next input for better training}
324             xes = self.model.answer\_embedder(
325                 torch.LongTensor(preds.numel()).fill\_(1), y
326             ).unsqueeze(0)
327 
328             \textcolor{keywordflow}{for} b \textcolor{keywordflow}{in} range(batchsize):
329                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} done[b]:
330                     token = self.dict.vec2txt(preds[b])
331                     \textcolor{keywordflow}{if} token == self.END:
332                         done[b] = \textcolor{keyword}{True}
333                         total\_done += 1
334                     \textcolor{keywordflow}{else}:
335                         output\_lines[b].append(token)
336             idx += 1
337         \textcolor{keywordflow}{return} output\_lines, loss
338 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a15b8b76a2d2ae5e0a4de2978e5ac0ac5}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a15b8b76a2d2ae5e0a4de2978e5ac0ac5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!generated\+\_\+predictions@{generated\+\_\+predictions}}
\index{generated\+\_\+predictions@{generated\+\_\+predictions}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{generated\+\_\+predictions()}{generated\_predictions()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+generated\+\_\+predictions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{output\+\_\+lines }\end{DoxyParamCaption})}



Definition at line 339 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
339     \textcolor{keyword}{def }generated\_predictions(self, output\_lines):
340         \textcolor{keywordflow}{return} [
341             [\textcolor{stringliteral}{' '}.join(c \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} o \textcolor{keywordflow}{if} c != self.END \textcolor{keywordflow}{and} c != self.dict.null\_token)]
342             \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} output\_lines
343         ]
344 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a43e08459f9552c66ef389b8727b8eff3}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a43e08459f9552c66ef389b8727b8eff3}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!load@{load}}
\index{load@{load}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{load()}{load()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+load (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path }\end{DoxyParamCaption})}



Definition at line 456 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
456     \textcolor{keyword}{def }load(self, path):
457         checkpoint = torch.load(path, map\_location=\textcolor{keyword}{lambda} cpu, \_: cpu)
458         self.model.load\_state\_dict(checkpoint[\textcolor{stringliteral}{'memnn'}])
459         self.optimizers[\textcolor{stringliteral}{'memnn'}].load\_state\_dict(checkpoint[\textcolor{stringliteral}{'memnn\_optim'}])
460         \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
461             self.decoder.load\_state\_dict(checkpoint[\textcolor{stringliteral}{'decoder'}])
462             self.optimizers[\textcolor{stringliteral}{'decoder'}].load\_state\_dict(checkpoint[\textcolor{stringliteral}{'decoder\_optim'}])
463             self.longest\_label = checkpoint[\textcolor{stringliteral}{'longest\_label'}]
464 
465 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a0f8358dd299ba6719f7354771938fd7b}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a0f8358dd299ba6719f7354771938fd7b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!observe@{observe}}
\index{observe@{observe}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{observe()}{observe()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+observe (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{observation }\end{DoxyParamCaption})}

\begin{DoxyVerb}Save observation for act.

If multiple observations are from the same episode, concatenate them.
\end{DoxyVerb}
 

Definition at line 200 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
200     \textcolor{keyword}{def }observe(self, observation):
201         \textcolor{stringliteral}{"""}
202 \textcolor{stringliteral}{        Save observation for act.}
203 \textcolor{stringliteral}{}
204 \textcolor{stringliteral}{        If multiple observations are from the same episode, concatenate them.}
205 \textcolor{stringliteral}{        """}
206         self.episode\_done = observation[\textcolor{stringliteral}{'episode\_done'}]
207         \textcolor{comment}{# shallow copy observation (deep copy can be expensive)}
208         obs = observation.copy()
209 
210         obs[\textcolor{stringliteral}{'text'}] = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1seq2seq_1_1utils__v0_ac7cb3ffae208474d6e67f37ecfe07f64}{maintain\_dialog\_history}(
211             self.history,
212             obs,
213             reply=self.answers[self.batch\_idx],
214             historyLength=self.opt[\textcolor{stringliteral}{'mem\_size'}] + 1,
215             useReplies=self.opt[\textcolor{stringliteral}{'history\_replies'}],
216             dict=self.dict,
217             useStartEndIndices=\textcolor{keyword}{False},
218             splitSentences=\textcolor{keyword}{True},
219         )
220 
221         self.observation = obs
222         self.answers[self.batch\_idx] = \textcolor{keywordtype}{None}
223         \textcolor{keywordflow}{return} obs
224 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a5e9b6393cb251b6030bb9a0db51b8026}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a5e9b6393cb251b6030bb9a0db51b8026}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!parse@{parse}}
\index{parse@{parse}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{parse()}{parse()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+parse (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{memory }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns:
    query = tensor (vector) of token indices for query
    query_length = length of query
    memory = tensor (matrix) where each row contains token indices for a memory
    memory_lengths = tensor (vector) with lengths of each memory
\end{DoxyVerb}
 

Definition at line 345 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
345     \textcolor{keyword}{def }parse(self, memory):
346         \textcolor{stringliteral}{"""Returns:}
347 \textcolor{stringliteral}{            query = tensor (vector) of token indices for query}
348 \textcolor{stringliteral}{            query\_length = length of query}
349 \textcolor{stringliteral}{            memory = tensor (matrix) where each row contains token indices for a memory}
350 \textcolor{stringliteral}{            memory\_lengths = tensor (vector) with lengths of each memory}
351 \textcolor{stringliteral}{        """}
352         query = memory.pop()
353         query = torch.LongTensor(query)
354         query\_length = torch.LongTensor([len(query)])
355 
356         \textcolor{keywordflow}{if} len(memory) == 0:
357             memory.append([self.NULL\_IDX])
358 
359         memory = [torch.LongTensor(m) \textcolor{keywordflow}{for} m \textcolor{keywordflow}{in} memory]
360         memory\_lengths = torch.LongTensor([len(m) \textcolor{keywordflow}{for} m \textcolor{keywordflow}{in} memory])
361         memory = torch.cat(memory)
362 
363         \textcolor{keywordflow}{return} (query, memory, query\_length, memory\_lengths)
364 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a4e850d51ca01adc45754cc509c8b096a}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a4e850d51ca01adc45754cc509c8b096a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!predict@{predict}}
\index{predict@{predict}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{predict()}{predict()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+predict (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{xs,  }\item[{}]{cands,  }\item[{}]{ys = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 231 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
231     \textcolor{keyword}{def }predict(self, xs, cands, ys=None):
232         is\_training = ys \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}
233         \textcolor{keywordflow}{if} is\_training:
234             \textcolor{comment}{# Subsample to reduce training time}
235             cands = [
236                 list(set(random.sample(c, min(32, len(c))) + self.labels))
237                 \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cands
238             ]
239         \textcolor{keywordflow}{else}:
240             \textcolor{comment}{# rank all cands to increase accuracy}
241             cands = [list(set(c)) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cands]
242 
243         self.model.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}(mode=is\_training)
244         \textcolor{comment}{# Organize inputs for network (see contents of xs and ys in batchify method)}
245         output\_embeddings = self.model(*xs)
246 
247         \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
248             scores = self.score(cands, output\_embeddings)
249             \textcolor{keywordflow}{if} is\_training:
250                 label\_inds = [
251                     cand\_list.index(self.labels[i]) \textcolor{keywordflow}{for} i, cand\_list \textcolor{keywordflow}{in} enumerate(cands)
252                 ]
253                 \textcolor{keywordflow}{if} self.use\_cuda:
254                     label\_inds = torch.cuda.LongTensor(label\_inds)
255                 \textcolor{keywordflow}{else}:
256                     label\_inds = torch.LongTensor(label\_inds)
257                 loss = self.rank\_loss(scores, label\_inds)
258             predictions = self.ranked\_predictions(cands, scores)
259         \textcolor{keywordflow}{else}:
260             self.decoder.\hyperlink{namespaceprojects_1_1mastering__the__dungeon_1_1mturk_1_1tasks_1_1MTD_1_1run_a36a5f4f6f9df0611a6818610518d2cf0}{train}(mode=is\_training)
261 
262             output\_lines, loss = self.decode(output\_embeddings, ys)
263             predictions = self.generated\_predictions(output\_lines)
264 
265         \textcolor{keywordflow}{if} is\_training:
266             \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} self.optimizers.values():
267                 o.zero\_grad()
268             loss.backward()
269             \textcolor{keywordflow}{for} o \textcolor{keywordflow}{in} self.optimizers.values():
270                 o.step()
271         \textcolor{keywordflow}{return} predictions
272 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_aeca21a7823ef27e0f56ac7e420e2beca}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_aeca21a7823ef27e0f56ac7e420e2beca}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!ranked\+\_\+predictions@{ranked\+\_\+predictions}}
\index{ranked\+\_\+predictions@{ranked\+\_\+predictions}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{ranked\+\_\+predictions()}{ranked\_predictions()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+ranked\+\_\+predictions (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{cands,  }\item[{}]{scores }\end{DoxyParamCaption})}



Definition at line 291 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
291     \textcolor{keyword}{def }ranked\_predictions(self, cands, scores):
292         \textcolor{comment}{# return [' '] * len(self.answers)}
293         \_, inds = scores.sort(descending=\textcolor{keyword}{True}, dim=1)
294         \textcolor{keywordflow}{return} [
295             [cands[i][j] \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} r \textcolor{keywordflow}{if} j < len(cands[i])] \textcolor{keywordflow}{for} i, r \textcolor{keywordflow}{in} enumerate(inds)
296         ]
297 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad365b2e33983158fbf7581d361a74246}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad365b2e33983158fbf7581d361a74246}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!reset@{reset}}
\index{reset@{reset}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{reset()}{reset()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+reset (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 225 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
225     \textcolor{keyword}{def }reset(self):
226         self.observation = \textcolor{keywordtype}{None}
227         self.history.clear()
228         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(self.answers)):
229             self.answers[i] = \textcolor{keywordtype}{None}
230 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a20509f6931e68ff52e965d3e214c7b0a}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a20509f6931e68ff52e965d3e214c7b0a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!save@{save}}
\index{save@{save}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{save()}{save()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+save (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{path = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 442 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
442     \textcolor{keyword}{def }save(self, path=None):
443         path = self.opt.get(\textcolor{stringliteral}{'model\_file'}, \textcolor{keywordtype}{None}) \textcolor{keywordflow}{if} path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None} \textcolor{keywordflow}{else} path
444 
445         \textcolor{keywordflow}{if} path:
446             checkpoint = \{\}
447             checkpoint[\textcolor{stringliteral}{'memnn'}] = self.model.state\_dict()
448             checkpoint[\textcolor{stringliteral}{'memnn\_optim'}] = self.optimizers[\textcolor{stringliteral}{'memnn'}].state\_dict()
449             \textcolor{keywordflow}{if} self.decoder \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
450                 checkpoint[\textcolor{stringliteral}{'decoder'}] = self.decoder.state\_dict()
451                 checkpoint[\textcolor{stringliteral}{'decoder\_optim'}] = self.optimizers[\textcolor{stringliteral}{'decoder'}].state\_dict()
452                 checkpoint[\textcolor{stringliteral}{'longest\_label'}] = self.longest\_label
453             with open(path, \textcolor{stringliteral}{'wb'}) \textcolor{keyword}{as} write:
454                 torch.save(checkpoint, write)
455 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a29485cab795b6c8abe0a61d9c6bb87fd}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a29485cab795b6c8abe0a61d9c6bb87fd}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!score@{score}}
\index{score@{score}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{score()}{score()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+score (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{cands,  }\item[{}]{output\+\_\+embeddings }\end{DoxyParamCaption})}



Definition at line 273 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
273     \textcolor{keyword}{def }score(self, cands, output\_embeddings):
274         last\_cand = \textcolor{keywordtype}{None}
275         max\_len = max([len(c) \textcolor{keywordflow}{for} c \textcolor{keywordflow}{in} cands])
276         scores = output\_embeddings.data.new(len(cands), max\_len)
277         \textcolor{keywordflow}{for} i, cand\_list \textcolor{keywordflow}{in} enumerate(cands):
278             \textcolor{keywordflow}{if} last\_cand != cand\_list:
279                 candidate\_lengths, candidate\_indices = \hyperlink{namespaceparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_a8bf19c6993b40602c1d86a848b30c5a1}{to\_tensors}(cand\_list, self.dict)
280                 candidate\_embeddings = self.model.answer\_embedder(
281                     candidate\_lengths, candidate\_indices
282                 )
283                 \textcolor{keywordflow}{if} self.use\_cuda:
284                     candidate\_embeddings = candidate\_embeddings.cuda()
285                 last\_cand = cand\_list
286             scores[i, : len(cand\_list)] = self.model.score.one\_to\_many(
287                 output\_embeddings[i].unsqueeze(0), candidate\_embeddings
288             ).squeeze(0)
289         \textcolor{keywordflow}{return} scores
290 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a64ae5911364ed06f2a72afe9859e6cdd}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a64ae5911364ed06f2a72afe9859e6cdd}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!share@{share}}
\index{share@{share}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{share()}{share()}}
{\footnotesize\ttfamily def parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+share (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line 192 of file memnn\+\_\+v0.\+py.


\begin{DoxyCode}
192     \textcolor{keyword}{def }share(self):
193         shared = super().share()
194         shared[\textcolor{stringliteral}{'answers'}] = self.answers
195         shared[\textcolor{stringliteral}{'dict'}] = self.dict
196         shared[\textcolor{stringliteral}{'model'}] = self.model
197         shared[\textcolor{stringliteral}{'decoder'}] = self.decoder
198         \textcolor{keywordflow}{return} shared
199 
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afe8168370453275f9d89b10a0212029d}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afe8168370453275f9d89b10a0212029d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!answers@{answers}}
\index{answers@{answers}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{answers}{answers}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+answers}



Definition at line 105 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a760f59a2f18c3132341cfc6737365c1f}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a760f59a2f18c3132341cfc6737365c1f}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!batch\+\_\+idx@{batch\+\_\+idx}}
\index{batch\+\_\+idx@{batch\+\_\+idx}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{batch\+\_\+idx}{batch\_idx}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+batch\+\_\+idx}



Definition at line 187 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a0de6d8c7652909439a38f21616a7561c}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a0de6d8c7652909439a38f21616a7561c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!decoder@{decoder}}
\index{decoder@{decoder}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{decoder}{decoder}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+decoder}



Definition at line 108 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae7f61afed6d1d95a36c490fb191e99aa}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae7f61afed6d1d95a36c490fb191e99aa}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!dict@{dict}}
\index{dict@{dict}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{dict}{dict}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+dict}



Definition at line 104 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ab4d3e5b627338f308b853d9a61aec2f0}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ab4d3e5b627338f308b853d9a61aec2f0}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!E\+ND@{E\+ND}}
\index{E\+ND@{E\+ND}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{E\+ND}{END}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+E\+ND}



Definition at line 143 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a27d4c7bb83f643782984d9ff3306bf41}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a27d4c7bb83f643782984d9ff3306bf41}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!E\+N\+D\+\_\+\+T\+E\+N\+S\+OR@{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}}
\index{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR@{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}{END\_TENSOR}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+E\+N\+D\+\_\+\+T\+E\+N\+S\+OR}



Definition at line 144 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a19eee67f8834043130a277fa35bbffc5}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a19eee67f8834043130a277fa35bbffc5}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!episode\+\_\+done@{episode\+\_\+done}}
\index{episode\+\_\+done@{episode\+\_\+done}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{episode\+\_\+done}{episode\_done}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+episode\+\_\+done}



Definition at line 188 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a1679d276474a4ab8baa4d368fdee8c8b}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a1679d276474a4ab8baa4d368fdee8c8b}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!gen\+\_\+loss@{gen\+\_\+loss}}
\index{gen\+\_\+loss@{gen\+\_\+loss}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{gen\+\_\+loss}{gen\_loss}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+gen\+\_\+loss}



Definition at line 149 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a86ebdb3ff6941cfb15945a9f3f198f83}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a86ebdb3ff6941cfb15945a9f3f198f83}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!history@{history}}
\index{history@{history}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{history}{history}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+history}



Definition at line 186 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a920f998926ca4466a6bd382ef7034499}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a920f998926ca4466a6bd382ef7034499}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!id@{id}}
\index{id@{id}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{id}{id}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+id}



Definition at line 103 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a5d56f023807667a1e589833d3d5220df}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a5d56f023807667a1e589833d3d5220df}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!labels@{labels}}
\index{labels@{labels}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{labels}{labels}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+labels}



Definition at line 390 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a2f76bf7b117ffc19e89b2b6168026063}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a2f76bf7b117ffc19e89b2b6168026063}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!last\+\_\+cands@{last\+\_\+cands}}
\index{last\+\_\+cands@{last\+\_\+cands}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{last\+\_\+cands}{last\_cands}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+last\+\_\+cands}



Definition at line 416 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_affeb8168155ac425e348c0ce599f1764}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_affeb8168155ac425e348c0ce599f1764}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!last\+\_\+cands\+\_\+list@{last\+\_\+cands\+\_\+list}}
\index{last\+\_\+cands\+\_\+list@{last\+\_\+cands\+\_\+list}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{last\+\_\+cands\+\_\+list}{last\_cands\_list}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+last\+\_\+cands\+\_\+list}



Definition at line 189 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a75eb3fc9ff074bd4b56b0a8897d37efc}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a75eb3fc9ff074bd4b56b0a8897d37efc}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!longest\+\_\+label@{longest\+\_\+label}}
\index{longest\+\_\+label@{longest\+\_\+label}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{longest\+\_\+label}{longest\_label}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+longest\+\_\+label}



Definition at line 140 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ab21b657cb95a7129d4e0586e537c84c2}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ab21b657cb95a7129d4e0586e537c84c2}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!mem\+\_\+size@{mem\+\_\+size}}
\index{mem\+\_\+size@{mem\+\_\+size}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{mem\+\_\+size}{mem\_size}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+mem\+\_\+size}



Definition at line 138 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a6ab848128ba532c6c72bea26f8256e4c}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a6ab848128ba532c6c72bea26f8256e4c}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!model@{model}}
\index{model@{model}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{model}{model}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+model}



Definition at line 106 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a459e4d3cc000e2f2458153af7ec83bef}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a459e4d3cc000e2f2458153af7ec83bef}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!N\+U\+LL@{N\+U\+LL}}
\index{N\+U\+LL@{N\+U\+LL}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{N\+U\+LL}{NULL}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+N\+U\+LL}



Definition at line 141 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a9934e51e2bbc8a76b8b6dd8325d809cb}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a9934e51e2bbc8a76b8b6dd8325d809cb}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}}
\index{N\+U\+L\+L\+\_\+\+I\+DX@{N\+U\+L\+L\+\_\+\+I\+DX}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{N\+U\+L\+L\+\_\+\+I\+DX}{NULL\_IDX}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+N\+U\+L\+L\+\_\+\+I\+DX}



Definition at line 142 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afa839a741742c292916a7fce23c71a31}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_afa839a741742c292916a7fce23c71a31}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!observation@{observation}}
\index{observation@{observation}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{observation}{observation}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+observation}



Definition at line 221 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae9e5ceae9adbc5b2e18dfc37da457e3a}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ae9e5ceae9adbc5b2e18dfc37da457e3a}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!opt@{opt}}
\index{opt@{opt}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{opt}{opt}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+opt}



Definition at line 137 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a442f9e9a53de9c0e91953371e11a2b5d}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a442f9e9a53de9c0e91953371e11a2b5d}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!optimizers@{optimizers}}
\index{optimizers@{optimizers}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{optimizers}{optimizers}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+optimizers}



Definition at line 158 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a438cc6b1bc8e6443220b6d25a332f627}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a438cc6b1bc8e6443220b6d25a332f627}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!rank\+\_\+loss@{rank\+\_\+loss}}
\index{rank\+\_\+loss@{rank\+\_\+loss}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{rank\+\_\+loss}{rank\_loss}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+rank\+\_\+loss}



Definition at line 148 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad47aab7437ba9ae08a1cd0637de02f27}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_ad47aab7437ba9ae08a1cd0637de02f27}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!S\+T\+A\+RT@{S\+T\+A\+RT}}
\index{S\+T\+A\+RT@{S\+T\+A\+RT}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{S\+T\+A\+RT}{START}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+S\+T\+A\+RT}



Definition at line 145 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a7a1ae5fdf464724f1c696ea71f4e2593}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a7a1ae5fdf464724f1c696ea71f4e2593}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR@{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}}
\index{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR@{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}{START\_TENSOR}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+S\+T\+A\+R\+T\+\_\+\+T\+E\+N\+S\+OR}



Definition at line 146 of file memnn\+\_\+v0.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a478c07f1b6366123c71344ad1a4bb9c6}\label{classparlai_1_1agents_1_1legacy__agents_1_1memnn_1_1memnn__v0_1_1MemnnAgent_a478c07f1b6366123c71344ad1a4bb9c6}} 
\index{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}!use\+\_\+cuda@{use\+\_\+cuda}}
\index{use\+\_\+cuda@{use\+\_\+cuda}!parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent@{parlai\+::agents\+::legacy\+\_\+agents\+::memnn\+::memnn\+\_\+v0\+::\+Memnn\+Agent}}
\subsubsection{\texorpdfstring{use\+\_\+cuda}{use\_cuda}}
{\footnotesize\ttfamily parlai.\+agents.\+legacy\+\_\+agents.\+memnn.\+memnn\+\_\+v0.\+Memnn\+Agent.\+use\+\_\+cuda}



Definition at line 98 of file memnn\+\_\+v0.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/legacy\+\_\+agents/memnn/\hyperlink{memnn__v0_8py}{memnn\+\_\+v0.\+py}\end{DoxyCompactItemize}
