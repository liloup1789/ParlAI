\hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention}{}\section{parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention Class Reference}
\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention}\index{parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention@{parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention}}


Inheritance diagram for parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{da/dc0/classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=247pt]{df/d8e/classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention__coll__graph}
\end{center}
\end{figure}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a427b8cfaac6d37141555616d9cee8b74}{\+\_\+\+\_\+init\+\_\+\+\_\+} (self, \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa28ff3887a718bb96a9bd27c938a0baf}{n\+\_\+heads}, \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a0ffd2e0d89db2f682561af438aaa1eb5}{dim}, dropout=0)
\item 
def \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a504eb3bb3e4b241e8461d78a0c3cbc03}{forward}
\item 
def \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aaaa65b1ea63856616e7b9d75b0e794a7}{prepare\+\_\+head} (tensor)
\item 
def \hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a3478f15a48d749a3cbfe0760722b249c}{reorder\+\_\+incremental\+\_\+state}
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_ac1c0169222b929c580d1a786479d7ed2}{attn\+\_\+dropout}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a84ab720bc232bb48e8f61e37e7c52323}{q\+\_\+lin}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a1e86cacd8fe8129222fe04c41c48655d}{k\+\_\+lin}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a1b1c33915c80f894221dfd4f0a0a2896}{v\+\_\+lin}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a495812bb583389a5f5dae989a22bda19}{out\+\_\+lin}
\end{DoxyCompactItemize}
\subsection*{Static Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a99f2e28c8a369a07a2982562391c1480}{batch\+\_\+size}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a100f3e07166c020ba43691ab0935b194}{query\+\_\+len}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a0ffd2e0d89db2f682561af438aaa1eb5}{dim}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa28ff3887a718bb96a9bd27c938a0baf}{n\+\_\+heads}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a50cc6181bc0d24e9e20f820344faa5ec}{dim\+\_\+per\+\_\+head}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_ae646637141fe94e312d080563f83ae5e}{scale}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a39d1a56edfde6dd1af7cdd73d33c869a}{key}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a16e1973304e7a76af3293daa82e2f17a}{value}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a14e312fdb4882f9f3dc730c08673aa54}{q}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_acdf6ff5307055074178f77080196d42e}{k}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a96d6455bac45c0ebf237863d9f292fc1}{v}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa5b5049ad1310575ef39a2221dc98867}{incr\+\_\+state}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_abd21d573bbd199c212823d195b1cc70d}{prev\+\_\+key}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_abfd84c6f81cbcf82f2dc576cd2fd634d}{prev\+\_\+value}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a5fa22233ceed27025626b6c58701f085}{mask}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_adb13ded9cb633bbe63d92dda6ab81e2a}{new\+\_\+incr\+\_\+state}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a8ef7af8f97df73fe6cd5fae6969e68bb}{full\+\_\+key\+\_\+len}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a34fb7def27abc78d179c7d944d67c305}{dot\+\_\+prod}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a733f712c97d7aa9b8bd8b7fd28d3adfe}{attn\+\_\+mask}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aef08475b7756f4c8e5049b3b17378a82}{attn\+\_\+weights}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a59719fa112c890e082ef22280fe13cc4}{attentioned}
\item 
\hyperlink{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a5c4a6c579fe84cd7fc04456359d334ac}{out}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Implements MultiHeadAttention; this is the core workhorse of the Transformer.

See Vaswani (2017) for an extensive description.
\end{DoxyVerb}
 

Definition at line 1003 of file modules.\+py.



\subsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a427b8cfaac6d37141555616d9cee8b74}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a427b8cfaac6d37141555616d9cee8b74}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{\+\_\+\+\_\+init\+\_\+\+\_\+()}{\_\_init\_\_()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{n\+\_\+heads,  }\item[{}]{dim,  }\item[{}]{dropout = {\ttfamily 0} }\end{DoxyParamCaption})}



Definition at line 1010 of file modules.\+py.


\begin{DoxyCode}
1010     \textcolor{keyword}{def }\_\_init\_\_(self, n\_heads, dim, dropout=0):
1011         super(MultiHeadAttention, self).\_\_init\_\_()
1012         self.n\_heads = n\_heads
1013         self.dim = dim
1014 
1015         self.attn\_dropout = nn.Dropout(p=dropout)  \textcolor{comment}{# --attention-dropout}
1016         self.q\_lin = nn.Linear(dim, dim)
1017         self.k\_lin = nn.Linear(dim, dim)
1018         self.v\_lin = nn.Linear(dim, dim)
1019         \textcolor{comment}{# TODO: merge for the initialization step}
1020         nn.init.xavier\_normal\_(self.q\_lin.weight)
1021         nn.init.xavier\_normal\_(self.k\_lin.weight)
1022         nn.init.xavier\_normal\_(self.v\_lin.weight)
1023         \textcolor{comment}{# and set biases to 0}
1024         self.out\_lin = nn.Linear(dim, dim)
1025 
1026         nn.init.xavier\_normal\_(self.out\_lin.weight)
1027 
\end{DoxyCode}


\subsection{Member Function Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a504eb3bb3e4b241e8461d78a0c3cbc03}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a504eb3bb3e4b241e8461d78a0c3cbc03}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!forward@{forward}}
\index{forward@{forward}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{forward()}{forward()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+forward (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{query }\end{DoxyParamCaption})}



Definition at line 1030 of file modules.\+py.


\begin{DoxyCode}
1030         query: torch.Tensor,
1031         key: torch.Tensor = \textcolor{keywordtype}{None},
1032         value: torch.Tensor = \textcolor{keywordtype}{None},
1033         mask: torch.Tensor = \textcolor{keywordtype}{None},
1034         incr\_state: Dict[str, torch.Tensor] = \textcolor{keywordtype}{None},
1035         static\_kv: bool = \textcolor{keyword}{False},
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aaaa65b1ea63856616e7b9d75b0e794a7}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aaaa65b1ea63856616e7b9d75b0e794a7}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!prepare\+\_\+head@{prepare\+\_\+head}}
\index{prepare\+\_\+head@{prepare\+\_\+head}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{prepare\+\_\+head()}{prepare\_head()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+prepare\+\_\+head (\begin{DoxyParamCaption}\item[{}]{tensor }\end{DoxyParamCaption})}



Definition at line 1064 of file modules.\+py.


\begin{DoxyCode}
1064         \textcolor{keyword}{def }prepare\_head(tensor):
1065             \textcolor{comment}{# input is [batch\_size, seq\_len, n\_heads * dim\_per\_head]}
1066             \textcolor{comment}{# output is [batch\_size * n\_heads, seq\_len, dim\_per\_head]}
1067             bsz, seq\_len, \_ = tensor.size()
1068             tensor = tensor.view(batch\_size, tensor.size(1), n\_heads, dim\_per\_head)
1069             tensor = (
1070                 tensor.transpose(1, 2)
1071                 .contiguous()
1072                 .view(batch\_size * n\_heads, seq\_len, dim\_per\_head)
1073             )
1074             \textcolor{keywordflow}{return} tensor
1075 
\end{DoxyCode}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a3478f15a48d749a3cbfe0760722b249c}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a3478f15a48d749a3cbfe0760722b249c}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!reorder\+\_\+incremental\+\_\+state@{reorder\+\_\+incremental\+\_\+state}}
\index{reorder\+\_\+incremental\+\_\+state@{reorder\+\_\+incremental\+\_\+state}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{reorder\+\_\+incremental\+\_\+state()}{reorder\_incremental\_state()}}
{\footnotesize\ttfamily def parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+reorder\+\_\+incremental\+\_\+state (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{incremental\+\_\+state }\end{DoxyParamCaption})}



Definition at line 1159 of file modules.\+py.


\begin{DoxyCode}
1159         self, incremental\_state: Dict[str, torch.Tensor], inds: torch.Tensor
\end{DoxyCode}


\subsection{Member Data Documentation}
\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a59719fa112c890e082ef22280fe13cc4}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a59719fa112c890e082ef22280fe13cc4}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!attentioned@{attentioned}}
\index{attentioned@{attentioned}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{attentioned}{attentioned}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+attentioned\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1145 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_ac1c0169222b929c580d1a786479d7ed2}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_ac1c0169222b929c580d1a786479d7ed2}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!attn\+\_\+dropout@{attn\+\_\+dropout}}
\index{attn\+\_\+dropout@{attn\+\_\+dropout}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{attn\+\_\+dropout}{attn\_dropout}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+attn\+\_\+dropout}



Definition at line 1015 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a733f712c97d7aa9b8bd8b7fd28d3adfe}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a733f712c97d7aa9b8bd8b7fd28d3adfe}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!attn\+\_\+mask@{attn\+\_\+mask}}
\index{attn\+\_\+mask@{attn\+\_\+mask}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{attn\+\_\+mask}{attn\_mask}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+attn\+\_\+mask\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1132 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aef08475b7756f4c8e5049b3b17378a82}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aef08475b7756f4c8e5049b3b17378a82}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!attn\+\_\+weights@{attn\+\_\+weights}}
\index{attn\+\_\+weights@{attn\+\_\+weights}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{attn\+\_\+weights}{attn\_weights}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+attn\+\_\+weights\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1142 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a99f2e28c8a369a07a2982562391c1480}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a99f2e28c8a369a07a2982562391c1480}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!batch\+\_\+size@{batch\+\_\+size}}
\index{batch\+\_\+size@{batch\+\_\+size}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{batch\+\_\+size}{batch\_size}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+batch\+\_\+size\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1055 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a0ffd2e0d89db2f682561af438aaa1eb5}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a0ffd2e0d89db2f682561af438aaa1eb5}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!dim@{dim}}
\index{dim@{dim}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{dim}{dim}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+dim\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1055 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a50cc6181bc0d24e9e20f820344faa5ec}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a50cc6181bc0d24e9e20f820344faa5ec}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!dim\+\_\+per\+\_\+head@{dim\+\_\+per\+\_\+head}}
\index{dim\+\_\+per\+\_\+head@{dim\+\_\+per\+\_\+head}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{dim\+\_\+per\+\_\+head}{dim\_per\_head}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+dim\+\_\+per\+\_\+head\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1061 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a34fb7def27abc78d179c7d944d67c305}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a34fb7def27abc78d179c7d944d67c305}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!dot\+\_\+prod@{dot\+\_\+prod}}
\index{dot\+\_\+prod@{dot\+\_\+prod}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{dot\+\_\+prod}{dot\_prod}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+dot\+\_\+prod\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1130 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a8ef7af8f97df73fe6cd5fae6969e68bb}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a8ef7af8f97df73fe6cd5fae6969e68bb}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!full\+\_\+key\+\_\+len@{full\+\_\+key\+\_\+len}}
\index{full\+\_\+key\+\_\+len@{full\+\_\+key\+\_\+len}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{full\+\_\+key\+\_\+len}{full\_key\_len}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+full\+\_\+key\+\_\+len\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1129 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa5b5049ad1310575ef39a2221dc98867}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa5b5049ad1310575ef39a2221dc98867}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!incr\+\_\+state@{incr\+\_\+state}}
\index{incr\+\_\+state@{incr\+\_\+state}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{incr\+\_\+state}{incr\_state}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+incr\+\_\+state\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1096 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_acdf6ff5307055074178f77080196d42e}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_acdf6ff5307055074178f77080196d42e}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!k@{k}}
\index{k@{k}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{k}{k}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+k\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1087 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a1e86cacd8fe8129222fe04c41c48655d}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a1e86cacd8fe8129222fe04c41c48655d}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!k\+\_\+lin@{k\+\_\+lin}}
\index{k\+\_\+lin@{k\+\_\+lin}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{k\+\_\+lin}{k\_lin}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+k\+\_\+lin}



Definition at line 1017 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a39d1a56edfde6dd1af7cdd73d33c869a}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a39d1a56edfde6dd1af7cdd73d33c869a}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!key@{key}}
\index{key@{key}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{key}{key}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+key\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1079 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a5fa22233ceed27025626b6c58701f085}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a5fa22233ceed27025626b6c58701f085}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!mask@{mask}}
\index{mask@{mask}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{mask}{mask}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+mask\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1115 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa28ff3887a718bb96a9bd27c938a0baf}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_aa28ff3887a718bb96a9bd27c938a0baf}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!n\+\_\+heads@{n\+\_\+heads}}
\index{n\+\_\+heads@{n\+\_\+heads}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{n\+\_\+heads}{n\_heads}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+n\+\_\+heads\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1060 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_adb13ded9cb633bbe63d92dda6ab81e2a}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_adb13ded9cb633bbe63d92dda6ab81e2a}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!new\+\_\+incr\+\_\+state@{new\+\_\+incr\+\_\+state}}
\index{new\+\_\+incr\+\_\+state@{new\+\_\+incr\+\_\+state}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{new\+\_\+incr\+\_\+state}{new\_incr\_state}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+new\+\_\+incr\+\_\+state\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1123 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a5c4a6c579fe84cd7fc04456359d334ac}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a5c4a6c579fe84cd7fc04456359d334ac}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!out@{out}}
\index{out@{out}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{out}{out}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+out\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1154 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a495812bb583389a5f5dae989a22bda19}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a495812bb583389a5f5dae989a22bda19}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!out\+\_\+lin@{out\+\_\+lin}}
\index{out\+\_\+lin@{out\+\_\+lin}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{out\+\_\+lin}{out\_lin}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+out\+\_\+lin}



Definition at line 1024 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_abd21d573bbd199c212823d195b1cc70d}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_abd21d573bbd199c212823d195b1cc70d}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!prev\+\_\+key@{prev\+\_\+key}}
\index{prev\+\_\+key@{prev\+\_\+key}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{prev\+\_\+key}{prev\_key}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+prev\+\_\+key\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1098 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_abfd84c6f81cbcf82f2dc576cd2fd634d}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_abfd84c6f81cbcf82f2dc576cd2fd634d}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!prev\+\_\+value@{prev\+\_\+value}}
\index{prev\+\_\+value@{prev\+\_\+value}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{prev\+\_\+value}{prev\_value}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+prev\+\_\+value\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1106 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a14e312fdb4882f9f3dc730c08673aa54}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a14e312fdb4882f9f3dc730c08673aa54}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!q@{q}}
\index{q@{q}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{q}{q}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+q\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1086 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a84ab720bc232bb48e8f61e37e7c52323}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a84ab720bc232bb48e8f61e37e7c52323}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!q\+\_\+lin@{q\+\_\+lin}}
\index{q\+\_\+lin@{q\+\_\+lin}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{q\+\_\+lin}{q\_lin}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+q\+\_\+lin}



Definition at line 1016 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a100f3e07166c020ba43691ab0935b194}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a100f3e07166c020ba43691ab0935b194}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!query\+\_\+len@{query\+\_\+len}}
\index{query\+\_\+len@{query\+\_\+len}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{query\+\_\+len}{query\_len}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+query\+\_\+len\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1055 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_ae646637141fe94e312d080563f83ae5e}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_ae646637141fe94e312d080563f83ae5e}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!scale@{scale}}
\index{scale@{scale}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{scale}{scale}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+scale\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1062 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a96d6455bac45c0ebf237863d9f292fc1}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a96d6455bac45c0ebf237863d9f292fc1}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!v@{v}}
\index{v@{v}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{v}{v}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+v\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1088 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a1b1c33915c80f894221dfd4f0a0a2896}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a1b1c33915c80f894221dfd4f0a0a2896}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!v\+\_\+lin@{v\+\_\+lin}}
\index{v\+\_\+lin@{v\+\_\+lin}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{v\+\_\+lin}{v\_lin}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+v\+\_\+lin}



Definition at line 1018 of file modules.\+py.

\mbox{\Hypertarget{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a16e1973304e7a76af3293daa82e2f17a}\label{classparlai_1_1agents_1_1transformer_1_1modules_1_1MultiHeadAttention_a16e1973304e7a76af3293daa82e2f17a}} 
\index{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}!value@{value}}
\index{value@{value}!parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention@{parlai\+::agents\+::transformer\+::modules\+::\+Multi\+Head\+Attention}}
\subsubsection{\texorpdfstring{value}{value}}
{\footnotesize\ttfamily parlai.\+agents.\+transformer.\+modules.\+Multi\+Head\+Attention.\+value\hspace{0.3cm}{\ttfamily [static]}}



Definition at line 1079 of file modules.\+py.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
parlai/agents/transformer/\hyperlink{parlai_2agents_2transformer_2modules_8py}{modules.\+py}\end{DoxyCompactItemize}
