\hypertarget{namespaceparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker}{}\section{parlai.\+agents.\+bert\+\_\+ranker.\+cross\+\_\+encoder\+\_\+ranker Namespace Reference}
\label{namespaceparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker}\index{parlai.\+agents.\+bert\+\_\+ranker.\+cross\+\_\+encoder\+\_\+ranker@{parlai.\+agents.\+bert\+\_\+ranker.\+cross\+\_\+encoder\+\_\+ranker}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker_1_1CrossEncoderRankerAgent}{Cross\+Encoder\+Ranker\+Agent}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker_a3914765cd62574f6f077c6e2e0070ab4}{concat\+\_\+without\+\_\+padding} (text\+\_\+idx, cand\+\_\+idx, use\+\_\+cuda, null\+\_\+idx=0)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker_a3914765cd62574f6f077c6e2e0070ab4}\label{namespaceparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker_a3914765cd62574f6f077c6e2e0070ab4}} 
\index{parlai\+::agents\+::bert\+\_\+ranker\+::cross\+\_\+encoder\+\_\+ranker@{parlai\+::agents\+::bert\+\_\+ranker\+::cross\+\_\+encoder\+\_\+ranker}!concat\+\_\+without\+\_\+padding@{concat\+\_\+without\+\_\+padding}}
\index{concat\+\_\+without\+\_\+padding@{concat\+\_\+without\+\_\+padding}!parlai\+::agents\+::bert\+\_\+ranker\+::cross\+\_\+encoder\+\_\+ranker@{parlai\+::agents\+::bert\+\_\+ranker\+::cross\+\_\+encoder\+\_\+ranker}}
\subsubsection{\texorpdfstring{concat\+\_\+without\+\_\+padding()}{concat\_without\_padding()}}
{\footnotesize\ttfamily def parlai.\+agents.\+bert\+\_\+ranker.\+cross\+\_\+encoder\+\_\+ranker.\+concat\+\_\+without\+\_\+padding (\begin{DoxyParamCaption}\item[{}]{text\+\_\+idx,  }\item[{}]{cand\+\_\+idx,  }\item[{}]{use\+\_\+cuda,  }\item[{}]{null\+\_\+idx = {\ttfamily 0} }\end{DoxyParamCaption})}

\begin{DoxyVerb}if text_idx = [[1, 2, 3, 4, 0, 0  ]]
        and cand_idx = [[5, 6, 7, 8, 0, 0 ]]
        then result = (tokens, segments) where
        tokens = [[1, 2, 3, 4, 5, 6, 7, 8, 0, 0, 0, 0]]
        segments = [[0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0]]\end{DoxyVerb}
 

Definition at line 24 of file cross\+\_\+encoder\+\_\+ranker.\+py.


\begin{DoxyCode}
24 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1agents_1_1bert__ranker_1_1cross__encoder__ranker_a3914765cd62574f6f077c6e2e0070ab4}{concat\_without\_padding}(text\_idx, cand\_idx, use\_cuda, null\_idx=0):
25     \textcolor{stringliteral}{""" if text\_idx = [[1, 2, 3, 4, 0, 0  ]]}
26 \textcolor{stringliteral}{            and cand\_idx = [[5, 6, 7, 8, 0, 0 ]]}
27 \textcolor{stringliteral}{            then result = (tokens, segments) where}
28 \textcolor{stringliteral}{            tokens = [[1, 2, 3, 4, 5, 6, 7, 8, 0, 0, 0, 0]]}
29 \textcolor{stringliteral}{            segments = [[0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0]]}
30 \textcolor{stringliteral}{        """}
31     \textcolor{keyword}{assert} text\_idx.size(0) == cand\_idx.size(0)
32     \textcolor{keyword}{assert} len(text\_idx.size()) == 2
33     \textcolor{keyword}{assert} len(cand\_idx.size()) == 2
34     segments\_idx = [0, 1]
35     text\_idx = text\_idx.cpu()
36     cand\_idx = cand\_idx.cpu()
37     cand\_len = cand\_idx.size(1)
38     concat\_len = text\_idx.size(1) + cand\_idx.size(1)
39     tokens = text\_idx.new\_zeros(text\_idx.size(0), concat\_len) + null\_idx
40     segments = text\_idx.new\_zeros(text\_idx.size(0), concat\_len) + null\_idx
41     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(tokens)):
42         non\_nuls = torch.sum(text\_idx[i, :] != null\_idx)
43         tokens[i, 0:non\_nuls] = text\_idx[i, 0:non\_nuls]
44         segments[i, 0:non\_nuls] = segments\_idx[0]
45         tokens[i, non\_nuls : non\_nuls + cand\_len] = cand\_idx[i, :]
46         segments[i, non\_nuls : non\_nuls + cand\_len] = segments\_idx[1]
47     \textcolor{keywordflow}{if} use\_cuda:
48         tokens = tokens.cuda()
49         segments = segments.cuda()
50     \textcolor{keywordflow}{return} tokens, segments
51 
52 
\end{DoxyCode}
