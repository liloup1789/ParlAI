\hypertarget{namespaceparlai_1_1scripts_1_1eval__model}{}\section{parlai.\+scripts.\+eval\+\_\+model Namespace Reference}
\label{namespaceparlai_1_1scripts_1_1eval__model}\index{parlai.\+scripts.\+eval\+\_\+model@{parlai.\+scripts.\+eval\+\_\+model}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespaceparlai_1_1scripts_1_1eval__model_a2eaba0aa76c4d83e2a0f7f77c23479c8}{setup\+\_\+args} (\hyperlink{namespaceparlai_1_1scripts_1_1eval__model_add6748e40c9e6791f7189d2d48cba31a}{parser}=None)
\item 
def \hyperlink{namespaceparlai_1_1scripts_1_1eval__model_ade1dfda1be70776553a1fbd6a3450c40}{eval\+\_\+model} (opt, print\+\_\+parser=None)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespaceparlai_1_1scripts_1_1eval__model_add6748e40c9e6791f7189d2d48cba31a}{parser}
\item 
\hyperlink{namespaceparlai_1_1scripts_1_1eval__model_a4a8ca10054cd72a43598c93620adc4ff}{print\+\_\+args}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1scripts_1_1eval__model_ade1dfda1be70776553a1fbd6a3450c40}\label{namespaceparlai_1_1scripts_1_1eval__model_ade1dfda1be70776553a1fbd6a3450c40}} 
\index{parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}!eval\+\_\+model@{eval\+\_\+model}}
\index{eval\+\_\+model@{eval\+\_\+model}!parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}}
\subsubsection{\texorpdfstring{eval\+\_\+model()}{eval\_model()}}
{\footnotesize\ttfamily def parlai.\+scripts.\+eval\+\_\+model.\+eval\+\_\+model (\begin{DoxyParamCaption}\item[{}]{opt,  }\item[{}]{print\+\_\+parser = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Evaluates a model.

:param opt: tells the evaluation function how to run
:param bool print_parser: if provided, prints the options that are set within the
    model after loading the model
:return: the final result of calling report()
\end{DoxyVerb}
 

Definition at line 144 of file eval\+\_\+model.\+py.


\begin{DoxyCode}
144 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1scripts_1_1eval__model_ade1dfda1be70776553a1fbd6a3450c40}{eval\_model}(opt, print\_parser=None):
145     \textcolor{stringliteral}{"""}
146 \textcolor{stringliteral}{    Evaluates a model.}
147 \textcolor{stringliteral}{}
148 \textcolor{stringliteral}{    :param opt: tells the evaluation function how to run}
149 \textcolor{stringliteral}{    :param bool print\_parser: if provided, prints the options that are set within the}
150 \textcolor{stringliteral}{        model after loading the model}
151 \textcolor{stringliteral}{    :return: the final result of calling report()}
152 \textcolor{stringliteral}{    """}
153     random.seed(42)
154     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'train'} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'datatype'}] \textcolor{keywordflow}{and} \textcolor{stringliteral}{'evalmode'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} opt[\textcolor{stringliteral}{'datatype'}]:
155         \textcolor{keywordflow}{raise} ValueError(
156             \textcolor{stringliteral}{'You should use --datatype train:evalmode if you want to evaluate on '}
157             \textcolor{stringliteral}{'the training set.'}
158         )
159 
160     \textcolor{keywordflow}{if} opt[\textcolor{stringliteral}{'save\_world\_logs'}] \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} opt[\textcolor{stringliteral}{'report\_filename'}]:
161         \textcolor{keywordflow}{raise} RuntimeError(
162             \textcolor{stringliteral}{'In order to save model replies, please specify the save path '}
163             \textcolor{stringliteral}{'with --report-filename'}
164         )
165 
166     \textcolor{comment}{# load model and possibly print opt}
167     agent = \hyperlink{namespaceparlai_1_1core_1_1agents_a00d77a7e26fb89e8bd900f7b2a02982a}{create\_agent}(opt, requireModelExists=\textcolor{keyword}{True})
168     \textcolor{keywordflow}{if} print\_parser:
169         \textcolor{comment}{# show args after loading model}
170         print\_parser.opt = agent.opt
171         print\_parser.print\_args()
172 
173     tasks = opt[\textcolor{stringliteral}{'task'}].split(\textcolor{stringliteral}{','})
174     reports = []
175     \textcolor{keywordflow}{for} task \textcolor{keywordflow}{in} tasks:
176         task\_report = \_eval\_single\_world(opt, agent, task)
177         reports.append(task\_report)
178 
179     report = \hyperlink{namespaceparlai_1_1core_1_1metrics_ae323045c05ed03d93c260521ebb8bf71}{aggregate\_task\_reports}(
180         reports, tasks, micro=opt.get(\textcolor{stringliteral}{'aggregate\_micro'}, \textcolor{keyword}{True})
181     )
182 
183     \textcolor{comment}{# print announcments and report}
184     \hyperlink{namespaceparlai_1_1core_1_1params_afd1a47c94990168ea9e70d894a79bd2c}{print\_announcements}(opt)
185     print(
186         \textcolor{stringliteral}{'[ Finished evaluating tasks \{\} using datatype \{\} ]'}.\hyperlink{namespaceparlai_1_1chat__service_1_1services_1_1messenger_1_1shared__utils_a32e2e2022b824fbaf80c747160b52a76}{format}(
187             tasks, opt.get(\textcolor{stringliteral}{'datatype'}, \textcolor{stringliteral}{'N/A'})
188         )
189     )
190     print(report)
191     \_save\_eval\_stats(opt, report)
192     \textcolor{keywordflow}{return} report
193 
194 
\end{DoxyCode}
\mbox{\Hypertarget{namespaceparlai_1_1scripts_1_1eval__model_a2eaba0aa76c4d83e2a0f7f77c23479c8}\label{namespaceparlai_1_1scripts_1_1eval__model_a2eaba0aa76c4d83e2a0f7f77c23479c8}} 
\index{parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}!setup\+\_\+args@{setup\+\_\+args}}
\index{setup\+\_\+args@{setup\+\_\+args}!parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}}
\subsubsection{\texorpdfstring{setup\+\_\+args()}{setup\_args()}}
{\footnotesize\ttfamily def parlai.\+scripts.\+eval\+\_\+model.\+setup\+\_\+args (\begin{DoxyParamCaption}\item[{}]{parser = {\ttfamily None} }\end{DoxyParamCaption})}



Definition at line 32 of file eval\+\_\+model.\+py.


\begin{DoxyCode}
32 \textcolor{keyword}{def }\hyperlink{namespaceparlai_1_1scripts_1_1eval__model_a2eaba0aa76c4d83e2a0f7f77c23479c8}{setup\_args}(parser=None):
33     \textcolor{keywordflow}{if} parser \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
34         parser = ParlaiParser(\textcolor{keyword}{True}, \textcolor{keyword}{True}, \textcolor{stringliteral}{'Evaluate a model'})
35     parser.add\_pytorch\_datateacher\_args()
36     \textcolor{comment}{# Get command line arguments}
37     parser.add\_argument(
38         \textcolor{stringliteral}{'-rf'},
39         \textcolor{stringliteral}{'--report-filename'},
40         type=str,
41         default=\textcolor{stringliteral}{''},
42         help=\textcolor{stringliteral}{'Saves a json file of the evaluation report either as an '}
43         \textcolor{stringliteral}{'extension to the model-file (if begins with a ".") or a whole '}
44         \textcolor{stringliteral}{'file path. Set to the empty string to not save at all.'},
45     )
46     parser.add\_argument(
47         \textcolor{stringliteral}{'--save-world-logs'},
48         type=\textcolor{stringliteral}{'bool'},
49         default=\textcolor{keyword}{False},
50         help=\textcolor{stringliteral}{'Saves a jsonl file containing all of the task examples and '}
51         \textcolor{stringliteral}{'model replies. Must also specify --report-filename.'},
52     )
53     parser.add\_argument(\textcolor{stringliteral}{'-ne'}, \textcolor{stringliteral}{'--num-examples'}, type=int, default=-1)
54     parser.add\_argument(\textcolor{stringliteral}{'-d'}, \textcolor{stringliteral}{'--display-examples'}, type=\textcolor{stringliteral}{'bool'}, default=\textcolor{keyword}{False})
55     parser.add\_argument(\textcolor{stringliteral}{'-ltim'}, \textcolor{stringliteral}{'--log-every-n-secs'}, type=float, default=2)
56     parser.add\_argument(
57         \textcolor{stringliteral}{'-micro'},
58         \textcolor{stringliteral}{'--aggregate-micro'},
59         type=\textcolor{stringliteral}{'bool'},
60         default=\textcolor{keyword}{False},
61         help=\textcolor{stringliteral}{'If multitasking, average metrics over the '}
62         \textcolor{stringliteral}{'number of examples. If false, averages over the '}
63         \textcolor{stringliteral}{'number of tasks.'},
64     )
65     parser.add\_argument(
66         \textcolor{stringliteral}{'-mcs'},
67         \textcolor{stringliteral}{'--metrics'},
68         type=str,
69         default=\textcolor{stringliteral}{'default'},
70         help=\textcolor{stringliteral}{'list of metrics to show/compute, e.g. all, default,'}
71         \textcolor{stringliteral}{'or give a list split by , like '}
72         \textcolor{stringliteral}{'ppl,f1,accuracy,hits@1,rouge,bleu'}
73         \textcolor{stringliteral}{'the rouge metrics will be computed as rouge-1, rouge-2 and rouge-l'},
74     )
75     WorldLogger.add\_cmdline\_args(parser)
76     TensorboardLogger.add\_cmdline\_args(parser)
77     parser.set\_defaults(datatype=\textcolor{stringliteral}{'valid'})
78     \textcolor{keywordflow}{return} parser
79 
80 
\end{DoxyCode}


\subsection{Variable Documentation}
\mbox{\Hypertarget{namespaceparlai_1_1scripts_1_1eval__model_add6748e40c9e6791f7189d2d48cba31a}\label{namespaceparlai_1_1scripts_1_1eval__model_add6748e40c9e6791f7189d2d48cba31a}} 
\index{parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}!parser@{parser}}
\index{parser@{parser}!parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}}
\subsubsection{\texorpdfstring{parser}{parser}}
{\footnotesize\ttfamily parlai.\+scripts.\+eval\+\_\+model.\+parser}



Definition at line 196 of file eval\+\_\+model.\+py.

\mbox{\Hypertarget{namespaceparlai_1_1scripts_1_1eval__model_a4a8ca10054cd72a43598c93620adc4ff}\label{namespaceparlai_1_1scripts_1_1eval__model_a4a8ca10054cd72a43598c93620adc4ff}} 
\index{parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}!print\+\_\+args@{print\+\_\+args}}
\index{print\+\_\+args@{print\+\_\+args}!parlai\+::scripts\+::eval\+\_\+model@{parlai\+::scripts\+::eval\+\_\+model}}
\subsubsection{\texorpdfstring{print\+\_\+args}{print\_args}}
{\footnotesize\ttfamily parlai.\+scripts.\+eval\+\_\+model.\+print\+\_\+args}



Definition at line 197 of file eval\+\_\+model.\+py.

